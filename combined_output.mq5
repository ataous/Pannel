// Combined Code Files
-e 

//+------------------------------------------------------------------+
//|                                               Pannel Service.mq5 |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property strict
#property service
//+------------------------------------------------------------------+
#include <_Ata\PanelServer\Defines.mqh>
#include <_Ata\PanelServer\Licence.mqh>
#include <_Ata\PanelServer\WebSocketApp.mqh>
#define  DEF_IS_TEST_MODE false
//+------------------------------------------------------------------+
//| Service program start function                                   |
//+------------------------------------------------------------------+
void OnStart()
 {
//string s = CreateLicence(D'2025.01.29 00:00:00');
  ::Print("Service Started. " + __FUNCSIG__);
//---
  SEQ_LOG_INIT("node", DEF_SEQ_LOG_URL, DEF_SEQ_LOG_HEADER);

  CWebSocketApp App(DEF_WEBSOCKET_SERVER);
  bool safe_stop = false;
  do
   {
    //---
    if(DEF_IS_TEST_MODE)
     {
      //string task = (string)(int)TASK_TYPE_RESET;
      string task = (string)(int)TASK_TYPE_UPDATE;
      string hash_a = "";
      string hash_b = "";
      if(true)
       {
        //--- my test account
        hash_a = "eyJ0aW1lTXNjIjoxNzMwMjgzMTg5NzY0fQ==";
        hash_b = "eyJ0aW1lIjoxNzMwMzEzOTYwMDAwLCJiYWxuY2UiOjE5OTkyNi4wMDAwMDAwMCwiZGF5TGltaXQiOjE5MDAwMC4wMDAwMDAwMCwidG90YWxMaW1pdCI6MTc2MDAwLjAwMDAwMDAwfQ==";

        string acc_id = "1223";
        string login = "899422";
        string pass = "0PeBg@1*";
        string init_bal = "200000";

        //--- Other Account
        //        hash_a = "";
        //        hash_b = "";
        //
        //        string acc_id = "1163";
        //        string login = "893992";
        //        string pass = "ZsE!p2@6";
        //        string init_bal = "5000";

        string response = "{"                                                +
                          "\"nodeId\": \"ata-test-node\","                   +
                          "\"task\": " + task + ","                          +
                          "\"accountId\": \"" + acc_id + "\","               +
                          "\"login\": " + login + ","                        +
                          "\"investorPassword\": \"" + pass + "\","          +
                          "\"server\": \"UNFXB-Real\","                      +
                          "\"hashPointA\": \"" + hash_a + "\","              +
                          "\"hashPointB\": \"" + hash_b + "\","              +
                          "\"userId\": 0,"                                   +
                          "\"initBalance\": " + init_bal + ","               +
                          "\"targetPercent\": 10,"                           +
                          "\"dailyPercent\": 5,"                             +
                          "\"totalPercent\": 12,"                            +
                          "\"tickScalp\":true,"                              +
                          "\"tickScalpTerm\": 30000,"                        +
                          "\"gambeling\":true, "                             +
                          "\"gambelingPercent\": 3,"                         +
                          "\"news\":true,"                                   +
                          "\"weekend\":true,"                                +
                          "\"trailTotal\":false,"                            +
                          "\"trailTotalType\": 0,"                           +
                          "\"secure\":false"                                 +
                          "}";

        App.CheckTask(response);
       }
      else     // accounts loop
       {
        int acc_ids[]      = {1163, 1172, 1173, 1181, 1182, 1185, 1188, 1194, 1197, 1199, 1200, 1201, 1203, 1204, 1209, 1216, 1218, 1219, 1221, 1222, 1223, 1227, 1230, 1231, 1237, 1251, 1252, 1253, 1255, 1256, 1257, 1258, 1259, 1260, 1261, 1262, 1263, 1264, 1265, 1266, 1267};
        int logins[]       = {893992, 893003, 808318, 894749, 322483, 810111, 819174, 893749, 126535, 889782, 895653, 893758, 813774, 895702, 897101, 895223, 898998, 812569, 889750, 808570, 899422, 122297, 896566, 897417, 812076, 813459, 815275, 889661, 892163, 896108, 898068, 903344, 902837, 815281, 901839, 789602, 899210, 902981, 899067, 901129, 903724};
        string passwords[] = {"ZsE!p2@6", "Y!P29j@y", ")bY4LXo2", "i8b@8!FJ", "OMDTin4)", "u23A)0ZL", "sGh#8]zA", "d41g!N!L", "S^riT0_e", "^1RfU4Jk", "U*!gI4h4", "iz1P9N!!", "]+q40USa", "89z*!KCp", "B7k*J@w4", "Ve*@R01v", "ZwV@92x!", "r#LVlt95", "7Xf9qW*x", "UyF5bOx%", "*Du0S!a5", "ux(Wb4gq", "5L@wg6P*", "!@pI9t9V", "z5O)jO*z", "w1E)5wQT", "Df0zk&!K", "tJ1&UM7)", "sYTk!22*", "39!*ncOF", "Jr*5@1Fa", "@el*6KN4", "Bb0@Rc6!", "r1enO!VO", "!*1Gy6fP", "rPlt5x4)", "34Eu*q@W", "P@w5@Qh8", "ok!*6HO8", "*J54B@es", "F@u@8Fi2"};
        int init_bals[]    = {5000, 10000, 100000, 200000, 25000, 5000, 200000, 10000, 25000, 5000, 10000, 5000, 5000, 25000, 50000, 50000, 10000, 5000, 10000, 5000, 200000, 25000, 5000, 10000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 50000, 10000, 5000, 5000, 10000, 25000, 5000, 200000, 10000, 5000};

        for(uint i = 0; i < acc_ids.Size(); i++)
         {
          string response = "{"                                                +
                            "\"nodeId\": \"ata-test-node\","                   +
                            "\"task\": " + task + ","                          +
                            "\"accountId\": \"" + (string)acc_ids[i] + "\","   +
                            "\"login\": " + (string)logins[i] + ","            +
                            "\"investorPassword\": \"" + passwords[i] + "\","  +
                            "\"server\": \"UNFXB-Real\","                      +
                            "\"hashPointA\": \"" + hash_a + "\","              +
                            "\"hashPointB\": \"" + hash_b + "\","              +
                            "\"userId\": 0,"                                   +
                            "\"initBalance\": " + (string)init_bals[i] + ","   +
                            "\"targetPercent\": 10,"                           +
                            "\"dailyPercent\": 5,"                             +
                            "\"totalPercent\": 12,"                            +
                            "\"tickScalp\":true,"                              +
                            "\"tickScalpTerm\": 30000,"                        +
                            "\"gambeling\":true, "                             +
                            "\"gambelingPercent\": 3,"                         +
                            "\"news\":true,"                                   +
                            "\"weekend\":true,"                                +
                            "\"trailTotal\":false,"                            +
                            "\"trailTotalType\": 0,"                           +
                            "\"secure\":false"                                 +
                            "}";

          App.CheckTask(response);
         }
       }
      continue;
     }
    //---
    if(!IsLicenced())
     {
      ::Print("Check Internet Connection...");
      ::Sleep(DEF_LICENCE_SLEEP_INTERVAL);
      continue;
     }
    //---
    if(App.CheckStopApp())
     {
      safe_stop = true;
      break;
     }
    if(App.CheckPauseApp())
     {
      ::Sleep(DEF_PAUSE_SLEEP_INTERVAL);
      continue;
     }
    //---
    App.CheckServerLoss();

    if(!App.isConnected() && !App.open(DEF_WEBSOCKET_OPEN_HEADER))
     {
      ::Sleep(DEF_SLEEP_INTERVAL);
      continue;
     }

    App.checkMessages(false);
    ::Sleep(DEF_SLEEP_INTERVAL);
   }
  while(!::IsStopped());

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
  App.close();
//---
  string message = "Service Stoped. ";
  ::Print(message + __FUNCSIG__);
  if(!safe_stop)
   {
    _SeqLogger.SetErrorCode((string)DEF_APP_ERR_SERVICE_STOP);
    _SeqLogger.SetDescription("Service Stoped");
    _SeqLogger.SetStatus(DEF_APP_STATUS_FAIL);
    _SeqLogger.SetTask("-");
    SEQ_LOG_FATAL(message);
   }
  else
    ::Print("Safe Stop...");
 }
//+------------------------------------------------------------------+

//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                         File.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Object.mqh>
//+------------------------------------------------------------------+
//| Class CFile.                                                     |
//| Purpose: Base class of file operations.                          |
//|          Derives from class CObject.                             |
//+------------------------------------------------------------------+
class CFile : public CObject
  {
protected:
   int               m_handle;             // handle of file
   string            m_name;               // name of opened file
   int               m_flags;              // flags of opened file

public:
                     CFile(void);
                    ~CFile(void);
   //--- methods of access to protected data
   int               Handle(void)              const { return(m_handle); };
   string            FileName(void)            const { return(m_name);   };
   int               Flags(void)               const { return(m_flags);  };
   void              SetUnicode(const bool unicode);
   void              SetCommon(const bool common);
   //--- general methods for working with files
   int               Open(const string file_name,int open_flags,const short delimiter='\t');
   void              Close(void);
   void              Delete(void);
   ulong             Size(void);
   ulong             Tell(void);
   void              Seek(const long offset,const ENUM_FILE_POSITION origin);
   void              Flush(void);
   bool              IsEnding(void);
   bool              IsLineEnding(void);
   //--- general methods for working with files
   void              Delete(const string file_name,const int common_flag=0);
   bool              IsExist(const string file_name,const int common_flag=0);
   bool              Copy(const string src_name,const int common_flag,const string dst_name,const int mode_flags);
   bool              Move(const string src_name,const int common_flag,const string dst_name,const int mode_flags);
   //--- general methods of working with folders
   bool              FolderCreate(const string folder_name);
   bool              FolderDelete(const string folder_name);
   bool              FolderClean(const string folder_name);
   //--- general methods of finding files
   long              FileFindFirst(const string file_filter,string &returned_filename);
   bool              FileFindNext(const long search_handle,string &returned_filename);
   void              FileFindClose(const long search_handle);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CFile::CFile(void) : m_handle(INVALID_HANDLE),
                     m_name(""),
                     m_flags(FILE_ANSI)
  {
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CFile::~CFile(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      Close();
  }
//+------------------------------------------------------------------+
//| Set the FILE_UNICODE flag                                        |
//+------------------------------------------------------------------+
void CFile::SetUnicode(const bool unicode)
  {
//--- check handle
   if(m_handle==INVALID_HANDLE)
     {
      if(unicode)
         m_flags|=FILE_UNICODE;
      else
         m_flags&=~FILE_UNICODE;
     }
  }
//+------------------------------------------------------------------+
//| Set the "Common Folder" flag                                     |
//+------------------------------------------------------------------+
void CFile::SetCommon(const bool common)
  {
//--- check handle
   if(m_handle==INVALID_HANDLE)
     {
      if(common)
         m_flags|=FILE_COMMON;
      else
         m_flags&=~FILE_COMMON;
     }
  }
//+------------------------------------------------------------------+
//| Open the file                                                    |
//+------------------------------------------------------------------+
int CFile::Open(const string file_name,int open_flags,const short delimiter)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      Close();
//--- action
   if((open_flags &(FILE_BIN|FILE_CSV))==0)
      open_flags|=FILE_TXT;
//--- open
   m_handle=FileOpen(file_name,open_flags|m_flags,delimiter);
   if(m_handle!=INVALID_HANDLE)
     {
      //--- store options of the opened file
      m_flags|=open_flags;
      m_name=file_name;
     }
//--- result
   return(m_handle);
  }
//+------------------------------------------------------------------+
//| Close the file                                                   |
//+------------------------------------------------------------------+
void CFile::Close(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
     {
      //--- closing the file and resetting all the variables to the initial state
      FileClose(m_handle);
      m_handle=INVALID_HANDLE;
      m_name="";
      //--- reset all flags except the text
      m_flags&=FILE_ANSI|FILE_UNICODE;
     }
  }
//+------------------------------------------------------------------+
//| Deleting an open file                                            |
//+------------------------------------------------------------------+
void CFile::Delete(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
     {
      string file_name=m_name;
      int    common_flag=m_flags&FILE_COMMON;
      //--- close before deleting
      Close();
      //--- delete
      FileDelete(file_name,common_flag);
     }
  }
//+------------------------------------------------------------------+
//| Get size of opened file                                          |
//+------------------------------------------------------------------+
ulong CFile::Size(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      return(FileSize(m_handle));
//--- failure
   return(0);
  }
//+------------------------------------------------------------------+
//| Get current position of pointer in file                          |
//+------------------------------------------------------------------+
ulong CFile::Tell(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      return(FileTell(m_handle));
//--- failure
   return(0);
  }
//+------------------------------------------------------------------+
//| Set position of pointer in file                                  |
//+------------------------------------------------------------------+
void CFile::Seek(const long offset,const ENUM_FILE_POSITION origin)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      FileSeek(m_handle,offset,origin);
  }
//+------------------------------------------------------------------+
//| Flush data from the file buffer of input-output to disk          |
//+------------------------------------------------------------------+
void CFile::Flush(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      FileFlush(m_handle);
  }
//+------------------------------------------------------------------+
//| Detect the end of file                                           |
//+------------------------------------------------------------------+
bool CFile::IsEnding(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      return(FileIsEnding(m_handle));
//--- failure
   return(false);
  }
//+------------------------------------------------------------------+
//| Detect the end of string                                         |
//+------------------------------------------------------------------+
bool CFile::IsLineEnding(void)
  {
//--- checking
   if(m_handle!=INVALID_HANDLE)
      if((m_flags&FILE_BIN)==0)
         return(FileIsLineEnding(m_handle));
//--- failure
   return(false);
  }
//+------------------------------------------------------------------+
//| Deleting a file                                                  |
//+------------------------------------------------------------------+
void CFile::Delete(const string file_name,const int common_flag)
  {
//--- checking
   if(file_name==m_name)
     {
      int flag=m_flags&FILE_COMMON;
      if(flag==common_flag)
         Close();
     }
//--- delete
   FileDelete(file_name,common_flag);
  }
//+------------------------------------------------------------------+
//| Check if file exists                                             |
//+------------------------------------------------------------------+
bool CFile::IsExist(const string file_name,const int common_flag)
  {
   return(FileIsExist(file_name,common_flag));
  }
//+------------------------------------------------------------------+
//| Copying file                                                     |
//+------------------------------------------------------------------+
bool CFile::Copy(const string src_name,const int common_flag,const string dst_name,const int mode_flags)
  {
   return(FileCopy(src_name,common_flag,dst_name,mode_flags));
  }
//+------------------------------------------------------------------+
//| Move/rename file                                                 |
//+------------------------------------------------------------------+
bool CFile::Move(const string src_name,const int common_flag,const string dst_name,const int mode_flags)
  {
   return(FileMove(src_name,common_flag,dst_name,mode_flags));
  }
//+------------------------------------------------------------------+
//| Create folder                                                    |
//+------------------------------------------------------------------+
bool CFile::FolderCreate(const string folder_name)
  {
   return(::FolderCreate(folder_name,m_flags));
  }
//+------------------------------------------------------------------+
//| Delete folder                                                    |
//+------------------------------------------------------------------+
bool CFile::FolderDelete(const string folder_name)
  {
   return(::FolderDelete(folder_name,m_flags));
  }
//+------------------------------------------------------------------+
//| Clean folder                                                     |
//+------------------------------------------------------------------+
bool CFile::FolderClean(const string folder_name)
  {
   return(::FolderClean(folder_name,m_flags));
  }
//+------------------------------------------------------------------+
//| Start search of files                                            |
//+------------------------------------------------------------------+
long CFile::FileFindFirst(const string file_filter,string &returned_filename)
  {
   return(::FileFindFirst(file_filter,returned_filename,m_flags));
  }
//+------------------------------------------------------------------+
//| Continue search of files                                         |
//+------------------------------------------------------------------+
bool CFile::FileFindNext(const long search_handle,string &returned_filename)
  {
   return(::FileFindNext(search_handle,returned_filename));
  }
//+------------------------------------------------------------------+
//| End search of files                                              |
//+------------------------------------------------------------------+
void CFile::FileFindClose(const long search_handle)
  {
   ::FileFindClose(search_handle);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      FileTxt.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "File.mqh"
//+------------------------------------------------------------------+
//| Class CFileTxt                                                   |
//| Purpose: Class of operations with text files.                    |
//|          Derives from class CFile.                               |
//+------------------------------------------------------------------+
class CFileTxt : public CFile
  {
public:
                     CFileTxt(void);
                    ~CFileTxt(void);
   //--- methods for working with files
   int               Open(const string file_name,const int open_flags);
   //--- methods to access data
   uint              WriteString(const string value);
   string            ReadString(void);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CFileTxt::CFileTxt(void)
  {
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CFileTxt::~CFileTxt(void)
  {
  }
//+------------------------------------------------------------------+
//| Open the text file                                               |
//+------------------------------------------------------------------+
int CFileTxt::Open(const string file_name,const int open_flags)
  {
   return(CFile::Open(file_name,open_flags|FILE_TXT));
  }
//+------------------------------------------------------------------+
//| Writing string to file                                           |
//+------------------------------------------------------------------+
uint CFileTxt::WriteString(const string value)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      return(FileWriteString(m_handle,value));
//--- failure
   return(0);
  }
//+------------------------------------------------------------------+
//| Reading string from file                                         |
//+------------------------------------------------------------------+
string CFileTxt::ReadString(void)
  {
//--- check handle
   if(m_handle!=INVALID_HANDLE)
      return(FileReadString(m_handle));
//--- failure
   return("");
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                        Array.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Object.mqh>
//+------------------------------------------------------------------+
//| Class CArray                                                     |
//| Purpose: Base class of dynamic arrays.                           |
//|          Derives from class CObject.                             |
//+------------------------------------------------------------------+
class CArray : public CObject
  {
protected:
   int               m_step_resize;      // increment size of the array
   int               m_data_total;       // number of elements
   int               m_data_max;         // maximmum size of the array without memory reallocation
   int               m_sort_mode;        // mode of array sorting

public:
                     CArray(void);
                    ~CArray(void);
   //--- methods of access to protected data
   int               Step(void) const { return(m_step_resize); }
   bool              Step(const int step);
   int               Total(void) const { return(m_data_total); }
   int               Available(void) const { return(m_data_max-m_data_total); }
   int               Max(void) const { return(m_data_max); }
   bool              IsSorted(const int mode=0) const { return(m_sort_mode==mode); }
   int               SortMode(void) const { return(m_sort_mode); }
   //--- cleaning method
   void              Clear(void) { m_data_total=0; }
   //--- methods for working with files
   virtual bool      Save(const int file_handle);
   virtual bool      Load(const int file_handle);
   //--- sorting method
   void              Sort(const int mode=0);

protected:
   virtual void      QuickSort(int beg,int end,const int mode=0) { m_sort_mode=-1; }
   //--- templates for methods of searching for minimum and maximum
   template<typename T>
   int               Minimum(const T &data[],const int start,const int count) const;
   template<typename T>
   int               Maximum(const T &data[],const int start,const int count) const;
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CArray::CArray(void) : m_step_resize(16),
                       m_data_total(0),
                       m_data_max(0),
                       m_sort_mode(-1)
  {
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CArray::~CArray(void)
  {
  }
//+------------------------------------------------------------------+
//| Method Set for variable m_step_resize                            |
//+------------------------------------------------------------------+
bool CArray::Step(const int step)
  {
//--- check
   if(step>0)
     {
      m_step_resize=step;
      return(true);
     }
//--- failure
   return(false);
  }
//+------------------------------------------------------------------+
//| Sorting an array in ascending order                              |
//+------------------------------------------------------------------+
void CArray::Sort(const int mode)
  {
//--- check
   if(IsSorted(mode))
      return;
   m_sort_mode=mode;
   if(m_data_total<=1)
      return;
//--- sort
   QuickSort(0,m_data_total-1,mode);
  }
//+------------------------------------------------------------------+
//| Writing header of array to file                                  |
//+------------------------------------------------------------------+
bool CArray::Save(const int file_handle)
  {
//--- check handle
   if(file_handle!=INVALID_HANDLE)
     {
      //--- write start marker - 0xFFFFFFFFFFFFFFFF
      if(FileWriteLong(file_handle,-1)==sizeof(long))
        {
         //--- write array type
         if(FileWriteInteger(file_handle,Type(),INT_VALUE)==INT_VALUE)
            return(true);
        }
     }
//--- failure
   return(false);
  }
//+------------------------------------------------------------------+
//| Reading header of array from file                                |
//+------------------------------------------------------------------+
bool CArray::Load(const int file_handle)
  {
//--- check handle
   if(file_handle!=INVALID_HANDLE)
     {
      //--- read and check start marker - 0xFFFFFFFFFFFFFFFF
      if(FileReadLong(file_handle)==-1)
        {
         //--- read and check array type
         if(FileReadInteger(file_handle,INT_VALUE)==Type())
            return(true);
        }
     }
//--- failure
   return(false);
  }
//+------------------------------------------------------------------+
//| Find minimum of array                                            |
//+------------------------------------------------------------------+
template<typename T>
int CArray::Minimum(const T &data[],const int start,const int count) const
  {
   int real_count;
//--- check for empty array
   if(m_data_total<1)
     {
      SetUserError(ERR_USER_ARRAY_IS_EMPTY);
      return(-1);
     }
   //--- check for start is out of range
   if(start<0 || start>=m_data_total)
     {
      SetUserError(ERR_USER_ITEM_NOT_FOUND);
      return(-1);
     }
//--- compute count of elements
   real_count=(count==WHOLE_ARRAY || start+count>m_data_total) ? m_data_total-start : count;
#ifdef __MQL5__
   return(ArrayMinimum(data,start,real_count));
#else
   return(ArrayMinimum(data,real_count,start));
#endif
  }
//+------------------------------------------------------------------+
//| Find maximum of array                                            |
//+------------------------------------------------------------------+
template<typename T>
int CArray::Maximum(const T &data[],const int start,const int count) const
  {
   int real_count;
//--- check for empty array
   if(m_data_total<1)
     {
      SetUserError(ERR_USER_ARRAY_IS_EMPTY);
      return(-1);
     }
   //--- check for start is out of range
   if(start<0 || start>=m_data_total)
     {
      SetUserError(ERR_USER_ITEM_NOT_FOUND);
      return(-1);
     }
//--- compute count of elements
   real_count=(count==WHOLE_ARRAY || start+count>m_data_total) ? m_data_total-start : count;
#ifdef __MQL5__
   return(ArrayMaximum(data,start,real_count));
#else
   return(ArrayMaximum(data,real_count,start));
#endif
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                     ArrayObj.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "Array.mqh"
//+------------------------------------------------------------------+
//| Class CArrayObj.                                                 |
//| Puprose: Class of dynamic array of pointers to instances         |
//|          of the CObject class and its derivatives.               |
//|          Derives from class CArray.                              |
//+------------------------------------------------------------------+
class CArrayObj : public CArray
  {
protected:
   CObject          *m_data[];           // data array
   bool              m_free_mode;        // flag of necessity of "physical" deletion of object

public:
                     CArrayObj(void);
                    ~CArrayObj(void);
   //--- methods of access to protected data
   bool              FreeMode(void) const { return(m_free_mode); }
   void              FreeMode(const bool mode) { m_free_mode=mode; }
   //--- method of identifying the object
   virtual int       Type(void) const { return(0x7778); }
   //--- methods for working with files
   virtual bool      Save(const int file_handle);
   virtual bool      Load(const int file_handle);
   //--- method of creating an element of array
   virtual bool      CreateElement(const int index) { return(false); }
   //--- methods of managing dynamic memory
   bool              Reserve(const int size);
   bool              Resize(const int size);
   bool              Shutdown(void);
   //--- methods of filling the array
   bool              Add(CObject *element);
   bool              AddArray(const CArrayObj *src);
   bool              Insert(CObject *element,const int pos);
   bool              InsertArray(const CArrayObj *src,const int pos);
   bool              AssignArray(const CArrayObj *src);
   //--- method of access to thre array
   CObject          *At(const int index) const;
   //--- methods of changing
   bool              Update(const int index,CObject *element);
   bool              Shift(const int index,const int shift);
   //--- methods of deleting
   CObject          *Detach(const int index);
   bool              Delete(const int index);
   bool              DeleteRange(int from,int to);
   void              Clear(void);
   //--- method for comparing arrays
   bool              CompareArray(const CArrayObj *array) const;
   //--- methods for working with the sorted array
   bool              InsertSort(CObject *element);
   int               Search(const CObject *element) const;
   int               SearchGreat(const CObject *element) const;
   int               SearchLess(const CObject *element) const;
   int               SearchGreatOrEqual(const CObject *element) const;
   int               SearchLessOrEqual(const CObject *element) const;
   int               SearchFirst(const CObject *element) const;
   int               SearchLast(const CObject *element) const;

protected:
   void              QuickSort(int beg,int end,const int mode);
   int               QuickSearch(const CObject *element) const;
   int               MemMove(const int dest,const int src,int count);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CArrayObj::CArrayObj(void) : m_free_mode(true)
  {
//--- initialize protected data
   m_data_max=ArraySize(m_data);
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CArrayObj::~CArrayObj(void)
  {
   if(m_data_max!=0)
      Shutdown();
  }
//+------------------------------------------------------------------+
//| Moving the memory within a single array                          |
//+------------------------------------------------------------------+
int CArrayObj::MemMove(const int dest,const int src,int count)
  {
   int i;
//--- check parameters
   if(dest<0 || src<0 || count<0)
      return(-1);
//--- check count
   if(src+count>m_data_total)
      count=m_data_total-src;
   if(count<0)
      return(-1);
//--- no need to copy
   if(dest==src || count==0)
      return(dest);
//--- check data total
   if(dest+count>m_data_total)
     {
      if(m_data_max<dest+count)
         return(-1);
      m_data_total=dest+count;
     }
//--- copy
   if(dest<src)
     {
      //--- copy from left to right
      for(i=0;i<count;i++)
        {
         //--- "physical" removal of the object (if necessary and possible)
         if(m_free_mode && CheckPointer(m_data[dest+i])==POINTER_DYNAMIC)
            delete m_data[dest+i];
         //---
         m_data[dest+i]=m_data[src+i];
         m_data[src+i]=NULL;
        }
     }
   else
     {
      //--- copy from right to left
      for(i=count-1;i>=0;i--)
        {
         //--- "physical" removal of the object (if necessary and possible)
         if(m_free_mode && CheckPointer(m_data[dest+i])==POINTER_DYNAMIC)
            delete m_data[dest+i];
         //---
         m_data[dest+i]=m_data[src+i];
         m_data[src+i]=NULL;
        }
     }
//--- successful
   return(dest);
  }
//+------------------------------------------------------------------+
//| Request for more memory in an array. Checks if the requested     |
//| number of free elements already exists; allocates additional     |
//| memory with a given step                                         |
//+------------------------------------------------------------------+
bool CArrayObj::Reserve(const int size)
  {
   int new_size;
//--- check
   if(size<=0)
      return(false);
//--- resize array
   if(Available()<size)
     {
      new_size=m_data_max+m_step_resize*(1+(size-Available())/m_step_resize);
      if(new_size<0)
         //--- overflow occurred when calculating new_size
         return(false);
      if((m_data_max=ArrayResize(m_data,new_size))==-1)
         m_data_max=ArraySize(m_data);
      //--- explicitly zeroize all the loose items in the array
      for(int i=m_data_total;i<m_data_max;i++)
         m_data[i]=NULL;
     }
//--- result
   return(Available()>=size);
  }
//+------------------------------------------------------------------+
//| Resizing (with removal of elements on the right)                 |
//+------------------------------------------------------------------+
bool CArrayObj::Resize(const int size)
  {
   int new_size;
//--- check
   if(size<0)
      return(false);
//--- resize array
   new_size=m_step_resize*(1+size/m_step_resize);
   if(m_data_total>size)
     {
      //--- "physical" removal of the object (if necessary and possible)
      if(m_free_mode)
         for(int i=size;i<m_data_total;i++)
            if(CheckPointer(m_data[i])==POINTER_DYNAMIC)
               delete m_data[i];
      m_data_total=size;
     }
   if(m_data_max!=new_size)
     {
      if((m_data_max=ArrayResize(m_data,new_size))==-1)
        {
         m_data_max=ArraySize(m_data);
         return(false);
        }
     }
//--- result
   return(m_data_max==new_size);
  }
//+------------------------------------------------------------------+
//| Complete cleaning of the array with the release of memory        |
//+------------------------------------------------------------------+
bool CArrayObj::Shutdown(void)
  {
//--- check
   if(m_data_max==0)
      return(true);
//--- clean
   Clear();
   if(ArrayResize(m_data,0)==-1)
      return(false);
   m_data_max=0;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array                        |
//+------------------------------------------------------------------+
bool CArrayObj::Add(CObject *element)
  {
//--- check
   if(!CheckPointer(element))
      return(false);
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- add
   m_data[m_data_total++]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array from another array     |
//+------------------------------------------------------------------+
bool CArrayObj::AddArray(const CArrayObj *src)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.Total();
   if(!Reserve(num))
      return(false);
//--- add
   for(int i=0;i<num;i++)
      m_data[m_data_total++]=src.m_data[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting an element in the specified position                   |
//+------------------------------------------------------------------+
bool CArrayObj::Insert(CObject *element,const int pos)
  {
//--- check
   if(pos<0 || !CheckPointer(element))
      return(false);
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- insert
   m_data_total++;
   if(pos<m_data_total-1)
     {
      if(MemMove(pos+1,pos,m_data_total-pos-1)<0)
         return(false);
      m_data[pos]=element;
     }
   else
      m_data[m_data_total-1]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting elements in the specified position                     |
//+------------------------------------------------------------------+
bool CArrayObj::InsertArray(const CArrayObj *src,const int pos)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.Total();
   if(!Reserve(num)) return(false);
//--- insert
   if(MemMove(num+pos,pos,m_data_total-pos)<0)
      return(false);
   for(int i=0;i<num;i++)
      m_data[i+pos]=src.m_data[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Assignment (copying) of another array                            |
//+------------------------------------------------------------------+
bool CArrayObj::AssignArray(const CArrayObj *src)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.m_data_total;
   Clear();
   if(m_data_max<num)
     {
      if(!Reserve(num))
         return(false);
     }
   else
      Resize(num);
//--- copy array
   for(int i=0;i<num;i++)
     {
      m_data[i]=src.m_data[i];
      m_data_total++;
     }
   m_sort_mode=src.SortMode();
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Access to data in the specified position                         |
//+------------------------------------------------------------------+
CObject *CArrayObj::At(const int index) const
  {
//--- check
   if(index<0 || index>=m_data_total)
      return(NULL);
//--- result
   return(m_data[index]);
  }
//+------------------------------------------------------------------+
//| Updating element in the specified position                       |
//+------------------------------------------------------------------+
bool CArrayObj::Update(const int index,CObject *element)
  {
//--- check
   if(index<0 || !CheckPointer(element) || index>=m_data_total)
      return(false);
//--- "physical" removal of the object (if necessary and possible)
   if(m_free_mode && CheckPointer(m_data[index])==POINTER_DYNAMIC)
      delete m_data[index];
//--- update
   m_data[index]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Moving element from the specified position                       |
//| on the specified shift                                           |
//+------------------------------------------------------------------+
bool CArrayObj::Shift(const int index,const int shift)
  {
   CObject *tmp_node;
//--- check
   if(index<0 || index+shift<0 || index+shift>=m_data_total)
      return(false);
   if(shift==0)
      return(true);
//--- move
   tmp_node=m_data[index];
   m_data[index]=NULL;
   if(shift>0)
     {
      if(MemMove(index,index+1,shift)<0)
         return(false);
     }
   else
     {
      if(MemMove(index+shift+1,index+shift,-shift)<0)
         return(false);
     }
   m_data[index+shift]=tmp_node;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Deleting element from the specified position                     |
//+------------------------------------------------------------------+
bool CArrayObj::Delete(const int index)
  {
//--- check
   if(index>=m_data_total)
      return(false);
//--- delete
   if(index<m_data_total-1)
     {
      if(index>=0 && MemMove(index,index+1,m_data_total-index-1)<0)
         return(false);
     }
   else
   if(m_free_mode && CheckPointer(m_data[index])==POINTER_DYNAMIC)
      delete m_data[index];
   m_data_total--;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Detach element from the specified position                       |
//+------------------------------------------------------------------+
CObject *CArrayObj::Detach(const int index)
  {
   CObject *result;
//--- check
   if(index>=m_data_total)
      return(NULL);
//--- detach
   result=m_data[index];
//--- reset the array element, so as not remove the method MemMove
   m_data[index]=NULL;
   if(index<m_data_total-1 && MemMove(index,index+1,m_data_total-index-1)<0)
      return(NULL);
   m_data_total--;
//--- successful
   return(result);
  }
//+------------------------------------------------------------------+
//| Deleting range of elements                                       |
//+------------------------------------------------------------------+
bool CArrayObj::DeleteRange(int from,int to)
  {
//--- check
   if(from<0 || to<0)
      return(false);
   if(from>to || from>=m_data_total)
      return(false);
//--- delete
   if(to>=m_data_total-1)
      to=m_data_total-1;
   if(MemMove(from,to+1,m_data_total-to-1)<0)
      return(false);
   for(int i=to-from+1;i>0;i--,m_data_total--)
      if(m_free_mode && CheckPointer(m_data[m_data_total-1])==POINTER_DYNAMIC)
         delete m_data[m_data_total-1];
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Clearing of array without the release of memory                  |
//+------------------------------------------------------------------+
void CArrayObj::Clear(void)
  {
//--- "physical" removal of the object (if necessary and possible)
   if(m_free_mode)
     {
      for(int i=0;i<m_data_total;i++)
        {
         if(CheckPointer(m_data[i])==POINTER_DYNAMIC)
            delete m_data[i];
         m_data[i]=NULL;
        }
     }
   m_data_total=0;
  }
//+------------------------------------------------------------------+
//| Equality comparison of two arrays                                |
//+------------------------------------------------------------------+
bool CArrayObj::CompareArray(const CArrayObj *array) const
  {
//--- check
   if(!CheckPointer(array))
      return(false);
//--- compare
   if(m_data_total!=array.m_data_total)
      return(false);
   for(int i=0;i<m_data_total;i++)
      if(m_data[i].Compare(array.m_data[i],0)!=0)
         return(false);
//--- equal
   return(true);
  }
//+------------------------------------------------------------------+
//| Method QuickSort                                                 |
//+------------------------------------------------------------------+
void CArrayObj::QuickSort(int beg,int end,const int mode)
  {
   int      i,j;
   CObject *p_node;
   CObject *t_node;
//--- sort
   i=beg;
   j=end;
   while(i<end)
     {
      //--- ">>1" is quick division by 2
      p_node=m_data[(beg+end)>>1];
      while(i<j)
        {
         while(m_data[i].Compare(p_node,mode)<0)
           {
            //--- control the output of the array bounds
            if(i==m_data_total-1)
               break;
            i++;
           }
         while(m_data[j].Compare(p_node,mode)>0)
           {
            //--- control the output of the array bounds
            if(j==0)
               break;
            j--;
           }
         if(i<=j)
           {
            t_node=m_data[i];
            m_data[i++]=m_data[j];
            m_data[j]=t_node;
            //--- control the output of the array bounds
            if(j==0)
               break;
            j--;
           }
        }
      if(beg<j)
         QuickSort(beg,j,mode);
      beg=i;
      j=end;
     }
  }
//+------------------------------------------------------------------+
//| Inserting element in a sorted array                              |
//+------------------------------------------------------------------+
bool CArrayObj::InsertSort(CObject *element)
  {
   int pos;
//--- check
   if(!CheckPointer(element) || m_sort_mode==-1)
      return(false);
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- if the array is empty, add an element
   if(m_data_total==0)
     {
      m_data[m_data_total++]=element;
      return(true);
     }
//--- find position and insert
   int mode=m_sort_mode;
   pos=QuickSearch(element);
   if(m_data[pos].Compare(element,m_sort_mode)>0)
      Insert(element,pos);
   else
      Insert(element,pos+1);
//--- restore the sorting flag after Insert(...)
   m_sort_mode=mode;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Quick search of position of element in a sorted array            |
//+------------------------------------------------------------------+
int CArrayObj::QuickSearch(const CObject *element) const
  {
   int      i,j,m=-1;
   CObject *t_node;
//--- search
   i=0;
   j=m_data_total-1;
   while(j>=i)
     {
      //--- ">>1" is quick division by 2
      m=(j+i)>>1;
      if(m<0 || m==m_data_total-1)
         break;
      t_node=m_data[m];
      if(t_node.Compare(element,m_sort_mode)==0)
         break;
      if(t_node.Compare(element,m_sort_mode)>0)
         j=m-1;
      else
         i=m+1;
     }
//--- position
   return(m);
  }
//+------------------------------------------------------------------+
//| Search of position of element in a sorted array                  |
//+------------------------------------------------------------------+
int CArrayObj::Search(const CObject *element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos].Compare(element,m_sort_mode)==0)
      return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is greater than       |
//| specified in a sorted array                                      |
//+------------------------------------------------------------------+
int CArrayObj::SearchGreat(const CObject *element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   pos=QuickSearch(element);
   while(m_data[pos].Compare(element,m_sort_mode)<=0)
      if(++pos==m_data_total)
         return(-1);
//--- position
   return(pos);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is less than          |
//| specified in the sorted array                                    |
//+------------------------------------------------------------------+
int CArrayObj::SearchLess(const CObject *element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   pos=QuickSearch(element);
   while(m_data[pos].Compare(element,m_sort_mode)>=0)
      if(pos--==0)
         return(-1);
//--- position
   return(pos);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is greater than or    |
//| equal to the specified in a sorted array                         |
//+------------------------------------------------------------------+
int CArrayObj::SearchGreatOrEqual(const CObject *element) const
  {
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   for(int pos=QuickSearch(element);pos<m_data_total;pos++)
      if(m_data[pos].Compare(element,m_sort_mode)>=0)
         return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is less than or equal |
//| to the specified in a sorted array                               |
//+------------------------------------------------------------------+
int CArrayObj::SearchLessOrEqual(const CObject *element) const
  {
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   for(int pos=QuickSearch(element);pos>=0;pos--)
      if(m_data[pos].Compare(element,m_sort_mode)<=0)
         return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Find position of first appearance of element in a sorted array   |
//+------------------------------------------------------------------+
int CArrayObj::SearchFirst(const CObject *element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos].Compare(element,m_sort_mode)==0)
     {
      while(m_data[pos].Compare(element,m_sort_mode)==0)
         if(pos--==0)
            break;
      return(pos+1);
     }
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Find position of last appearance of element in a sorted array    |
//+------------------------------------------------------------------+
int CArrayObj::SearchLast(const CObject *element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !CheckPointer(element) || m_sort_mode==-1)
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos].Compare(element,m_sort_mode)==0)
     {
      while(m_data[pos].Compare(element,m_sort_mode)==0)
         if(++pos==m_data_total)
            break;
      return(pos-1);
     }
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Writing array to file                                            |
//+------------------------------------------------------------------+
bool CArrayObj::Save(const int file_handle)
  {
   int i=0;
//--- check
   if(!CArray::Save(file_handle))
      return(false);
//--- write array length
   if(FileWriteInteger(file_handle,m_data_total,INT_VALUE)!=INT_VALUE)
      return(false);
//--- write array
   for(i=0;i<m_data_total;i++)
      if(m_data[i].Save(file_handle)!=true)
         break;
//--- result
   return(i==m_data_total);
  }
//+------------------------------------------------------------------+
//| Reading array from file                                          |
//+------------------------------------------------------------------+
bool CArrayObj::Load(const int file_handle)
  {
   int i=0,num;
//--- check
   if(!CArray::Load(file_handle))
      return(false);
//--- read array length
   num=FileReadInteger(file_handle,INT_VALUE);
//--- read array
   Clear();
   if(num!=0)
     {
      if(!Reserve(num))
         return(false);
      for(i=0;i<num;i++)
        {
         //--- create new element
         if(!CreateElement(i))
            break;
         if(m_data[i].Load(file_handle)!=true)
            break;
         m_data_total++;
        }
     }
   m_sort_mode=-1;
//--- result
   return(m_data_total==num);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                  ArrayString.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "Array.mqh"
//+------------------------------------------------------------------+
//| Class CArrayString.                                              |
//| Purpose: Class of dynamic array of variables of string type.     |
//|          Derives from class CArray.                              |
//+------------------------------------------------------------------+
class CArrayString : public CArray
  {
protected:
   string            m_data[];           // data array

public:
                     CArrayString(void);
                    ~CArrayString(void);
   //--- method of identifying the object
   virtual int       Type(void) const { return(TYPE_STRING); }
   //--- methods for working with files
   virtual bool      Save(const int file_handle);
   virtual bool      Load(const int file_handle);
   //--- methods of managing dynamic memory
   bool              Reserve(const int size);
   bool              Resize(const int size);
   bool              Shutdown(void);
   //--- methods of filling the array
   bool              Add(const string element);
   bool              AddArray(const string &src[]);
   bool              AddArray(const CArrayString *src);
   bool              Insert(const string element,const int pos);
   bool              InsertArray(const string &src[],const int pos);
   bool              InsertArray(const CArrayString *src,const int pos);
   bool              AssignArray(const string &src[]);
   bool              AssignArray(const CArrayString *src);
   //--- method of access to the array
   string            At(const int index) const;
   string operator[](const int index) const { return(At(index)); }
   //--- methods of changing
   bool              Update(const int index,const string element);
   bool              Shift(const int index,const int shift);
   //--- methods of deleting
   bool              Delete(const int index);
   bool              DeleteRange(int from,int to);
   //--- methods for comparing arrays
   bool              CompareArray(const string &array[]) const;
   bool              CompareArray(const CArrayString *array) const;
   //--- methods for working with the sorted array
   bool              InsertSort(const string element);
   int               Search(const string element) const;
   int               SearchGreat(const string element) const;
   int               SearchLess(const string element) const;
   int               SearchGreatOrEqual(const string element) const;
   int               SearchLessOrEqual(const string element) const;
   int               SearchFirst(const string element) const;
   int               SearchLast(const string element) const;
   int               SearchLinear(const string element) const;

protected:
   virtual void      QuickSort(int beg,int end,const int mode=0);
   int               QuickSearch(const string element) const;
   int               MemMove(const int dest,const int src,int count);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CArrayString::CArrayString(void)
  {
//--- initialize protected data
   m_data_max=ArraySize(m_data);
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CArrayString::~CArrayString(void)
  {
   if(m_data_max!=0)
      Shutdown();
  }
//+------------------------------------------------------------------+
//| Moving the memory within a single array                          |
//+------------------------------------------------------------------+
int CArrayString::MemMove(const int dest,const int src,int count)
  {
   int i;
//--- check parameters
   if(dest<0 || src<0 || count<0)
      return(-1);
//--- check count
   if(src+count>m_data_total)
      count=m_data_total-src;
   if(count<0)
      return(-1);
//--- no need to copy
   if(dest==src || count==0)
      return(dest);
//--- check data total
   if(dest+count>m_data_total)
     {
      if(m_data_max<dest+count)
         return(-1);
      m_data_total=dest+count;
     }
//--- copy
   if(dest<src)
     {
      //--- copy from left to right
      for(i=0;i<count;i++)
         m_data[dest+i]=m_data[src+i];
     }
   else
     {
      //--- copy from right to left
      for(i=count-1;i>=0;i--)
         m_data[dest+i]=m_data[src+i];
     }
//--- successful
   return(dest);
  }
//+------------------------------------------------------------------+
//| Request for more memory in an array. Checks if the requested     |
//| number of free elements already exists; allocates additional     |
//| memory with a given step                                         |
//+------------------------------------------------------------------+
bool CArrayString::Reserve(const int size)
  {
   int new_size;
//--- check
   if(size<=0)
      return(false);
//--- resize array
   if(Available()<size)
     {
      new_size=m_data_max+m_step_resize*(1+(size-Available())/m_step_resize);
      if(new_size<0)
         //--- overflow occurred when calculating new_size
         return(false);
      if((m_data_max=ArrayResize(m_data,new_size))==-1)
         m_data_max=ArraySize(m_data);
     }
//--- result
   return(Available()>=size);
  }
//+------------------------------------------------------------------+
//| Resizing (with removal of elements on the right)                 |
//+------------------------------------------------------------------+
bool CArrayString::Resize(const int size)
  {
   int new_size;
//--- check
   if(size<0)
      return(false);
//--- resize array
   new_size=m_step_resize*(1+size/m_step_resize);
   if(m_data_max!=new_size)
     {
      if((m_data_max=ArrayResize(m_data,new_size))==-1)
        {
         m_data_max=ArraySize(m_data);
         return(false);
        }
     }
   if(m_data_total>size)
      m_data_total=size;
//--- result
   return(m_data_max==new_size);
  }
//+------------------------------------------------------------------+
//| Complete cleaning of the array with the release of memory        |
//+------------------------------------------------------------------+
bool CArrayString::Shutdown(void)
  {
//--- check
   if(m_data_max==0)
      return(true);
//--- clean
   if(ArrayResize(m_data,0)==-1)
      return(false);
   m_data_total=0;
   m_data_max=0;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array                        |
//+------------------------------------------------------------------+
bool CArrayString::Add(const string element)
  {
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- add
   m_data[m_data_total++]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array from another array     |
//+------------------------------------------------------------------+
bool CArrayString::AddArray(const string &src[])
  {
   int num=ArraySize(src);
//--- check/reserve elements of array
   if(!Reserve(num))
      return(false);
//--- add
   for(int i=0;i<num;i++)
      m_data[m_data_total++]=src[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array from another array     |
//+------------------------------------------------------------------+
bool CArrayString::AddArray(const CArrayString *src)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.Total();
   if(!Reserve(num))
      return(false);
//--- add
   for(int i=0;i<num;i++)
      m_data[m_data_total++]=src.m_data[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting an element in the specified position                   |
//+------------------------------------------------------------------+
bool CArrayString::Insert(const string element,const int pos)
  {
//--- check/reserve elements of array
   if(pos<0 || !Reserve(1))
      return(false);
//--- insert
   m_data_total++;
   if(pos<m_data_total-1)
     {
      if(MemMove(pos+1,pos,m_data_total-pos-1)<0)
         return(false);
      m_data[pos]=element;
     }
   else
      m_data[m_data_total-1]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting elements in the specified position                     |
//+------------------------------------------------------------------+
bool CArrayString::InsertArray(const string &src[],const int pos)
  {
   int num=ArraySize(src);
//--- check/reserve elements of array
   if(!Reserve(num))
      return(false);
//--- insert
   if(MemMove(num+pos,pos,m_data_total-pos)<0)
      return(false);
   for(int i=0;i<num;i++)
      m_data[i+pos]=src[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting elements in the specified position                     |
//+------------------------------------------------------------------+
bool CArrayString::InsertArray(const CArrayString *src,const int pos)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.Total();
   if(!Reserve(num))
      return(false);
//--- insert
   if(MemMove(num+pos,pos,m_data_total-pos)<0)
      return(false);
   for(int i=0;i<num;i++)
      m_data[i+pos]=src.m_data[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Assignment (copying) of another array                            |
//+------------------------------------------------------------------+
bool CArrayString::AssignArray(const string &src[])
  {
   int num=ArraySize(src);
//--- check/reserve elements of array
   Clear();
   if(m_data_max<num)
     {
      if(!Reserve(num))
         return(false);
     }
   else
      Resize(num);
//--- copy array
   for(int i=0;i<num;i++)
     {
      m_data[i]=src[i];
      m_data_total++;
     }
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Assignment (copying) of another array                            |
//+------------------------------------------------------------------+
bool CArrayString::AssignArray(const CArrayString *src)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.m_data_total;
   Clear();
   if(m_data_max<num)
     {
      if(!Reserve(num))
         return(false);
     }
   else
      Resize(num);
//--- copy array
   for(int i=0;i<num;i++)
     {
      m_data[i]=src.m_data[i];
      m_data_total++;
     }
   m_sort_mode=src.SortMode();
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Access to data in the specified position                         |
//+------------------------------------------------------------------+
string CArrayString::At(const int index) const
  {
//--- check
   if(index<0 || index>=m_data_total)
      return("");
//--- result
   return(m_data[index]);
  }
//+------------------------------------------------------------------+
//| Updating element in the specified position                       |
//+------------------------------------------------------------------+
bool CArrayString::Update(const int index,const string element)
  {
//--- check
   if(index<0 || index>=m_data_total)
      return(false);
//--- update
   m_data[index]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Moving element from the specified position                       |
//| on the specified shift                                           |
//+------------------------------------------------------------------+
bool CArrayString::Shift(const int index,const int shift)
  {
   string tmp_string;
//--- check
   if(index<0 || index+shift<0 || index+shift>=m_data_total)
      return(false);
   if(shift==0)
      return(true);
//--- move
   tmp_string=m_data[index];
   if(shift>0)
     {
      if(MemMove(index,index+1,shift)<0)
         return(false);
     }
   else
     {
      if(MemMove(index+shift+1,index+shift,-shift)<0)
         return(false);
     }
   m_data[index+shift]=tmp_string;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Deleting element from the specified position                     |
//+------------------------------------------------------------------+
bool CArrayString::Delete(const int index)
  {
//--- check
   if(index<0 || index>=m_data_total)
      return(false);
//--- delete
   if(index<m_data_total-1 && MemMove(index,index+1,m_data_total-index-1)<0)
      return(false);
   m_data_total--;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Deleting range of elements                                       |
//+------------------------------------------------------------------+
bool CArrayString::DeleteRange(int from,int to)
  {
//--- check
   if(from<0 || to<0)
      return(false);
   if(from>to || from>=m_data_total)
      return(false);
//--- delete
   if(to>=m_data_total-1)
      to=m_data_total-1;
   if(MemMove(from,to+1,m_data_total-to-1)<0)
      return(false);
   m_data_total-=to-from+1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Equality comparison of two arrays                                |
//+------------------------------------------------------------------+
bool CArrayString::CompareArray(const string &array[]) const
  {
//--- compare
   if(m_data_total!=ArraySize(array))
      return(false);
   for(int i=0;i<m_data_total;i++)
      if(m_data[i]!=array[i])
         return(false);
//--- equal
   return(true);
  }
//+------------------------------------------------------------------+
//| Equality comparison of two arrays                                |
//+------------------------------------------------------------------+
bool CArrayString::CompareArray(const CArrayString *array) const
  {
//--- check
   if(!CheckPointer(array))
      return(false);
//--- compare
   if(m_data_total!=array.m_data_total)
      return(false);
   for(int i=0;i<m_data_total;i++)
      if(m_data[i]!=array.m_data[i])
         return(false);
//--- equal
   return(true);
  }
//+------------------------------------------------------------------+
//| Method QuickSort                                                 |
//+------------------------------------------------------------------+
void CArrayString::QuickSort(int beg,int end,const int mode)
  {
   int    i,j;
   string p_string;
   string t_string;
//--- check
   if(beg<0 || end<0)
      return;
//--- sort
   i=beg;
   j=end;
   while(i<end)
     {
      //--- ">>1" is quick division by 2
      p_string=m_data[(beg+end)>>1];
      while(i<j)
        {
         while(m_data[i]<p_string)
           {
            //--- control the output of the array bounds
            if(i==m_data_total-1)
               break;
            i++;
           }
         while(m_data[j]>p_string)
           {
            //--- control the output of the array bounds
            if(j==0)
               break;
            j--;
           }
         if(i<=j)
           {
            t_string=m_data[i];
            m_data[i++]=m_data[j];
            m_data[j]=t_string;
            //--- control the output of the array bounds
            if(j==0)
               break;
            j--;
           }
        }
      if(beg<j)
         QuickSort(beg,j);
      beg=i;
      j=end;
     }
  }
//+------------------------------------------------------------------+
//| Inserting element in a sorted array                              |
//+------------------------------------------------------------------+
bool CArrayString::InsertSort(const string element)
  {
   int pos;
//--- check
   if(!IsSorted())
      return(false);
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- if the array is empty, add an element
   if(m_data_total==0)
     {
      m_data[m_data_total++]=element;
      return(true);
     }
//--- find position and insert
   pos=QuickSearch(element);
   if(m_data[pos]>element)
      Insert(element,pos);
   else
      Insert(element,pos+1);
//--- restore the sorting flag after Insert(...)
   m_sort_mode=0;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Search of position of element in a array                         |
//+------------------------------------------------------------------+
int CArrayString::SearchLinear(const string element) const
  {
//--- check
   if(m_data_total==0)
      return(-1);
//---
   for(int i=0;i<m_data_total;i++)
      if(m_data[i]==element)
         return(i);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Quick search of position of element in a sorted array            |
//+------------------------------------------------------------------+
int CArrayString::QuickSearch(const string element) const
  {
   int    i,j,m=-1;
   string t_string;
//--- search
   i=0;
   j=m_data_total-1;
   while(j>=i)
     {
      //--- ">>1" is quick division by 2
      m=(j+i)>>1;
      if(m<0 || m>=m_data_total)
         break;
      t_string=m_data[m];
      if(t_string==element)
         break;
      if(t_string>element)
         j=m-1;
      else
         i=m+1;
     }
//--- position
   return(m);
  }
//+------------------------------------------------------------------+
//| Search of position of element in a sorted array                  |
//+------------------------------------------------------------------+
int CArrayString::Search(const string element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos]==element)
      return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is greater than       |
//| specified in a sorted array                                      |
//+------------------------------------------------------------------+
int CArrayString::SearchGreat(const string element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   while(m_data[pos]<=element)
      if(++pos==m_data_total)
         return(-1);
//--- position
   return(pos);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is less than          |
//| specified in the sorted array                                    |
//+------------------------------------------------------------------+
int CArrayString::SearchLess(const string element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   while(m_data[pos]>=element)
      if(pos--==0)
         return(-1);
//--- position
   return(pos);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is greater than or    |
//| equal to the specified in a sorted array                         |
//+------------------------------------------------------------------+
int CArrayString::SearchGreatOrEqual(const string element) const
  {
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   for(int pos=QuickSearch(element);pos<m_data_total;pos++)
      if(m_data[pos]>=element)
         return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is less than or equal |
//| to the specified in a sorted array                               |
//+------------------------------------------------------------------+
int CArrayString::SearchLessOrEqual(const string element) const
  {
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   for(int pos=QuickSearch(element);pos>=0;pos--)
      if(m_data[pos]<=element)
         return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Find position of first appearance of element in a sorted array   |
//+------------------------------------------------------------------+
int CArrayString::SearchFirst(const string element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos]==element)
     {
      while(m_data[pos]==element)
         if(pos--==0)
            break;
      return(pos+1);
     }
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Find position of last appearance of element in a sorted array    |
//+------------------------------------------------------------------+
int CArrayString::SearchLast(const string element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos]==element)
     {
      while(m_data[pos]==element)
         if(++pos==m_data_total)
            break;
      return(pos-1);
     }
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Writing array to file                                            |
//+------------------------------------------------------------------+
bool CArrayString::Save(const int file_handle)
  {
   int i=0,len;
//--- check
   if(!CArray::Save(file_handle))
      return(false);
//--- write array length
   if(FileWriteInteger(file_handle,m_data_total,INT_VALUE)!=INT_VALUE)
      return(false);
//--- write array
   for(i=0;i<m_data_total;i++)
     {
      len=StringLen(m_data[i]);
      //--- write string length
      if(FileWriteInteger(file_handle,len,INT_VALUE)!=INT_VALUE)
         return(false);
      //--- write string
      if(len!=0) if(FileWriteString(file_handle,m_data[i],len)!=len)
         break;
     }
//--- result
   return(i==m_data_total);
  }
//+------------------------------------------------------------------+
//| Reading array from file                                          |
//+------------------------------------------------------------------+
bool CArrayString::Load(const int file_handle)
  {
   int i=0,num,len;
//--- check
   if(!CArray::Load(file_handle))
      return(false);
//--- read array length
   num=FileReadInteger(file_handle,INT_VALUE);
//--- read array
   Clear();
   if(num!=0)
     {
      if(!Reserve(num))
         return(false);
      for(i=0;i<num;i++)
        {
         //--- read string length
         len=FileReadInteger(file_handle,INT_VALUE);
         //--- read string
         if(len!=0)
            m_data[i]=FileReadString(file_handle,len);
         else
            m_data[i]="";
         m_data_total++;
         if(FileIsEnding(file_handle))
            break;
        }
     }
   m_sort_mode=-1;
//--- result
   return(m_data_total==num);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                  ArrayDouble.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "Array.mqh"
//+------------------------------------------------------------------+
//| Class CArrayDouble.                                              |
//| Puprpose: Class of dynamic array variables of double type.       |
//|           Derives from class CArray.                             |
//+------------------------------------------------------------------+
class CArrayDouble : public CArray
  {
protected:
   double            m_data[];           // data array
   double            m_delta;            // search tolerance

public:
                     CArrayDouble(void);
                    ~CArrayDouble(void);
   //--- methods of access to protected data
   void              Delta(const double delta) { m_delta=MathAbs(delta); }
   //--- method of identifying the object
   virtual int       Type(void) const { return(TYPE_DOUBLE); }
   //--- methods for working with files
   virtual bool      Save(const int file_handle);
   virtual bool      Load(const int file_handle);
   //--- methods of managing dynamic memory
   bool              Reserve(const int size);
   bool              Resize(const int size);
   bool              Shutdown(void);
   //--- methods of filling the array
   bool              Add(const double element);
   bool              AddArray(const double &src[]);
   bool              AddArray(const CArrayDouble *src);
   bool              Insert(const double element,const int pos);
   bool              InsertArray(const double &src[],const int pos);
   bool              InsertArray(const CArrayDouble *src,const int pos);
   bool              AssignArray(const double &src[]);
   bool              AssignArray(const CArrayDouble *src);
   //--- method of access to the array
   double            At(const int index) const;
   double operator[](const int index) const { return(At(index)); }
   //--- methods of searching for minimum and maximum
   int               Minimum(const int start,const int count) const { return(CArray::Minimum(m_data,start,count)); }
   int               Maximum(const int start,const int count) const { return(CArray::Maximum(m_data,start,count)); }
   //--- methods of changing
   bool              Update(const int index,const double element);
   bool              Shift(const int index,const int shift);
   //--- methods of deleting
   bool              Delete(const int index);
   bool              DeleteRange(int from,int to);
   //--- methods for comparing arrays
   bool              CompareArray(const double &array[]) const;
   bool              CompareArray(const CArrayDouble *array) const;
   //--- methods for working with a sorted array
   bool              InsertSort(const double element);
   int               Search(const double element) const;
   int               SearchGreat(const double element) const;
   int               SearchLess(const double element) const;
   int               SearchGreatOrEqual(const double element) const;
   int               SearchLessOrEqual(const double element) const;
   int               SearchFirst(const double element) const;
   int               SearchLast(const double element) const;
   int               SearchLinear(const double element) const;

protected:
   virtual void      QuickSort(int beg,int end,const int mode=0);
   int               QuickSearch(const double element) const;
   int               MemMove(const int dest,const int src,int count);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CArrayDouble::CArrayDouble(void) : m_delta(0.0)
  {
   m_data_max=ArraySize(m_data);
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CArrayDouble::~CArrayDouble(void)
  {
   if(m_data_max!=0)
      Shutdown();
  }
//+------------------------------------------------------------------+
//| Moving the memory within a single array                          |
//+------------------------------------------------------------------+
int CArrayDouble::MemMove(const int dest,const int src,int count)
  {
   int i;
//--- check parameters
   if(dest<0 || src<0 || count<0)
      return(-1);
//--- check count
   if(src+count>m_data_total)
      count=m_data_total-src;
   if(count<0)
      return(-1);
//--- no need to copy
   if(dest==src || count==0)
      return(dest);
//--- check data total
   if(dest+count>m_data_total)
     {
      if(m_data_max<dest+count)
         return(-1);
      m_data_total=dest+count;
     }
//--- copy
   if(dest<src)
     {
      //--- copy from left to right
      for(i=0;i<count;i++)
         m_data[dest+i]=m_data[src+i];
     }
   else
     {
      //--- copy from right to left
      for(i=count-1;i>=0;i--)
         m_data[dest+i]=m_data[src+i];
     }
//--- successful
   return(dest);
  }
//+------------------------------------------------------------------+
//| Request for more memory in an array. Checks if the requested     |
//| number of free elements already exists; allocates additional     |
//| memory with a given step                                         |
//+------------------------------------------------------------------+
bool CArrayDouble::Reserve(const int size)
  {
   int new_size;
//--- check
   if(size<=0)
      return(false);
//--- resize array
   if(Available()<size)
     {
      new_size=m_data_max+m_step_resize*(1+(size-Available())/m_step_resize);
      if(new_size<0)
         //--- overflow occurred when calculating new_size
         return(false);
      if((m_data_max=ArrayResize(m_data,new_size))==-1)
         m_data_max=ArraySize(m_data);
     }
//--- result
   return(Available()>=size);
  }
//+------------------------------------------------------------------+
//| Resizing (with removal of elements on the right)                 |
//+------------------------------------------------------------------+
bool CArrayDouble::Resize(const int size)
  {
   int new_size;
//--- check
   if(size<0)
      return(false);
//--- resize array
   new_size=m_step_resize*(1+size/m_step_resize);
   if(m_data_max!=new_size)
     {
      if((m_data_max=ArrayResize(m_data,new_size))==-1)
        {
         m_data_max=ArraySize(m_data);
         return(false);
        }
     }
   if(m_data_total>size)
      m_data_total=size;
//--- result
   return(m_data_max==new_size);
  }
//+------------------------------------------------------------------+
//| Complete cleaning of the array with the release of memory        |
//+------------------------------------------------------------------+
bool CArrayDouble::Shutdown(void)
  {
//--- check
   if(m_data_max==0)
      return(true);
//--- clean
   if(ArrayResize(m_data,0)==-1)
      return(false);
   m_data_total=0;
   m_data_max=0;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array                        |
//+------------------------------------------------------------------+
bool CArrayDouble::Add(const double element)
  {
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- add
   m_data[m_data_total++]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array from another array     |
//+------------------------------------------------------------------+
bool CArrayDouble::AddArray(const double &src[])
  {
   int num=ArraySize(src);
//--- check/reserve elements of array
   if(!Reserve(num))
      return(false);
//--- add
   for(int i=0;i<num;i++)
      m_data[m_data_total++]=src[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Adding an element to the end of the array from another array     |
//+------------------------------------------------------------------+
bool CArrayDouble::AddArray(const CArrayDouble *src)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.Total();
   if(!Reserve(num))
      return(false);
//--- add
   for(int i=0;i<num;i++)
      m_data[m_data_total++]=src.m_data[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting an element in the specified position                   |
//+------------------------------------------------------------------+
bool CArrayDouble::Insert(const double element,const int pos)
  {
//--- check/reserve elements of array
   if(pos<0 || !Reserve(1))
      return(false);
//--- insert
   m_data_total++;
   if(pos<m_data_total-1)
     {
      if(MemMove(pos+1,pos,m_data_total-pos-1)<0)
         return(false);
      m_data[pos]=element;
     }
   else
      m_data[m_data_total-1]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting elements in the specified position                     |
//+------------------------------------------------------------------+
bool CArrayDouble::InsertArray(const double &src[],const int pos)
  {
   int num=ArraySize(src);
//--- check/reserve elements of array
   if(!Reserve(num))
      return(false);
//--- insert
   if(MemMove(num+pos,pos,m_data_total-pos)<0)
      return(false);
   for(int i=0;i<num;i++)
      m_data[i+pos]=src[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserting elements in the specified position                     |
//+------------------------------------------------------------------+
bool CArrayDouble::InsertArray(const CArrayDouble *src,const int pos)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.Total();
   if(!Reserve(num))
      return(false);
//--- insert
   if(MemMove(num+pos,pos,m_data_total-pos)<0)
      return(false);
   for(int i=0;i<num;i++)
      m_data[i+pos]=src.m_data[i];
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Assignment (copying) of another array                            |
//+------------------------------------------------------------------+
bool CArrayDouble::AssignArray(const double &src[])
  {
   int num=ArraySize(src);
//--- check/reserve elements of array
   Clear();
   if(m_data_max<num)
     {
      if(!Reserve(num))
         return(false);
     }
   else
      Resize(num);
//--- copy array
   for(int i=0;i<num;i++)
     {
      m_data[i]=src[i];
      m_data_total++;
     }
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Assignment (copying) of another array                            |
//+------------------------------------------------------------------+
bool CArrayDouble::AssignArray(const CArrayDouble *src)
  {
   int num;
//--- check
   if(!CheckPointer(src))
      return(false);
//--- check/reserve elements of array
   num=src.m_data_total;
   Clear();
   if(m_data_max<num)
     {
      if(!Reserve(num))
         return(false);
     }
   else
      Resize(num);
//--- copy array
   for(int i=0;i<num;i++)
     {
      m_data[i]=src.m_data[i];
      m_data_total++;
     }
   m_sort_mode=src.SortMode();
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Access to data in the specified position                         |
//+------------------------------------------------------------------+
double CArrayDouble::At(const int index) const
  {
//--- check
   if(index<0 || index>=m_data_total)
      return(DBL_MAX);
//--- result
   return(m_data[index]);
  }
//+------------------------------------------------------------------+
//| Updating element in the specified position                       |
//+------------------------------------------------------------------+
bool CArrayDouble::Update(const int index,const double element)
  {
//--- check
   if(index<0 || index>=m_data_total)
      return(false);
//--- update
   m_data[index]=element;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Moving element from the specified position                       |
//| on the specified shift                                           |
//+------------------------------------------------------------------+
bool CArrayDouble::Shift(const int index,const int shift)
  {
   double tmp_double;
//--- check
   if(index<0 || index+shift<0 || index+shift>=m_data_total)
      return(false);
   if(shift==0)
      return(true);
//--- move
   tmp_double=m_data[index];
   if(shift>0)
     {
      if(MemMove(index,index+1,shift)<0)
         return(false);
     }
   else
     {
      if(MemMove(index+shift+1,index+shift,-shift)<0)
         return(false);
     }
   m_data[index+shift]=tmp_double;
   m_sort_mode=-1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Deleting element from the specified position                     |
//+------------------------------------------------------------------+
bool CArrayDouble::Delete(const int index)
  {
//--- check
   if(index<0 || index>=m_data_total)
      return(false);
//--- delete
   if(index<m_data_total-1 && MemMove(index,index+1,m_data_total-index-1)<0)
      return(false);
   m_data_total--;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Deleting range of elements                                       |
//+------------------------------------------------------------------+
bool CArrayDouble::DeleteRange(int from,int to)
  {
//--- check
   if(from<0 || to<0)
      return(false);
   if(from>to || from>=m_data_total)
      return(false);
//--- delete
   if(to>=m_data_total-1)
      to=m_data_total-1;
   if(MemMove(from,to+1,m_data_total-to-1)<0)
      return(false);
   m_data_total-=to-from+1;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Equality comparison of two arrays                                |
//+------------------------------------------------------------------+
bool CArrayDouble::CompareArray(const double &array[]) const
  {
//--- compare
   if(m_data_total!=ArraySize(array))
      return(false);
   for(int i=0;i<m_data_total;i++)
      if(m_data[i]!=array[i])
         return(false);
//--- equal
   return(true);
  }
//+------------------------------------------------------------------+
//| Equality comparison of two arrays                                |
//+------------------------------------------------------------------+
bool CArrayDouble::CompareArray(const CArrayDouble *array) const
  {
//--- check
   if(!CheckPointer(array))
      return(false);
//--- compare
   if(m_data_total!=array.m_data_total)
      return(false);
   for(int i=0;i<m_data_total;i++)
      if(m_data[i]!=array.m_data[i])
         return(false);
//--- equal
   return(true);
  }
//+------------------------------------------------------------------+
//| Method QuickSort                                                 |
//+------------------------------------------------------------------+
void CArrayDouble::QuickSort(int beg,int end,const int mode)
  {
   int    i,j;
   double p_double,t_double;
//--- check
   if(beg<0 || end<0)
      return;
//--- sort
   i=beg;
   j=end;
   while(i<end)
     {
      //--- ">>1" is quick division by 2
      p_double=m_data[(beg+end)>>1];
      while(i<j)
        {
         while(m_data[i]<p_double)
           {
            //--- control the output of the array bounds
            if(i==m_data_total-1)
               break;
            i++;
           }
         while(m_data[j]>p_double)
           {
            //--- control the output of the array bounds
            if(j==0)
               break;
            j--;
           }
         if(i<=j)
           {
            t_double=m_data[i];
            m_data[i++]=m_data[j];
            m_data[j]=t_double;
            //--- control the output of the array bounds
            if(j==0)
               break;
            j--;
           }
        }
      if(beg<j)
         QuickSort(beg,j);
      beg=i;
      j=end;
     }
  }
//+------------------------------------------------------------------+
//| Inserting element in a sorted array                              |
//+------------------------------------------------------------------+
bool CArrayDouble::InsertSort(const double element)
  {
   int pos;
//--- check
   if(!IsSorted())
      return(false);
//--- check/reserve elements of array
   if(!Reserve(1))
      return(false);
//--- if the array is empty, add an element
   if(m_data_total==0)
     {
      m_data[m_data_total++]=element;
      return(true);
     }
//--- search position and insert
   pos=QuickSearch(element);
   if(m_data[pos]>element)
      Insert(element,pos);
   else
      Insert(element,pos+1);
//--- restore the sorting flag after Insert(...)
   m_sort_mode=0;
//--- successful
   return(true);
  }
//+------------------------------------------------------------------+
//| Search of position of element in a array                         |
//+------------------------------------------------------------------+
int CArrayDouble::SearchLinear(const double element) const
  {
//--- check
   if(m_data_total==0)
      return(-1);
//---
   for(int i=0;i<m_data_total;i++)
      if(MathAbs(m_data[i]-element)<=m_delta)
         return(i);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Quick search of position of element in a sorted array            |
//+------------------------------------------------------------------+
int CArrayDouble::QuickSearch(const double element) const
  {
   int    i,j,m=-1;
   double t_double;
//--- search
   i=0;
   j=m_data_total-1;
   while(j>=i)
     {
      //--- ">>1" is quick division by 2
      m=(j+i)>>1;
      if(m<0 || m>=m_data_total)
         break;
      t_double=m_data[m];
      //--- compare with delta
      if(MathAbs(t_double-element)<=m_delta)
         break;
      if(t_double>element)
         j=m-1;
      else
         i=m+1;
     }
//--- position
   return(m);
  }
//+------------------------------------------------------------------+
//| Search of position of element in a sorted array                  |
//+------------------------------------------------------------------+
int CArrayDouble::Search(const double element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
//--- compare with delta
   if(MathAbs(m_data[pos]-element)<=m_delta)
      return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is greater than       |
//| specified in a sorted array                                      |
//+------------------------------------------------------------------+
int CArrayDouble::SearchGreat(const double element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
//--- compare with delta
   while(m_data[pos]<=element+m_delta)
      if(++pos==m_data_total)
         return(-1);
//--- position
   return(pos);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is less than          |
//| specified in the sorted array                                    |
//+------------------------------------------------------------------+
int CArrayDouble::SearchLess(const double element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
//--- compare with delta
   while(m_data[pos]>=element-m_delta)
      if(pos--==0)
         return(-1);
//--- position
   return(pos);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is greater than or    |
//| equal to the specified in a sorted array                         |
//+------------------------------------------------------------------+
int CArrayDouble::SearchGreatOrEqual(const double element) const
  {
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   for(int pos=QuickSearch(element);pos<m_data_total;pos++)
      if(m_data[pos]>=element)
         return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Search position of the first element which is less than or equal |
//| to the specified in a sorted array                               |
//+------------------------------------------------------------------+
int CArrayDouble::SearchLessOrEqual(const double element) const
  {
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   for(int pos=QuickSearch(element);pos>=0;pos--)
      if(m_data[pos]<=element)
         return(pos);
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Find position of first appearance of element in a sorted array   |
//+------------------------------------------------------------------+
int CArrayDouble::SearchFirst(const double element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos]==element)
     {
      //--- compare with delta
      while(MathAbs(m_data[pos]-element)<=m_delta)
         if(pos--==0)
            break;
      return(pos+1);
     }
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Find position of last appearance of element in a sorted array    |
//+------------------------------------------------------------------+
int CArrayDouble::SearchLast(const double element) const
  {
   int pos;
//--- check
   if(m_data_total==0 || !IsSorted())
      return(-1);
//--- search
   pos=QuickSearch(element);
   if(m_data[pos]==element)
     {
      //--- compare with delta
      while(MathAbs(m_data[pos]-element)<=m_delta)
         if(++pos==m_data_total)
            break;
      return(pos-1);
     }
//--- not found
   return(-1);
  }
//+------------------------------------------------------------------+
//| Writing array to file                                            |
//+------------------------------------------------------------------+
bool CArrayDouble::Save(const int file_handle)
  {
   int i=0;
//--- check
   if(!CArray::Save(file_handle))
      return(false);
//--- write array length
   if(FileWriteInteger(file_handle,m_data_total,INT_VALUE)!=INT_VALUE)
      return(false);
//--- write array
   for(i=0;i<m_data_total;i++)
      if(FileWriteDouble(file_handle,m_data[i])!=sizeof(double))
         break;
//--- result
   return(i==m_data_total);
  }
//+------------------------------------------------------------------+
//| Reading array from file                                          |
//+------------------------------------------------------------------+
bool CArrayDouble::Load(const int file_handle)
  {
   int i=0,num;
//--- check
   if(!CArray::Load(file_handle))
      return(false);
//--- read array length
   num=FileReadInteger(file_handle,INT_VALUE);
//--- read array
   Clear();
   if(num!=0)
     {
      if(!Reserve(num))
         return(false);
      for(i=0;i<num;i++)
        {
         m_data[i]=FileReadDouble(file_handle);
         m_data_total++;
         if(FileIsEnding(file_handle))
            break;
        }
     }
   m_sort_mode=-1;
//--- result
   return(m_data_total==num);
  }
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                   M a t h . m q h   |  
 / / |                                                           C o p y r i g h t   2 0 0 0 - 2 0 2 4 ,   M e t a Q u o t e s   L t d .   |  
 / / |                                                                                           h t t p s : / / w w w . m q l 5 . c o m   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # d e f i n e   E R R _ O K                                 0  
 # d e f i n e   E R R _ A R G U M E N T S _ N A N           1  
 # d e f i n e   E R R _ A R G U M E N T S _ I N V A L I D   2  
 # d e f i n e   E R R _ R E S U L T _ I N F I N I T E       3  
 # d e f i n e   E R R _ N O N _ C O N V E R G E N C E       4  
  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   N a n s                                                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   Q N a N       = ( d o u b l e ) " n a n " ;       / /   Q N a N  
 d o u b l e   Q P O S I N F = ( d o u b l e ) " i n f " ;       / /   + i n f i n i t y   1 . # I N F  
 d o u b l e   Q N E G I N F = ( d o u b l e ) " - i n f " ;     / /   - i n f i n i t y   - 1 . # I N F  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R a n d o m                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h R a n d o m N o n Z e r o ( v o i d )  
     {  
       d o u b l e   r n d = 0 ;  
 / / - - -   e x c e p t   0   a n d   1  
       w h i l e ( r n d = = 0 . 0   | |   r n d = = 1 . 0 )  
             r n d = M a t h R a n d ( ) / 3 2 7 6 7 . 0 ;  
 / / - - -  
       r e t u r n ( r n d ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   4   f i r s t   m o m e n t s   o f   t h e   v a l u e s   i n   a r r a y [ ]                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h M o m e n t s ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & m e a n , d o u b l e   & v a r i a n c e , d o u b l e   & s k e w n e s s , d o u b l e   & k u r t o s i s , c o n s t   i n t   s t a r t = 0 , c o n s t   i n t   c o u n t = W H O L E _ A R R A Y )  
     {  
 / / - - -   i n i t i a l   v a l u e s  
       m e a n = 0 . 0 ;  
       v a r i a n c e = 0 . 0 ;  
       s k e w n e s s = 0 . 0 ;  
       k u r t o s i s = 0 . 0 ;  
 / / - - -   g e t   d a t a   s i z e  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i n t   d a t a _ c o u n t = 0 ;  
 / / - - -   s e t   d a t a   c o u n t  
       i f ( c o u n t = = W H O L E _ A R R A Y )  
             d a t a _ c o u n t = s i z e ;  
       e l s e  
             d a t a _ c o u n t = c o u n t ;  
 / / - - -   c h e c k   d a t a   r a n g e  
       i f ( d a t a _ c o u n t = = 0 )  
             r e t u r n ( f a l s e ) ;  
       i f ( s t a r t + d a t a _ c o u n t > s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   s e t   i n d e x e s  
       i n t   i n d 1 = s t a r t ;  
       i n t   i n d 2 = i n d 1 + d a t a _ c o u n t - 1 ;  
 / / - - -   c a l c u l a t e   m e a n  
       f o r ( i n t   i = i n d 1 ;   i < = i n d 2 ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
       m e a n = m e a n / d a t a _ c o u n t ;  
       d o u b l e   S = 0 . 0 ;  
 / / - - -  
       i f ( d a t a _ c o u n t > 1 )  
           {  
             / / - - -   c a l c u l a t e   v a r i a n c e  
             f o r ( i n t   i = i n d 1 ;   i < = i n d 2 ;   i + + )  
                   v a r i a n c e + = M a t h P o w ( a r r a y [ i ] - m e a n , 2 ) ;  
             v a r i a n c e = v a r i a n c e / ( d a t a _ c o u n t - 1 ) ;  
             S = M a t h S q r t ( v a r i a n c e ) ;  
           }  
       e l s e  
             v a r i a n c e = Q N a N ;  
 / / - - -  
       i f ( d a t a _ c o u n t > 2   & &   S > 0 . 0 )  
           {  
             / / - - -   c a l c u l a t e   s k e w n e s s  
             f o r ( i n t   i = i n d 1 ;   i < = i n d 2 ;   i + + )  
                   s k e w n e s s + = M a t h P o w ( a r r a y [ i ] - m e a n , 3 ) ;  
             s k e w n e s s = s k e w n e s s / ( d a t a _ c o u n t * M a t h P o w ( S , 3 ) ) ;  
           }  
       e l s e  
             s k e w n e s s = Q N a N ;  
 / / - - -  
       i f ( d a t a _ c o u n t > 3   & &   S > 0 . 0 )  
           {  
             / / - - -   c a l c u l a t e   k u r t o s i s  
             f o r ( i n t   i = i n d 1 ;   i < = i n d 2 ;   i + + )  
                   k u r t o s i s + = M a t h P o w ( a r r a y [ i ] - m e a n , 4 ) ;  
             k u r t o s i s = k u r t o s i s / ( d a t a _ c o u n t * M a t h P o w ( S , 4 ) ) ;  
             k u r t o s i s - = 3 ;  
           }  
       e l s e  
             k u r t o s i s = Q N a N ;  
 / / - - -   c h e c k   v a l u e s   a n d   r e t u r n   c a l c u l a t i o n   r e s u l t  
       i f ( ( ! M a t h I s V a l i d N u m b e r ( v a r i a n c e ) )   | |   ( ! M a t h I s V a l i d N u m b e r ( s k e w n e s s ) )   | |   ( ! M a t h I s V a l i d N u m b e r ( k u r t o s i s ) ) )  
             r e t u r n ( f a l s e ) ;  
       e l s e  
             r e t u r n ( t r u e ) ;  
     }  
  
 # d e f i n e   M _ 1 _ S Q R T _ 2 P I     1 / M a t h S q r t ( 2 * M _ P I )  
  
 d o u b l e   F a c t o r i a l s T a b l e [ 2 1 ] =  
     {  
       1 , 1 , 2 , 6 , 2 4 , 1 2 0 , 7 2 0 , 5 0 4 0 , 4 0 3 2 0 , 3 6 2 8 8 0 , 3 6 2 8 8 0 0 , 3 9 9 1 6 8 0 0 , 4 7 9 0 0 1 6 0 0 ,  
       6 2 2 7 0 2 0 8 0 0 , 8 7 1 7 8 2 9 1 2 0 0 , 1 3 0 7 6 7 4 3 6 8 0 0 0 , 2 0 9 2 2 7 8 9 8 8 8 0 0 0 , 3 5 5 6 8 7 4 2 8 0 9 6 0 0 0 ,  
       6 4 0 2 3 7 3 7 0 5 7 2 8 0 0 0 , 1 2 1 6 4 5 1 0 0 4 0 8 8 3 2 0 0 0 , 2 4 3 2 9 0 2 0 0 8 1 7 6 6 4 0 0 0 0  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h P o w I n t                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h P o w I n t ( c o n s t   d o u b l e   x , c o n s t   i n t   p o w e r )  
     {  
 / / - - -   c h e c k   p o w e r  
       i f ( p o w e r = = 0 )  
             r e t u r n ( 1 . 0 ) ;  
       i f ( p o w e r < 0 )  
             r e t u r n ( 0 ) ;  
 / / - - -   c a l c u l a t e   p r o d u c t  
       d o u b l e   v a l = x ;  
       f o r ( i n t   i = 2 ;   i < = p o w e r ;   i + + )  
             v a l * = x ;  
 / / - - -   r e t u r n   r e s u l t  
       r e t u r n ( v a l ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h F a c t o r i a l                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h F a c t o r i a l ( c o n s t   i n t   n )  
     {  
       i f ( n < 0 )  
             r e t u r n ( 0 ) ;  
       i f ( n < = 2 0 )  
             / / - - -   u s e   v a l u e s   f r o m   t h e   f a c t o r i a l s   t a b l e  
             r e t u r n ( F a c t o r i a l s T a b l e [ n ] ) ;  
       e l s e  
           {  
             / / - - -   c a l c u l a t e   p r o d u c t   s t a r t i n g   f r o m   2 0 t h   e l e m e n t   o f   f a c t o r i a l s   t a b l e  
             d o u b l e   v a l = F a c t o r i a l s T a b l e [ 2 0 ] ;  
             f o r ( i n t   i = 2 1 ;   i < = n ;   i + + )  
                   v a l * = i ;  
             / / - - -   r e t u r n   r e s u l t  
             r e t u r n ( v a l ) ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T r u n c                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h T r u n c ( c o n s t   d o u b l e   x )  
     {  
       i f ( x > = 0 )  
             r e t u r n ( M a t h F l o o r ( x ) ) ;  
       e l s e  
             r e t u r n ( M a t h C e i l ( x ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R o u n d                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R o u n d   a   d o u b l e   n u m b e r   t o   a   g i v e n   p r e c i s i o n                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h R o u n d ( c o n s t   d o u b l e   x , c o n s t   i n t   d i g i t s )  
     {  
       i f ( ! M a t h I s V a l i d N u m b e r ( x ) )  
             r e t u r n ( Q N a N ) ;  
  
       i f ( x = = 0 . 0 )  
             r e t u r n ( x ) ;  
  
       i f ( d i g i t s > 0 )  
           {  
             d o u b l e   s i g n = 1 . 0 ;  
             d o u b l e   x x = x ;  
             i f ( x x < 0 . 0 )  
                 {  
                   x x = - x x ;  
                   s i g n = - 1 . 0 ;  
                 }  
             d o u b l e   p w r _ f a c t o r = M a t h P o w ( 1 0 , d i g i t s ) ;  
             d o u b l e   i n t _ v a l u e = M a t h F l o o r ( x x ) ;  
             d o u b l e   r e s = ( x x - i n t _ v a l u e ) * p w r _ f a c t o r ;  
             r e s = M a t h F l o o r ( M a t h A b s ( r e s ) + 0 . 5 ) ;  
             r e t u r n ( s i g n * ( i n t _ v a l u e + r e s / p w r _ f a c t o r ) ) ;  
           }  
       e l s e  
             i f ( d i g i t s = = 0 )  
                   r e t u r n   M a t h R o u n d ( x ) ;  
 / / - - -  
       r e t u r n ( 0 ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m m e n t s   f r o m   o r i g i n a l   F O R T R A N   c o d e :                                                           |  
 / / |   h t t p s : / / w w w . n e t l i b . o r g / s p e c f u n / g a m m a                                                           |  
 / / |                                                                                                                                     |  
 / / |   T h i s   r o u t i n e   c a l c u l a t e s   t h e   G A M M A   f u n c t i o n   f o r   a   r e a l   a r g u m e n t   X . |  
 / / |   C o m p u t a t i o n   i s   b a s e d   o n   a n   a l g o r i t h m   o u t l i n e d   i n   r e f e r e n c e   1 .         |  
 / / |   T h e   p r o g r a m   u s e s   r a t i o n a l   f u n c t i o n s   t h a t   a p p r o x i m a t e   t h e   G A M M A       |  
 / / |   f u n c t i o n   t o   a t   l e a s t   2 0   s i g n i f i c a n t   d e c i m a l   d i g i t s .   C o e f f i c i e n t s   |  
 / / |   f o r   t h e   a p p r o x i m a t i o n   o v e r   t h e   i n t e r v a l   ( 1 , 2 )   a r e   u n p u b l i s h e d .       |  
 / / |   T h o s e   f o r   t h e   a p p r o x i m a t i o n   f o r   X   . G E .   1 2   a r e   f r o m   r e f e r e n c e   2 .     |  
 / / |                                                                                                                                     |  
 / / |   R e f e r e n c e s :                                                                                                             |  
 / / |   1 .   " A n   O v e r v i e w   o f   S o f t w a r e   D e v e l o p m e n t   f o r   S p e c i a l   F u n c t i o n s "       |  
 / / |         W .   J .   C o d y ,   L e c t u r e   N o t e s   i n   M a t h e m a t i c s ,   5 0 6 ,                                 |  
 / / |         N u m e r i c a l   A n a l y s i s   D u n d e e ,   1 9 7 5 ,   G .   A .   W a t s o n   ( e d . )                       |  
 / / |         S p r i n g e r   V e r l a g ,   B e r l i n ,   1 9 7 6 .                                                                 |  
 / / |   2 .   C o m p u t e r   A p p r o x i m a t i o n s ,   H a r t ,   E t .   A l . ,   W i l e y   a n d   s o n s ,               |  
 / / |         N e w   Y o r k ,   1 9 6 8 .                                                                                               |  
 / / |                                                                                                                                     |  
 / / |   A u t h o r s :                                                                                                                   |  
 / / |         W .   J .   C o d y   a n d   L .   S t o l t z ,   A p p l i e d   M a t h e m a t i c s   D i v i s i o n                 |  
 / / |         A r g o n n e   N a t i o n a l   L a b o r a t o r y ,   A r g o n n e ,   I L   6 0 4 3 9                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h G a m m a ( c o n s t   d o u b l e   x )  
     {  
 / / - - -   m a t h e m a t i c a l   c o n s t a n t s  
       c o n s t   d o u b l e   l o g s q r t 2 p i = M a t h L o g ( M a t h S q r t ( 2 * M _ P I ) ) ;  
 / / - - -   m a c h i n e   d e p e n d e n t   p a r a m e t e r s  
       c o n s t   d o u b l e   x m i n i n = 2 . 2 3 e - 3 0 8 ;  
       c o n s t   d o u b l e   x b i g = 1 7 1 . 6 2 4 ;  
       d o u b l e   e p s = 2 . 2 2 e - 1 6 ;  
 / / - - -   n u m e r a t o r   a n d   d e n o m i n a t o r   c o e f f i c i e n t s   f o r   r a t i o n a l   m i n i m a x  
 / / - - -   a p p r o x i m a t i o n   o v e r   ( 1 , 2 )  
       c o n s t   d o u b l e   p [ 8 ] =  
           {  
             - 1 . 7 1 6 1 8 5 1 3 8 8 6 5 4 9 4 9 2 5 3 3 8 1 1 e + 0 ,   2 . 4 7 6 5 6 5 0 8 0 5 5 7 5 9 1 9 9 1 0 8 3 1 4 e + 1 ,  
             - 3 . 7 9 8 0 4 2 5 6 4 7 0 9 4 5 6 3 5 0 9 7 5 7 7 e + 2 ,   6 . 2 9 3 3 1 1 5 5 3 1 2 8 1 8 4 4 2 6 6 1 0 5 2 e + 2 ,  
               8 . 6 6 9 6 6 2 0 2 7 9 0 4 1 3 2 1 1 2 9 5 0 6 4 e + 2 , - 3 . 1 4 5 1 2 7 2 9 6 8 8 4 8 3 6 7 5 2 5 4 3 5 7 e + 4 ,  
             - 3 . 6 1 4 4 4 1 3 4 1 8 6 9 1 1 7 2 9 8 0 7 0 6 9 e + 4 ,   6 . 6 4 5 6 1 4 3 8 2 0 2 4 0 5 4 4 0 6 2 7 8 5 5 e + 4  
             } ;  
       c o n s t   d o u b l e   q [ 8 ] =  
           {  
             - 3 . 0 8 4 0 2 3 0 0 1 1 9 7 3 8 9 7 5 2 5 4 3 5 3 e + 1 ,   3 . 1 5 3 5 0 6 2 6 9 7 9 6 0 4 1 6 1 5 2 9 1 4 4 e + 2 ,  
             - 1 . 0 1 5 1 5 6 3 6 7 4 9 0 2 1 9 1 4 1 6 6 1 4 6 e + 3 , - 3 . 1 0 7 7 7 1 6 7 1 5 7 2 3 1 1 0 9 4 4 0 4 4 4 e + 3 ,  
               2 . 2 5 3 8 1 1 8 4 2 0 9 8 0 1 5 1 0 3 3 0 1 1 2 e + 4 ,   4 . 7 5 5 8 4 6 2 7 7 5 2 7 8 8 1 1 0 7 6 7 8 1 5 e + 3 ,  
             - 1 . 3 4 6 5 9 9 5 9 8 6 4 9 6 9 3 0 6 3 9 2 4 5 6 e + 5 , - 1 . 1 5 1 3 2 2 5 9 6 7 5 5 5 3 4 8 3 4 9 7 2 1 1 e + 5  
             } ;  
 / / - - -   c o e f f i c i e n t s   f o r   m i n i m a x   a p p r o x i m a t i o n   o v e r   ( 1 2 ,   i n f )  
       c o n s t   d o u b l e   c [ 7 ] =  
           {  
             - 1 . 9 1 0 4 4 4 0 7 7 7 2 8 e - 0 3 ,                   8 . 4 1 7 1 3 8 7 7 8 1 2 9 5 e - 0 4 ,  
             - 5 . 9 5 2 3 7 9 9 1 3 0 4 3 0 1 2 e - 0 4 ,             7 . 9 3 6 5 0 7 9 3 5 0 0 3 5 0 2 4 8 e - 0 4 ,  
             - 2 . 7 7 7 7 7 7 7 7 7 7 7 7 6 8 1 6 2 2 5 5 3 e - 0 3 , 8 . 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 5 5 4 2 4 7 e - 0 2 ,  
               5 . 7 0 8 3 8 3 5 2 6 1 e - 0 3  
           } ;  
  
       i n t         p a r i t y = 0 ;  
       d o u b l e   f a c t = 1 . 0 ;  
       i n t         n = 0 ;  
       d o u b l e   y = x , y 1 , r e s , z , x n u m = 0 , x d e n = 0 , y s q = 0 , s u m = 0 ;  
  
       i f ( y < = 0 . 0 )  
           {  
             / / - - -   a r g u m e n t   i s   n e g a t i v e  
             y = - x ;  
             y 1 = M a t h T r u n c ( y ) ;  
             r e s = y - y 1 ;  
             i f ( r e s ! = 0 . 0 )  
                 {  
                   i f ( y 1 ! = M a t h T r u n c ( y 1 * 0 . 5 ) * 2 . 0 )  
                         p a r i t y = 1 ;  
                   f a c t = - M _ P I / M a t h S i n ( M _ P I * r e s ) ;  
                   y = y + 1 . 0 ;  
                 }  
             e l s e  
                 {  
                   r e t u r n ( Q P O S I N F ) ;  
                 }  
           }  
 / / - - -   a r g u m e n t   i s   p o s i t i v e  
       i f ( y < e p s )  
           {  
             / / - - -   a r g u m e n t   <   e p s  
             i f ( y > = x m i n i n )  
                 {  
                   r e s = 1 . 0 / y ;  
                 }  
             e l s e  
                 {  
                   r e t u r n ( Q P O S I N F ) ;  
                 }  
           }  
       e l s e  
             i f ( y < 1 2 . 0 )  
                 {  
                   y 1 = y ;  
                   i f ( y < 1 . 0 )  
                       {  
                         / / - - -   0 . 0   <   a r g u m e n t   <   1 . 0  
                         z   =   y ;  
                         y   =   y   +   1 . 0 ;  
                       }  
                   e l s e  
                       {  
                         / / - - -   1 . 0   <   a r g u m e n t   <   1 2 . 0 ,   r e d u c e   a r g u m e n t   i f   n e c e s s a r y  
                         n   =   i n t ( y )   -   1 ;  
                         y   =   y   -   d o u b l e ( n ) ;  
                         z   =   y   -   1 . 0 ;  
                       }  
                   / / - - -   e v a l u a t e   a p p r o x i m a t i o n   f o r   1 . 0   <   a r g u m e n t   <   2 . 0  
                   x n u m = 0 . 0 ;  
                   x d e n = 1 . 0 ;  
                   f o r ( i n t   i = 0 ;   i < 8 ;   i + + )  
                       {  
                         x n u m   =   ( x n u m   +   p [ i ] )   *   z ;  
                         x d e n   =   x d e n   *   z   +   q [ i ] ;  
                       }  
                   r e s = x n u m / x d e n + 1 . 0 ;  
                   i f ( y 1 < y )  
                       {  
                         / / - - -   a d j u s t   r e s u l t   f o r   c a s e     0 . 0   <   a r g u m e n t   <   1 . 0  
                         r e s = r e s / y 1 ;  
                       }  
                   e l s e  
                         i f ( y 1 > y )  
                             {  
                               / / - - -   a d j u s t   r e s u l t   f o r   c a s e     2 . 0   <   a r g u m e n t   <   1 2 . 0  
                               f o r ( i n t   i = 0 ;   i < n ;   i + + )  
                                   {  
                                     r e s = r e s * y ;  
                                     y = y + 1 . 0 ;  
                                   }  
                             }  
                 }  
             e l s e  
                 {  
                   / / - - -   e v a l u a t e   f o r   a r g u m e n t   < = 1 2 . 0 ,  
                   i f ( y < = x b i g )  
                       {  
                         y s q = y * y ;  
                         s u m = c [ 6 ] ;  
                         f o r ( i n t   i = 0 ;   i < 6 ;   i + + )  
                             {  
                               s u m = s u m / y s q + c [ i ] ;  
                             }  
                         s u m   =   s u m / y   -   y   +   l o g s q r t 2 p i ;  
                         s u m   =   s u m   +   ( y - 0 . 5 ) * M a t h L o g ( y ) ;  
                         r e s   =   M a t h E x p ( s u m ) ;  
                       }  
                   e l s e  
                       {  
                         r e t u r n ( Q P O S I N F ) ;  
                       }  
                 }  
 / / - - -   f i n a l   a d j u s t m e n t s   a n d   r e t u r n  
       i f ( p a r i t y = = 1 )  
             r e s = - r e s ;  
       i f ( f a c t ! = 1 . 0 )  
             r e s = f a c t / r e s ;  
 / / - - -   r e t u r n   r e s u l t  
       r e t u r n ( r e s ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h G a m m a L o g                                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m m e n t s   f r o m   o r i g i n a l   F O R T R A N   c o d e :                                                           |  
 / / |   h t t p s : / / w w w . n e t l i b . o r g / s p e c f u n / a l g a m a                                                         |  
 / / |                                                                                                                                     |  
 / / |   T h i s   r o u t i n e   c a l c u l a t e s   t h e   L O G ( G A M M A )   f u n c t i o n   f o r   a   p o s i t i v e       |  
 / / |   r e a l   a r g u m e n t   X .   C o m p u t a t i o n   i s   b a s e d   o n   a n   a l g o r i t h m   o u t l i n e d       |  
 / / |   i n   r e f e r e n c e s   1   a n d   2 .   T h e   p r o g r a m   u s e s   r a t i o n a l   f u n c t i o n s   t h a t     |  
 / / |   t h e o r e t i c a l l y   a p p r o x i m a t e   L O G ( G A M M A )   t o   a t   l e a s t   1 8   s i g n i f i c a n t     |  
 / / |   d e c i m a l   d i g i t s .     T h e   a p p r o x i m a t i o n   f o r   X   >   1 2   i s   f r o m   r e f e r e n c e     |  
 / / |   3 ,   w h i l e   a p p r o x i m a t i o n s   f o r   X   <   1 2 . 0   a r e   s i m i l a r   t o   t h o s e   i n           |  
 / / |   r e f e r e n c e   1 ,   b u t   a r e   u n p u b l i s h e d .     T h e   a c c u r a c y   a c h i e v e d   d e p e n d s   |  
 / / |   o n   t h e   a r i t h m e t i c   s y s t e m ,   t h e   c o m p i l e r ,   t h e   i n t r i n s i c   f u n c t i o n s ,   |  
 / / |   a n d   p r o p e r   s e l e c t i o n   o f   t h e   m a c h i n e - d e p e n d e n t   c o n s t a n t s .                   |  
 / / |                                                                                                                                     |  
 / / |   R e f e r e n c e s :                                                                                                             |  
 / / |   1 )   W .   J .   C o d y   a n d   K .   E .   H i l l s t r o m ,   ' C h e b y s h e v   A p p r o x i m a t i o n s   f o r   |  
 / / |       t h e   N a t u r a l   L o g a r i t h m   o f   t h e   G a m m a   F u n c t i o n , '   M a t h .   C o m p .   2 1 ,     |  
 / / |       1 9 6 7 ,   p p .   1 9 8 - 2 0 3 .                                                                                           |  
 / / |   2 )   K .   E .   H i l l s t r o m ,   A N L / A M D   P r o g r a m   A N L C 3 6 6 S ,   D G A M M A / D L G A M A ,   M a y , |  
 / / |       1 9 6 9 .                                                                                                                     |  
 / / |   3 )   H a r t ,   E t .   A l . ,   C o m p u t e r   A p p r o x i m a t i o n s ,   W i l e y   a n d   s o n s ,   N e w       |  
 / / |       Y o r k ,   1 9 6 8 .                                                                                                         |  
 / / |   A u t h o r s :   W .   J .   C o d y   a n d   L .   S t o l t z                                                                 |  
 / / |                     A r g o n n e   N a t i o n a l   L a b o r a t o r y                                                           |  
 / / |                                                                                                                                     |  
 / / |   h t t p s : / / g c c . g n u . o r g / m l / f o r t r a n / 2 0 0 7 - 1 1 / m s g 0 0 0 6 1 / g a m m a . d i f f               |  
 / / |   F o r   n e g a t i v e   a r g u m e n t s   ( w h e r e   n e t l i b   w o u l d   r e t u r n   + I n f )                     |  
 / / |   w e   u s e   t h e   f o l l o w i n g   i d e n t i t y :                                                                       |  
 / / |   l g a m m a ( y )   =   l o g ( p i / ( | y * s i n ( p i * y ) | ) )   -   l g a m m a ( - y )                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h G a m m a L o g ( c o n s t   d o u b l e   x )  
     {  
 / / - - -   m a t h e m a t i c a l   c o n s t a n t s  
       c o n s t   d o u b l e   p n t 6 8 = 0 . 6 7 9 6 8 7 5 e 0 ;  
       c o n s t   d o u b l e   s q r t p i = 0 . 9 1 8 9 3 8 5 3 3 2 0 4 6 7 2 7 4 1 7 8 0 3 2 9 7 e 0 ;  
 / / - - -   m a c h i n e   d e p e n d e n t   p a r a m e t e r s  
       c o n s t   d o u b l e   x b i g = 2 . 5 5 E 3 0 5 ;  
       c o n s t   d o u b l e   x i n f = 1 . 7 9 E 3 0 8 ;  
       c o n s t   d o u b l e   e p s = 2 . 2 2 E - 1 6 ;  
       c o n s t   d o u b l e   f r t b i g = 2 . 2 5 E 7 6 ;  
 / / - - -   n u m e r a t o r   a n d   d e n o m i n a t o r   c o e f f i c i e n t s   f o r   r a t i o n a l   m i n i m a x  
 / / - - -   a p p r o x i m a t i o n   o v e r   ( 0 . 5 , 1 . 5 )  
       c o n s t   d o u b l e   d 1 = - 5 . 7 7 2 1 5 6 6 4 9 0 1 5 3 2 8 6 0 5 1 9 5 1 7 4 e - 1 ;  
       c o n s t   d o u b l e   p 1 [ 8 ] =  
           {  
             4 . 9 4 5 2 3 5 3 5 9 2 9 6 7 2 7 0 4 6 7 3 4 8 8 8 e 0 , 2 . 0 1 8 1 1 2 6 2 0 8 5 6 7 7 5 0 8 3 9 1 5 5 6 5 e 2 ,  
             2 . 2 9 0 8 3 8 3 7 3 8 3 1 3 4 6 3 9 3 0 2 6 7 3 9 e 3 , 1 . 1 3 1 9 6 7 2 0 5 9 0 3 3 8 0 8 2 8 6 8 5 0 4 5 e 4 ,  
             2 . 8 5 5 7 2 4 6 3 5 6 7 1 6 3 5 3 3 5 7 3 6 3 8 9 e 4 , 3 . 8 4 8 4 9 6 2 2 8 4 4 3 7 9 3 3 5 9 9 9 0 2 6 9 e 4 ,  
             2 . 6 3 7 7 4 8 7 8 7 6 2 4 1 9 5 4 3 7 9 6 3 5 3 4 e 4 , 7 . 2 2 5 8 1 3 9 7 9 7 0 0 2 8 8 1 9 7 6 9 8 9 6 1 e 3  
           } ;  
       c o n s t   d o u b l e   q 1 [ 8 ] =  
           {  
             6 . 7 4 8 2 1 2 5 5 0 3 0 3 7 7 7 1 9 6 0 7 3 0 3 6 e 1 , 1 . 1 1 3 3 3 2 3 9 3 8 5 7 1 9 9 3 2 3 5 1 3 0 0 8 e 3 ,  
             7 . 7 3 8 7 5 7 0 5 6 9 3 5 3 9 8 7 3 3 2 3 3 8 3 4 e 3 , 2 . 7 6 3 9 8 7 0 7 4 4 0 3 3 4 0 7 0 8 8 9 8 5 8 5 e 4 ,  
             5 . 4 9 9 3 1 0 2 0 6 2 2 6 1 5 7 3 2 9 7 9 4 4 1 4 e 4 , 6 . 1 6 1 1 2 2 1 8 0 0 6 6 0 0 2 1 2 7 8 3 3 3 5 2 e 4 ,  
             3 . 6 3 5 1 2 7 5 9 1 5 0 1 9 4 0 5 0 7 2 7 6 2 8 7 e 4 , 8 . 7 8 5 5 3 6 3 0 2 4 3 1 0 1 3 1 7 0 8 7 0 8 3 5 e 3  
           } ;  
 / / - - -   n u m e r a t o r   a n d   d e n o m i n a t o r   c o e f f i c i e n t s   f o r   r a t i o n a l   m i n i m a x  
 / / - - -   a p p r o x i m a t i o n   o v e r   ( 1 . 5 , 4 . 0 )  
       c o n s t   d o u b l e   d 2 = 4 . 2 2 7 8 4 3 3 5 0 9 8 4 6 7 1 3 9 3 9 9 3 7 7 7 e - 1 ;  
       c o n s t   d o u b l e   p 2 [ 8 ] =  
           {  
             4 . 9 7 4 6 0 7 8 4 5 5 6 8 9 3 2 0 3 5 0 1 2 0 6 4 e 0 , 5 . 4 2 4 1 3 8 5 9 9 8 9 1 0 7 0 4 9 4 1 0 1 9 8 6 e 2 ,  
             1 . 5 5 0 6 9 3 8 6 4 9 7 8 3 6 4 9 4 7 6 6 5 0 7 7 e 4 , 1 . 8 4 7 9 3 2 9 0 4 4 4 5 6 3 2 4 2 5 4 1 7 2 2 3 e 5 ,  
             1 . 0 8 8 2 0 4 7 6 9 4 6 8 8 2 8 7 6 7 4 9 8 4 7 0 e 6 , 3 . 3 3 8 1 5 2 9 6 7 9 8 7 0 2 9 7 3 5 9 1 7 2 2 3 e 6 ,  
             5 . 1 0 6 6 6 1 6 7 8 9 2 7 3 5 2 4 5 6 2 7 5 2 5 5 e 6 , 3 . 0 7 4 1 0 9 0 5 4 8 5 0 5 3 9 5 5 6 2 5 0 9 2 7 e 6  
           } ;  
       c o n s t   d o u b l e   q 2 [ 8 ] =  
           {  
             1 . 8 3 0 3 2 8 3 9 9 3 7 0 5 9 2 6 0 4 0 5 5 9 4 2 e 2 , 7 . 7 6 5 0 4 9 3 2 1 4 4 5 0 0 5 8 7 1 3 2 3 0 4 7 e 3 ,  
             1 . 3 3 1 9 0 3 8 2 7 9 6 6 0 7 4 1 9 4 4 0 2 4 4 8 e 5 , 1 . 1 3 6 7 0 5 8 2 1 3 2 1 9 6 9 6 0 8 9 3 8 7 5 5 e 6 ,  
             5 . 2 6 7 9 6 4 1 1 7 4 3 7 9 4 6 9 1 7 5 7 7 5 3 8 e 6 , 1 . 3 4 6 7 0 1 4 5 4 3 1 1 1 0 1 6 9 2 2 9 0 0 5 2 e 7 ,  
             1 . 7 8 2 7 3 6 5 3 0 3 5 3 2 7 4 2 1 3 9 7 5 9 3 2 e 7 , 9 . 5 3 3 0 9 5 5 9 1 8 4 4 3 5 3 6 1 3 3 9 5 7 4 7 e 6  
           } ;  
 / / - - -   n u m e r a t o r   a n d   d e n o m i n a t o r   c o e f f i c i e n t s   f o r   r a t i o n a l   m i n i m a x  
 / / - - -   a p p r o x i m a t i o n   o v e r   ( 4 . 0 , 1 2 . 0 )  
       c o n s t   d o u b l e   d 4 = 1 . 7 9 1 7 5 9 4 6 9 2 2 8 0 5 5 0 0 0 0 9 4 0 2 3 e 0 ;  
       c o n s t   d o u b l e   p 4 [ 8 ] =  
           {  
             1 . 4 7 4 5 0 2 1 6 6 0 5 9 9 3 9 9 4 8 9 0 5 0 6 2 e 4 ,   2 . 4 2 6 8 1 3 3 6 9 4 8 6 7 0 4 5 0 2 8 3 6 3 1 2 e 6 ,  
             1 . 2 1 4 7 5 5 5 7 4 0 4 5 0 9 3 2 2 7 9 3 9 5 9 2 e 8 ,   2 . 6 6 3 4 3 2 4 4 9 6 3 0 9 7 6 9 4 9 8 9 8 0 7 8 e 9 ,  
             2 . 9 4 0 3 7 8 9 5 6 6 3 4 5 5 3 8 9 9 9 0 6 8 7 6 e 1 0 , 1 . 7 0 2 6 6 5 7 3 7 7 6 5 3 9 8 8 6 8 3 9 2 9 9 8 e 1 1 ,  
             4 . 9 2 6 1 2 5 7 9 3 3 7 7 4 3 0 8 8 7 5 8 8 1 2 0 e 1 1 , 5 . 6 0 6 2 5 1 8 5 6 2 2 3 9 5 1 4 6 5 0 7 8 2 4 2 e 1 1  
           } ;  
       c o n s t   d o u b l e   q 4 [ 8 ] =  
           {  
             2 . 6 9 0 5 3 0 1 7 5 8 7 0 8 9 9 3 3 3 3 7 9 8 4 3 e 3 ,   6 . 3 9 3 8 8 5 6 5 4 3 0 0 0 9 2 3 9 8 9 8 4 2 3 8 e 5 ,  
             4 . 1 3 5 5 9 9 9 3 0 2 4 1 3 8 8 0 5 2 0 4 2 8 4 2 e 7 ,   1 . 1 2 0 8 7 2 1 0 9 6 1 6 1 4 7 9 4 1 3 7 6 5 7 0 e 9 ,  
             1 . 4 8 8 6 1 3 7 2 8 6 7 8 8 1 3 8 1 1 5 4 2 3 9 8 e 1 0 , 1 . 0 1 6 8 0 3 5 8 6 2 7 2 4 3 8 2 2 8 0 7 7 3 0 4 e 1 1 ,  
             3 . 4 1 7 4 7 6 3 4 5 5 0 7 3 7 7 1 3 2 7 9 8 5 9 7 e 1 1 , 4 . 4 6 3 1 5 8 1 8 7 4 1 9 7 1 3 2 8 6 4 6 2 0 8 1 e 1 1  
           } ;  
 / / - - -   c o e f f i c i e n t s   f o r   m i n i m a x   a p p r o x i m a t i o n   o v e r   ( 1 2 ,   i n f )  
       c o n s t   d o u b l e   c [ 7 ] =  
           {  
             - 1 . 9 1 0 4 4 4 0 7 7 7 2 8 e - 0 3 ,                   8 . 4 1 7 1 3 8 7 7 8 1 2 9 5 e - 0 4 ,  
             - 5 . 9 5 2 3 7 9 9 1 3 0 4 3 0 1 2 e - 0 4 ,             7 . 9 3 6 5 0 7 9 3 5 0 0 3 5 0 2 4 8 e - 0 4 ,  
             - 2 . 7 7 7 7 7 7 7 7 7 7 7 7 6 8 1 6 2 2 5 5 3 e - 0 3 , 8 . 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 5 5 4 2 4 7 e - 0 2 ,  
               5 . 7 0 8 3 8 3 5 2 6 1 e - 0 3  
           } ;  
  
       d o u b l e   y = x ;  
       d o u b l e   r e s = 0 . 0 ;  
       d o u b l e   c o r r = 0 ;  
       d o u b l e   x m 1 , x m 2 , x m 4 , x d e n , x n u m ;  
       d o u b l e   y s q = 0 ;  
  
       i f ( ( y > 0   & &   y < = x b i g ) )  
           {  
             i f ( y < = e p s )  
                 {  
                   r e s = - M a t h L o g ( y ) ;  
                 }  
             e l s e  
                 {  
                   i f ( y < = 1 . 5 )  
                       {  
                         / / - - -   e p s   <   x   < =   1 . 5  
                         i f ( y < p n t 6 8 )  
                             {  
                               c o r r =   - M a t h L o g ( y ) ;  
                               x m 1   =   y ;  
                             }  
                         e l s e  
                             {  
                               c o r r = 0 . 0 ;  
                               x m 1   = ( y - 0 . 5 ) - 0 . 5 ;  
                             }  
                         i f ( ( y < = 0 . 5   | |   y > = p n t 6 8 ) )  
                             {  
                               x d e n   =   1 . 0 ;  
                               x n u m   =   0 ;  
                               f o r ( i n t   i = 0 ;   i < 8 ;   i + + )  
                                   {  
                                     x n u m   =   x n u m * x m 1   +   p 1 [ i ] ;  
                                     x d e n   =   x d e n * x m 1   +   q 1 [ i ] ;  
                                   }  
                               r e s = c o r r + ( x m 1   * ( d 1 + x m 1 * ( x n u m / x d e n ) ) ) ;  
                             }  
                         e l s e  
                             {  
                               x m 2 = ( y - 0 . 5 ) - 0 . 5 ;  
                               x d e n   =   1 . 0 ;  
                               x n u m   =   0 . 0 ;  
                               f o r ( i n t   i = 0 ;   i < 8 ;   i + + )  
                                   {  
                                     x n u m = x n u m * x m 2 + p 2 [ i ] ;  
                                     x d e n = x d e n * x m 2 + q 2 [ i ] ;  
                                   }  
                               r e s = c o r r + x m 2   * ( d 2 + x m 2 * ( x n u m / x d e n ) ) ;  
                             }  
                       }  
                   e l s e  
                       {  
                         i f ( y < = 4 . 0 )  
                             {  
                               / / - - -   1 . 5   <   x   . < =   4 . 0  
                               x m 2 = y - 2 . 0 ;  
                               x d e n   =   1 . 0 ;  
                               x n u m   =   0 . 0 ;  
                               f o r ( i n t   i = 0 ;   i < 8 ;   i + + )  
                                   {  
                                     x n u m   =   x n u m * x m 2   +   p 2 [ i ] ;  
                                     x d e n   =   x d e n * x m 2   +   q 2 [ i ] ;  
                                   }  
                               r e s = x m 2   * ( d 2 + x m 2 * ( x n u m / x d e n ) ) ;  
                             }  
                         e l s e  
                             {  
                               i f ( y < = 1 2 . 0 )  
                                   {  
                                     / / - - -   4 . 0   <   x   < =   1 2 . 0  
                                     x m 4 = y - 4 . 0 ;  
                                     x d e n   =   - 1 . 0 ;  
                                     x n u m   =   0 . 0 ;  
                                     f o r ( i n t   i = 0 ;   i < 8 ;   i + + )  
                                         {  
                                           x n u m   =   x n u m * x m 4   +   p 4 [ i ] ;  
                                           x d e n   =   x d e n * x m 4   +   q 4 [ i ] ;  
                                         }  
                                     r e s = d 4 + x m 4 * ( x n u m / x d e n ) ;  
                                   }  
                               e l s e  
                                   {  
                                     / / - - -   e v a l u a t e   f o r   a r g u m e n t > = 1 2 . 0 ,  
                                     r e s = 0 . 0 ;  
                                     i f ( y < = f r t b i g )  
                                         {  
                                           r e s = c [ 6 ] ;  
                                           y s q = y * y ;  
                                           f o r ( i n t   i = 0 ;   i < 6 ;   i + + )  
                                               {  
                                                 r e s = r e s / y s q + c [ i ] ;  
                                               }  
                                         }  
                                     r e s = r e s / y ;  
                                     c o r r =   M a t h L o g ( y ) ;  
                                     r e s   =   r e s   +   s q r t p i   -   0 . 5 * c o r r ;  
                                     r e s   =   r e s   +   y * ( c o r r - 1 . 0 ) ;  
                                   }  
                             }  
                       }  
                 }  
           }  
       e l s e  
           {  
             / / - - -   r e t u r n   f o r   b a d   a r g u m e n t s  
             / / - - -   r e s = Q P O S I N F ;  
             / / - - -   f o r   n e g a t i v e   a r g u m e n t s   ( w h e r e   n e t l i b   w o u l d   r e t u r n   + I n f )  
             / / - - -   w e   u s e   t h e   f o l l o w i n g   i d e n t i t y :  
             / / - - -   l g a m m a ( y )   =   l o g ( p i / ( | y * s i n ( p i * y ) | ) )   -   l g a m m a ( - y )  
             / / - - -   h t t p s : / / g c c . g n u . o r g / m l / f o r t r a n / 2 0 0 7 - 1 1 / m s g 0 0 0 6 1 / g a m m a . d i f f  
             i f ( y < 0   & &   M a t h F l o o r ( y ) ! = y )  
                 {  
                   / / - - -   f o r   a b s ( y )   v e r y   c l o s e   t o   z e r o ,   w e   u s e   a   s e r i e s   e x p a n s i o n   t o  
                   / / - - -   t h e   f i r s t   o r d e r   i n   y   t o   a v o i d   o v e r f l o w .  
                   i f ( y > - 1 . e - 1 0 0 )  
                         r e s = - 2 * M a t h L o g ( M a t h A b s ( y ) ) - M a t h G a m m a L o g ( - y ) ;  
                   e l s e  
                         r e s = M a t h L o g ( M _ P I / M a t h A b s ( y * M a t h S i n ( M _ P I * y ) ) ) - M a t h G a m m a L o g ( - y ) ;  
                 }  
             e l s e  
                 {  
                   / / - - -   n e g a t i v e   i n t e g e r   v a l u e s  
                   r e s = Q P O S I N F ;  
                 }  
           }  
 / / - - -   r e t u r n   r e s u l t  
       r e t u r n ( r e s ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B e t a                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h B e t a ( c o n s t   d o u b l e   a , c o n s t   d o u b l e   b )  
     {  
       r e t u r n   M a t h E x p ( M a t h B e t a L o g ( a , b ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B e t a L o g                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h B e t a L o g ( c o n s t   d o u b l e   a , c o n s t   d o u b l e   b )  
     {  
       r e t u r n ( M a t h G a m m a L o g ( a ) + M a t h G a m m a L o g ( b ) - M a t h G a m m a L o g ( a + b ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n c o m p l e t e   b e t a   f u n c t i o n                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   i n c o m p l e t e   b e t a   f u n c t i o n   r a t i o   i s   t h e   p r o b a b i l i t y   t h a t   a           |  
 / / |   r a n d o m   v a r i a b l e   f r o m   a   b e t a   d i s t r i b u t i o n   h a v i n g   p a r a m e t e r s   p           |  
 / / |   a n d   q   w i l l   b e   l e s s   t h a n   o r   e q u a l   t o   x .                                                       |  
 / / |                                                                                                                                     |  
 / / |   I n p u t :                                                                                                                       |  
 / / |   x   :   u p p e r   l i m i t   o f   i n t e g r a t i o n .     x   m u s t   b e   i n   ( 0 , 1 )   i n c l u s i v e .       |  
 / / |   p   :   f i r s t   b e t a   d i s t r i b u t i o n   p a r a m e t e r .     p   m u s t   b e > 0 . 0 .                       |  
 / / |   q   :   s e c o n d   b e t a   d i s t r i b u t i o n   p a r a m e t e r .   q   m u s t   b e > 0 . 0 .                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n s   t h e   v a l u e   o f   t h e   i n c o m p l e t e   B e t a   f u n c t i o n   r a t i o .                   |  
 / / |                                                                                                                                     |  
 / / |   O r i g i n a l   F O R T R A N 7 7   v e r s i o n   b y   K L   M a j u m d e r ,   G P   B h a t t a c h a r j e e .           |  
 / / |   C   v e r s i o n   b y   J o h n   B u r k a r d t .                                                                             |  
 / / |                                                                                                                                     |  
 / / |   R e f e r e n c e :                                                                                                               |  
 / / |                                                                                                                                     |  
 / / |   K L   M a j u m d e r ,   G P   B h a t t a c h a r j e e ,                                                                       |  
 / / |   A l g o r i t h m   A S   6 3 :   T h e   i n c o m p l e t e   B e t a   I n t e g r a l ,                                       |  
 / / |   A p p l i e d   S t a t i s t i c s , . V o l u m e   2 2 ,   N u m b e r   3 ,   1 9 7 3 ,   p a g e s   4 0 9 - 4 1 1 .         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h B e t a I n c o m p l e t e ( c o n s t   d o u b l e   x , c o n s t   d o u b l e   p , c o n s t   d o u b l e   q )  
     {  
       d o u b l e   a c u = 0 . 1 E - 1 6 ;  
       d o u b l e   p p , q q , x x ;  
       i n t         i f a u l t = 0 ;  
       d o u b l e   v a l u e = x ;  
 / / - - -   c h e c k   t h e   i n p u t   a r g u m e n t s  
       i f ( p < = 0 . 0   | |   q < = 0 . 0 )  
           {  
             i f a u l t = 1 ;  
             r e t u r n ( v a l u e ) ;  
           }  
 / / - - -   c h e c k   x   r a n g e  
       i f ( x < 0 . 0   | |   1 . 0 < x )  
           {  
             i f a u l t = 2 ;  
             r e t u r n ( v a l u e ) ;  
           }  
 / / - - -   s p e c i a l   c a s e s  
       i f ( x = = 0 . 0   | |   x = = 1 . 0 )  
           {  
             r e t u r n ( v a l u e ) ;  
           }  
 / / - - -   c a l c   b e t a   l o g  
       d o u b l e   b e t a _ l o g = M a t h G a m m a L o g ( p ) + M a t h G a m m a L o g ( q ) - M a t h G a m m a L o g ( p + q ) ;  
 / / - - -   c h a n g e   t a i l   i f   n e c e s s a r y   a n d   d e t e r m i n e   S  
       d o u b l e   p s q =   p + q ;  
       d o u b l e   c x   =   1 . 0 - x ;  
  
       i n t   i n d x = 0 ;  
       i f ( p < p s q * x )  
           {  
             x x   =   c x ;  
             c x   =   x ;  
             p p   =   q ;  
             q q   =   p ;  
             i n d x = 1 ;  
           }  
       e l s e  
           {  
             x x   =   x ;  
             p p   =   p ;  
             q q   =   q ;  
             i n d x = 0 ;  
           }  
  
       v a l u e = 1 . 0 ;  
       d o u b l e   t e r m = 1 . 0 ;  
       d o u b l e   a i = 1 . 0 ;  
       i n t         n s = ( i n t ) ( q q + c x * p s q ) ;  
 / / - - -   u s e   t h e   S o p e r   r e d u c t i o n   f o r m u l a  
       d o u b l e   r x = x x / c x ;  
       d o u b l e   t e m p = q q - a i ;  
  
       i f ( n s = = 0 . 0 )  
           {  
             r x = x x ;  
           }  
  
       f o r ( ; ; )  
           {  
             t e r m = t e r m * t e m p * r x / ( p p + a i ) ;  
             v a l u e =   v a l u e + t e r m ; ;  
             t e m p   =   M a t h A b s ( t e r m ) ;  
             / / - - -  
             i f ( t e m p < = a c u   & &   t e m p < = a c u * v a l u e )  
                 {  
                   v a l u e = v a l u e * M a t h E x p ( p p * M a t h L o g ( x x ) + ( q q - 1 . 0 ) * M a t h L o g ( c x ) - b e t a _ l o g ) / p p ;  
                   i f ( i n d x )  
                       {  
                         v a l u e = 1 . 0 - v a l u e ;  
                       }  
                   b r e a k ;  
                 }  
  
             a i = a i + 1 . 0 ;  
             n s - - ;  
  
             i f ( 0 < = n s )  
                 {  
                   t e m p = q q - a i ;  
                   i f ( n s = = 0 )  
                       {  
                         r x = x x ;  
                       }  
                 }  
             e l s e  
                 {  
                   t e m p =   p s q ;  
                   p s q   =   p s q + 1 . 0 ;  
                 }  
           }  
 / / - - -   r e t u r n   r e s u l t  
       r e t u r n ( v a l u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n c o m p l e t e   G a m m a   f u n c t i o n                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n p u t s :                                                                                                                     |  
 / / |   x           :   v a l u e   a t   w h i c h   t h e   c . d . f   i s   t o   b e   c o m p u t e d                               |  
 / / |   a l p h a   :   p a r a m e t e r   o f   t h e   g a m m a   f u n c t i o n   ( > 0 )                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m m e n t   f r o m   o r i g i n a l   F O R T R A N   c o d e :                                                             |  
 / / |   w w w . n i s t . g o v / s i t e s / d e f a u l t / f i l e s / d o c u m e n t s / i t l / s e d / s t s p a c . f             |  
 / / |   i b i d   . . . / i t l / s e d / S E D _ N o t e _ 8 6 - 2 - 2 . p d f                                                           |  
 / / |                                                                                                                                     |  
 / / |   C D F G A M     W r i t t e n   b y   C h a r l e s   p .   R e e v e ,   S t a t i s t i c a l   E n g i n e e r i n g           |  
 / / |                   D i v i s i o n ,   N a t i o n a l   B u r e a u   o f   S t a n d a r d s ,   G a i t h e r s b u r g .         |  
 / / |                                                                                                                                     |  
 / / |   C o m p u t i n g   t h e   c u m u l a t i v e   d i s t r i b u t i o n   f u n c t i o n   o f   t h e   G a m m a             |  
 / / |   d i s t r i b u t i o n   ( a l s o   k n o w n   a s   t h e   I n c o m p l e t e   G a m m a   r a t i o )   t o   a           |  
 / / |   s p e c i f i e d   a c c u r a c y   ( t r u n c a t i o n   e r r o r   i n   t h e   i n f i n i t e   s e r i e s ) .         |  
 / / |   t h e   a l g o r i t h m ,   d e s c r i b e d   i n   R e f .   2 ,   i s   a   m o d i f i c a t i o n   o f                   |  
 / / |   t h e   a l g o r i t h m   o f   R e f .   1 .   T h r e e   f e a t u r e s   h a v e   b e e n   a d d e d :                   |  
 / / |                                                                                                                                     |  
 / / |     1 )   A   p r e c i s e   m e t h o d   o f   m e e t i n g   t h e   t r u n c a t i o n   a c c u r a c y ,                   |  
 / / |     2 )   C o m p u t a t i o n   o f   t h e   u p p e r   t a i l   a r e a   b y   d e c r e m e n t i n g   a l p h a           |  
 / / |           w h e n   t h a t   m e t h o d   i s   m o r e   e f f i c i e n t ,   a n d                                             |  
 / / |     3 )   A   c o n s t a n t   u f l o   > =   t h e   u n d e r f l o w   l i m i t   o n   t h e   c o m p u t e r .             |  
 / / |                                                                                                                                     |  
 / / |   R e f e r e n c e s :                                                                                                             |  
 / / |                                                                                                                                     |  
 / / |   1 )   L a u ,   C h i - L e u n g ,   ' A   S i m p l e   S e r i e s   f o r   t h e   I n c o m p l e t e   G a m m a           |  
 / / |         I n t e g r a l ' ,   A l g o r i t h m   A S   1 4 7 ,   A p p l i e d   S t a t i s t i c s ,   v o l .   2 9 ,           |  
 / / |         N o .   1 ,   1 9 8 0 ,   p p .   1 1 3 - 1 1 4 .                                                                           |  
 / / |                                                                                                                                     |  
 / / |   2 )   R e e v e ,   C h a r l e s   p . ,   ' A n   A l g o r i t h m   f o r   C o m p u t i n g   t h e   G a m m a             |  
 / / |         C . D . F .   t o   a   S p e c i f i e d   A c c u r a c y ' ,   S t a t i s t i c a l   E n g i n e e r i n g             |  
 / / |         D i v i s i o n , N o t e   8 6 - 2 ,   O c t o b e r   1 9 8 6 .                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h G a m m a I n c o m p l e t e ( d o u b l e   x , d o u b l e   a l p h a )  
     {  
       d o u b l e   e p s = 1 0 e - 2 0 ;  
       i n t         i f l a g = 0 ;  
       b o o l       l l ;  
       i n t         i m a x = 5 0 0 0 ;  
       d o u b l e   u f l o = 1 . 0 e - 1 0 0 ;  
       d o u b l e   c d f x = 0 . 0 ;  
       i n t         k = 0 ;  
 / / - - -   c h e c k   f o r   v a l i d i t y   o f   a r g u m e n t s   a l p h a   a n d   e p s  
       i f ( a l p h a < = u f l o   | |   e p s < = u f l o )  
           {  
             i f l a g = 1 ;  
             r e t u r n ( Q N a N ) ;  
           }  
  
       i f l a g = 0 ;  
 / / - - -   c h e c k   f o r   s p e c i a l   c a s e   o f   x  
       i f ( x < = 0 . 0 )  
             r e t u r n ( Q N a N ) ;  
 / / - - -   e v a l u a t e   t h e   g a m m a   p . d . f .   a n d   c h e c k   f o r   u n d e r f l o w  
       d o u b l e   d x = d o u b l e ( x ) ;  
  
       d o u b l e   p d f l = d o u b l e ( a l p h a - 1 . 0 ) * M a t h L o g ( d x ) - d x - M a t h G a m m a L o g ( a l p h a ) ;  
  
       i f ( p d f l < M a t h L o g ( u f l o ) )  
           {  
             i f ( x > = a l p h a )  
                   c d f x = 1 . 0 ;  
           }  
       e l s e  
           {  
             d o u b l e   p = a l p h a ;  
             d o u b l e   u = M a t h E x p ( p d f l ) ;  
             / / - - -   d e t e r m i n e   w h e t h e r   t o   i n c r e m e n t   o r   d e c r e m e n t   a l p h a   ( a . k . a .   p )  
             l l = t r u e ;  
             i f ( x > = p )  
                 {  
                   k = i n t ( p ) ;  
  
                   i f ( p < = d o u b l e ( k ) )  
                         k = k - 1 ;  
  
                   d o u b l e   e t a = p - d o u b l e ( k ) ;  
                   d o u b l e   b l = d o u b l e ( ( e t a - 1 . 0 ) * M a t h L o g ( d x ) - d x - M a t h G a m m a L o g ( e t a ) ) ;  
                   l l = b l > M a t h L o g ( e p s ) ;  
                 }  
             / / - - -  
             d o u b l e   e p s x = e p s / x ;  
             / / - - -  
             i f ( l l = = t r u e )  
                 {  
                   / / - - -   i n c r e m e n t   p  
                   f o r ( i n t   i = 0 ;   i < = i m a x ;   i + + )  
                       {  
                         i f ( u < = e p s x * ( p - x ) )  
                             {  
                               r e t u r n ( c d f x ) ;  
                             }  
                         u = x * u / p ;  
                         c d f x = c d f x + u ;  
                         p = p + 1 . 0 ;  
                       }  
                   i f l a g = 2 ;  
                 }  
             e l s e  
                 {  
                   / / - - -   d e c r e m e n t   p  
                   f o r ( i n t   j = 1 ;   j < = k ;   j + + )  
                       {  
                         p = p - 1 . 0 ;  
  
                         i f ( u < = e p s x * ( x - p ) )  
                               b r e a k ;  
  
                         c d f x = c d f x + u ;  
                         u = p * u / x ;  
                       }  
                   c d f x = 1 . 0 - c d f x ;  
                 }  
           }  
 / / - - -   r e t u r n   r e s u l t  
       r e t u r n ( c d f x ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   b i n o m i a l   c o e f f i c i e n t   C ( n , k ) = n ! / ( k ! * ( n - k ) ! )                     |  
 / / |  
 / / |   T h e   v a l u e   i s   c a l c u l a t e d   i n   s u c h   a   w a y   a s   t o   a v o i d   o v e r f l o w   a n d       |  
 / / |   r o u n d o f f .     T h e   c a l c u l a t i o n   i s   d o n e   i n   i n t e g e r   a r i t h m e t i c .                 |  
 / / |                                                                                                                                     |  
 / / |   P a r a m e t e r s :                                                                                                             |  
 / / |   I n p u t ,   i n t   N ,   K ,   a r e   t h e   v a l u e s   o f   N   a n d   K .                                             |  
 / / |   O u t p u t :   t h e   n u m b e r   o f   c o m b i n a t i o n s   o f   N   t h i n g s   t a k e n   K   a t   a   t i m e . |  
 / / |                                                                                                                                     |  
 / / |   A u t h o r :   J o h n   B u r k a r d t                                                                                         |  
 / / |                                                                                                                                     |  
 / / |   R e f e r e n c e :                                                                                                               |  
 / / |   M L   W o l f s o n ,   H V   W r i g h t ,                                                                                       |  
 / / |   A l g o r i t h m   1 6 0 :   C o m b i n a t o r i a l   o f   M   T h i n g s   T a k e n   N   a t   a   T i m e ,             |  
 / / |   C o m m u n i c a t i o n s   o f   t h e   A C M ,   V o l u m e   6 ,   N 4 ,   A p r i l   1 9 6 3 ,   p a g e   1 6 1 .       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 l o n g   M a t h B i n o m i a l C o e f f i c i e n t ( c o n s t   i n t   n , c o n s t   i n t   k )  
     {  
       i n t     m n , m x ;  
       l o n g   v a l u e = 0 ;  
       i n t   n _ k = n - k ;  
 / / - - -  
       i f ( k < n _ k )  
           {  
             m n   =   k ;  
             m x   =   n _ k ;  
           }  
       e l s e  
           {  
             m n   =   n _ k ;  
             m x   =   k ;  
           }  
       i f ( m n > 0 )  
           {  
             v a l u e = m x + 1 ;  
             f o r ( i n t   i = 2 ;   i < = m n ;   i + + )  
                   v a l u e = ( v a l u e * ( m x + i ) ) / i ;  
           }  
       e l s e  
           {  
             i f ( m n < 0 )  
                   r e t u r n ( 0 ) ;  
             i f ( m n = = 0 )  
                   r e t u r n ( 1 ) ;  
           }  
 / / - - -  
       r e t u r n ( v a l u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i n o m i a l C o e f f i c i e n t L o g                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h B i n o m i a l C o e f f i c i e n t L o g ( c o n s t   i n t   n , c o n s t   i n t   k )  
     {  
       i n t     m n , m x ;  
       l o n g   v a l u e = 0 ;  
       i n t   n _ k = n - k ;  
 / / - - -  
       i f ( k < n _ k )  
           {  
             m n   =   k ;  
             m x   =   n _ k ;  
           }  
       e l s e  
           {  
             m n   =   n _ k ;  
             m x   =   k ;  
           }  
       i f ( m n > 0 )  
           {  
             v a l u e = m x + 1 ;  
             f o r ( i n t   i = 2 ;   i < = m n ;   i + + )  
                   v a l u e = ( v a l u e * ( m x + i ) ) / i ;  
           }  
       e l s e  
           {  
             i f ( m n < 0 )  
                   r e t u r n ( Q N E G I N F ) ;  
             i f ( m n = = 0 )  
                   r e t u r n ( 0 ) ;  
           }  
 / / - - -  
       r e t u r n   M a t h L o g ( v a l u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   l o g a r i t h m   o f   t h e   B i n o m i a l   c o e f f i c i e n t .                             |  
 / / |                                                                                                                                     |  
 / / |   L o g ( C ( n , k ) ) = L o g ( n ! / ( k ! * ( n - k ) ! ) )                                                                     |  
 / / |                                                                                                                                     |  
 / / |   P a r a m e t e r s :                                                                                                             |  
 / / |   I n p u t ,   i n t   n ,   k ,   a r e   t h e   v a l u e s   o f   n   a n d   k .                                             |  
 / / |   R e t u r n   v a l u e :   t h e   l o g a r i t h m   o f   C ( n , k ) .                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h B i n o m i a l C o e f f i c i e n t L o g ( c o n s t   d o u b l e   n , c o n s t   d o u b l e   k )  
     {  
       r e t u r n ( M a t h G a m m a L o g ( n + 1 ) - M a t h G a m m a L o g ( k + 1 ) - M a t h G a m m a L o g ( n - k + 1 ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   f u n c t i o n   H y p e r g e o m e t r i c _ 2 F 2 ( a , b , c , d , z )   u s i n g                 |  
 / / |   a   T a y l o r   m e t h o d .                                                                                                   |  
 / / |                                                                                                                                     |  
 / / |   A u t h o r         :   J o h n   P e a r s o n                                                                                   |  
 / / |   R e f e r e n c e   :   M S c   t h e s i s   " C o m p u t a t i o n   o f   H y p e r g e o m e t r i c   F u n c t i o n s "   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h H y p e r g e o m e t r i c 2 F 2 ( c o n s t   d o u b l e   a , c o n s t   d o u b l e   b , c o n s t   d o u b l e   c , c o n s t   d o u b l e   d , c o n s t   d o u b l e   z )  
     {  
       d o u b l e   a 1 = 1 . 0 ;  
       d o u b l e   b 1 = 1 . 0 ;  
       d o u b l e   t o l = 1 0 E - 1 0 ;     / /   s e t   t o l e r a n c e  
 / / - - -   d i r e c t   s u m m a t i o n  
       f o r ( i n t   j = 1 ;   j < = 5 0 0 ;   j + + )  
           {  
             / / - - -   u p d a t e   c u r r e n t   t e r m   i n   t e r m s   o f   p r e v i o u s   o n e  
             a 1 = ( a + j - 1 ) * ( b + j - 1 ) / ( c + j - 1 ) / ( d + j - 1 ) * z / j * a 1 ;  
             / / - - -   u p d a t e   s u m   o f   t e r m s   c o m p u t e d   s o   f a r  
             b 1 = b 1 + a 1 ;  
             / / - - -   t e r m i n a t e   s u m m a t i o n   i f   s t o p p i n g   c r i t e r i o n   i s   s a t i s f i e d  
             i f ( M a t h A b s ( a 1 ) / M a t h A b s ( b 1 ) < t o l )  
                   r e t u r n ( b 1 ) ;  
           }  
 / / - - -   u n k n o w n  
       r e t u r n ( Q N a N ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e t u r n s   l o g ( 0 )   d e p e n d i n g   o n   t a i l   a n d   l o g _ m o d e   a r u g m e n t s                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   T a i l L o g 0 ( c o n s t   b o o l   t a i l , c o n s t   b o o l   l o g _ m o d e )  
     {  
       i f ( t a i l = = t r u e )  
           {  
             i f ( l o g _ m o d e = = t r u e )  
                   r e t u r n ( Q N E G I N F ) ;  
             e l s e  
                   r e t u r n ( 0 . 0 ) ;  
           }  
       e l s e  
           {  
             i f ( l o g _ m o d e = = t r u e )  
                   r e t u r n ( 0 . 0 ) ;  
             e l s e  
                   r e t u r n ( 1 . 0 ) ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e t u r n s   l o g ( 1 )   d e p e n d i n g   o n   t a i l   a n d   l o g _ m o d e   a r u g m e n t s                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   T a i l L o g 1 ( c o n s t   b o o l   t a i l , c o n s t   b o o l   l o g _ m o d e )  
     {  
       i f ( t a i l = = t r u e )  
           {  
             i f ( l o g _ m o d e = = t r u e )  
                   r e t u r n ( 0 . 0 ) ;  
             e l s e  
                   r e t u r n ( 1 . 0 ) ;  
           }  
       e l s e  
           {  
             i f ( l o g _ m o d e = = t r u e )  
                   r e t u r n ( 1 . 0 ) ;  
             e l s e  
                   r e t u r n ( 0 . 0 ) ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e t u r n s   v a l u e   d e p e n d i n g   o n   t a i l   a n d   l o g _ m o d e   a r u g m e n t s                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   T a i l L o g V a l u e ( c o n s t   d o u b l e   v a l u e , c o n s t   b o o l   t a i l , c o n s t   b o o l   l o g _ m o d e )  
     {  
       i f ( t a i l = = t r u e )  
           {  
             i f ( l o g _ m o d e )  
                   r e t u r n   M a t h L o g ( M a t h A b s ( v a l u e ) ) ;  
             e l s e  
                   r e t u r n ( v a l u e ) ;  
           }  
       e l s e  
           {  
             i f ( l o g _ m o d e )  
                   r e t u r n   M a t h L o g ( M a t h A b s ( 1 . 0 - v a l u e ) ) ;  
             e l s e  
                   r e t u r n ( 1 . 0 - v a l u e ) ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e t u r n s   v a l u e   d e p e n d i n g   o n   t a i l   a n d   l o g _ m o d e   a r u g m e n t s                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   T a i l L o g P r o b a b i l i t y ( c o n s t   d o u b l e   p r o b a b i l i t y , c o n s t   b o o l   t a i l , c o n s t   b o o l   l o g _ m o d e )  
     {  
       i f ( t a i l = = t r u e )  
           {  
             i f ( l o g _ m o d e )  
                   r e t u r n   M a t h E x p ( p r o b a b i l i t y ) ;  
             e l s e  
                   r e t u r n ( p r o b a b i l i t y ) ;  
           }  
       e l s e  
           {  
             i f ( l o g _ m o d e )  
                   r e t u r n ( 1 . 0 - M a t h E x p ( p r o b a b i l i t y ) ) ;  
             e l s e  
                   r e t u r n ( 1 . 0 - p r o b a b i l i t y ) ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S e q u e n c e                                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   g e n e r a t e s   a   s e q u e n c e   o f   d o u b l e   n u m b e r s                             |  
 / / |   w i t h   g i v e n   s t a r t i n g   a n d   e n d i n g   v a l u e s   a n d   s t e p .                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   f r o m                 :   S t a r t i n g   v a l u e   o f   t h e   s e q u e n c e                                           |  
 / / |   t o                     :   L a s t   v a l u e   o f   t h e   s e q u e n c e                                                   |  
 / / |   s t e p                 :   S t e p   o f   t h e   s e q u e n c e                                                               |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   t h e   s e q u e n c e   v a l u e s                                             |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S e q u e n c e ( c o n s t   d o u b l e   f r o m , c o n s t   d o u b l e   t o , c o n s t   d o u b l e   s t e p , d o u b l e   & r e s u l t [ ] )  
     {  
 / / - - -   c h e c k   N a N  
       i f ( ! M a t h I s V a l i d N u m b e r ( f r o m )   | |   ! M a t h I s V a l i d N u m b e r ( t o )   | |   ! M a t h I s V a l i d N u m b e r ( s t e p ) )  
             r e t u r n ( f a l s e ) ;  
  
       i f ( t o < f r o m )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   n u m b e r   o f   e l e m e n t s   a n d   p r e p a r e   o u t p u t   a r r a y  
       i n t   c o u n t = 1 + i n t ( ( t o - f r o m ) / s t e p ) ;  
  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   s e q u e n c e  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             r e s u l t [ i ] = f r o m + i * s t e p ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S e q u e n c e                                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   g e n e r a t e s   a   s e q u e n c e   o f   i n t e g e r   n u m b e r s                           |  
 / / |   w i t h   g i v e n   s t a r t i n g   a n d   e n d i n g   v a l u e s   a n d   s t e p .                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   f r o m                 :   S t a r t i n g   v a l u e   o f   t h e   s e q u e n c e                                           |  
 / / |   t o                     :   L a s t   v a l u e   o f   t h e   s e q u e n c e                                                   |  
 / / |   s t e p                 :   S t e p   o f   t h e   s e q u e n c e                                                               |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   t h e   s e q u e n c e   v a l u e s                                             |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S e q u e n c e ( c o n s t   i n t   f r o m , c o n s t   i n t   t o , c o n s t   i n t   s t e p , i n t   & r e s u l t [ ] )  
     {  
       i f ( t o < f r o m )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   n u m b e r   o f   e l e m e n t s   a n d   p r e p a r e   o u t p u t   a r r a y  
       i n t   c o u n t = 1 + i n t ( ( t o - f r o m ) / s t e p ) ;  
  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   s e q u e n c e  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             r e s u l t [ i ] = f r o m + i * s t e p ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S e q u e n c e B y C o u n t                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   g e n e r a t e s   a   s e q u e n c e   o f   d o u b l e   n u m b e r s                             |  
 / / |   w i t h   g i v e n   s t a r t i n g   a n d   e n d i n g   v a l u e s   a n d   n u m b e r   o f   e l e m e n t s           |  
 / / |   i n   t h e   s e q u e n c e .                                                                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   f r o m                 :   S t a r t i n g   v a l u e   o f   t h e   s e q u e n c e                                           |  
 / / |   t o                     :   L a s t   v a l u e   o f   t h e   s e q u e n c e                                                   |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   i n   t h e   s e q u e n c e                                   |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s e q u e n c e   v a l u e s                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S e q u e n c e B y C o u n t ( c o n s t   d o u b l e   f r o m , c o n s t   d o u b l e   t o , c o n s t   i n t   c o u n t , d o u b l e   & r e s u l t [ ] )  
     {  
 / / - - -   c h e c k   N a N  
       i f ( ! M a t h I s V a l i d N u m b e r ( f r o m )   | |   ! M a t h I s V a l i d N u m b e r ( t o ) )  
             r e t u r n ( f a l s e ) ;  
  
       i f ( t o < f r o m   | |   c o u n t < = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   o u t p u t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   s e q u e n c e  
       d o u b l e   s t e p = ( c o u n t = = 1 )   ?   0   :   ( ( t o - f r o m ) / ( c o u n t - 1 ) ) ;  
  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             r e s u l t [ i ] = f r o m + i * s t e p ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S e q u e n c e B y C o u n t                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   g e n e r a t e s   a   s e q u e n c e   o f   d o u b l e   n u m b e r s                             |  
 / / |   w i t h   g i v e n   s t a r t i n g   a n d   e n d i n g   v a l u e s   a n d   n u m b e r   o f   e l e m e n t s           |  
 / / |   i n   t h e   s e q u e n c e .                                                                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   f r o m                 :   S t a r t i n g   v a l u e   o f   t h e   s e q u e n c e                                           |  
 / / |   t o                     :   L a s t   v a l u e   o f   t h e   s e q u e n c e                                                   |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   i n   t h e   s e q u e n c e                                   |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s e q u e n c e   v a l u e s                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S e q u e n c e B y C o u n t ( c o n s t   i n t   f r o m , c o n s t   i n t   t o , c o n s t   i n t   c o u n t , i n t   & r e s u l t [ ] )  
     {  
       i f ( t o < f r o m   | |   c o u n t < = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   o u t p u t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   s e q u e n c e  
       i n t   s t e p = ( c o u n t = = 1 )   ?   0   :   ( ( t o - f r o m ) / ( c o u n t - 1 ) ) ;  
  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             r e s u l t [ i ] = f r o m + i * s t e p ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R e p l i c a t e                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   r e p l i c a t e s   t h e   s e q u e n c e   o f   d o u b l e   n u m b e r s                       |  
 / / |   f r o m   a r r a y [ ]   w i t h   g i v e n   t i m e s   ( c o u n t ) .                                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s   t o   r e p l i c a t e                                           |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   i n   t h e   s e q u e n c e                                   |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s e q u e n c e   v a l u e s                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R e p l i c a t e ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   c o u n t , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   r e p l i c a t e   c o u n t  
       i f ( c o u n t < = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r e p a r e   o u t p u t   a r r a y  
       i n t   t a r g e t _ s i z e = s i z e * c o u n t ;  
       i f ( A r r a y S i z e ( r e s u l t ) < t a r g e t _ s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , t a r g e t _ s i z e ) ! = t a r g e t _ s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
 / / - - -   r e p l i c a t e   a r r a y   e l e m e n t s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             A r r a y C o p y ( r e s u l t , a r r a y , i * s i z e , 0 , W H O L E _ A R R A Y ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R e p l i c a t e                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   r e p l i c a t e s   t h e   s e q u e n c e   o f   i n t e g e r   n u m b e r s                     |  
 / / |   f r o m   a r r a y [ ]   w i t h   g i v e n   t i m e s   ( c o u n t ) .                                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s   t o   r e p l i c a t e                                             |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   i n   t h e   s e q u e n c e                                   |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s e q u e n c e   v a l u e s                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R e p l i c a t e ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   c o u n t , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   r e p l i c a t e   c o u n t  
       i f ( c o u n t < = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r e p a r e   o u t p u t   a r r a y  
       i n t   t a r g e t _ s i z e = s i z e * c o u n t ;  
       i f ( A r r a y S i z e ( r e s u l t ) < t a r g e t _ s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , t a r g e t _ s i z e ) ! = t a r g e t _ s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
 / / - - -   r e p l i c a t e   a r r a y   e l e m e n t s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             A r r a y C o p y ( r e s u l t , a r r a y , i * s i z e , 0 , W H O L E _ A R R A Y ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R e v e r s e                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   r e v e r s e s   o r d e r   o f   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   r e v e r s e d   e l e m e n t s                                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R e v e r s e ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   e l e m e n t s   o f   t h e   r e v e r s e d   a r r a y  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i n t   i d x = s i z e - 1 - i ;  
             r e s u l t [ i d x ] = a r r a y [ i ] ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R e v e r s e                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   r e v e r s e s   o r d e r   o f   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   r e v e r s e d   e l e m e n t s                                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R e v e r s e ( c o n s t   i n t   & a r r a y [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   e l e m e n t s   o f   t h e   r e v e r s e d   a r r a y  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i n t   i d x = s i z e - 1 - i ;  
             r e s u l t [ i d x ] = a r r a y [ i ] ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R e v e r s e                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   r e v e r s e s   o r d e r   o f   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R e v e r s e ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       i n t   c o u n t = s i z e / 2 ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             i n t   i d x = s i z e - 1 - i ;  
             / / - - -   s w a p   a r r a y [ i ]   a n d   a r r a y [ s i z e - 1 - i ] ;  
             d o u b l e   t = a r r a y [ i ] ;  
             a r r a y [ i ] = a r r a y [ i d x ] ;  
             a r r a y [ i d x ] = t ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R e v e r s e                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   r e v e r s e s   o r d e r   o f   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R e v e r s e ( i n t   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       i n t   c o u n t = s i z e / 2 ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             i n t   i d x = s i z e - 1 - i ;  
             / / - - -   s w a p   a r r a y [ i ]   a n d   a r r a y [ s i z e - 1 - i ] ;  
             i n t   t = a r r a y [ i ] ;  
             a r r a y [ i ] = a r r a y [ i d x ] ;  
             a r r a y [ i d x ] = t ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h I d e n t i c a l                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c o m p a r e s   t w o   a r r a y s .                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y                                                                                 |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   t h e   a r r a y s   a r e   e q u a l ,   o t h e r w i s e   f a l s e .           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h I d e n t i c a l ( c o n s t   d o u b l e   & a r r a y 1 [ ] , c o n s t   d o u b l e   & a r r a y 2 [ ] )  
     {  
       i n t   s i z e 1 = A r r a y S i z e ( a r r a y 1 ) ;  
       i n t   s i z e 2 = A r r a y S i z e ( a r r a y 1 ) ;  
 / / - - -   c h e c k   s i z e   o f   t h e   a r r a y s  
       i f ( s i z e 1 ! = s i z e 2 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   e m p t y   a r r a y   c a s e  
       i f ( s i z e 1 = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   a l l   a r r a y   e l e m e n t s  
       f o r ( i n t   i = 0 ;   i < s i z e 1 ;   i + + )  
           {  
             i f ( a r r a y 1 [ i ] ! = a r r a y 2 [ i ] )  
                   r e t u r n ( f a l s e ) ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h I d e n t i c a l                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c o m p a r e s   t w o   a r r a y s .                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y                                                                                 |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   t h e   a r r a y s   a r e   e q u a l ,   o t h e r w i s e   f a l s e .           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h I d e n t i c a l ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] )  
     {  
       i n t   s i z e 1 = A r r a y S i z e ( a r r a y 1 ) ;  
       i n t   s i z e 2 = A r r a y S i z e ( a r r a y 1 ) ;  
 / / - - -   c h e c k   s i z e   o f   t h e   a r r a y s  
       i f ( s i z e 1 ! = s i z e 2 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   e m p t y   a r r a y   c a s e  
       i f ( s i z e 1 = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   a l l   a r r a y   e l e m e n t s  
       f o r ( i n t   i = 0 ;   i < s i z e 1 ;   i + + )  
           {  
             i f ( a r r a y 1 [ i ] ! = a r r a y 2 [ i ] )  
                   r e t u r n ( f a l s e ) ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h U n i q u e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   e x t r a c t s   t h e   u n i q u e   v a l u e s   f r o m   t h e   a r r a y .                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   u n i q u e   v a l u e s                                                         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h U n i q u e ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
 / / - - -   c h e c k   a r r a y   s i z e  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r e p a r e   a d d i t i o n a l   a r r a y  
       b o o l   c h e c k e d [ ] ;  
       i f ( A r r a y R e s i z e ( c h e c k e d , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       A r r a y F i l l ( c h e c k e d , 0 , s i z e , f a l s e ) ;  
  
 / / - - -   p r e p a r e   r e s u l t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   f i n d   u n i q u e   e l e m e n t s  
       i n t   u n i q u e _ c o u n t = 0 ;  
       d o u b l e   v a l u e = 0 ;  
       f o r ( ; ; )  
           {  
             b o o l   f l a g = f a l s e ;  
             f o r ( i n t   i = u n i q u e _ c o u n t ;   i < s i z e ;   i + + )  
                 {  
                   i f ( ! f l a g   & &   ! c h e c k e d [ i ] )  
                       {  
                         v a l u e = a r r a y [ i ] ;  
                         r e s u l t [ u n i q u e _ c o u n t ] = a r r a y [ i ] ;  
                         u n i q u e _ c o u n t + + ;  
                         c h e c k e d [ i ] = t r u e ;  
                         f l a g = t r u e ;  
                       }  
                   e l s e  
                         i f ( f l a g   & &   v a l u e = = a r r a y [ i ] )  
                               c h e c k e d [ i ] = t r u e ;  
                 }  
             i f ( ! f l a g )  
                   b r e a k ;  
           }  
 / / - - -   r e s i z e   t a r g e t   a r r a y  
       A r r a y R e s i z e ( r e s u l t , u n i q u e _ c o u n t ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h U n i q u e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   e x t r a c t s   t h e   u n i q u e   v a l u e s   f r o m   t h e   a r r a y .                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   u n i q u e   v a l u e s                                                         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h U n i q u e ( c o n s t   i n t   & a r r a y [ ] , i n t   & r e s u l t [ ] )  
     {  
 / / - - -   c h e c k   a r r a y   s i z e  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r e p a r e   a d d i t i o n a l   a r r a y  
       b o o l   c h e c k e d [ ] ;  
       i f ( A r r a y R e s i z e ( c h e c k e d , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       A r r a y F i l l ( c h e c k e d , 0 , s i z e , f a l s e ) ;  
  
 / / - - -   p r e p a r e   r e s u l t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   f i n d   u n i q u e   e l e m e n t s  
       i n t   u n i q u e _ c o u n t = 0 ;  
       i n t   v a l u e = 0 ;  
       f o r ( ; ; )  
           {  
             b o o l   f l a g = f a l s e ;  
             f o r ( i n t   i = u n i q u e _ c o u n t ;   i < s i z e ;   i + + )  
                 {  
                   i f ( ! f l a g   & &   ! c h e c k e d [ i ] )  
                       {  
                         v a l u e = a r r a y [ i ] ;  
                         r e s u l t [ u n i q u e _ c o u n t ] = a r r a y [ i ] ;  
                         u n i q u e _ c o u n t + + ;  
                         c h e c k e d [ i ] = t r u e ;  
                         f l a g = t r u e ;  
                       }  
                   e l s e  
                         i f ( f l a g   & &   v a l u e = = a r r a y [ i ] )  
                               c h e c k e d [ i ] = t r u e ;  
                 }  
             i f ( ! f l a g )  
                   b r e a k ;  
           }  
 / / - - -   r e s i z e   t a r g e t   a r r a y  
       A r r a y R e s i z e ( r e s u l t , u n i q u e _ c o u n t ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h Q u i c k S o r t A s c e n d i n g                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   s o r t s   a r r a y [ ]   a n d   i n d i c e s [ ]   s i m u l t a n e o u s l y                     |  
 / / |   u s i n g   Q u i c k S o r t   a l g o r i t h m .   A f t e r   s o r t i n g   t h e   i n i t i a l   o r d e r i n g         |  
 / / |   o f   t h e   e l e m e n t s   i s   l o c a t e d   i n   t h e   i n d i c e s [ ]   a r r a y .                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y               :   A r r a y   w i t h   v a l u e s   t o   s o r t                                                     |  
 / / |   i n d i c e s           :   T a r g e   a r r a y   t o   s o r t                                                                 |  
 / / |   f i r s t               :   F i r s t   e l e m e n t   i n d e x                                                                 |  
 / / |   l a s t                 :   L a s t   e l e m e n t   i n d e x                                                                   |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   N o n e                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   M a t h Q u i c k S o r t A s c e n d i n g ( d o u b l e   & a r r a y [ ] , i n t   & i n d i c e s [ ] , i n t   f i r s t , i n t   l a s t )  
     {  
       i n t         i , j , t _ i n t ;  
       d o u b l e   p _ d o u b l e , t _ d o u b l e ;  
 / / - - -   c h e c k  
       i f ( f i r s t < 0   | |   l a s t < 0 )  
             r e t u r n ;  
 / / - - -   s o r t  
       i = f i r s t ;  
       j = l a s t ;  
       w h i l e ( i < l a s t )  
           {  
             / / - - -   " > > 1 "   i s   q u i c k   d i v i s i o n   b y   2  
             p _ d o u b l e = a r r a y [ ( f i r s t + l a s t ) > > 1 ] ;  
             w h i l e ( i < j )  
                 {  
                   w h i l e ( a r r a y [ i ] < p _ d o u b l e )  
                       {  
                         / / - - -   c o n t r o l   t h e   o u t p u t   o f   t h e   a r r a y   b o u n d s  
                         i f ( i = = A r r a y S i z e ( a r r a y ) - 1 )  
                               b r e a k ;  
                         i + + ;  
                       }  
                   w h i l e ( a r r a y [ j ] > p _ d o u b l e )  
                       {  
                         / / - - -   c o n t r o l   t h e   o u t p u t   o f   t h e   a r r a y   b o u n d s  
                         i f ( j = = 0 )  
                               b r e a k ;  
                         j - - ;  
                       }  
                   i f ( i < = j )  
                       {  
                         / / - -   s w a p   e l e m e n t s   i   a n d   j  
                         t _ d o u b l e = a r r a y [ i ] ;  
                         a r r a y [ i ] = a r r a y [ j ] ;  
                         a r r a y [ j ] = t _ d o u b l e ;  
                         / / - -   s w a p   i n d i c e s   i   a n d   j  
                         t _ i n t = i n d i c e s [ i ] ;  
                         i n d i c e s [ i ] = i n d i c e s [ j ] ;  
                         i n d i c e s [ j ] = t _ i n t ;  
                         i + + ;  
                         / / - - -   c o n t r o l   t h e   o u t p u t   o f   t h e   a r r a y   b o u n d s  
                         i f ( j = = 0 )  
                               b r e a k ;  
                         j - - ;  
                       }  
                 }  
             i f ( f i r s t < j )  
                   M a t h Q u i c k S o r t A s c e n d i n g ( a r r a y , i n d i c e s , f i r s t , j ) ;  
             f i r s t = i ;  
             j = l a s t ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h Q u i c k S o r t D e s c e n d i n g                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   s o r t s   a r r a y [ ]   a n d   i n d i c e s [ ]   s i m u l t a n e o u s l y                     |  
 / / |   u s i n g   Q u i c k S o r t   a l g o r i t h m .   A f t e r   s o r t i n g   t h e   i n i t i a l   o r d e r i n g         |  
 / / |   o f   t h e   e l e m e n t s   i s   l o c a t e d   i n   t h e   i n d i c e s [ ]   a r r a y .                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y               :   A r r a y   w i t h   v a l u e s   t o   s o r t                                                     |  
 / / |   i n d i c e s           :   T a r g e   a r r a y   t o   s o r t                                                                 |  
 / / |   f i r s t               :   F i r s t   e l e m e n t   i n d e x                                                                 |  
 / / |   l a s t                 :   L a s t   e l e m e n t   i n d e x                                                                   |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   N o n e                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   M a t h Q u i c k S o r t D e s c e n d i n g ( d o u b l e   & a r r a y [ ] , i n t   & i n d i c e s [ ] , i n t   f i r s t , i n t   l a s t )  
     {  
       i n t         i , j , t _ i n t ;  
       d o u b l e   p _ d o u b l e , t _ d o u b l e ;  
 / / - - -   c h e c k  
       i f ( f i r s t < 0   | |   l a s t < 0 )  
             r e t u r n ;  
 / / - - -   s o r t  
       i = f i r s t ;  
       j = l a s t ;  
       w h i l e ( i < l a s t )  
           {  
             / / - - -   " > > 1 "   i s   q u i c k   d i v i s i o n   b y   2  
             p _ d o u b l e = a r r a y [ ( f i r s t + l a s t ) > > 1 ] ;  
             w h i l e ( i < j )  
                 {  
                   w h i l e ( a r r a y [ i ] > p _ d o u b l e )  
                       {  
                         / / - - -   c o n t r o l   t h e   o u t p u t   o f   t h e   a r r a y   b o u n d s  
                         i f ( i = = A r r a y S i z e ( a r r a y ) - 1 )  
                               b r e a k ;  
                         i + + ;  
                       }  
                   w h i l e ( a r r a y [ j ] < p _ d o u b l e )  
                       {  
                         / / - - -   c o n t r o l   t h e   o u t p u t   o f   t h e   a r r a y   b o u n d s  
                         i f ( j = = 0 )  
                               b r e a k ;  
                         j - - ;  
                       }  
                   i f ( i < = j )  
                       {  
                         / / - -   s w a p   e l e m e n t s   i   a n d   j  
                         t _ d o u b l e = a r r a y [ i ] ;  
                         a r r a y [ i ] = a r r a y [ j ] ;  
                         a r r a y [ j ] = t _ d o u b l e ;  
                         / / - -   s w a p   i n d i c e s   i   a n d   j  
                         t _ i n t = i n d i c e s [ i ] ;  
                         i n d i c e s [ i ] = i n d i c e s [ j ] ;  
                         i n d i c e s [ j ] = t _ i n t ;  
                         i + + ;  
                         / / - - -   c o n t r o l   t h e   o u t p u t   o f   t h e   a r r a y   b o u n d s  
                         i f ( j = = 0 )  
                               b r e a k ;  
                         j - - ;  
                       }  
                 }  
             i f ( f i r s t < j )  
                   M a t h Q u i c k S o r t D e s c e n d i n g ( a r r a y , i n d i c e s , f i r s t , j ) ;  
             f i r s t = i ;  
             j = l a s t ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h Q u i c k S o r t                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   s o r t s   a r r a y [ ]   a n d   i n d i c e s [ ]   s i m u l t a n e o u s l y                     |  
 / / |   u s i n g   Q u i c k S o r t   a l g o r i t h m .   A f t e r   s o r t i n g   t h e   i n i t i a l   o r d e r i n g         |  
 / / |   o f   t h e   e l e m e n t s   i s   l o c a t e d   i n   t h e   i n d i c e s [ ]   a r r a y .                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y               :   A r r a y   w i t h   v a l u e s   t o   s o r t                                                     |  
 / / |   i n d i c e s           :   T a r g e   a r r a y   t o   s o r t                                                                 |  
 / / |   f i r s t               :   F i r s t   e l e m e n t   i n d e x                                                                 |  
 / / |   l a s t                 :   L a s t   e l e m e n t   i n d e x                                                                   |  
 / / |   m o d e                 :   S o r t   d i r e c t i o n   ( > 0   a s c e n d i n g , o t h e r w i s e   d e s c e n d i n g )   |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   N o n e                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   M a t h Q u i c k S o r t ( d o u b l e   & a r r a y [ ] , i n t   & i n d i c e s [ ] , i n t   f i r s t , i n t   l a s t , i n t   m o d e )  
     {  
       i f ( m o d e > 0 )  
             M a t h Q u i c k S o r t A s c e n d i n g ( a r r a y , i n d i c e s , f i r s t , l a s t ) ;  
       e l s e  
             M a t h Q u i c k S o r t D e s c e n d i n g ( a r r a y , i n d i c e s , f i r s t , l a s t ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h O r d e r                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t h e   o r d e r   o f   e l e m e n t s   f r o m   t h e   a r r a y .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s o r t e d   i n d i c e s                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h O r d e r ( c o n s t   d o u b l e   & a r r a y [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t e m p o r a r y   a r r a y  
       d o u b l e   t m p _ a r r a y [ ] ;  
       A r r a y C o p y ( t m p _ a r r a y , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ;  
 / / - - -   p r e p a r e   i d e n t i c a l   p e r m u t a t i o n  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = i + 1 ;  
 / / - - -   c a l c u l a t e   o r d e r   o f   n u m b e r s  
       M a t h Q u i c k S o r t A s c e n d i n g ( t m p _ a r r a y , r e s u l t , 0 , s i z e - 1 ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h O r d e r                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t h e   o r d e r   o f   e l e m e n t s   f r o m   t h e   a r r a y .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s o r t e d   i n d i c e s                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h O r d e r ( c o n s t   i n t   & a r r a y [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t e m p o r a r y   a r r a y  
       d o u b l e   t m p _ a r r a y [ ] ;  
       i f ( A r r a y R e s i z e ( t m p _ a r r a y , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             t m p _ a r r a y [ i ] = a r r a y [ i ] ;  
 / / - - -   p r e p a r e   i d e n t i c a l   p e r m u t a t i o n  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = i + 1 ;  
 / / - - -   c a l c u l a t e   o r d e r   o f   n u m b e r s  
       M a t h Q u i c k S o r t A s c e n d i n g ( t m p _ a r r a y , r e s u l t , 0 , s i z e - 1 ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e N o t                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   N O T   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s               |  
 / / |   o f   t h e   a r r a y [ ] .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e N o t ( c o n s t   i n t   & a r r a y [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   ~ a r r a y [ i ]  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = ~ a r r a y [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e N o t                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   N O T   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s               |  
 / / |   o f   t h e   a r r a y [ ] .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e N o t ( i n t   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   ~ a r r a y [ i ]  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = ~ a r r a y [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e A n d                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A N D   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s               |  
 / / |   o f   t h e   a r r a y 1 [ ]   a n d   a r r a y 2 [ ] .                                                                         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   v a l u e s                                                         |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   v a l u e s                                                       |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e A n d ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e 1 = A r r a y S i z e ( a r r a y 1 ) ;  
       i n t   s i z e 2 = A r r a y S i z e ( a r r a y 2 ) ;  
       i f ( s i z e 1 = = 0   | |   s i z e 2 = = 0   | |   s i z e 1 ! = s i z e 2 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   a r r a y 1 & a r r a y 2  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e 1 )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e 1 ) ! = s i z e 1 )  
                   r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e 1 ;   i + + )  
             r e s u l t [ i ] = a r r a y 1 [ i ] & a r r a y 2 [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e O r                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   O R   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s                 |  
 / / |   o f   t h e   a r r a y 1 [ ]   a n d   a r r a y 2 [ ] .                                                                         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   v a l u e s                                                         |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   v a l u e s                                                       |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e O r ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e 1 = A r r a y S i z e ( a r r a y 1 ) ;  
       i n t   s i z e 2 = A r r a y S i z e ( a r r a y 2 ) ;  
       i f ( s i z e 1 = = 0   | |   s i z e 2 = = 0   | |   s i z e 1 ! = s i z e 2 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   a r r a y 1 | a r r a y 2  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e 1 )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e 1 ) ! = s i z e 1 )  
                   r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e 1 ;   i + + )  
             r e s u l t [ i ] = a r r a y 1 [ i ] | a r r a y 2 [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e X o r                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   X O R   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s               |  
 / / |   o f   t h e   a r r a y 1 [ ]   a n d   a r r a y 2 [ ] .                                                                         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   v a l u e s                                                         |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   v a l u e s                                                       |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e X o r ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e 1 = A r r a y S i z e ( a r r a y 1 ) ;  
       i n t   s i z e 2 = A r r a y S i z e ( a r r a y 2 ) ;  
       i f ( s i z e 1 = = 0   | |   s i z e 2 = = 0   | |   s i z e 1 ! = s i z e 2 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   a r r a y 1 ^ a r r a y 2  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e 1 )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e 1 ) ! = s i z e 1 )  
                   r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e 1 ;   i + + )  
             r e s u l t [ i ] = a r r a y 1 [ i ] ^ a r r a y 2 [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e S h i f t L                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   < <   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s                 |  
 / / |   o f   t h e   a r r a y [ ] .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   n                       :   N u m b e r   o f   b i t s   t o   s h i f t                                                         |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s o r t e d   i n d i c e s                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e S h i f t L ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   n , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   a r r a y < < n  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = a r r a y [ i ] < < n ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e S h i f t L                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   < <   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s                 |  
 / / |   o f   t h e   a r r a y [ ] .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   n                       :   N u m b e r   o f   b i t s   t o   s h i f t                                                         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e S h i f t L ( i n t   & a r r a y [ ] , c o n s t   i n t   n )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   a r r a y < < n  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = a r r a y [ i ] < < n ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e S h i f t R                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   > >   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s                 |  
 / / |   o f   t h e   a r r a y [ ] .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   n                       :   N u m b e r   o f   b i t s   t o   s h i f t                                                         |  
 / / |   r e s u l t [ ]         :   A r r a y   f o r   s o r t e d   i n d i c e s                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e S h i f t R ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   n , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   a r r a y > > n  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = a r r a y [ i ] > > n ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h B i t w i s e S h i f t R                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   > >   l o g i c a l   o p e r a t i o n   f o r   e l e m e n t s                 |  
 / / |   o f   t h e   a r r a y [ ] .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   n                       :   N u m b e r   o f   b i t s   t o   s h i f t                                                         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h B i t w i s e S h i f t R ( i n t   & a r r a y [ ] , c o n s t   i n t   n )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   a r r a y > > n  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = a r r a y [ i ] > > n ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e S u m                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   s u m   o f   t h e   e l e m e n t s                       |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c u m u l a t i v e   s u m                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e S u m ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   c u m u l a t i v e   s u m  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
       d o u b l e   s u m = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             / / - - -   c h e c k   v a l u e  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
             s u m + = a r r a y [ i ] ;  
             r e s u l t [ i ] = s u m ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e S u m                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   s u m   o f   t h e   e l e m e n t s                       |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e S u m ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   c u m u l a t i v e   s u m  
       d o u b l e   s u m = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
             s u m + = a r r a y [ i ] ;  
             a r r a y [ i ] = s u m ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e P r o d u c t                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   p r o d u c t   o f   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c u m u l a t i v e   p r o d u c t                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e P r o d u c t ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   c u m u l a t i v e   p r o d u c t  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
       d o u b l e   p r o d u c t = 1 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
             p r o d u c t * = a r r a y [ i ] ;  
             r e s u l t [ i ] = p r o d u c t ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e P r o d u c t                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   p r o d u c t   o f   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e P r o d u c t ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   c u m u l a t i v e   p r o d u c t  
       d o u b l e   p r o d u c t = 1 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             / / - - -   c h e c k   v a l u e  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
             p r o d u c t * = a r r a y [ i ] ;  
             a r r a y [ i ] = p r o d u c t ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e M i n                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   m i n i m u m   o f   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c u m u l a t i v e   p r o d u c t                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e M i n ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   c u m u l a t i v e   m i n  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
       d o u b l e   m i n = Q P O S I N F ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] )   | |   ! M a t h I s V a l i d N u m b e r ( m i n ) )  
                   m i n + = a r r a y [ i ] ;  
             e l s e  
                   m i n = M a t h M i n ( m i n , a r r a y [ i ] ) ;  
             r e s u l t [ i ] = m i n ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e M i n                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   m i n i m u m   o f   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e M i n ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
       d o u b l e   m i n = Q P O S I N F ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] )   | |   ! M a t h I s V a l i d N u m b e r ( m i n ) )  
                   m i n + = a r r a y [ i ] ;  
             e l s e  
                   m i n = M a t h M i n ( m i n , a r r a y [ i ] ) ;  
             a r r a y [ i ] = m i n ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e M a x                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   m a x i m u m   o f   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c u m u l a t i v e   p r o d u c t                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e M a x ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   c u m u l a t i v e   m a x  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
  
       d o u b l e   m a x = Q N E G I N F ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] )   | |   ! M a t h I s V a l i d N u m b e r ( m a x ) )  
                   m a x + = a r r a y [ i ] ;  
             e l s e  
                   m a x = M a t h M a x ( m a x , a r r a y [ i ] ) ;  
             r e s u l t [ i ] = m a x ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e M a x                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c u m u l a t i v e   m a x i m u m   o f   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e M a x ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
       d o u b l e   m a x = Q N E G I N F ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] )   | |   ! M a t h I s V a l i d N u m b e r ( m a x ) )  
                   m a x + = a r r a y [ i ] ;  
             e l s e  
                   m a x = M a t h M a x ( m a x , a r r a y [ i ] ) ;  
             a r r a y [ i ] = m a x ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i n                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   s i n ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i n ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h S i n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i n                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   s i n ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i n ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h S i n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o s                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c o s ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o s ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h C o s ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o s                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c o s ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o s ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h C o s ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T a n                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t a n ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T a n ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h T a n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T a n                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t a n ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T a n ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h T a n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c s i n                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A r c s i n ( x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c s i n ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c s i n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c s i n                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A r c s i n ( x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c s i n ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A r c s i n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c c o s                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A r c c o s ( x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c c o s ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c c o s ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c c o s                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A r c c o s ( x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c c o s ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A r c c o s ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c t a n                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A r c t a n ( x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c t a n ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c t a n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c t a n                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   A r c t a n ( x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c t a n ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A r c t a n ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i n P i                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   s i n ( p i * x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i n P i ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h S i n ( M _ P I * a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i n P i                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   s i n ( p i * x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i n P i ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h S i n ( M _ P I * a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o s P i                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c o s ( p i * x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o s P i ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h C o s ( M _ P I * a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o s P i                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   c o s ( p i * x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o s P i ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h C o s ( M _ P I * a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T a n P i                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t a n ( p i * x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T a n P i ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h T a n ( M _ P I * a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T a n P i                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t a n ( p i * x )   f o r   t h e   e l e m e n t s                               |  
 / / |   f r o m   t h e   a r r a y .                                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T a n P i ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h T a n ( M _ P I * a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A b s                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   a b s ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y .     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A b s ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A b s ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A b s                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   a b s ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y .     |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A b s ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A b s ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C e i l                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n t e g e r   n u m b e r i c   v a l u e s   c l o s e s t   f r o m           |  
 / / |   a b o v e   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C e i l ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   C e i l ( a r r a y [ i ] )  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h C e i l ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C e i l                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n t e g e r   n u m b e r i c   v a l u e s   c l o s e s t   f r o m           |  
 / / |   a b o v e   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C e i l ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h C e i l ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h F l o o r                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n t e g e r   n u m b e r i c   v a l u e s   c l o s e s t   f r o m           |  
 / / |   b e l o w   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h F l o o r ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   F l o o r ( a r r a y [ i ] )  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h F l o o r ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h F l o o r                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n t e g e r   n u m b e r i c   v a l u e s   c l o s e s t   f r o m           |  
 / / |   b e l o w   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h F l o o r ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h F l o o r ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T r u n c                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t r u n c ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T r u n c ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   T r u n c ( a r r a y [ i ] )  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( a r r a y [ i ] > = 0 )  
                   r e s u l t [ i ] = M a t h F l o o r ( a r r a y [ i ] ) ;  
             e l s e  
                   r e s u l t [ i ] = M a t h C e i l ( a r r a y [ i ] ) ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T r u n c                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t r u n c ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T r u n c ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( a r r a y [ i ] > = 0 )  
                   a r r a y [ i ] = M a t h F l o o r ( a r r a y [ i ] ) ;  
             e l s e  
                   a r r a y [ i ] = M a t h C e i l ( a r r a y [ i ] ) ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S q r t                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   s q r t ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y .   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S q r t ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h S q r t ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S q r t                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   s q r t ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y .   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S q r t ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h S q r t ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h E x p                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   e x p ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h E x p ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h E x p ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h E x p                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   e x p ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h E x p ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h E x p ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h P o w                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   P o w ( x , p o w e r )   f o r   t h e   e l e m e n t s                         |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h P o w ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   d o u b l e   p o w e r , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   N A N  
       i f ( ! M a t h I s V a l i d N u m b e r ( p o w e r ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h P o w ( a r r a y [ i ] , p o w e r ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h P o w                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   P o w ( x , p o w e r )   f o r   t h e   e l e m e n t s                         |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h P o w ( d o u b l e   & a r r a y [ ] , c o n s t   d o u b l e   p o w e r )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   N A N  
       i f ( ! M a t h I s V a l i d N u m b e r ( p o w e r ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h P o w ( a r r a y [ i ] , p o w e r ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h L o g ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g ( x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h L o g ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g a r i t h m   w i t h   t h e   s p e c i f i e d   b a s e                 |  
 / / |   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   d o u b l e   b a s e , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   N A N  
       i f ( ! M a t h I s V a l i d N u m b e r ( b a s e ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   b a s e  
       i f ( b a s e = = 1 . 0   | |   b a s e < = 0 . 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       d o u b l e   f a c t o r = 1 . 0 / M a t h L o g ( b a s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h L o g ( a r r a y [ i ] ) * f a c t o r ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g a r i t h m   w i t h   t h e   s p e c i f i e d   b a s e                 |  
 / / |   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g ( d o u b l e   & a r r a y [ ] , c o n s t   d o u b l e   b a s e )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   N A N  
       i f ( ! M a t h I s V a l i d N u m b e r ( b a s e ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   b a s e  
       i f ( b a s e = = 1 . 0   | |   b a s e < = 0 . 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       d o u b l e   f a c t o r = 1 . 0 / M a t h L o g ( b a s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h L o g ( a r r a y [ i ] ) * f a c t o r ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g 2                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g a r i t h m s   o n   b a s e   2   f o r   t h e   e l e m e n t s         |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g 2 ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       s t a t i c   c o n s t   d o u b l e   f a c t o r = 1 . 0 / M _ L N 2 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h L o g ( a r r a y [ i ] ) * f a c t o r ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g 2                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g a r i t h m s   o n   b a s e   2   f o r   t h e   e l e m e n t s         |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g 2 ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       s t a t i c   c o n s t   d o u b l e   f a c t o r = 1 . 0 / M _ L N 2 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h L o g ( a r r a y [ i ] ) * f a c t o r ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g 1 0                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g a r i t h m   o n   b a s e   1 0   f o r   t h e   e l e m e n t s         |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g 1 0 ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h L o g 1 0 ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g 1 0                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g a r i t h m   o n   b a s e   1 0   f o r   t h e   e l e m e n t s         |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g 1 0 ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h L o g 1 0 ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c t a n 2                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   p o l a r   a n g l e s   o f   v e c t o r   ( x [ i ] , y [ i ] )               |  
 / / |   i n   r a n g e   [ - p i ,   p i ]   f o r   t h e   e l e m e n t s   f r o m   t h e   x [ ]   a n d   y [ ]   a r r a y s .   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   x [ ]                   :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   y [ ]                   :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c t a n 2 ( c o n s t   d o u b l e   & y [ ] , c o n s t   d o u b l e   & x [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( x ) ;  
       i f ( s i z e = = 0   | |   A r r a y S i z e ( y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c t a n 2 ( y [ i ] , x [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R o u n d                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   r o u n d e d   v a l u e s   t o   a   g i v e n   p r e c i s i o n             |  
 / / |   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   d i g i t s             :   P r e c i s i o n                                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   r o u n d e d   v a l u e s                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R o u n d ( c o n s t   d o u b l e   & a r r a y [ ] , i n t   d i g i t s , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       i f ( d i g i t s < 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h R o u n d ( a r r a y [ i ] , d i g i t s ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R o u n d                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   r o u n d e d   v a l u e s   t o   a   g i v e n   p r e c i s i o n             |  
 / / |   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                               |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   d i g i t s             :   P r e c i s i o n                                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R o u n d ( d o u b l e   & a r r a y [ ] , i n t   d i g i t s )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
       i f ( d i g i t s < 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h R o u n d ( a r r a y [ i ] , d i g i t s ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h D i f f e r e n c e                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l a g g g e d   d i f f e r e n c e s   o f   t h e   e l e m e n t s             |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   l a g                   :   L a g   v a l u e                                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   d i f f e r e n c e s                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h D i f f e r e n c e ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   l a g , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) - l a g ;  
       i f ( l a g < 1   | |   s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = a r r a y [ i + l a g ] - a r r a y [ i ] ;  
 / / - - -   c h a n g e   a r r a y   s i z e   f o r   c a l l   w i t h   d i f f e r e n c e s  
       i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h D i f f e r e n c e                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l a g g g e d   d i f f e r e n c e s   o f   t h e   e l e m e n t s             |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   i n t e g e r   v a l u e s                                                     |  
 / / |   l a g                   :   L a g   v a l u e                                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   d i f f e r e n c e s                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h D i f f e r e n c e ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   l a g , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) - l a g ;  
       i f ( l a g < 1   | |   s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = a r r a y [ i + l a g ] - a r r a y [ i ] ;  
 / / - - -   c h a n g e   a r r a y   s i z e   f o r   c a l l   w i t h   d i f f e r e n c e s  
       i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h D i f f e r e n c e                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l a g g g e d   a n d   i t e r a t e d   d i f f e r e n c e s                   |  
 / / |   o f   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   l a g                   :   L a g   v a l u e                                                                                     |  
 / / |   d i f f e r e n c e s   :   N u m b e r   o f   i t e r a t i o n s                                                               |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   d i f f e r e n c e s                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h D i f f e r e n c e ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   l a g , c o n s t   i n t   d i f f e r e n c e s , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   p a r a m e t e r s  
       i f ( s i z e = = 0   | |   d i f f e r e n c e s < 0   | |   l a g * d i f f e r e n c e s > = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c o p y   d a t a   f r o m   i n i t i a l   a r r a y  
       i f ( A r r a y C o p y ( r e s u l t , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   i t e r a t e d   d i f f e r e n c e s  
       f o r ( i n t   i = 0 ;   i < d i f f e r e n c e s ;   i + + )  
           {  
             i f ( ! M a t h D i f f e r e n c e ( r e s u l t , l a g , r e s u l t ) )  
                   r e t u r n   f a l s e ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h D i f f e r e n c e                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l a g g g e d   a n d   i t e r a t e d   d i f f e r e n c e s                   |  
 / / |   o f   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   i n t e g e r   v a l u e s                                                     |  
 / / |   l a g                   :   L a g   v a l u e                                                                                     |  
 / / |   d i f f e r e n c e s   :   N u m b e r   o f   i t e r a t i o n s                                                               |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   d i f f e r e n c e s                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h D i f f e r e n c e ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   l a g , c o n s t   i n t   d i f f e r e n c e s , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   p a r a m e t e r s  
       i f ( s i z e = = 0   | |   d i f f e r e n c e s < 0   | |   l a g * d i f f e r e n c e s > = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c o p y   d a t a   f r o m   i n i t i a l   a r r a y  
       i f ( A r r a y C o p y ( r e s u l t , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   i t e r a t e d   d i f f e r e n c e s  
       f o r ( i n t   i = 0 ;   i < d i f f e r e n c e s ;   i + + )  
           {  
             i f ( ! M a t h D i f f e r e n c e ( r e s u l t , l a g , r e s u l t ) )  
                   r e t u r n   f a l s e ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ] .                                                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                               |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   c o u n t , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n   f a l s e ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   v a l u e s  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             i n t   i n d = ( i n t ) ( ( u l o n g ) s i z e * M a t h R a n d ( ) / 3 2 7 6 8 ) ;  
             r e s u l t [ i ] = a r r a y [ i n d ] ;  
           }  
 / / - - -  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ] .                                                                                   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   i n t e g e r   v a l u e s                                                     |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                               |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   c o u n t , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0 )  
             r e t u r n   f a l s e ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   v a l u e s  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             i n t   i n d = ( i n t ) ( ( u l o n g ) s i z e * M a t h R a n d ( ) / 3 2 7 6 8 ) ;  
             r e s u l t [ i ] = a r r a y [ i n d ] ;  
           }  
 / / - - -  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ]   w i t h   r e p l a c e m e n t .                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                               |  
 / / |   r e p l a c e           :   I f   t r u e ,   S a m p l i n g   w i t h   R e p l a c e m e n t   w i l l   b e   u s e d         |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   c o u n t , c o n s t   b o o l   r e p l a c e , d o u b l e   & r e s u l t [ ] )  
     {  
 / / - - -   S a m p l i n g   w i t h   R e p l a c e m e n t  
       i f ( r e p l a c e )  
             r e t u r n   M a t h S a m p l e ( a r r a y , c o u n t , r e s u l t ) ;  
  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0   | |   c o u n t > s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   u n i q u e   v a l u e s   n e e d e d ,   p r e p a r e   i n d i c e s  
       i n t   i n d i c e s [ ] ;  
  
       i f ( ! M a t h S e q u e n c e B y C o u n t ( 0 , s i z e - 1 , s i z e , i n d i c e s ) )  
             r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             / / - - -   s e l e c t   r a n d o m   i n d e x   a n d   s w a p   i t e m s   [ j ]   a n d   [ i ]  
             i n t   j = i + i n t ( ( u l o n g ) ( s i z e - i ) * M a t h R a n d ( ) / 3 2 7 6 8 ) ;  
  
             i f ( j ! = i )  
                 {  
                   i n t   t = i n d i c e s [ i ] ;  
                   i n d i c e s [ i ] = i n d i c e s [ j ] ;  
                   i n d i c e s [ j ] = t ;  
                 }  
           }  
 / / - - -   s e l e c t   d a t a   a c c o r d i n g   t o   i n d i c e s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             r e s u l t [ i ] = a r r a y [ i n d i c e s [ i ] ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ]   w i t h   r e p l a c e m e n t .                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   i n t e g e r   v a l u e s                                                     |  
 / / |   c o u n t               :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                               |  
 / / |   r e p l a c e           :   I f   t r u e ,   S a m p l i n g   w i t h   R e p l a c e m e n t   w i l l   b e   u s e d         |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y                                                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   i n t   & a r r a y [ ] , c o n s t   i n t   c o u n t , c o n s t   b o o l   r e p l a c e , i n t   & r e s u l t [ ] )  
     {  
 / / - - -   S a m p l i n g   w i t h   R e p l a c e m e n t  
       i f ( r e p l a c e )  
             r e t u r n   M a t h S a m p l e ( a r r a y , c o u n t , r e s u l t ) ;  
  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0   | |   c o u n t > s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   u n i q u e   v a l u e s   n e e d e d ,   p r e p a r e   i n d i c e s  
       i n t   i n d i c e s [ ] ;  
  
       i f ( ! M a t h S e q u e n c e B y C o u n t ( 0 , s i z e - 1 , s i z e , i n d i c e s ) )  
             r e t u r n ( f a l s e ) ;  
  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             / / - - -   s e l e c t   r a n d o m   i n d e x   a n d   s w a p   i t e m s   [ j ]   a n d   [ i ]  
             i n t   j = i + i n t ( ( u l o n g ) ( s i z e - i ) * M a t h R a n d ( ) / 3 2 7 6 8 ) ;  
  
             i f ( j ! = i )  
                 {  
                   i n t   t = i n d i c e s [ i ] ;  
                   i n d i c e s [ i ] = i n d i c e s [ j ] ;  
                   i n d i c e s [ j ] = t ;  
                 }  
           }  
 / / - - -   s e l e c t   d a t a   a c c o r d i n g   t o   i n d i c e s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             r e s u l t [ i ] = a r r a y [ i n d i c e s [ i ] ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ]   a c c o r d i n g   t o   t h e   g i v e n   p r o b a b i l i t i e s .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]                   :   A r r a y   w i t h   d o u b l e   v a l u e s                                               |  
 / / |   p r o b a b i l i t i e s [ ]   :   A r r a y   w i t h   p r o b a b i l i t i e s                                               |  
 / / |   c o u n t                       :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                       |  
 / / |   r e s u l t [ ]                 :   O u t p u t   a r r a y                                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & p r o b a b i l i t i e s [ ] , c o n s t   i n t   c o u n t , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0   | |   s i z e ! = A r r a y S i z e ( p r o b a b i l i t i e s ) )  
             r e t u r n ( f a l s e ) ;  
  
       i f ( c o u n t < = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r o b a b i l i t i e s  
       d o u b l e   p r o b [ ] ;  
       i f ( A r r a y C o p y ( p r o b , p r o b a b i l i t i e s , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   s u m   a n d   n o r m a l i z e   p r o b a b i l i t i e s  
       d o u b l e   s u m = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             s u m + = p r o b [ i ] ;  
  
       i f ( s u m = = 0 . 0 )  
             r e t u r n ( f a l s e ) ;  
  
       s u m = 1 . 0 / s u m ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             p r o b [ i ] * = s u m ;  
 / / - - -   p r e p a r e   i n d i c e s  
       i n t   i n d i c e s [ ] ;  
       i f ( A r r a y R e s i z e ( i n d i c e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             i n d i c e s [ i ] = i ;  
 / / - - -   s o r t   a n d   p r e p a r e   c u m u l a t i v e   p r o b a b i l i t i e s  
       M a t h Q u i c k S o r t D e s c e n d i n g ( p r o b , i n d i c e s , 0 , s i z e - 1 ) ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
             p r o b [ i ] + = p r o b [ i - 1 ] ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   v a l u e s  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   r a n d o m   s a m p l e s   a c c o r d i n g   t o   g i v e n   p r o b a b i l i t i e s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             d o u b l e   p r b = M a t h R a n d ( ) / 3 2 7 6 7 . 0 ;  
             f o r ( i n t   k = 0 ;   k < s i z e ;   k + + )  
                 {  
                   i f ( p r b < = p r o b [ k ] )  
                       {  
                         r e s u l t [ i ] = a r r a y [ i n d i c e s [ k ] ] ;  
                         b r e a k ;  
                       }  
                 }  
           }  
 / / - - -  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ]   a c c o r d i n g   t o   t h e   g i v e n   p r o b a b i l i t i e s .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]                   :   A r r a y   w i t h   i n t e g e r   v a l u e s                                             |  
 / / |   p r o b a b i l i t i e s [ ]   :   A r r a y   w i t h   p r o b a b i l i t i e s                                               |  
 / / |   c o u n t                       :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                       |  
 / / |   r e s u l t [ ]                 :   O u t p u t   a r r a y                                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   i n t   & a r r a y [ ] , d o u b l e   & p r o b a b i l i t i e s [ ] , c o n s t   i n t   c o u n t , i n t   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0   | |   s i z e ! = A r r a y S i z e ( p r o b a b i l i t i e s ) )  
             r e t u r n ( f a l s e ) ;  
  
       i f ( c o u n t < = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r o b a b i l i t i e s  
       d o u b l e   p r o b [ ] ;  
       i f ( A r r a y C o p y ( p r o b , p r o b a b i l i t i e s , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   s u m   a n d   n o r m a l i z e   p r o b a b i l i t i e s  
       d o u b l e   s u m = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             s u m + = p r o b [ i ] ;  
  
       i f ( s u m = = 0 . 0 )  
             r e t u r n ( f a l s e ) ;  
  
       s u m = 1 . 0 / s u m ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             p r o b [ i ] * = s u m ;  
 / / - - -   p r e p a r e   i n d i c e s  
       i n t   i n d i c e s [ ] ;  
       i f ( A r r a y R e s i z e ( i n d i c e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             i n d i c e s [ i ] = i ;  
 / / - - -   s o r t   a n d   p r e p a r e   c u m u l a t i v e   p r o b a b i l i t i e s  
       M a t h Q u i c k S o r t D e s c e n d i n g ( p r o b , i n d i c e s , 0 , s i z e - 1 ) ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
             p r o b [ i ] + = p r o b [ i - 1 ] ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   v a l u e s  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   r a n d o m   s a m p l e s   a c c o r d i n g   t o   g i v e n   p r o b a b i l i t i e s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             d o u b l e   p r b = M a t h R a n d ( ) / 3 2 7 6 7 . 0 ;  
             f o r ( i n t   k = 0 ;   k < s i z e ;   k + + )  
                 {  
                   i f ( p r b < = p r o b [ k ] )  
                       {  
                         r e s u l t [ i ] = a r r a y [ i n d i c e s [ k ] ] ;  
                         b r e a k ;  
                       }  
                 }  
           }  
 / / - - -  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ]   a c c o r d i n g   t o   t h e   g i v e n   p r o b a b i l i t i e s .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]                   :   A r r a y   w i t h   d o u b l e   v a l u e s                                               |  
 / / |   p r o b a b i l i t i e s [ ]   :   A r r a y   w i t h   p r o b a b i l i t i e s                                               |  
 / / |   c o u n t                       :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                       |  
 / / |   r e p l a c e                   :   I f   t r u e ,   S a m p l i n g   w i t h   R e p l a c e m e n t   w i l l   b e   u s e d |  
 / / |   r e s u l t [ ]                 :   O u t p u t   a r r a y                                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & p r o b a b i l i t i e s [ ] , c o n s t   i n t   c o u n t , c o n s t   b o o l   r e p l a c e , d o u b l e   & r e s u l t [ ] )  
     {  
 / / - - -   S a m p l i n g   w i t h   R e p l a c e m e n t  
       i f ( r e p l a c e )  
             r e t u r n   M a t h S a m p l e ( a r r a y , p r o b a b i l i t i e s , c o u n t , r e s u l t ) ;  
  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0   | |   s i z e ! = A r r a y S i z e ( p r o b a b i l i t i e s ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   r e t u r n   f a l s e   i f   c o u n t > t o t a l   s a m p l e s  
       i f ( c o u n t < = 0   | |   c o u n t > s i z e )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r o b a b i l i t i e s  
       d o u b l e   p r o b [ ] ;  
       i f ( A r r a y C o p y ( p r o b , p r o b a b i l i t i e s , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   s u m   a n d   n o r m a l i z e   p r o b a b i l i t i e s  
       d o u b l e   s u m = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             s u m + = p r o b [ i ] ;  
  
       i f ( s u m = = 0 . 0 )  
             r e t u r n ( f a l s e ) ;  
  
       s u m = 1 . 0 / s u m ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             p r o b [ i ] * = s u m ;  
 / / - - -   p r e p a r e   i n d i c e s  
       i n t   i n d i c e s [ ] ;  
       i f ( A r r a y R e s i z e ( i n d i c e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             i n d i c e s [ i ] = i ;  
 / / - - -   s o r t   a n d   p r e p a r e   c u m u l a t i v e   p r o b a b i l i t i e s  
       M a t h Q u i c k S o r t D e s c e n d i n g ( p r o b , i n d i c e s , 0 , s i z e - 1 ) ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
             p r o b [ i ] + = p r o b [ i - 1 ] ;  
 / / - - -   p r e p a r e   a r r a y   f o r   t a k e n   v a l u e s   f l a g  
       b o o l   t a k e n _ v a l u e s [ ] ;  
       i f ( A r r a y R e s i z e ( t a k e n _ v a l u e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       A r r a y F i l l ( t a k e n _ v a l u e s , 0 , s i z e , f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   v a l u e s  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   r a n d o m   s a m p l e s   a c c o r d i n g   t o   g i v e n   p r o b a b i l i t i e s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             d o u b l e   p r b = M a t h R a n d ( ) / 3 2 7 6 7 . 0 ;  
             f o r ( i n t   k = 0 ;   k < s i z e ;   k + + )  
                 {  
                   i n t   i n d = i n d i c e s [ k ] ;  
                   / / - - -   c h e c k   a l s o   i f   t h e   v a l u e   h a s   b e e n   a l r e a d y   t a k e n  
                   i f ( p r b < = p r o b [ k ]   & &   t a k e n _ v a l u e s [ i n d ] = = f a l s e )  
                       {  
                         r e s u l t [ i ] = a r r a y [ i n d ] ;  
                         t a k e n _ v a l u e s [ i n d ] = t r u e ;  
                         b r e a k ;  
                       }  
                 }  
           }  
 / / - - -  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S a m p l e                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   t a k e s   a   s a m p l e   o f   t h e   s p e c i f i e d   s i z e   f r o m   t h e               |  
 / / |   e l e m e n t s   o f   t h e   a r r a y [ ]   a c c o r d i n g   t o   t h e   g i v e n   p r o b a b i l i t i e s .         |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]                   :   A r r a y   w i t h   i n t e g e r   v a l u e s                                             |  
 / / |   p r o b a b i l i t i e s [ ]   :   A r r a y   w i t h   p r o b a b i l i t i e s                                               |  
 / / |   c o u n t                       :   N u m b e r   o f   e l e m e n t s   t o   c h o o s e                                       |  
 / / |   r e p l a c e                   :   I f   t r u e ,   S a m p l i n g   w i t h   R e p l a c e m e n t   w i l l   b e   u s e d |  
 / / |   r e s u l t [ ]                 :   O u t p u t   a r r a y                                                                       |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S a m p l e ( c o n s t   i n t   & a r r a y [ ] , d o u b l e   & p r o b a b i l i t i e s [ ] , c o n s t   i n t   c o u n t , c o n s t   b o o l   r e p l a c e , i n t   & r e s u l t [ ] )  
     {  
 / / - - -   S a m p l i n g   w i t h   R e p l a c e m e n t  
       i f ( r e p l a c e )  
             r e t u r n   M a t h S a m p l e ( a r r a y , p r o b a b i l i t i e s , c o u n t , r e s u l t ) ;  
  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i f ( s i z e = = 0   | |   s i z e ! = A r r a y S i z e ( p r o b a b i l i t i e s ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   r e t u r n   f a l s e   i f   c o u n t > t o t a l   s a m p l e s  
       i f ( c o u n t < = 0   | |   c o u n t > s i z e )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   p r o b a b i l i t i e s  
       d o u b l e   p r o b [ ] ;  
       i f ( A r r a y C o p y ( p r o b , p r o b a b i l i t i e s , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   s u m   a n d   n o r m a l i z e   p r o b a b i l i t i e s  
       d o u b l e   s u m = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             s u m + = p r o b [ i ] ;  
  
       i f ( s u m = = 0 . 0 )  
             r e t u r n ( f a l s e ) ;  
  
       s u m = 1 . 0 / s u m ;  
  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             p r o b [ i ] * = s u m ;  
 / / - - -   p r e p a r e   i n d i c e s  
       i n t   i n d i c e s [ ] ;  
       i f ( A r r a y R e s i z e ( i n d i c e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             i n d i c e s [ i ] = i ;  
 / / - - -   s o r t   a n d   p r e p a r e   c u m u l a t i v e   p r o b a b i l i t i e s  
       M a t h Q u i c k S o r t D e s c e n d i n g ( p r o b , i n d i c e s , 0 , s i z e - 1 ) ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
             p r o b [ i ] + = p r o b [ i - 1 ] ;  
 / / - - -   p r e p a r e   a r r a y   f o r   t a k e n   v a l u e s   f l a g  
       b o o l   t a k e n _ v a l u e s [ ] ;  
       i f ( A r r a y R e s i z e ( t a k e n _ v a l u e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       A r r a y F i l l ( t a k e n _ v a l u e s , 0 , s i z e , f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y   a n d   c a l c u l a t e   v a l u e s  
       i f ( A r r a y S i z e ( r e s u l t ) < c o u n t )  
             i f ( A r r a y R e s i z e ( r e s u l t , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   r a n d o m   s a m p l e s   a c c o r d i n g   t o   g i v e n   p r o b a b i l i t i e s  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             d o u b l e   p r b = M a t h R a n d ( ) / 3 2 7 6 7 . 0 ;  
             f o r ( i n t   k = 0 ;   k < s i z e ;   k + + )  
                 {  
                   i n t   i n d = i n d i c e s [ k ] ;  
                   / / - - -   c h e c k   a l s o   i f   t h e   v a l u e   h a s   b e e n   a l r e a d y   t a k e n  
                   i f ( p r b < = p r o b [ k ]   & &   t a k e n _ v a l u e s [ i n d ] = = f a l s e )  
                       {  
                         r e s u l t [ i ] = a r r a y [ i n d ] ;  
                         t a k e n _ v a l u e s [ i n d ] = t r u e ;  
                         b r e a k ;  
                       }  
                 }  
           }  
 / / - - -  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T u k e y S u m m a r y                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   T u k e y ' s   f i v e   n u m b e r   s u m m a r y .                           |  
 / / |   I t   c o n s i s t s   o f   t h e   f i v e   m o s t   i m p o r t a n t   s a m p l e   p e r c e n t i l e s :               |  
 / / |   1 )   t h e   s a m p l e   m i n i m u m   ( s m a l l e s t   o b s e r v a t i o n )                                           |  
 / / |   2 )   t h e   l o w e r   q u a r t i l e   o r   f i r s t   q u a r t i l e   ( 0 . 2 5   q u a n t i l e )                     |  
 / / |   3 )   t h e   m e d i a n   ( m i d d l e   v a l u e )                                                                           |  
 / / |   4 )   t h e   u p p e r   q u a r t i l e   o r   t h i r d   q u a r t i l e   ( 0 . 7 5   q u a n t i l e )                     |  
 / / |   5 )   t h e   s a m p l e   m a x i m u m   ( l a r g e s t   o b s e r v a t i o n )                                             |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]                   :   A r r a y   w i t h   d o u b l e   v a l u e s                                               |  
 / / |   r e m o v e N A N               :   F l a g ,   i f   t r u e ,   a l l   N a N   v a l u e s   w i l l   b e   r e m o v e d     |  
 / / |   m i n i m u m                   :   O u t p u t   v a r i a b l e   f o r   m i n i m u m   v a l u e                             |  
 / / |   l o w e r _ h i n g e           :   O u t p u t   v a r i a b l e   f o r   0 . 2 5   q u a n t i l e                             |  
 / / |   m e d i a n                     :   O u t p u t   v a r i a b l e   f o r   m e d i a n   v a l u e                               |  
 / / |   u p p e r _ h i n g e           :   O u t p u t   v a r i a b l e   f o r   0 . 7 5   q u a n t i l e                             |  
 / / |   m a x i m u m                   :   O u t p u t   v a r i a b l e   f o r   m a x i m u m   v a l u e                             |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T u k e y S u m m a r y ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   b o o l   r e m o v e N A N , d o u b l e   & m i n i m u m , d o u b l e   & l o w e r _ h i n g e , d o u b l e   & m e d i a n , d o u b l e   & u p p e r _ h i n g e , d o u b l e   & m a x i m u m )  
     {  
 / / - - -   s e t   d e f a u l t   v a l u e s  
       m i n i m u m = Q N a N ;  
       l o w e r _ h i n g e = Q N a N ;  
       m e d i a n = Q N a N ;  
       u p p e r _ h i n g e = Q N a N ;  
       m a x i m u m = Q N a N ;  
 / / - - -   c h e c k   a r r a y   s i z e  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
       d o u b l e   d a t a [ ] ;  
       i f ( A r r a y R e s i z e ( d a t a , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
  
       i n t   a c t u a l _ v a l u e s = 0 ;  
       i f ( r e m o v e N A N = = t r u e )  
           {  
             / / - - -   r e m o v e   N A N   v a l u e s   ( c o p y   n o n - N A N   e l e m e n t s )  
             f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
                 {  
                   i f ( M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                       {  
                         d a t a [ a c t u a l _ v a l u e s ] = a r r a y [ i ] ;  
                         a c t u a l _ v a l u e s + + ;  
                       }  
                 }  
             / / - - -   s e t   a c t u a l   s i z e  
             A r r a y R e s i z e ( d a t a , a c t u a l _ v a l u e s ) ;  
           }  
       e l s e  
           {  
             / / - - -   c h e c k   N A N   a n d   r e t u r n   i f   N A N   f o u n d  
             f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
                 {  
                   i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                         r e t u r n ( f a l s e ) ;  
                 }  
             / / - - -   o t h e r w i s e   c o p y   d a t a  
             i f ( A r r a y C o p y ( d a t a , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
           }  
 / / - - -   s o r t   a r r a y  
       A r r a y S o r t ( d a t a ) ;  
       i n t   n = A r r a y S i z e ( d a t a ) ;  
       i f ( n = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   i n d i c e s  
       d o u b l e   n 4 = M a t h F l o o r ( ( n + 3 ) * 0 . 5 ) * 0 . 5 ;  
       d o u b l e   i n d [ 5 ] ;  
       i n d [ 0 ] = 0 ;  
       i n d [ 1 ] = n 4 - 1 ;  
       i n d [ 2 ] = 0 . 5 * ( n + 1 ) - 1 ;  
       i n d [ 3 ] = n - n 4 ;  
       i n d [ 4 ] = n - 1 ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       m i n i m u m = 0 . 5 * ( d a t a [ ( i n t ) M a t h F l o o r ( i n d [ 0 ] ) ] + d a t a [ ( i n t ) M a t h C e i l ( i n d [ 0 ] ) ] ) ;  
       l o w e r _ h i n g e = 0 . 5 * ( d a t a [ ( i n t ) M a t h F l o o r ( i n d [ 1 ] ) ] + d a t a [ ( i n t ) M a t h C e i l ( i n d [ 1 ] ) ] ) ;  
       m e d i a n = 0 . 5 * ( d a t a [ ( i n t ) M a t h F l o o r ( i n d [ 2 ] ) ] + d a t a [ ( i n t ) M a t h C e i l ( i n d [ 2 ] ) ] ) ;  
       u p p e r _ h i n g e = 0 . 5 * ( d a t a [ ( i n t ) M a t h F l o o r ( i n d [ 3 ] ) ] + d a t a [ ( i n t ) M a t h C e i l ( i n d [ 3 ] ) ] ) ;  
       m a x i m u m = 0 . 5 * ( d a t a [ ( i n t ) M a t h F l o o r ( i n d [ 4 ] ) ] + d a t a [ ( i n t ) M a t h C e i l ( i n d [ 4 ] ) ] ) ;  
 / / - - -   s u c c e s s f u l  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   m i n i m u m   a n d   m a x i m u m   o f   t h e   v a l u e s   i n   a r r a y [ ]                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R a n g e ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & m i n , d o u b l e   & m a x )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   d e f a u l t   v a l u e s ,   f i n d   m i n i m u m   a n d   m a x i m u m   v a l u e s  
       m i n = a r r a y [ 0 ] ;  
       m a x = a r r a y [ 0 ] ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
           {  
             d o u b l e   v a l u e = a r r a y [ i ] ;  
             m i n = M a t h M i n ( m i n , v a l u e ) ;  
             m a x = M a t h M a x ( m a x , v a l u e ) ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   m i n i m u m   v a l u e   i n   a r r a y [ ]                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h M i n ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( Q N a N ) ;  
       d o u b l e   m i n _ v a l u e = a r r a y [ 0 ] ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
             m i n _ v a l u e = M a t h M i n ( m i n _ v a l u e , a r r a y [ i ] ) ;  
 / / - - -   r e t u r n   m i n i m u m   v a l u e  
       r e t u r n ( m i n _ v a l u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   m a x i m u m   v a l u e   i n   a r r a y [ ]                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h M a x ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( Q N a N ) ;  
       d o u b l e   m a x _ v a l u e = a r r a y [ 0 ] ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
             m a x _ v a l u e = M a t h M a x ( m a x _ v a l u e , a r r a y [ i ] ) ;  
 / / - - -   r e t u r n   m a x i m u m   v a l u e  
       r e t u r n ( m a x _ v a l u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   s u m   o f   t h e   v a l u e s   i n   a r r a y [ ]                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h S u m ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( Q N a N ) ;  
 / / - - -   c a l c u l a t e   s u m  
       d o u b l e   s u m = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             s u m + = a r r a y [ i ] ;  
 / / - - -   r e t u r n   s u m  
       r e t u r n ( s u m ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   p r o d u c t   o f   t h e   v a l u e s   i n   a r r a y [ ]                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h P r o d u c t ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( Q N a N ) ;  
 / / - - -   c a l c u l a t e   p r o d u c t  
       d o u b l e   p r o d u c t = 1 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             p r o d u c t * = a r r a y [ i ] ;  
 / / - - -   r e t u r n   p r o d u c t  
       r e t u r n ( p r o d u c t ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   s t a n d a r d   d e v i a t i o n   o f   t h e   v a l u e s   i n   a r r a y [ ]                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h S t a n d a r d D e v i a t i o n ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e < = 1 )  
             r e t u r n ( Q N a N ) ;  
 / / - - -   c a l c u l a t e   m e a n  
       d o u b l e   m e a n = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
 / / - - -   a v e r a g e   m e a n  
       m e a n = m e a n / s i z e ;  
 / / - - -   c a l c u l a t e   s t a n d a r d   d e v i a t i o n  
       d o u b l e   s d e v = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             s d e v + = M a t h P o w ( a r r a y [ i ] - m e a n , 2 ) ;  
 / / - - -   r e t u r n   s t a n d a r d   d e v i a t i o n  
       r e t u r n   M a t h S q r t ( s d e v / ( s i z e - 1 ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   a v e r a g e   a b s o l u t e   d e v i a t i o n   o f   t h e   v a l u e s   i n   a r r a y [ ]   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h A v e r a g e D e v i a t i o n ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e < = 1 )  
             r e t u r n ( Q N a N ) ;  
 / / - - -   c a l c u l a t e   m e a n  
       d o u b l e   m e a n = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
       m e a n = m e a n / s i z e ;  
 / / - - -   c a l c u l a t e   a v e r a g e   d e v i a t i o n  
       d o u b l e   a d e v = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a d e v + = M a t h A b s ( a r r a y [ i ] - m e a n ) ;  
       a d e v = a d e v / s i z e ;  
 / / - - -   r e t u r n   a v e r a g e   d e v i a t i o n  
       r e t u r n ( a d e v ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   m e d i a n   v a l u e   o f   t h e   v a l u e s   i n   a r r a y [ ]                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h M e d i a n ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   d a t a   r a n g e  
       i f ( s i z e = = 0 )  
             r e t u r n ( Q N a N ) ;  
 / / - - -   p r e p a r e   s o r t e d   v a l u e s  
       d o u b l e   s o r t e d _ v a l u e s [ ] ;  
       i f ( A r r a y C o p y ( s o r t e d _ v a l u e s , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( Q N a N ) ;  
       A r r a y S o r t ( s o r t e d _ v a l u e s ) ;  
 / / - - -   c a l c u l a t e   m e d i a n   f o r   o d d   a n d   e v e n   c a s e s  
 / / - - -   d a t a _ c o u n t = o d d  
       i f ( s i z e % 2 = = 1 )  
             r e t u r n ( s o r t e d _ v a l u e s [ s i z e / 2 ] ) ;  
 / / - - -   d a t a _ c o u n t = e v e n  
       r e t u r n ( 0 . 5 * ( s o r t e d _ v a l u e s [ ( s i z e - 1 ) / 2 ] + s o r t e d _ v a l u e s [ ( s i z e + 1 ) / 2 ] ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   m e a n   v a l u e   o f   t h e   v a l u e s   i n   a r r a y [ ]                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h M e a n ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   d a t a   r a n g e  
       i f ( s i z e < 1 )  
             r e t u r n ( Q N a N ) ;   / /   n e e d   a t   l e a s t   1   o b s e r v a t i o n  
 / / - - -   c a l c u l a t e   m e a n  
       d o u b l e   m e a n = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
       m e a n = m e a n / s i z e ;  
 / / - - -   r e t u r n   m e a n  
       r e t u r n ( m e a n ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   v a r i a n c e   o f   t h e   v a l u e s   i n   a r r a y [ ]                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h V a r i a n c e ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   d a t a   r a n g e  
       i f ( s i z e < 2 )  
             r e t u r n ( Q N a N ) ;   / /   n e e d   a t   l e a s t   2   o b s e r v a t i o n s  
 / / - - -   c a l c u l a t e   m e a n  
       d o u b l e   m e a n = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
       m e a n = m e a n / s i z e ;  
 / / - - -   c a l c u l a t e   v a r i a n c e  
       d o u b l e   v a r i a n c e = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             v a r i a n c e + = M a t h P o w ( a r r a y [ i ] - m e a n , 2 ) ;  
       v a r i a n c e = v a r i a n c e / ( s i z e - 1 ) ;  
 / / - - -   r e t u r n   v a r i a n c e  
       r e t u r n ( v a r i a n c e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   s k e w n e s s   o f   t h e   v a l u e s   i n   a r r a y [ ]                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h S k e w n e s s ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   d a t a   r a n g e  
       i f ( s i z e < 3 )  
             r e t u r n ( Q N a N ) ;   / /   n e e d   a t   l e a s t   3   o b s e r v a t i o n s  
 / / - - -   c a l c u l a t e   m e a n  
       d o u b l e   m e a n = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
       m e a n = m e a n / s i z e ;  
 / / - - -   c a l c u l a t e   v a r i a n c e   a n d   s k e w n e s s  
       d o u b l e   v a r i a n c e = 0 ;  
       d o u b l e   s k e w n e s s = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             d o u b l e   s q r _ d e v = M a t h P o w ( a r r a y [ i ] - m e a n , 2 ) ;  
             s k e w n e s s + = s q r _ d e v * ( a r r a y [ i ] - m e a n ) ;  
             v a r i a n c e + = s q r _ d e v ;  
           }  
       v a r i a n c e = ( v a r i a n c e ) / ( s i z e - 1 ) ;  
       d o u b l e   v 3 = M a t h P o w ( M a t h S q r t ( v a r i a n c e ) , 3 ) ;  
 / / - - -  
       i f ( v 3 ! = 0 )  
           {  
             s k e w n e s s = s k e w n e s s / ( s i z e * v 3 ) ;  
             / / - - -   r e t u r n   s k e w n e s s  
             r e t u r n ( s k e w n e s s ) ;  
           }  
       e l s e  
             r e t u r n ( Q N a N ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o m p u t e s   t h e   k u r t o s i s   o f   t h e   v a l u e s   i n   a r r a y [ ]                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h K u r t o s i s ( c o n s t   d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
 / / - - -   c h e c k   d a t a   r a n g e  
       i f ( s i z e < 4 )  
             r e t u r n ( Q N a N ) ;   / /   n e e d   a t   l e a s t   4   o b s e r v a t i o n s  
 / / - - -   c a l c u l a t e   m e a n  
       d o u b l e   m e a n = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             m e a n + = a r r a y [ i ] ;  
       m e a n = m e a n / s i z e ;  
 / / - - -   c a l c u l a t e   v a r i a n c e   a n d   k u r t o s i s  
       d o u b l e   v a r i a n c e = 0 ;  
       d o u b l e   k u r t o s i s = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             d o u b l e   s q r _ d e v = M a t h P o w ( a r r a y [ i ] - m e a n , 2 ) ;  
             v a r i a n c e + = s q r _ d e v ;  
             k u r t o s i s + = s q r _ d e v * s q r _ d e v ;  
           }  
 / / - - -   c a l c u l a t e   v a r i a n c e  
       v a r i a n c e = ( v a r i a n c e ) / ( s i z e - 1 ) ;  
       d o u b l e   v 4 = M a t h P o w ( M a t h S q r t ( v a r i a n c e ) , 4 ) ;  
  
       i f ( v 4 ! = 0 )  
           {  
             / / - - -   c a l c u l a t e   k u r t o s i s  
             k u r t o s i s = k u r t o s i s / ( s i z e * v 4 ) ;  
             k u r t o s i s - = 3 ;  
             / / - - -   r e t u r n   k u r t o s i s  
             r e t u r n ( k u r t o s i s ) ;  
           }  
       e l s e  
             r e t u r n ( Q N a N ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g 1 p                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g ( 1 + x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g 1 p ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h L o g 1 p ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h L o g 1 p                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   l o g ( 1 + x )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h L o g 1 p ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h L o g 1 p ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h E x p m 1                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   e x p ( x ) - 1   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h E x p m 1 ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h E x p m 1 ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h E x p m 1                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   e x p ( x ) - 1   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h E x p m 1 ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h E x p m 1 ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i n h                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   h y p e r b o l i c   s i n e   f o r   t h e   e l e m e n t s                   |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i n h ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h S i n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i n h                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   h y p e r b o l i c   s i n e   f o r   t h e   e l e m e n t s                   |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i n h ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h S i n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o s h                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   h y p e r b o l i c   c o s i n e   f o r   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o s h ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h C o s h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o s h                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   h y p e r b o l i c   c o s i n e   f o r   t h e   e l e m e n t s               |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o s h ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h C o s h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T a n h                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   h y p e r b o l i c   t a n g e n t   f o r   t h e   e l e m e n t s             |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T a n h ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h T a n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h T a n h                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   h y p e r b o l i c   t a n g e n t   f o r   t h e   e l e m e n t s             |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h T a n h ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h T a n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c s i n h                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n v e r s e   h y p e r b o l i c   s i n e   f o r   t h e   e l e m e n t s   |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c s i n h ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c s i n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c s i n h                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n v e r s e   h y p e r b o l i c   s i n e   f o r   t h e   e l e m e n t s   |  
 / / |   f r o m   t h e   a r r a y [ ] .                                                                                                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c s i n h ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A r c s i n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c c o s h                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n v e r s e   h y p e r b o l i c   c o s i n e   f o r                         |  
 / / |   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c c o s h ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c c o s h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c c o s h                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n v e r s e   h y p e r b o l i c   c o s i n e   f o r                         |  
 / / |   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c c o s h ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A r c c o s h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c t a n h                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n v e r s e   h y p e r b o l i c   t a n g e n t   f o r                       |  
 / / |   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c t a n h ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h A r c t a n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h A r c t a n h                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   i n v e r s e   h y p e r b o l i c   t a n g e n t   f o r                       |  
 / / |   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .                                                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   v a l u e s                                                                     |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h A r c t a n h ( d o u b l e   & a r r a y [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h A r c t a n h ( a r r a y [ i ] ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R o u n d s   t h e   v a l u e   t o   t h e   s p e c i f i e d   n u m b e r   o f   s i g n i f i c a n t   d i g i t s       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   M a t h S i g n i f ( c o n s t   d o u b l e   x , c o n s t   i n t   d i g i t s )  
     {  
       i f ( x = = 0 )  
             r e t u r n   x ;  
  
       i n t   d i g = d i g i t s ;  
       i f ( d i g > 3 0 )  
             r e t u r n   x ;  
       i f ( d i g < 1 )  
             d i g = 1 ;  
  
       d o u b l e   s i g n = 1 . 0 ;  
       d o u b l e   x x = x ;  
       i f ( x x < 0 . 0 )  
           {  
             s i g n = - s i g n ;  
             x x = - x x ;  
           }  
 / / - - -   c a l c u l a t e   l o g  
       d o u b l e   l 1 0   =   M a t h L o g 1 0 ( x x ) ;  
       d o u b l e   e 1 0   =   ( i n t ) ( d i g - 1 - M a t h F l o o r ( l 1 0 ) ) ;  
       d o u b l e   v a l u e = 0 , p w r 1 0 ;  
       i f ( e 1 0 > 0 )  
           {  
             p w r 1 0 = M a t h P o w ( 1 0 , e 1 0 ) ;  
             v a l u e = M a t h F l o o r ( ( x x * p w r 1 0 ) + 0 . 5 ) / p w r 1 0 ;  
           }  
       e l s e  
           {  
             p w r 1 0 = M a t h P o w ( 1 0 , - e 1 0 ) ;  
             v a l u e = M a t h F l o o r ( ( x x / p w r 1 0 ) + 0 . 5 ) * p w r 1 0 ;  
           }  
       r e t u r n ( s i g n * v a l u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i g n i f                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t h e   r o u n d e d   v a l u e s   ( t o   t h e   s p e c i f i e d           |  
 / / |   n u m b e r   o f   s i g n i f i c a n t   d i g i t s )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   d i g i t s             :   N u m b e r   o f   s i g n i f i c a n t   d i g i t s                                               |  
 / / |   r e s u l t [ ]         :   O u t p u t   a r r a y   w i t h   c a l c u l a t e d   v a l u e s                                 |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i g n i f ( c o n s t   d o u b l e   & a r r a y [ ] , i n t   d i g i t s , d o u b l e   & r e s u l t [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   t a r g e t   a r r a y  
       i f ( A r r a y S i z e ( r e s u l t ) < s i z e )  
             i f ( A r r a y R e s i z e ( r e s u l t , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             r e s u l t [ i ] = M a t h S i g n i f ( a r r a y [ i ] , d i g i t s ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h S i g n i f                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t h e   r o u n d e d   v a l u e s   ( t o   t h e   s p e c i f i e d           |  
 / / |   n u m b e r   o f   s i g n i f i c a n t   d i g i t s )   f o r   t h e   e l e m e n t s   f r o m   t h e   a r r a y [ ] .   |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   A r r a y   w i t h   d o u b l e   v a l u e s                                                       |  
 / / |   d i g i t s             :   N u m b e r   o f   s i g n i f i c a n t   d i g i t s                                               |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h S i g n i f ( d o u b l e   & a r r a y [ ] , i n t   d i g i t s )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             a r r a y [ i ] = M a t h S i g n i f ( a r r a y [ i ] , d i g i t s ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R a n k                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t i e d   r a n k s   f o r   t h e   e l e m e n t s   o f   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   I n p u t   a r r a y   w i t h   d o u b l e   v a l u e s                                           |  
 / / |   r a n k [ ]             :   O u t p u t   a r r a y   w i t h   r a n k e d   v a l u e s                                         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o d e   f r o m   A L G L I B   n u m e r i c a l   a n a l y s i s   a n d   d a t a   p r o c e s s i n g   l i b r a r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R a n k ( c o n s t   d o u b l e   & a r r a y [ ] , d o u b l e   & r a n k [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e < 1 )  
             r e t u r n ( f a l s e ) ;  
       i f ( s i z e = = 1 )  
           {  
             i f ( A r r a y R e s i z e ( r a n k , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
             r a n k [ 0 ] = 1 ;  
             r e t u r n ( t r u e ) ;  
           }  
 / / - - -   p r e p a r e   a r r a y s  
       d o u b l e   v a l u e s [ ] ;  
       i n t   i n d i c e s [ ] ;  
       i f ( A r r a y C o p y ( v a l u e s , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       i f ( ! M a t h S e q u e n c e B y C o u n t ( 0 , s i z e , s i z e , i n d i c e s ) )  
             r e t u r n ( f a l s e ) ;  
       i f ( A r r a y R e s i z e ( r a n k , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       i n t   i , j , k , t , t m p i ;  
       d o u b l e   t m p ;  
 / / - - -   s o r t  
       i f ( s i z e ! = 1 )  
           {  
             i = 2 ;  
             d o  
                 {  
                   t = i ;  
                   w h i l e ( t ! = 1 )  
                       {  
                         k = t / 2 ;  
                         i f ( v a l u e s [ k - 1 ] > = v a l u e s [ t - 1 ] )  
                               t = 1 ;  
                         e l s e  
                             {  
                               / / - - -   s w a p  
                               t m p = v a l u e s [ k - 1 ] ;  
                               v a l u e s [ k - 1 ] = v a l u e s [ t - 1 ] ;  
                               v a l u e s [ t - 1 ] = t m p ;  
                               t m p i = i n d i c e s [ k - 1 ] ;  
                               i n d i c e s [ k - 1 ] = i n d i c e s [ t - 1 ] ;  
                               i n d i c e s [ t - 1 ] = t m p i ;  
                               t = k ;  
                             }  
                       }  
                   i = i + 1 ;  
                 }  
             w h i l e ( i < = s i z e ) ;  
             i = s i z e - 1 ;  
             d o  
                 {  
                   / / - - -   s w a p  
                   t m p = v a l u e s [ i ] ;  
                   v a l u e s [ i ] = v a l u e s [ 0 ] ;  
                   v a l u e s [ 0 ] = t m p ;  
                   t m p i = i n d i c e s [ i ] ;  
                   i n d i c e s [ i ] = i n d i c e s [ 0 ] ;  
                   i n d i c e s [ 0 ] = t m p i ;  
                   t = 1 ;  
                   w h i l e ( t ! = 0 )  
                       {  
                         k = 2 * t ;  
                         i f ( k > i )  
                               t = 0 ;  
                         e l s e  
                             {  
                               i f ( k < i )  
                                     i f ( v a l u e s [ k ] > v a l u e s [ k - 1 ] )  
                                           k + + ;  
                               i f ( v a l u e s [ t - 1 ] > = v a l u e s [ k - 1 ] )  
                                     t = 0 ;  
                               e l s e  
                                   {  
                                     / / - - -   s w a p  
                                     t m p = v a l u e s [ k - 1 ] ;  
                                     v a l u e s [ k - 1 ] = v a l u e s [ t - 1 ] ;  
                                     v a l u e s [ t - 1 ] = t m p ;  
                                     t m p i = i n d i c e s [ k - 1 ] ;  
                                     i n d i c e s [ k - 1 ] = i n d i c e s [ t - 1 ] ;  
                                     i n d i c e s [ t - 1 ] = t m p i ;  
                                     t = k ;  
                                   }  
                             }  
                       }  
                   i = i - 1 ;  
                 }  
             w h i l e ( i > = 1 ) ;  
           }  
 / / - - -   c o m p u t e   t i e d   r a n k s  
       i = 0 ;  
       w h i l e ( i < s i z e )  
           {  
             j = i + 1 ;  
             w h i l e ( j < s i z e )  
                 {  
                   / / - - -   c h e c k  
                   i f ( v a l u e s [ j ] ! = v a l u e s [ i ] )  
                         b r e a k ;  
                   j = j + 1 ;  
                 }  
             f o r ( k = i ;   k < j ;   k + + )  
                   v a l u e s [ k ] = 1 + ( i + j - 1 ) * 0 . 5 ;  
             i = j ;  
           }  
 / / - - -   s e t   o u t p u t   v a l u e s  
       f o r ( i = 0 ;   i < s i z e ;   i + + )  
             r a n k [ i n d i c e s [ i ] ] = v a l u e s [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h R a n k                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t i e d   r a n k s   f o r   t h e   e l e m e n t s   o f   t h e   a r r a y . |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]           :   I n p u t   a r r a y   w i t h   i n t e g e r   v a l u e s                                         |  
 / / |   r a n k [ ]             :   O u t p u t   a r r a y   w i t h   r a n k e d   v a l u e s                                         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o d e   f r o m   A L G L I B   n u m e r i c a l   a n a l y s i s   a n d   d a t a   p r o c e s s i n g   l i b r a r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h R a n k ( c o n s t   i n t   & a r r a y [ ] , d o u b l e   & r a n k [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e < 1 )  
             r e t u r n ( f a l s e ) ;  
       i f ( s i z e = = 1 )  
           {  
             i f ( A r r a y R e s i z e ( r a n k , s i z e ) ! = s i z e )  
                   r e t u r n ( f a l s e ) ;  
             r a n k [ 0 ] = 1 ;  
             r e t u r n ( t r u e ) ;  
           }  
 / / - - -   p r e p a r e   a r r a y s  
       d o u b l e   v a l u e s [ ] ;  
       i n t   i n d i c e s [ ] ;  
  
       i f ( A r r a y R e s i z e ( v a l u e s , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             v a l u e s [ i ] = a r r a y [ i ] ;  
  
       i f ( ! M a t h S e q u e n c e B y C o u n t ( 0 , s i z e , s i z e , i n d i c e s ) )  
             r e t u r n ( f a l s e ) ;  
       i f ( A r r a y R e s i z e ( r a n k , s i z e ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       i n t   i , j , k , t , t m p i ;  
       d o u b l e   t m p ;  
 / / - - -   s o r t  
       i f ( s i z e ! = 1 )  
           {  
             i = 2 ;  
             d o  
                 {  
                   t = i ;  
                   w h i l e ( t ! = 1 )  
                       {  
                         k = t / 2 ;  
                         i f ( v a l u e s [ k - 1 ] > = v a l u e s [ t - 1 ] )  
                               t = 1 ;  
                         e l s e  
                             {  
                               / / - - -   s w a p  
                               t m p = v a l u e s [ k - 1 ] ;  
                               v a l u e s [ k - 1 ] = v a l u e s [ t - 1 ] ;  
                               v a l u e s [ t - 1 ] = t m p ;  
                               t m p i = i n d i c e s [ k - 1 ] ;  
                               i n d i c e s [ k - 1 ] = i n d i c e s [ t - 1 ] ;  
                               i n d i c e s [ t - 1 ] = t m p i ;  
                               t = k ;  
                             }  
                       }  
                   i = i + 1 ;  
                 }  
             w h i l e ( i < = s i z e ) ;  
             i = s i z e - 1 ;  
             d o  
                 {  
                   / / - - -   s w a p  
                   t m p = v a l u e s [ i ] ;  
                   v a l u e s [ i ] = v a l u e s [ 0 ] ;  
                   v a l u e s [ 0 ] = t m p ;  
                   t m p i = i n d i c e s [ i ] ;  
                   i n d i c e s [ i ] = i n d i c e s [ 0 ] ;  
                   i n d i c e s [ 0 ] = t m p i ;  
                   t = 1 ;  
                   w h i l e ( t ! = 0 )  
                       {  
                         k = 2 * t ;  
                         i f ( k > i )  
                               t = 0 ;  
                         e l s e  
                             {  
                               i f ( k < i )  
                                     i f ( v a l u e s [ k ] > v a l u e s [ k - 1 ] )  
                                           k + + ;  
                               i f ( v a l u e s [ t - 1 ] > = v a l u e s [ k - 1 ] )  
                                     t = 0 ;  
                               e l s e  
                                   {  
                                     / / - - -   s w a p  
                                     t m p = v a l u e s [ k - 1 ] ;  
                                     v a l u e s [ k - 1 ] = v a l u e s [ t - 1 ] ;  
                                     v a l u e s [ t - 1 ] = t m p ;  
                                     t m p i = i n d i c e s [ k - 1 ] ;  
                                     i n d i c e s [ k - 1 ] = i n d i c e s [ t - 1 ] ;  
                                     i n d i c e s [ t - 1 ] = t m p i ;  
                                     t = k ;  
                                   }  
                             }  
                       }  
                   i = i - 1 ;  
                 }  
             w h i l e ( i > = 1 ) ;  
           }  
 / / - - -   c o m p u t e   t i e d   r a n k s  
       i = 0 ;  
       w h i l e ( i < s i z e )  
           {  
             j = i + 1 ;  
             w h i l e ( j < s i z e )  
                 {  
                   / / - - -   c h e c k  
                   i f ( v a l u e s [ j ] ! = v a l u e s [ i ] )  
                         b r e a k ;  
                   j = j + 1 ;  
                 }  
             f o r ( k = i ;   k < j ;   k + + )  
                   v a l u e s [ k ] = 1 + ( i + j - 1 ) * 0 . 5 ;  
             i = j ;  
           }  
 / / - - -   s e t   o u t p u t   v a l u e s  
       f o r ( i = 0 ;   i < s i z e ;   i + + )  
             r a n k [ i n d i c e s [ i ] ] = v a l u e s [ i ] ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o r r e l a t i o n P e a r s o n                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   P e a r s o n   p r o d u c t - m o m e n t   c o r r e l a t i o n               |  
 / / |   c o e f f i c i e n t .                                                                                                           |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   d o u b l e   v a l u e s                                           |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   d o u b l e   v a l u e s                                         |  
 / / |   r                       :   V a r i a b l e   f o r   c a l c u l a t e d   v a l u e   o f   t h e   P e a r s o n   r           |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o d e   f r o m   A L G L I B   n u m e r i c a l   a n a l y s i s   a n d   d a t a   p r o c e s s i n g   l i b r a r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o r r e l a t i o n P e a r s o n ( c o n s t   d o u b l e   & a r r a y 1 [ ] , c o n s t   d o u b l e   & a r r a y 2 [ ] , d o u b l e   & r )  
     {  
       r = Q N a N ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y 1 ) ;  
       i f ( s i z e < = 1   | |   A r r a y S i z e ( a r r a y 2 ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c r e a t e   v a r i a b l e s  
       d o u b l e   x m e a n = 0 ;  
       d o u b l e   y m e a n = 0 ;  
       d o u b l e   v = 1 . 0 / ( d o u b l e ) s i z e ;  
       d o u b l e   x 0 = a r r a y 1 [ 0 ] ;  
       d o u b l e   y 0 = a r r a y 2 [ 0 ] ;  
       d o u b l e   s = 0 ;  
       d o u b l e   x v = 0 ;  
       d o u b l e   y v = 0 ;  
       d o u b l e   t 1 = 0 ;  
       d o u b l e   t 2 = 0 ;  
       b o o l       s a m e x = t r u e ;  
       b o o l       s a m e y = t r u e ;  
 / / - - -   a d d i t o n a l l y   w e   c a l c u l a t e   S a m e X   a n d   S a m e Y   -   f l a g   v a r i a b l e s   w h i c h   a r e   s e t   t o   t r u e  
 / / - - -   w h e n   a l l   X [ ]   ( o r   Y [ ] )   c o n t a i n   e x a c t l y   s a m e   v a l u e .  
 / / - - -   i f   a t   l e a s t   o n e   o f   t h e m   i s   t r u e ,   w e   r e t u r n   z e r o  
 / / - - -   ( o t h w e r w i s e   w e   r i s k   t o   g e t   n o n z e r o   c o r r e l a t i o n   b e c a u s e   o f   r o u n d o f f ) .  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             s = a r r a y 1 [ i ] ;  
             s a m e x = s a m e x   & &   s = = x 0 ;  
             x m e a n + = s * v ;  
             s = a r r a y 2 [ i ] ;  
             s a m e y = s a m e y   & &   s = = y 0 ;  
             y m e a n + = s * v ;  
           }  
 / / - - -   c h e c k  
       i f ( s a m e x   | |   s a m e y )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t i o n  
       s = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             t 1 = a r r a y 1 [ i ] - x m e a n ;  
             t 2 = a r r a y 2 [ i ] - y m e a n ;  
             x v + = t 1 * t 1 ;  
             y v + = t 2 * t 2 ;  
             s + = t 1 * t 2 ;  
           }  
 / / - - -   c h e c k  
       i f ( x v = = 0   | |   y v = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       r = s / M a t h S q r t ( x v * y v ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o r r e l a t i o n P e a r s o n                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   P e a r s o n   p r o d u c t - m o m e n t   c o r r e l a t i o n               |  
 / / |   c o e f f i c i e n t .                                                                                                           |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   i n t e g e r   v a l u e s                                         |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   i n t e g e r   v a l u e s                                       |  
 / / |   r                       :   V a r i a b l e   f o r   c a l c u l a t e d   v a l u e   o f   t h e   P e a r s o n   r           |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o d e   f r o m   A L G L I B   n u m e r i c a l   a n a l y s i s   a n d   d a t a   p r o c e s s i n g   l i b r a r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o r r e l a t i o n P e a r s o n ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] , d o u b l e   & r )  
     {  
       r = Q N a N ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y 1 ) ;  
       i f ( s i z e < = 1   | |   A r r a y S i z e ( a r r a y 2 ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c r e a t e   v a r i a b l e s  
       d o u b l e   x m e a n = 0 ;  
       d o u b l e   y m e a n = 0 ;  
       d o u b l e   v = 1 . 0 / ( d o u b l e ) s i z e ;  
       d o u b l e   x 0 = a r r a y 1 [ 0 ] ;  
       d o u b l e   y 0 = a r r a y 2 [ 0 ] ;  
       d o u b l e   s = 0 ;  
       d o u b l e   x v = 0 ;  
       d o u b l e   y v = 0 ;  
       d o u b l e   t 1 = 0 ;  
       d o u b l e   t 2 = 0 ;  
       b o o l       s a m e x = t r u e ;  
       b o o l       s a m e y = t r u e ;  
 / / - - -   a d d i t o n a l l y   w e   c a l c u l a t e   S a m e X   a n d   S a m e Y   -   f l a g   v a r i a b l e s   w h i c h   a r e   s e t   t o   t r u e  
 / / - - -   w h e n   a l l   X [ ]   ( o r   Y [ ] )   c o n t a i n   e x a c t l y   s a m e   v a l u e .  
 / / - - -   i f   a t   l e a s t   o n e   o f   t h e m   i s   t r u e ,   w e   r e t u r n   z e r o  
 / / - - -   ( o t h w e r w i s e   w e   r i s k   t o   g e t   n o n z e r o   c o r r e l a t i o n   b e c a u s e   o f   r o u n d o f f ) .  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             s = a r r a y 1 [ i ] ;  
             s a m e x = s a m e x   & &   s = = x 0 ;  
             x m e a n + = s * v ;  
             s = a r r a y 2 [ i ] ;  
             s a m e y = s a m e y   & &   s = = y 0 ;  
             y m e a n + = s * v ;  
           }  
 / / - - -   c h e c k  
       i f ( s a m e x   | |   s a m e y )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t i o n  
       s = 0 ;  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             t 1 = a r r a y 1 [ i ] - x m e a n ;  
             t 2 = a r r a y 2 [ i ] - y m e a n ;  
             x v + = t 1 * t 1 ;  
             y v + = t 2 * t 2 ;  
             s + = t 1 * t 2 ;  
           }  
 / / - - -   c h e c k  
       i f ( x v = = 0   | |   y v = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       r = s / M a t h S q r t ( x v * y v ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o r r e l a t i o n S p e a r m a n                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   S p e a r m a n   c o r r e l a t i o n   c o e f f i c i e n t .                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   d o u b l e   v a l u e s                                           |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   d o u b l e   v a l u e s                                         |  
 / / |   r                       :   V a r i a b l e   f o r   c a l c u l a t e d   v a l u e   o f   t h e   S p e a r m a n   r         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o d e   f r o m   A L G L I B   n u m e r i c a l   a n a l y s i s   a n d   d a t a   p r o c e s s i n g   l i b r a r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o r r e l a t i o n S p e a r m a n ( c o n s t   d o u b l e   & a r r a y 1 [ ] , c o n s t   d o u b l e   & a r r a y 2 [ ] , d o u b l e   & r )  
     {  
       r = Q N a N ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y 1 ) ;  
       i f ( s i z e < 1   | |   A r r a y S i z e ( a r r a y 2 ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   r a n k s  
       d o u b l e   r a n k _ x [ ] ;  
       d o u b l e   r a n k _ y [ ] ;  
       i f ( ! M a t h R a n k ( a r r a y 1 , r a n k _ x ) )  
             r e t u r n ( f a l s e ) ;  
       i f ( ! M a t h R a n k ( a r r a y 2 , r a n k _ y ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       r e t u r n   M a t h C o r r e l a t i o n P e a r s o n ( r a n k _ x , r a n k _ y , r ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o r r e l a t i o n S p e a r m a n                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   S p e a r m a n   c o r r e l a t i o n   c o e f f i c i e n t .                 |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   i n t e g e r   v a l u e s                                         |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   i n t e g e r   v a l u e s                                       |  
 / / |   r                       :   V a r i a b l e   f o r   c a l c u l a t e d   v a l u e   o f   t h e   S p e a r m a n   r         |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o d e   f r o m   A L G L I B   n u m e r i c a l   a n a l y s i s   a n d   d a t a   p r o c e s s i n g   l i b r a r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o r r e l a t i o n S p e a r m a n ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] , d o u b l e   & r )  
     {  
       r = Q N a N ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y 1 ) ;  
       i f ( s i z e < 1   | |   A r r a y S i z e ( a r r a y 2 ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   r a n k s  
       d o u b l e   r a n k _ x [ ] ;  
       d o u b l e   r a n k _ y [ ] ;  
       i f ( ! M a t h R a n k ( a r r a y 1 , r a n k _ x ) )  
             r e t u r n ( f a l s e ) ;  
       i f ( ! M a t h R a n k ( a r r a y 2 , r a n k _ y ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       r e t u r n   M a t h C o r r e l a t i o n P e a r s o n ( r a n k _ x , r a n k _ y , r ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o r r e l a t i o n K e n d a l l                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   K e n d a l l ' s   t a u   c o r r e l a t i o n   c o e f f i c i e n t .       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   d o u b l e   v a l u e s                                           |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   d o u b l e   v a l u e s                                         |  
 / / |   t a u                   :   V a r i a b l e   f o r   c a l c u l a t e d   v a l u e   o f   t h e   K e n d a l l ' s   t a u   |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o r r e l a t i o n K e n d a l l ( c o n s t   d o u b l e   & a r r a y 1 [ ] , c o n s t   d o u b l e   & a r r a y 2 [ ] , d o u b l e   & t a u )  
     {  
       t a u = Q N a N ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y 1 ) ;  
       i f ( s i z e = = 0   | |   A r r a y S i z e ( a r r a y 2 ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       i n t   c n t 1 = 0 , c n t 2 = 0 , c n t = 0 ;  
 / / - - -  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             f o r ( i n t   j = i + 1 ;   j < s i z e ;   j + + )  
                 {  
                   d o u b l e   d e l t a 1 = a r r a y 1 [ i ] - a r r a y 1 [ j ] ;  
                   d o u b l e   d e l t a 2 = a r r a y 2 [ i ] - a r r a y 2 [ j ] ;  
                   d o u b l e   d e l t a = d e l t a 1 * d e l t a 2 ;  
                   i f ( d e l t a = = 0 )  
                       {  
                         i f ( d e l t a 1 ! = 0 )  
                               c n t 1 + + ;  
                         i f ( d e l t a 2 ! = 0 )  
                               c n t 2 + + ;  
                       }  
                   e l s e  
                       {  
                         c n t 1 + + ;  
                         c n t 2 + + ;  
                         i f ( d e l t a > 0 . 0 )  
                               c n t + + ;  
                         e l s e  
                               c n t - - ;  
                       }  
                 }  
           }  
 / / - - -   c a l c u l a t e   K e n d a l l   t a u  
       d o u b l e   d e n = c n t 1 * c n t 2 ;  
       i f ( d e n = = 0 )  
             r e t u r n ( f a l s e ) ;  
       t a u = c n t / M a t h S q r t ( d e n ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C o r r e l a t i o n K e n d a l l                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   K e n d a l l ' s   t a u   c o r r e l a t i o n   c o e f f i c i e n t .       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y 1 [ ]         :   F i r s t   a r r a y   w i t h   i n t e g e r   v a l u e s                                         |  
 / / |   a r r a y 2 [ ]         :   S e c o n d   a r r a y   w i t h   i n t e g e r   v a l u e s                                       |  
 / / |   t a u                   :   V a r i a b l e   f o r   c a l c u l a t e d   v a l u e   o f   t h e   K e n d a l l ' s   t a u   |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C o r r e l a t i o n K e n d a l l ( c o n s t   i n t   & a r r a y 1 [ ] , c o n s t   i n t   & a r r a y 2 [ ] , d o u b l e   & t a u )  
     {  
       t a u = Q N a N ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y 1 ) ;  
       i f ( s i z e = = 0   | |   A r r a y S i z e ( a r r a y 2 ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -  
       i n t   c n t 1 = 0 , c n t 2 = 0 , c n t = 0 ;  
 / / - - -  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             f o r ( i n t   j = i + 1 ;   j < s i z e ;   j + + )  
                 {  
                   d o u b l e   d e l t a 1 = a r r a y 1 [ i ] - a r r a y 1 [ j ] ;  
                   d o u b l e   d e l t a 2 = a r r a y 2 [ i ] - a r r a y 2 [ j ] ;  
                   d o u b l e   d e l t a = d e l t a 1 * d e l t a 2 ;  
                   i f ( d e l t a = = 0 )  
                       {  
                         i f ( d e l t a 1 ! = 0 )  
                               c n t 1 + + ;  
                         i f ( d e l t a 2 ! = 0 )  
                               c n t 2 + + ;  
                       }  
                   e l s e  
                       {  
                         c n t 1 + + ;  
                         c n t 2 + + ;  
                         i f ( d e l t a > 0 . 0 )  
                               c n t + + ;  
                         e l s e  
                               c n t - - ;  
                       }  
                 }  
           }  
 / / - - -   c a l c u l a t e   K e n d a l l   t a u  
       d o u b l e   d e n = c n t 1 * c n t 2 ;  
       i f ( d e n = = 0 )  
             r e t u r n ( f a l s e ) ;  
       t a u = c n t / M a t h S q r t ( d e n ) ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h Q u a n t i l e                                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   p r o d u c e s   s a m p l e   q u a n t i l e s   c o r r e s p o n d i n g   t o   t h e             |  
 / / |   g i v e n   p r o b a b i l i t i e s .   T h e   s m a l l e s t   o b s e r v a t i o n   c o r r e s p o n d s                 |  
 / / |   t o   a   p r o b a b i l i t y   o f   0 . 0   a n d   t h e   l a r g e s t   t o   a   p r o b a b i l i t y   o f   1 . 0 .   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   e s t i m a t e s   o f   u n d e r l y i n g   d i s t r i b u t i o n           |  
 / / |   q u a n t i l e s   b a s e d   o n   o n e   o r   t w o   o r d e r   s t a t i s t i c s   f r o m   t h e   s u p p l i e d   |  
 / / |   e l e m e n t s   i n   x   a t   p r o b a b i l i t i e s   i n   p r o b s .                                                   |  
 / / |                                                                                                                                     |  
 / / |   R e f e r e n c e :                                                                                                               |  
 / / |   H y n d m a n ,   R .   J .   a n d   F a n ,   Y .   ( 1 9 9 6 )                                                                 |  
 / / |   " S a m p l e   q u a n t i l e s   i n   s t a t i s t i c a l   p a c k a g e s " ,                                             |  
 / / |   A m e r i c a n   S t a t i s t i c i a n ,   v o l . 5 0 ,   p p .   3 6 1  3 6 5 .                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A l l   s a m p l e   q u a n t i l e s   a r e   d e f i n e d   a s   w e i g h t e d   a v e r a g e s                         |  
 / / |   o f   c o n s e c u t i v e   o r d e r   s t a t i s t i c s .                                                                   |  
 / / |   S a m p l e   q u a n t i l e s   o f   t y p e   i   a r e   d e f i n e d   b y :                                               |  
 / / |   Q [ i ] ( p )   =   ( 1   -   g a m m a ) * x [ j ]   +   g a m m a * x [ j + 1 ]                                                 |  
 / / |                                                                                                                                     |  
 / / |   T h e   f u n c t i o n   M a t h Q u a n t i l e   c a l c u l a t e s   q u a n t i l e s   a c c o r d i n g   t o             |  
 / / |   d e f a u l t   t y p e   i n   R   ( t y p e = 7 )                                                                               |  
 / / |   p ( k )   =   ( k   -   1 ) / ( n   -   1 ) .                                                                                     |  
 / / |   I n   t h i s   c a s e ,   p ( k )   =   m o d e [ F ( x [ k ] ) ] .   T h i s   i s   u s e d   b y   S .                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h Q u a n t i l e ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   d o u b l e   & p r o b s [ ] , d o u b l e   & q u a n t i l e [ ] )  
     {  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i n t   s i z e _ p = A r r a y S i z e ( p r o b s ) ;  
  
       i f ( s i z e = = 0   | |   s i z e _ p = = 0 )  
             r e t u r n ( f a l s e ) ;  
  
 / / - - -   c h e c k   p r o b a b i l i t y  
       f o r ( i n t   i = 0 ;   i < s i z e _ p ;   i + + )  
           {  
             / / - - -   c h e c k   N a N  
             i f ( ! M a t h I s V a l i d N u m b e r ( p r o b s [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
             / / - - -   c h e c k   p r o b a b i l i t y   r a n g e  
             i f ( p r o b s [ i ] < 0 . 0   | |   p r o b s [ i ] > 1 . 0 )  
                   r e t u r n ( f a l s e ) ;  
           }  
 / / - - -   p r e p a r e   a r r a y   w i t h   v a l u e s  
       d o u b l e   x _ v a l u e s [ ] ;  
       i f ( A r r a y C o p y ( x _ v a l u e s , a r r a y , 0 , 0 , W H O L E _ A R R A Y ) ! = s i z e )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   p r e p a r e   o u t p u t   a r r a y  
       i f ( A r r a y S i z e ( q u a n t i l e ) < s i z e _ p )  
             i f ( A r r a y R e s i z e ( q u a n t i l e , s i z e _ p ) ! = s i z e _ p )  
                   r e t u r n ( f a l s e ) ;  
  
       d o u b l e   i n d [ ] ;  
       i n t   l o [ ] ;  
       i n t   h i [ ] ;  
       A r r a y R e s i z e ( i n d , s i z e _ p ) ;  
       A r r a y R e s i z e ( l o , s i z e _ p ) ;  
       A r r a y R e s i z e ( h i , s i z e _ p ) ;  
 / / - - -   c a l c u l a t e   r a n g e s  
       f o r ( i n t   i = 0 ;   i < s i z e _ p ;   i + + )  
           {  
             i n d [ i ] = ( s i z e - 1 ) * p r o b s [ i ] ;  
             l o [ i ] = ( i n t ) M a t h F l o o r ( i n d [ i ] ) ;  
             h i [ i ] = ( i n t ) M a t h C e i l ( i n d [ i ] ) ;  
           }  
 / / - - -   c a l c u l a t e   q u a n t i l e s  
       i n t   i n d i c e s [ ] ;  
       M a t h S e q u e n c e B y C o u n t ( 0 , s i z e - 1 , s i z e , i n d i c e s ) ;  
       M a t h Q u i c k S o r t ( x _ v a l u e s , i n d i c e s , 0 , s i z e - 1 , 1 ) ;  
       f o r ( i n t   i = 0 ;   i < s i z e _ p ;   i + + )  
           {  
             q u a n t i l e [ i ] = x _ v a l u e s [ l o [ i ] ] ;  
             i f ( i n d [ i ] > l o [ i ] )  
                 {  
                   d o u b l e   g a m m a = ( i n d [ i ] - l o [ i ] ) ;  
                   q u a n t i l e [ i ] = ( 1 . 0 - g a m m a ) * q u a n t i l e [ i ] + g a m m a * x _ v a l u e s [ h i [ i ] ] ;  
                 }  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h P r o b a b i l i t y D e n s i t y E m p i r i c a l                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t h e   e m p i r i c a l   p r o b a b i l i t y   d e n s i t y                 |  
 / / |   f u n c t i o n   ( p d f )   f o r   r a n d o m   v a l u e s   f r o m   a r r a y [ ] .                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]     :   A r r a y   w i t h   r a n d o m   v a l u e s                                                             |  
 / / |   c o u n t         :   D a t a   c o u n t ,   t o t a l   c o u n t   p a i r s   ( x , p d f ( x ) )                             |  
 / / |   x [ ]             :   O u t p u t   a r r a y   f o r   x   v a l u e s                                                           |  
 / / |   p d f [ ]         :   O u t p u t   a r r a y   f o r   e m p i r i c a l   p d f ( x )   v a l u e s                             |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h P r o b a b i l i t y D e n s i t y E m p i r i c a l ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   c o u n t , d o u b l e   & x [ ] , d o u b l e   & p d f [ ] )  
     {  
       i f ( c o u n t < = 1 )  
             r e t u r n ( f a l s e ) ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   N a N   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
           }  
 / / - - -   p r e p a r e   o u t p u t   a r r a y s  
       i f ( A r r a y S i z e ( x ) < c o u n t )  
             i f ( A r r a y R e s i z e ( x , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
       i f ( A r r a y S i z e ( p d f ) < c o u n t )  
             i f ( A r r a y R e s i z e ( p d f , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   s e a r c h   f o r   m i n , m a x   a n d   r a n g e  
       d o u b l e   m i n v = a r r a y [ 0 ] ;  
       d o u b l e   m a x v = a r r a y [ 0 ] ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
           {  
             m i n v = M a t h M i n ( m i n v , a r r a y [ i ] ) ;  
             m a x v = M a t h M a x ( m a x v , a r r a y [ i ] ) ;  
           }  
       d o u b l e   r a n g e = m a x v - m i n v ;  
       i f ( r a n g e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   p r o b a b i l i t y   d e n s i t y   o f   t h e   e m p i r i c a l   d i s t r i b u t i o n  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             x [ i ] = m i n v + i * r a n g e / ( c o u n t - 1 ) ;  
             p d f [ i ] = 0 ;  
           }  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             d o u b l e   v = ( a r r a y [ i ] - m i n v ) / r a n g e ;  
             i n t   i n d = i n t ( ( v * ( c o u n t - 1 ) ) ) ;  
             p d f [ i n d ] + + ;  
           }  
 / / - - -   n o r m a l i z e   v a l u e s  
       d o u b l e   d x = r a n g e / c o u n t ;  
       d o u b l e   s u m = 0 ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             s u m + = p d f [ i ] * d x ;  
       i f ( s u m = = 0 )  
             r e t u r n ( f a l s e ) ;  
       d o u b l e   c o e f = 1 . 0 / s u m ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             p d f [ i ] * = c o e f ;  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   M a t h C u m u l a t i v e D i s t r i b u t i o n E m p i r i c a l                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   c a l c u l a t e s   t h e   e m p i r i c a l   c u m u l a t i v e   d i s t r i b u t i o n         |  
 / / |   f u n c t i o n   ( c d f )   f o r   r a n d o m   v a l u e s   f r o m   a r r a y [ ] .                                       |  
 / / |                                                                                                                                     |  
 / / |   A r g u m e n t s :                                                                                                               |  
 / / |   a r r a y [ ]     :   A r r a y   w i t h   r a n d o m   v a l u e s                                                             |  
 / / |   c o u n t         :   D a t a   c o u n t ,   t o t a l   c o u n t   p a i r s   ( x , c d f ( x ) )                             |  
 / / |   x [ ]             :   O u t p u t   a r r a y   f o r   x   v a l u e s                                                           |  
 / / |   c d f [ ]         :   O u t p u t   a r r a y   f o r   e m p i r i c a l   c d f ( x )   v a l u e s                             |  
 / / |                                                                                                                                     |  
 / / |   R e t u r n   v a l u e :   t r u e   i f   s u c c e s s f u l ,   o t h e r w i s e   f a l s e                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   M a t h C u m u l a t i v e D i s t r i b u t i o n E m p i r i c a l ( c o n s t   d o u b l e   & a r r a y [ ] , c o n s t   i n t   c o u n t , d o u b l e   & x [ ] , d o u b l e   & c d f [ ] )  
     {  
       i f ( c o u n t < = 1 )  
             r e t u r n ( f a l s e ) ;  
       i n t   s i z e = A r r a y S i z e ( a r r a y ) ;  
       i f ( s i z e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   N a N   v a l u e s  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             i f ( ! M a t h I s V a l i d N u m b e r ( a r r a y [ i ] ) )  
                   r e t u r n ( f a l s e ) ;  
           }  
 / / - - -   p r e p a r e   o u t p u t   a r r a y s  
       i f ( A r r a y S i z e ( x ) < c o u n t )  
             i f ( A r r a y R e s i z e ( x , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
       i f ( A r r a y S i z e ( c d f ) < c o u n t )  
             i f ( A r r a y R e s i z e ( c d f , c o u n t ) ! = c o u n t )  
                   r e t u r n ( f a l s e ) ;  
 / / - - -   s e a r c h   f o r   m i n , m a x   a n d   r a n g e  
       d o u b l e   m i n v = a r r a y [ 0 ] ;  
       d o u b l e   m a x v = a r r a y [ 0 ] ;  
       f o r ( i n t   i = 1 ;   i < s i z e ;   i + + )  
           {  
             m i n v = M a t h M i n ( m i n v , a r r a y [ i ] ) ;  
             m a x v = M a t h M a x ( m a x v , a r r a y [ i ] ) ;  
           }  
       d o u b l e   r a n g e = m a x v - m i n v ;  
       i f ( r a n g e = = 0 )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c a l c u l a t e   p r o b a b i l i t y   d e n s i t y   o f   t h e   e m p i r i c a l   d i s t r i b u t i o n  
       d o u b l e   p d f [ ] ;  
       i f ( A r r a y R e s i z e ( p d f , c o u n t ) ! = c o u n t )  
             r e t u r n ( f a l s e ) ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             x [ i ] = m i n v + i * r a n g e / ( c o u n t - 1 ) ;  
             p d f [ i ] = 0 ;  
           }  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
           {  
             d o u b l e   v = ( a r r a y [ i ] - m i n v ) / r a n g e ;  
             i n t   i n d = i n t ( ( v * ( c o u n t - 1 ) ) ) ;  
             p d f [ i n d ] + + ;  
           }  
 / / - - -   n o r m a l i z e   v a l u e s  
       d o u b l e   d x = r a n g e / c o u n t ;  
       d o u b l e   s u m = 0 ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             s u m + = p d f [ i ] * d x ;  
       i f ( s u m = = 0 )  
             r e t u r n ( f a l s e ) ;  
       d o u b l e   c o e f = 1 . 0 / s u m ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
             p d f [ i ] * = c o e f ;  
 / / - - -   c a l c u l a t e   c u m u l a t i v e   d i s t r i b u t i o n   f u n c t i o n  
       s u m = 0 . 0 ;  
       f o r ( i n t   i = 0 ;   i < c o u n t ;   i + + )  
           {  
             s u m + = p d f [ i ] * d x ;  
             c d f [ i ] = s u m ;  
           }  
 / / - - -  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                             ErrorDescription.mqh |
//|                        Copyright 2010, MetaQuotes Software Corp. |
//|                                              http://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright "2010, MetaQuotes Software Corp."
#property link      "http://www.mql5.com"
#property version   "1.00"
//+------------------------------------------------------------------+
//| returns trade server return code description                     |
//+------------------------------------------------------------------+
string TradeServerReturnCodeDescription(int return_code)
  {
//---
   switch(return_code)
     {
      case TRADE_RETCODE_REQUOTE:            return("Requote");
      case TRADE_RETCODE_REJECT:             return("Request rejected");
      case TRADE_RETCODE_CANCEL:             return("Request canceled by trader");
      case TRADE_RETCODE_PLACED:             return("Order placed");
      case TRADE_RETCODE_DONE:               return("Request is completed");
      case TRADE_RETCODE_DONE_PARTIAL:       return("Request is partially completed");
      case TRADE_RETCODE_ERROR:              return("Request processing error");
      case TRADE_RETCODE_TIMEOUT:            return("Request canceled by timeout");
      case TRADE_RETCODE_INVALID:            return("Invalid request");
      case TRADE_RETCODE_INVALID_VOLUME:     return("Invalid volume in the request");
      case TRADE_RETCODE_INVALID_PRICE:      return("Invalid price in the request");
      case TRADE_RETCODE_INVALID_STOPS:      return("Invalid stops in the request");
      case TRADE_RETCODE_TRADE_DISABLED:     return("Trade is disabled");
      case TRADE_RETCODE_MARKET_CLOSED:      return("Market is closed");
      case TRADE_RETCODE_NO_MONEY:           return("There is not enough money to fulfill the request");
      case TRADE_RETCODE_PRICE_CHANGED:      return("Prices changed");
      case TRADE_RETCODE_PRICE_OFF:          return("There are no quotes to process the request");
      case TRADE_RETCODE_INVALID_EXPIRATION: return("Invalid order expiration date of in the request");
      case TRADE_RETCODE_ORDER_CHANGED:      return("Order state changed");
      case TRADE_RETCODE_TOO_MANY_REQUESTS:  return("Too frequent requests");
      case TRADE_RETCODE_NO_CHANGES:         return("No changes in request");
      case TRADE_RETCODE_SERVER_DISABLES_AT: return("Autotrading disabled by server");
      case TRADE_RETCODE_CLIENT_DISABLES_AT: return("Autotrading disabled by client terminal");
      case TRADE_RETCODE_LOCKED:             return("Request locked for processing");
      case TRADE_RETCODE_FROZEN:             return("Order or position frozen");
      case TRADE_RETCODE_INVALID_FILL:       return("Invalid order filling type"); 
      case TRADE_RETCODE_CONNECTION:         return("No connection with the trade server"); 
      case TRADE_RETCODE_ONLY_REAL:          return("Operation is allowed only for live accounts");     
      case TRADE_RETCODE_LIMIT_ORDERS:       return("The number of pending orders has reached the limit"); 
      case TRADE_RETCODE_LIMIT_VOLUME:       return("The volume of orders and positions for the symbol has reached the limit"); 
     }
//---
   return("Invalid return code of the trade server");
  }
//+------------------------------------------------------------------+
//| returns runtime error code description                           |
//+------------------------------------------------------------------+
string ErrorDescription(int err_code)
  {
//---
   switch(err_code)
     {
      case ERR_INTERNAL_ERROR:               return("Unexpected internal error");
      case ERR_WRONG_INTERNAL_PARAMETER:     return("Wrong parameter in the inner call of the client terminal function");
      case ERR_INVALID_PARAMETER:            return("Wrong parameter when calling the system function");
      case ERR_NOT_ENOUGH_MEMORY:            return("Not enough memory to perform the system function");
      case ERR_STRUCT_WITHOBJECTS_ORCLASS:   return("The structure contains objects of strings and/or dynamic arrays and/or structure of such objects and/or classes");
      case ERR_INVALID_ARRAY:                return("Array of a wrong type, wrong size, or a damaged object of a dynamic array");
      case ERR_ARRAY_RESIZE_ERROR:           return("Not enough memory for the relocation of an array, or an attempt to change the size of a static array");
      case ERR_STRING_RESIZE_ERROR:          return("Not enough memory for the relocation of string");
      case ERR_NOTINITIALIZED_STRING:        return("Not initialized string");
      case ERR_INVALID_DATETIME:             return("Invalid date and/or time");
      case ERR_ARRAY_BAD_SIZE:               return("Requested array size exceeds 2 GB");
      case ERR_INVALID_POINTER:              return("Wrong pointer");
      case ERR_INVALID_POINTER_TYPE:         return("Wrong type of pointer");
      case ERR_FUNCTION_NOT_ALLOWED:         return("System function is not allowed to call");
      case ERR_CHART_WRONG_ID:               return("Wrong chart ID");
      case ERR_CHART_NO_REPLY:               return("Chart does not respond");
      case ERR_CHART_NOT_FOUND:              return("Chart not found");
      case ERR_CHART_NO_EXPERT:              return("No Expert Advisor in the chart that could handle the event");
      case ERR_CHART_CANNOT_OPEN:            return("Chart opening error");
      case ERR_CHART_CANNOT_CHANGE:          return("Failed to change chart symbol and period");
      //case ERR_CHART_WRONG_TIMER_PARAMETER:  return("Wrong parameter for timer");
      case ERR_CHART_CANNOT_CREATE_TIMER:    return("Failed to create timer");
      case ERR_CHART_WRONG_PROPERTY:         return("Wrong chart property ID");
      case ERR_CHART_SCREENSHOT_FAILED:      return("Error creating screenshots");
      case ERR_CHART_NAVIGATE_FAILED:        return("Error navigating through chart");
      case ERR_CHART_TEMPLATE_FAILED:        return("Error applying template");
      case ERR_CHART_WINDOW_NOT_FOUND:       return("Subwindow containing the indicator was not found");
      case ERR_OBJECT_ERROR:                 return("Error working with a graphical object");
      case ERR_OBJECT_NOT_FOUND:             return("Graphical object was not found");
      case ERR_OBJECT_WRONG_PROPERTY:        return("Wrong ID of a graphical object property");
      case ERR_OBJECT_GETDATE_FAILED:        return("Unable to get date corresponding to the value");
      case ERR_OBJECT_GETVALUE_FAILED:       return("Unable to get value corresponding to the date");
      case ERR_MARKET_UNKNOWN_SYMBOL:        return("Unknown symbol");
      case ERR_MARKET_SELECT_ERROR:          return("Symbol is not selected in MarketWatch");
      case ERR_MARKET_WRONG_PROPERTY:        return("Wrong identifier of a symbol property");
      case ERR_MARKET_LASTTIME_UNKNOWN:      return("Time of the last tick is not known (no ticks)");
      case ERR_HISTORY_NOT_FOUND:            return("Requested history not found");
      case ERR_HISTORY_WRONG_PROPERTY:       return("Wrong ID of the history property");
      case ERR_GLOBALVARIABLE_NOT_FOUND:     return("Global variable of the client terminal is not found");
      case ERR_GLOBALVARIABLE_EXISTS:        return("Global variable of the client terminal with the same name already exists");
      case ERR_MAIL_SEND_FAILED:             return("Email sending failed");
      case ERR_PLAY_SOUND_FAILED:            return("Sound playing failed");
      case ERR_MQL5_WRONG_PROPERTY:          return("Wrong identifier of the program property");
      case ERR_TERMINAL_WRONG_PROPERTY:      return("Wrong identifier of the terminal property");
      case ERR_FTP_SEND_FAILED:              return("File sending via ftp failed");
      case ERR_BUFFERS_NO_MEMORY:            return("Not enough memory for the distribution of indicator buffers");
      case ERR_BUFFERS_WRONG_INDEX:          return("Wrong indicator buffer index");
      case ERR_CUSTOM_WRONG_PROPERTY:        return("Wrong ID of the custom indicator property");
      case ERR_ACCOUNT_WRONG_PROPERTY:       return("Wrong account property ID");
      case ERR_TRADE_WRONG_PROPERTY:         return("Wrong trade property ID");
      case ERR_TRADE_DISABLED:               return("Trading by Expert Advisors prohibited");
      case ERR_TRADE_POSITION_NOT_FOUND:     return("Position not found");
      case ERR_TRADE_ORDER_NOT_FOUND:        return("Order not found");
      case ERR_TRADE_DEAL_NOT_FOUND:         return("Deal not found");
      case ERR_TRADE_SEND_FAILED:            return("Trade request sending failed");
      case ERR_INDICATOR_UNKNOWN_SYMBOL:     return("Unknown symbol");
      case ERR_INDICATOR_CANNOT_CREATE:      return("Indicator cannot be created");
      case ERR_INDICATOR_NO_MEMORY:          return("Not enough memory to add the indicator");
      case ERR_INDICATOR_CANNOT_APPLY:       return("The indicator cannot be applied to another indicator");
      case ERR_INDICATOR_CANNOT_ADD:         return("Error applying an indicator to chart");
      case ERR_INDICATOR_DATA_NOT_FOUND:     return("Requested data not found");
      case ERR_INDICATOR_WRONG_INDEX:        return("Wrong index of the requested indicator buffer");
      case ERR_INDICATOR_WRONG_PARAMETERS:   return("Wrong number of parameters when creating an indicator");
      case ERR_INDICATOR_PARAMETERS_MISSING: return("No parameters when creating an indicator");
      case ERR_INDICATOR_CUSTOM_NAME:        return("The first parameter in the array must be the name of the custom indicator");
      case ERR_INDICATOR_PARAMETER_TYPE:     return("Invalid parameter type in the array when creating an indicator");
      case ERR_BOOKS_CANNOT_ADD:             return("Depth Of Market can not be added");
      case ERR_BOOKS_CANNOT_DELETE:          return("Depth Of Market can not be removed");
      case ERR_BOOKS_CANNOT_GET:             return("The data from Depth Of Market can not be obtained");
      case ERR_BOOKS_CANNOT_SUBSCRIBE:       return("Error in subscribing to receive new data from Depth Of Market");
      case ERR_TOO_MANY_FILES:               return("More than 64 files cannot be opened at the same time");
      case ERR_WRONG_FILENAME:               return("Invalid file name");
      case ERR_TOO_LONG_FILENAME:            return("Too long file name");
      case ERR_CANNOT_OPEN_FILE:             return("File opening error");
      case ERR_FILE_CACHEBUFFER_ERROR:       return("Not enough memory for cache to read");
      case ERR_CANNOT_DELETE_FILE:           return("File deleting error");
      case ERR_INVALID_FILEHANDLE:           return("A file with this handle was closed, or was not opening at all");
      case ERR_WRONG_FILEHANDLE:             return("Wrong file handle");
      case ERR_FILE_NOTTOWRITE:              return("The file must be opened for writing");
      case ERR_FILE_NOTTOREAD:               return("The file must be opened for reading");
      case ERR_FILE_NOTBIN:                  return("The file must be opened as a binary one");
      case ERR_FILE_NOTTXT:                  return("The file must be opened as a text");
      case ERR_FILE_NOTTXTORCSV:             return("The file must be opened as a text or CSV");
      case ERR_FILE_NOTCSV:                  return("The file must be opened as CSV");
      case ERR_FILE_READERROR:               return("File reading error");
      case ERR_FILE_BINSTRINGSIZE:           return("String size must be specified, because the file is opened as binary");
      case ERR_INCOMPATIBLE_FILE:            return("A text file must be for string arrays, for other arrays - binary");
      case ERR_FILE_IS_DIRECTORY:            return("This is not a file, this is a directory");
      case ERR_FILE_NOT_EXIST:               return("File does not exist");
      case ERR_FILE_CANNOT_REWRITE:          return("File can not be rewritten");
      case ERR_WRONG_DIRECTORYNAME:          return("Wrong directory name");
      case ERR_DIRECTORY_NOT_EXIST:          return("Directory does not exist");
      case ERR_FILE_ISNOT_DIRECTORY:         return("This is a file, not a directory");
      case ERR_CANNOT_DELETE_DIRECTORY:      return("The directory cannot be removed");
      case ERR_NO_STRING_DATE:               return("No date in the string");
      case ERR_WRONG_STRING_DATE:            return("Wrong date in the string");
      case ERR_WRONG_STRING_TIME:            return("Wrong time in the string");
      case ERR_STRING_TIME_ERROR:            return("Error converting string to date");
      case ERR_STRING_OUT_OF_MEMORY:         return("Not enough memory for the string");
      case ERR_STRING_SMALL_LEN:             return("The string length is less than expected");
      case ERR_STRING_TOO_BIGNUMBER:         return("Too large number, more than ULONG_MAX");
      case ERR_WRONG_FORMATSTRING:           return("Invalid format string");
      case ERR_TOO_MANY_FORMATTERS:          return("Amount of format specifiers more than the parameters");
      case ERR_TOO_MANY_PARAMETERS:          return("Amount of parameters more than the format specifiers");
      case ERR_WRONG_STRING_PARAMETER:       return("Damaged parameter of string type");
      case ERR_STRINGPOS_OUTOFRANGE:         return("Position outside the string");
      case ERR_STRING_ZEROADDED:             return("0 added to the string end, a useless operation");
      case ERR_STRING_UNKNOWNTYPE:           return("Unknown data type when converting to a string");
      case ERR_WRONG_STRING_OBJECT:          return("Damaged string object");
      case ERR_INCOMPATIBLE_ARRAYS:          return("Copying incompatible arrays. String array can be copied only to a string array, and a numeric array - in numeric array only");
      case ERR_SMALL_ASSERIES_ARRAY:         return("The receiving array is declared as AS_SERIES, and it is of insufficient size");
      case ERR_SMALL_ARRAY:                  return("Too small array, the starting position is outside the array");
      case ERR_ZEROSIZE_ARRAY:               return("An array of zero length");
      case ERR_NUMBER_ARRAYS_ONLY:           return("Must be a numeric array");
      case ERR_ONEDIM_ARRAYS_ONLY:           return("Must be a one-dimensional array");
      case ERR_SERIES_ARRAY:                 return("Timeseries cannot be used");
      case ERR_DOUBLE_ARRAY_ONLY:            return("Must be an array of type double");
      case ERR_FLOAT_ARRAY_ONLY:             return("Must be an array of type float");
      case ERR_LONG_ARRAY_ONLY:              return("Must be an array of type long");
      case ERR_INT_ARRAY_ONLY:               return("Must be an array of type int");
      case ERR_SHORT_ARRAY_ONLY:             return("Must be an array of type short");
      case ERR_CHAR_ARRAY_ONLY:              return("Must be an array of type char");
      default: if(err_code>=ERR_USER_ERROR_FIRST && err_code<ERR_USER_ERROR_LAST)
                                             return("User error "+string(err_code-ERR_USER_ERROR_FIRST));
     }
//---
   return("Unknown error");
  }
//+------------------------------------------------------------------+-e 

//+------------------------------------------------------------------+
//|                                                      HashSet.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include<Generic\Interfaces\ISet.mqh>
#include <Generic\Internal\PrimeGenerator.mqh>
#include <Generic\Interfaces\IEqualityComparer.mqh>
#include <Generic\Internal\DefaultEqualityComparer.mqh>
//+------------------------------------------------------------------+
//| Struct Slot<T>.                                                  |
//| Usage: Internal structure for organization CHashSet<T>.          |
//+------------------------------------------------------------------+
template<typename T>
struct Slot
  {
public:
   int               hash_code;
   T                 value;
   int               next;
                     Slot(void): hash_code(0),value((T)NULL),next(0) {}
  };
//+------------------------------------------------------------------+
//| Class CHashSet<T>.                                               |
//| Usage: Represents a set of unique values.                        |
//+------------------------------------------------------------------+
template<typename T>
class CHashSet: public ISet<T>
  {
protected:
   int               m_buckets[];
   Slot<T>           m_slots[];
   int               m_count;
   int               m_last_index;
   int               m_free_list;
   IEqualityComparer<T>*m_comparer;
   bool              m_delete_comparer;

public:
                     CHashSet(void);
                     CHashSet(IEqualityComparer<T>*comparer);
                     CHashSet(ICollection<T>*collection);
                     CHashSet(ICollection<T>*collection,IEqualityComparer<T>*comparer);
                     CHashSet(T &array[]);
                     CHashSet(T &array[],IEqualityComparer<T>*comparer);
                    ~CHashSet(void);
   //--- methods of filling data
   bool              Add(T value);
   //--- methods of access to protected data
   int               Count(void)                                       { return(m_count);              }
   IEqualityComparer<T>* Comparer(void)                          const { return(m_comparer);           }
   bool              Contains(T item);
   void              TrimExcess(void);
   //--- methods of copy data from collection
   int               CopyTo(T &ds_array[],const int dst_start=0);
   //--- methods of cleaning and deleting
   void              Clear(void);
   bool              Remove(T item);
   //--- methods of changing sets
   void              ExceptWith(ICollection<T>*collection);
   void              ExceptWith(T &array[]);
   void              IntersectWith(ICollection<T>*collection);
   void              IntersectWith(T &array[]);
   void              SymmetricExceptWith(ICollection<T>*collection);
   void              SymmetricExceptWith(T &array[]);
   void              UnionWith(ICollection<T>*collection);
   void              UnionWith(T &array[]);
   //--- methods for determining the relationship between sets
   bool              IsProperSubsetOf(ICollection<T>*collection);
   bool              IsProperSubsetOf(T &array[]);
   bool              IsProperSupersetOf(ICollection<T>*collection);
   bool              IsProperSupersetOf(T &array[]);
   bool              IsSubsetOf(ICollection<T>*collection);
   bool              IsSubsetOf(T &array[]);
   bool              IsSupersetOf(ICollection<T>*collection);
   bool              IsSupersetOf(T &array[]);
   bool              Overlaps(ICollection<T>*collection);
   bool              Overlaps(T &array[]);
   bool              SetEquals(ICollection<T>*collection);
   bool              SetEquals(T &array[]);

private:
   void              SetCapacity(const int new_size,bool new_hash_codes);
   bool              AddIfNotPresent(T value);
   void              Initialize(const int capacity);
   void              InternalSymmetricExceptWith(CHashSet<T>*set);
   bool              InternalIsSubsetOf(CHashSet<T>*set);
   bool              InternalIsSupersetOf(CHashSet<T>*set);
   bool              InternalIsProperSubsetOf(CHashSet<T>*set);
   bool              InternalIsProperSupersetOf(CHashSet<T>*set);
  };
//+------------------------------------------------------------------+
//| Initializes a new instance of the CHashSet<T> class that is empty|
//| and uses the default equality comparer for the set type.         |
//+------------------------------------------------------------------+
template<typename T>
CHashSet::CHashSet(void): m_count(0),
                          m_last_index(0),
                          m_free_list(-1)
  {
//--- use default equality comaprer
   m_comparer=new CDefaultEqualityComparer<T>();
   m_delete_comparer=true;
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CHashSet<T> class that is empty|
//| and uses the specified equality comparer for the set type.       |
//+------------------------------------------------------------------+
template<typename T>
CHashSet::CHashSet(IEqualityComparer<T>*comparer): m_count(0),
                                                   m_last_index(0),
                                                   m_free_list(-1)
  {
//--- check equality comaprer
   if(CheckPointer(comparer)==POINTER_INVALID)
     {
      //--- use default equality comaprer
      m_comparer=new CDefaultEqualityComparer<T>();
      m_delete_comparer=true;
     }
   else
     {
      //--- use specified equality comaprer
      m_comparer=comparer;
      m_delete_comparer=false;
     }
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CHashSet<T> class that uses the|
//| default equality comparer for the set type, contains elements    |
//| copied from the specified collection, and has sufficient capacity|
//| to accommodate the number of elements copied.                    |
//+------------------------------------------------------------------+
template<typename T>
CHashSet::CHashSet(ICollection<T>*collection): m_count(0),
                                               m_last_index(0),
                                               m_free_list(-1)
  {
//--- use default equality comaprer
   m_comparer=new CDefaultEqualityComparer<T>();
   m_delete_comparer=true;
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- set capacity for elements of the collection
   int count=collection.Count();
   Initialize(count);
//--- add element from collection to the set
   this.UnionWith(collection);
   if((m_count==0 && ArraySize(m_slots)>3) ||
      (m_count>0 && ArraySize(m_slots)/m_count>3))
      TrimExcess();
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CHashSet<T> class that uses the|
//| specified equality comparer for the set type, contains elements  |
//| copied from the specified collection, and has sufficient capacity|
//| to accommodate the number of elements copied.                    |
//+------------------------------------------------------------------+
template<typename T>
CHashSet::CHashSet(ICollection<T>*collection,IEqualityComparer<T>*comparer): m_count(0),
                                                                             m_last_index(0),
                                                                             m_free_list(-1)
  {
//--- check equality comaprer
   if(CheckPointer(comparer)==POINTER_INVALID)
     {
      //--- use default equality comaprer
      m_comparer=new CDefaultEqualityComparer<T>();
      m_delete_comparer=true;
     }
   else
     {
      //--- use specified comaprer
      m_comparer=comparer;
      m_delete_comparer=false;
     }
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- set capacity for elements of the collection
   int count=collection.Count();
   Initialize(count);
//--- add element from collection to the set
   this.UnionWith(collection);
   if((m_count==0 && ArraySize(m_slots)>3) ||
      (m_count>0 && ArraySize(m_slots)/m_count>3))
      TrimExcess();
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CHashSet<T> class that uses the|
//| default equality comparer for the set type, contains elements    |
//| copied from the specified array, and has sufficient capacity to  |
//| accommodate the number of elements copied.                       |
//+------------------------------------------------------------------+
template<typename T>
CHashSet::CHashSet(T &array[]): m_count(0),
                                m_last_index(0),
                                m_free_list(-1)
  {
//--- use default equality comaprer
   m_comparer=new CDefaultEqualityComparer<T>();
   m_delete_comparer=true;
//--- set capacity for elements of the array
   int count=ArraySize(array);
   Initialize(count);
//--- add element from array to the set
   this.UnionWith(array);
   if((m_count==0 && ArraySize(m_slots)>3) ||
      (m_count>0 && ArraySize(m_slots)/m_count>3))
      TrimExcess();
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CHashSet<T> class that uses the|
//| specified equality comparer for the set type, contains elements  |
//| copied from the specified array, and has sufficient capacity to  |
//| accommodate the number of elements copied.                       |
//+------------------------------------------------------------------+
template<typename T>
CHashSet::CHashSet(T &array[],IEqualityComparer<T>*comparer): m_count(0),
                                                              m_last_index(0),
                                                              m_free_list(-1)
  {
//--- check equality comaprer
   if(CheckPointer(comparer)==POINTER_INVALID)
     {
      //--- use default equality comaprer
      m_comparer=new CDefaultEqualityComparer<T>();
      m_delete_comparer=true;
     }
   else
     {
      //--- use specified comaprer
      m_comparer=comparer;
      m_delete_comparer=false;
     }
//--- set capacity for elements of the array
   int count=ArraySize(array);
   Initialize(count);
//--- add element from array to the set
   this.UnionWith(array);
   if((m_count==0 && ArraySize(m_slots)>3) ||
      (m_count>0 && ArraySize(m_slots)/m_count>3))
      TrimExcess();
  }
//+------------------------------------------------------------------+
//| Destructor.                                                      |
//+------------------------------------------------------------------+
template<typename T> CHashSet::~CHashSet(void)
  {
   if(m_delete_comparer)
      delete m_comparer;
  }
//+------------------------------------------------------------------+
//| Adds the specified element to a set.                             |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::Add(T value)
  {
   return AddIfNotPresent(value);
  }
//+------------------------------------------------------------------+
//| Determines whether a set contains the specified element.         |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::Contains(T item)
  {
//--- check buckets
   if(ArraySize(m_buckets)!=0)
     {
      //--- get hash code for item
      int hash_code=m_comparer.HashCode(item)&0x7FFFFFFF;
      //--- search item in the slots
      for(int i=m_buckets[hash_code%ArraySize(m_buckets)]-1; i>=0; i=m_slots[i].next)
         if(m_slots[i].hash_code==hash_code && m_comparer.Equals(m_slots[i].value,item))
            return(true);
     }
   return(false);
  }
//+------------------------------------------------------------------+
//| Sets the capacity of a set to the actual number of elements it   |
//| contains, rounded up to a nearby, implementation-specific value. |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::TrimExcess(void)
  {
   if(m_count==0)
     {
      ArrayFree(m_buckets);
      ArrayFree(m_slots);
     }
   else
     {
      //--- calculate min prime size for current count
      int new_size=CPrimeGenerator::GetPrime(m_count);
      //--- resize buckets and slots
      ArrayResize(m_slots,new_size);
      ArrayResize(m_buckets,new_size);
      //--- restore buckets and slots
      int new_index=0;
      for(int i=0; i<m_last_index; i++)
        {
         if(m_slots[i].hash_code>=0)
           {
            m_slots[new_index]=m_slots[i];
            //--- rehash
            int bucket=m_slots[new_index].hash_code%new_size;
            m_slots[new_index].next=m_buckets[bucket]-1;
            m_buckets[bucket]=new_index+1;
            //--- increment index
            new_index++;
           }
        }
      m_last_index=new_index;
      m_free_list=-1;
     }
  }
//+------------------------------------------------------------------+
//| Copies a range of elements from the set to a compatible          |
//| one-dimensional array.                                           |
//+------------------------------------------------------------------+
template<typename T>
int CHashSet::CopyTo(T &dst_array[],const int dst_start)
  {
//--- resize array
   if(dst_start+m_count>ArraySize(dst_array))
      ArrayResize(dst_array,dst_start+m_count);
//--- start copy
   int index=0;
   for(int i=0; i<ArraySize(m_slots); i++)
      if(m_slots[i].hash_code>=0)
        {
         if(dst_start+index>=ArraySize(dst_array) || index>=m_count)
            return(index);
         dst_array[dst_start+index++]=m_slots[i].value;
        }
   return(index);
  }
//+------------------------------------------------------------------+
//| Removes all elements from a set.                                 |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::Clear(void)
  {
   if(m_last_index>0)
     {
      ArrayFree(m_slots);
      ArrayFree(m_buckets);
      m_last_index=0;
      m_count=0;
      m_free_list=-1;
     }
  }
//+------------------------------------------------------------------+
//| Removes the specified element from a set.                        |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::Remove(T item)
  {
   if(ArraySize(m_buckets)!=0)
     {
      //--- get hash code for item
      int hash_code=m_comparer.HashCode(item)&0x7FFFFFFF;
      int bucket=hash_code%ArraySize(m_buckets);
      int last=-1;
      //--- search item
      for(int i=m_buckets[bucket]-1; i>=0; last=i,i=m_slots[i].next)
        {
         if(m_slots[i].hash_code==hash_code && m_comparer.Equals(m_slots[i].value,item))
           {
            if(last<0)
               m_buckets[bucket]=m_slots[i].next+1;
            else
               m_slots[last].next=m_slots[i].next;
            //--- remove item
            m_slots[i].hash_code=-1;
            m_slots[i].value=(T)NULL;
            m_slots[i].next =m_free_list;
            //--- decrement count
            m_count--;
            if(m_count==0)
              {
               m_last_index= 0;
               m_free_list = -1;
              }
            else
              {
               m_free_list=i;
              }
            return(true);
           }
        }
     }
   return(false);
  }
//+------------------------------------------------------------------+
//| Removes all elements in the specified collection from the current|
//| set.                                                             |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::ExceptWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- this is already the enpty set
   if(m_count==0)
      return;
//--- special case if collecion is this
//--- a set minus itself is the empty set
   if(collection==GetPointer(this))
     {
      Clear();
      return;
     }
//--- copy collection to array
   T array[];
   collection.CopyTo(array,0);
//--- remove every element in collection from this
   for(int i=0; i<ArraySize(array); i++)
      Remove(array[i]);
  }
//+------------------------------------------------------------------+
//| Removes all elements in the specified array from the current set.|
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::ExceptWith(T &array[])
  {
//--- this is already the enpty set
   if(m_count==0)
      return;
//--- remove every element in collection from this
   for(int i=0; i<ArraySize(array); i++)
      Remove(array[i]);
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present in that object and in the specified collection.          |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::IntersectWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- intersection of anything with empty set is empty set, so return if count is 0
   if(m_count==0)
      return;
//--- if collection is empty, intersection is empty set
   if(collection.Count()==0)
     {
      Clear();
      return;
     }
//--- intersect
   for(int i=0; i<m_last_index; i++)
     {
      if(m_slots[i].hash_code>=0)
        {
         T item=m_slots[i].value;
         if(!collection.Contains(item))
            Remove(item);
        }
     }
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present in that object and in the specified array.               |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::IntersectWith(T &array[])
  {
//--- intersection of anything with empty set is empty set, so return if count is 0
   if(m_count==0)
      return;
//--- if collection is empty, intersection is empty set
   if(ArraySize(array)==0)
     {
      Clear();
      return;
     }
//--- intersect
   CHashSet<T>set(array);
   for(int i=0; i<m_last_index; i++)
     {
      if(m_slots[i].hash_code>=0)
        {
         T item=m_slots[i].value;
         if(!set.Contains(item))
            Remove(item);
        }
     }
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present either in that set or in the specified collection, but   |
//| not both.                                                        |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::SymmetricExceptWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- if set is empty, then symmetric difference is other
   if(m_count==0)
     {
      UnionWith(collection);
      return;
     }
//--- special case this; the symmetric difference of a set with itself is the empty set
   if(collection==GetPointer(this))
     {
      Clear();
      return;
     }
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      InternalSymmetricExceptWith(ptr_set);
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      InternalSymmetricExceptWith(GetPointer(set));
     }
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present either in that set or in the specified array, but not    |
//| both.                                                            |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::SymmetricExceptWith(T &array[])
  {
//--- if set is empty, then symmetric difference is other
   if(m_count==0)
     {
      UnionWith(array);
      return;
     }
//--- symmetric except
   CHashSet<T>set(array);
   InternalSymmetricExceptWith(GetPointer(set));
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain all elements that are present|
//| in itself, the specified collection, or both.                    |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::UnionWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- get array from collection
   T array[];
   collection.CopyTo(array);
//--- union array with the current set
   UnionWith(array);
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain all elements that are present|
//| in itself, the specified array, or both.                         |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::UnionWith(T &array[])
  {
   for(int i=0; i<ArraySize(array); i++)
      AddIfNotPresent(array[i]);
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper subset of the specified     |
//| collection.                                                      |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsProperSubsetOf(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(false);
//--- the empty set is a proper subset of anything but the empty set
   if(m_count==0)
      return(collection.Count()>0);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return InternalIsProperSubsetOf(ptr_set);
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return InternalIsProperSubsetOf(GetPointer(set));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper subset of the specified     |
//| array.                                                           |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsProperSubsetOf(T &array[])
  {
//--- the empty set is a proper subset of anything but the empty set
   if(m_count==0)
      return(ArraySize(array)>0);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   return InternalIsProperSubsetOf(GetPointer(set));
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper superset of the specified   |
//| collection.                                                      |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsProperSupersetOf(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(m_count>0);
//--- the empty set is a proper subset of anything but the empty set
   if(m_count==0)
      return(false);
//--- if other is the empty set then this is a superset
   if(collection.Count()==0)
      return(true);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return InternalIsProperSupersetOf(ptr_set);
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return InternalIsProperSupersetOf(GetPointer(set));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper superset of the specified   |
//| array.                                                           |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsProperSupersetOf(T &array[])
  {
//--- the empty set is a proper subset of anything but the empty set
   if(m_count==0)
      return(false);
//--- if other is the empty set then this is a superset
   if(ArraySize(array)==0)
      return(true);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   return InternalIsProperSupersetOf(GetPointer(set));
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a subset of the specified collection.|
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsSubsetOf(ICollection<T>*collection)
  {
   if(CheckPointer(collection)==POINTER_INVALID)
      return(m_count==0);
//--- The empty set is a subset of any set
   if(m_count==0)
      return(true);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return InternalIsSubsetOf(ptr_set);
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return InternalIsSubsetOf(GetPointer(set));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a subset of the specified array.     |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsSubsetOf(T &array[])
  {
//--- The empty set is a subset of any set
   if(m_count==0)
      return(true);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   return InternalIsSubsetOf(GetPointer(set));
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a superset of the specified          |
//| collection.                                                      |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsSupersetOf(ICollection<T>*collection)
  {
   if(CheckPointer(collection)==POINTER_INVALID)
      return(m_count>=0);
//--- if other is the empty set then this is a superset
   if(collection.Count()==0)
      return(true);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return InternalIsSupersetOf(ptr_set);
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return InternalIsSupersetOf(GetPointer(set));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a superset of the specified array.   |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::IsSupersetOf(T &array[])
  {
//--- if other is the empty set then this is a superset
   if(ArraySize(array)==0)
      return(true);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   return InternalIsSupersetOf(GetPointer(set));
  }
//+------------------------------------------------------------------+
//| Determines whether the current set and a specified collection    |
//| share common elements.                                           |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::Overlaps(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(false);
//--- check current count
   if(m_count==0)
      return(false);
//--- get array from collection
   T array[];
   collection.CopyTo(array);
//--- check overlaps between current set and array
   return Overlaps(array);
  }
//+------------------------------------------------------------------+
//| Determines whether the current set and a specified array share   |
//| common elements.                                                 |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::Overlaps(T &array[])
  {
//--- check current count
   if(m_count==0)
      return(false);
//--- try to find any elements from specified array in current set
   for(int i=0; i<ArraySize(array); i++)
      if(Contains(array[i]))
         return(true);
   return(false);
  }
//+------------------------------------------------------------------+
//| Determines whether a set and the specified collection contain the|
//| same elements.                                                   |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::SetEquals(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(false);
//--- check current set is equal specified collection
   if(collection==GetPointer(this))
      return(true);
//--- get array from collection
   T array[];
   collection.CopyTo(array);
//--- check current set is equal specified array
   return SetEquals(array);
  }
//+------------------------------------------------------------------+
//| Determines whether a set and the specified array contain the same|
//| elements.                                                        |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::SetEquals(T &array[])
  {
//--- check size
   if(ArraySize(array)!=m_count)
      return(false);
//--- check current set is equal specified array
   for(int i=0; i<ArraySize(array); i++)
      if(!Contains(array[i]))
         return(false);
   return(true);
  }
//+------------------------------------------------------------------+
//| Set the underlying buckets array to size new_size and rehash.    |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::SetCapacity(const int new_size,bool new_hash_codes)
  {
//--- resize slots
   ArrayResize(m_slots,new_size);
//--- restore slots
   if(new_hash_codes)
      for(int i=0; i<m_last_index; i++)
         if(m_slots[i].hash_code!=-1)
            m_slots[i].hash_code=m_comparer.HashCode(m_slots[i].value)&0x7FFFFFFF;
//--- resize buckets
   ArrayResize(m_buckets,new_size);
   ArrayFill(m_buckets,0,new_size,0);
//--- restore buckets
   for(int i=0; i<m_last_index; i++)
     {
      int bucket=m_slots[i].hash_code%new_size;
      m_slots[i].next=m_buckets[bucket]-1;
      m_buckets[bucket]=i+1;
     }
  }
//+------------------------------------------------------------------+
//| Adds value to set if not contained already. Returns true if added|
//| and false if already present.                                    |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::AddIfNotPresent(T value)
  {
//--- set minimum capacity
   if(ArraySize(m_buckets)==0)
      Initialize(0);
//--- get hash code and bucket for value
   int hash_code=m_comparer.HashCode(value)&0x7FFFFFFF;
   int bucket=hash_code%ArraySize(m_buckets);
//--- check value already in the set
   for(int i=m_buckets[hash_code%ArraySize(m_buckets)]-1; i>=0; i=m_slots[i].next)
      if(m_slots[i].hash_code==hash_code && m_comparer.Equals(m_slots[i].value,value))
         return(false);
//--- calculate index for value
   int index=0;
   if(m_free_list>=0)
     {
      index=m_free_list;
      m_free_list=m_slots[index].next;
     }
   else
     {
      if(m_last_index==ArraySize(m_slots))
        {
         int new_size=CPrimeGenerator::ExpandPrime(m_count);
         SetCapacity(new_size,false);
         bucket=hash_code%ArraySize(m_buckets);
        }
      index=m_last_index;
      m_last_index++;
     }
//--- set value
   m_slots[index].hash_code=hash_code;
   m_slots[index].value=value;
   m_slots[index].next=m_buckets[bucket]-1;
   m_buckets[bucket]=index+1;
//--- increase count
   m_count++;
   return(true);
  }
//+------------------------------------------------------------------+
//| Initialize set with specified capacity.                          |
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::Initialize(const int capacity)
  {
   int size=CPrimeGenerator::GetPrime(capacity);
   ArrayResize(m_buckets,size);
   ArrayResize(m_slots,size);
   ZeroMemory(m_buckets);
   ZeroMemory(m_slots);
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present either in that set or in the specified set, but not both.|
//+------------------------------------------------------------------+
template<typename T>
void CHashSet::InternalSymmetricExceptWith(CHashSet<T>*set)
  {
   for(int i=0; i<ArraySize(set.m_slots); i++)
     {
      T item=set.m_slots[i].value;
      if(!Remove(item))
         AddIfNotPresent(item);
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a subset of the specified set.       |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::InternalIsSubsetOf(CHashSet<T>*set)
  {
//--- if this has more elements then it can't be a subset
   if(m_count>set.m_count)
      return(false);
//--- try to find any elements from current set in specified set
   for(int i=0; i<m_count; i++)
     {
      T item=m_slots[i].value;
      if(!set.Contains(item))
         return(false);
     }
   return(true);
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a superset of the specified set.     |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::InternalIsSupersetOf(CHashSet<T>*set)
  {
//--- if this has less elements then it can't be a superset
   if(set.m_count>m_count)
      return(false);
//--- try to find any elements from specified set in current set
   for(int i=0; i<set.m_count; i++)
     {
      T item=set.m_slots[i].value;
      if(!Contains(item))
         return(false);
     }
   return(true);
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper subset of the specified set.|
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::InternalIsProperSubsetOf(CHashSet<T>*set)
  {
//--- if this has more or equal elements then it can't be a proper subset
   if(m_count>=set.m_count)
      return(false);
//--- try to find any elements from current set in specified set
   for(int i=0; i<m_count; i++)
     {
      T item=m_slots[i].value;
      if(!set.Contains(item))
         return(false);
     }
   return(true);
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper superset of the specified   |
//| set.                                                             |
//+------------------------------------------------------------------+
template<typename T>
bool CHashSet::InternalIsProperSupersetOf(CHashSet<T>*set)
  {
//--- if this has less or equal elements then it can't be a proper superset
   if(m_count<=set.m_count)
      return(false);
//--- try to find any elements from specified set in current set
   for(int i=0; i<set.m_count; i++)
     {
      T item=set.m_slots[i].value;
      if(!Contains(item))
         return(false);
     }
   return(true);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                  ICollection.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Interface ICollection<T>.                                        |
//| Usage: Defines methods to manipulate generic collections.        |
//+------------------------------------------------------------------+
template<typename T>
interface ICollection
  {
//--- methods of filling data 
   bool      Add(T value);
//--- methods of access to protected data
   int       Count(void);
   bool      Contains(T item);
//--- methods of copy data from collection   
   int       CopyTo(T &dst_array[],const int dst_start=0);
//--- methods of cleaning and removing
   void      Clear(void);
   bool      Remove(T item);
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                    IComparer.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Interface IComparer<T>.                                          |
//| Usage: Defines a method that a type implements to compare two    |
//|        values.                                                   |
//+------------------------------------------------------------------+
template<typename T>
interface IComparer
  {
//--- compares two values and returns a value indicating whether one is less than, equal to, or greater than the other
   int       Compare(T x,T y);
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                          IEqualityComparable.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Interface IEqualityComparable<T>.                                |
//| Usage: Defines a generalized method to create a type-specific    |
//| method for determining equality of instances.                    |
//+------------------------------------------------------------------+
template<typename T>
interface IEqualityComparable
  {
//--- method for determining equality
   bool              Equals(T value);
//--- method to calculate hash code   
   int               HashCode(void);
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                  IComparable.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "IEqualityComparable.mqh"
//+------------------------------------------------------------------+
//| Interface IComparable<T>.                                        |
//| Usage: Defines a generalized comparison method to create a       |
//| type-specific comparison method for ordering or sorting          |
//| instances.                                                       |
//+------------------------------------------------------------------+
template<typename T>
interface IComparable: public IEqualityComparable<T>
  {
//--- method for determining compare
   int       Compare(T value);
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                         ISet.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "ICollection.mqh"
//+------------------------------------------------------------------+
//| Interface ISet<T>.                                               |
//| Usage: Provides the base interface for the abstraction of sets.  |
//+------------------------------------------------------------------+
template<typename T>
interface ISet: public ICollection<T>
  {
//--- methods of changing sets
   void              ExceptWith(ICollection<T>*collection);
   void              ExceptWith(T &array[]);
   void              IntersectWith(ICollection<T>*collection);
   void              IntersectWith(T &array[]);
   void              SymmetricExceptWith(ICollection<T>*collection);
   void              SymmetricExceptWith(T &array[]);
   void              UnionWith(ICollection<T>*collection);
   void              UnionWith(T &array[]);
//--- methods for determining the relationship between sets
   bool              IsProperSubsetOf(ICollection<T>*collection);
   bool              IsProperSubsetOf(T &array[]);
   bool              IsProperSupersetOf(ICollection<T>*collection);
   bool              IsProperSupersetOf(T &array[]);
   bool              IsSubsetOf(ICollection<T>*collection);
   bool              IsSubsetOf(T &array[]);
   bool              IsSupersetOf(ICollection<T>*collection);
   bool              IsSupersetOf(T &array[]);
   bool              Overlaps(ICollection<T>*collection);
   bool              Overlaps(T &array[]);
   bool              SetEquals(ICollection<T>*collection);
   bool              SetEquals(T &array[]);
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                            IEqualityComparer.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Interface IEqualityComparer<T>.                                  |
//| Usage: Defines methods to support the comparison of values for   |
//|        equality.                                                 |
//+------------------------------------------------------------------+
template<typename T>
interface IEqualityComparer
  {
//--- determines whether the specified values are equal
   bool      Equals(T x,T y);
//--- returns a hash code for the specified object
   int       HashCode(T value);
  };
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                   R e d B l a c k T r e e . m q h   |  
 / / |                                                           C o p y r i g h t   2 0 0 0 - 2 0 2 4 ,   M e t a Q u o t e s   L t d .   |  
 / / |                                                                                           h t t p s : / / w w w . m q l 5 . c o m   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   < G e n e r i c \ I n t e r f a c e s \ I C o l l e c t i o n . m q h >  
 # i n c l u d e   < G e n e r i c \ I n t e r n a l \ D e f a u l t C o m p a r e r . m q h >  
 # i n c l u d e   < G e n e r i c \ I n t e r n a l \ A r r a y F u n c t i o n . m q h >  
 # i n c l u d e   < G e n e r i c \ I n t e r f a c e s \ I C o m p a r e r . m q h >  
 # i n c l u d e   " S t a c k . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E n u m   E N U M _ R E D _ B L A C K _ T R E E _ N O D E _ T Y P E .                                                             |  
 / / |   U s a g e :   D e f i n e s   p o s s i b l e   n o d e   c o l o r s   f o r   r e d   b l a c k   t r e e .                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 e n u m   E N U M _ R E D _ B L A C K _ T R E E _ N O D E _ T Y P E  
     {  
       R E D _ B L A C K _ T R E E _ N O D E _ R E D = 0 ,  
       R E D _ B L A C K _ T R E E _ N O D E _ B L A C K = 1  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C l a s s   C R e d B l a c k T r e e N o d e < T > .                                                                             |  
 / / |   U s a g e :   R e p r e s e n t s   a   n o d e   o f   r e d   b l a c k   t r e e .                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 c l a s s   C R e d B l a c k T r e e N o d e  
     {  
 p r i v a t e :  
       T                                   m _ v a l u e ;  
       C R e d B l a c k T r e e N o d e < T > * m _ l e f t ;  
       C R e d B l a c k T r e e N o d e < T > * m _ r i g h t ;  
       C R e d B l a c k T r e e N o d e < T > * m _ p a r e n t ;  
       E N U M _ R E D _ B L A C K _ T R E E _ N O D E _ T Y P E   m _ c l r ;  
  
 p u b l i c :  
                                           C R e d B l a c k T r e e N o d e ( v o i d ) ;  
                                           C R e d B l a c k T r e e N o d e ( T   v a l u e ) ;  
                                         ~ C R e d B l a c k T r e e N o d e ( v o i d ) ;  
  
       / / - - -   m e t h o d s   o f   a c c e s s   t o   p r o t e c t e d   d a t a  
       T                                   V a l u e ( v o i d )                                                   {   r e t u r n ( m _ v a l u e ) ;     }  
       v o i d                             V a l u e ( T   v a l u e )                                             {   m _ v a l u e = v a l u e ;         }  
       C R e d B l a c k T r e e N o d e < T >       * P a r e n t ( v o i d )                                                 {   r e t u r n ( m _ p a r e n t ) ;   }  
       v o i d                             P a r e n t ( C R e d B l a c k T r e e N o d e < T > * n o d e )                   {   m _ p a r e n t = n o d e ;         }  
       C R e d B l a c k T r e e N o d e < T >       * L e f t ( v o i d )                                                     {   r e t u r n ( m _ l e f t ) ;       }  
       v o i d                             L e f t ( C R e d B l a c k T r e e N o d e < T > * n o d e )                       {   m _ l e f t = n o d e ;             }  
       C R e d B l a c k T r e e N o d e < T >       * R i g h t ( v o i d )                                                   {   r e t u r n ( m _ r i g h t ) ;     }  
       v o i d                             R i g h t ( C R e d B l a c k T r e e N o d e < T > * n o d e )                     {   m _ r i g h t = n o d e ;           }  
       E N U M _ R E D _ B L A C K _ T R E E _ N O D E _ T Y P E   C o l o r ( v o i d )                                           {   r e t u r n ( m _ c l r ) ;         }  
       v o i d                             C o l o r ( E N U M _ R E D _ B L A C K _ T R E E _ N O D E _ T Y P E   c l r )         {   m _ c l r = c l r ;                 }  
       / / - - -   c h e c k   n o d e   i s   e m p t y    
       b o o l                             I s L e a f ( v o i d ) ;  
       / / - - -   c r e a t e   n e w   e m p t y   n o d e  
       s t a t i c                         C R e d B l a c k T r e e N o d e < T > * C r e a t e E m p t y N o d e ( v o i d ) ;  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e N o d e < T >   c l a s s   t h a t |  
 / / |   i s   e m p t y .                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e : : C R e d B l a c k T r e e N o d e ( v o i d )   :   m _ c l r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D )  
     {  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e N o d e < T >   c l a s s   w i t h |  
 / / |   s p e c i f i e d   v a l u e .                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e : : C R e d B l a c k T r e e N o d e ( T   v a l u e )  
     {  
       m _ v a l u e = v a l u e ;  
       m _ c l r = R E D _ B L A C K _ T R E E _ N O D E _ R E D ;  
       m _ l e f t = C r e a t e E m p t y N o d e ( ) ;  
       m _ r i g h t = C r e a t e E m p t y N o d e ( ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   D e s t r u c t o r .                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e : : ~ C R e d B l a c k T r e e N o d e ( v o i d )  
     {  
       i f ( C h e c k P o i n t e r ( m _ l e f t ) = = P O I N T E R _ D Y N A M I C )  
             d e l e t e   m _ l e f t ;  
       i f ( C h e c k P o i n t e r ( m _ r i g h t ) = = P O I N T E R _ D Y N A M I C )  
             d e l e t e   m _ r i g h t ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C h e c k   n o d e   i s   e m p t y .                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e N o d e : : I s L e a f ( v o i d )  
     {  
       r e t u r n ( m _ c l r = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K   & &  
                     C h e c k P o i n t e r ( m _ l e f t ) = = P O I N T E R _ I N V A L I D   & &    
                     C h e c k P o i n t e r ( m _ r i g h t ) = = P O I N T E R _ I N V A L I D ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C r e a t e   n e w   e m p t y   b l a c k   n o d e .                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e < T > * C R e d B l a c k T r e e N o d e : : C r e a t e E m p t y N o d e ( v o i d )  
     {  
       C R e d B l a c k T r e e N o d e < T > * n e w _ n o d e = n e w   C R e d B l a c k T r e e N o d e < T > ( ) ;  
       n e w _ n o d e . m _ c l r = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ;  
       n e w _ n o d e . m _ p a r e n t = N U L L ;  
       n e w _ n o d e . m _ l e f t = N U L L ;  
       n e w _ n o d e . m _ r i g h t = N U L L ;  
 / / - - -   r e t u r n   n e w   e m p t y   n o d e  
       r e t u r n ( n e w _ n o d e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C l a s s   C R e d B l a c k T r e e < T > .                                                                                     |  
 / / |   U s a g e :   A   r e d  b l a c k   t r e e   i s   a   d a t a   s t r u c t u r e   w h i c h   i s   a   t y p e   o f       |  
 / / |                 s e l f - b a l a n c i n g   b i n a r y   s e a r c h   t r e e .                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 c l a s s   C R e d B l a c k T r e e :   p u b l i c   I C o l l e c t i o n < T >  
     {  
 p r o t e c t e d :  
       C R e d B l a c k T r e e N o d e < T > * m _ r o o t _ n o d e ;  
       C R e d B l a c k T r e e N o d e < T > * m _ l a s t _ n o d e ;  
       I C o m p a r e r < T > * m _ c o m p a r e r ;  
       i n t                               m _ c o u n t ;  
       b o o l                             m _ d e l e t e _ c o m p a r e r ;  
  
 p u b l i c :  
                                           C R e d B l a c k T r e e ( v o i d ) ;  
                                           C R e d B l a c k T r e e ( I C o m p a r e r < T > * c o m p a r e r ) ;  
                                           C R e d B l a c k T r e e ( I C o l l e c t i o n < T > * c o l l e c t i o n ) ;  
                                           C R e d B l a c k T r e e ( I C o l l e c t i o n < T > * c o l l e c t i o n , I C o m p a r e r < T > * c o m p a r e r ) ;  
                                           C R e d B l a c k T r e e ( T   & a r r a y [ ] ) ;  
                                           C R e d B l a c k T r e e ( T   & a r r a y [ ] , I C o m p a r e r < T > * c o m p a r e r ) ;  
                                         ~ C R e d B l a c k T r e e ( v o i d ) ;  
       / / - - -   m e t h o d s   o f   f i l l i n g   d a t a    
       b o o l                             A d d ( T   v a l u e ) ;  
       / / - - -   m e t h o d s   o f   a c c e s s   t o   p r o t e c t e d   d a t a  
       C R e d B l a c k T r e e N o d e < T > * R o o t ( v o i d )           {   r e t u r n ( m _ r o o t _ n o d e ) ;   }  
       i n t                               C o u n t ( v o i d )               {   r e t u r n ( m _ c o u n t ) ;           }  
       b o o l                             C o n t a i n s ( T   i t e m ) ;  
       I C o m p a r e r < T >           * C o m p a r e r ( v o i d )   c o n s t   {   r e t u r n ( m _ c o m p a r e r ) ;   }  
       b o o l                             T r y G e t M i n ( T   & m i n ) ;  
       b o o l                             T r y G e t M a x ( T   & m a x ) ;  
       / / - - -   m e t h o d s   o f   c o p y   d a t a   f r o m   c o l l e c t i o n        
       i n t                               C o p y T o ( T   & d s t _ a r r a y [ ] , c o n s t   i n t   d s t _ s t a r t = 0 ) ;  
       / / - - -   m e t h o d s   o f   c l e a n i n g   a n d   r e m o v i n g  
       v o i d                             C l e a r ( v o i d ) ;  
       b o o l                             R e m o v e ( T   v a l u e ) ;  
       b o o l                             R e m o v e ( C R e d B l a c k T r e e N o d e < T > * n o d e ) ;  
       b o o l                             R e m o v e M i n ( v o i d ) ;  
       b o o l                             R e m o v e M a x ( v o i d ) ;  
       / / - - -   m e t h o d   f o r   s e a r c h i n g  
       C R e d B l a c k T r e e N o d e < T > * F i n d ( T   v a l u e ) ;  
       C R e d B l a c k T r e e N o d e < T > * F i n d M a x ( v o i d ) ;  
       C R e d B l a c k T r e e N o d e < T > * F i n d M i n ( v o i d ) ;  
  
 p r i v a t e :  
       v o i d                             R o t a t e R i g h t ( C R e d B l a c k T r e e N o d e < T > * r o t a t e _ n o d e ) ;  
       v o i d                             R o t a t e L e f t ( C R e d B l a c k T r e e N o d e < T > * r o t a t e _ n o d e ) ;  
       v o i d                             B a l a n c e T r e e A f t e r I n s e r t ( C R e d B l a c k T r e e N o d e < T > * i n s e r t _ n o d e ) ;  
       v o i d                             B a l a n c e T r e e A f t e r D e l e t e ( C R e d B l a c k T r e e N o d e < T > * l i n k e d _ n o d e ) ;  
       s t a t i c   v o i d               W a l k N e x t L e v e l ( C R e d B l a c k T r e e N o d e < T > * n o d e , T   & a r r a y [ ] , i n t   & i n d e x ) ;  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e < T >   c l a s s   t h a t   i s   |  
 / / |   e m p t y   a n d   u s e s   t h e   s p e c i f i e d   c o m p a r e r .                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : C R e d B l a c k T r e e ( v o i d ) :   m _ c o u n t ( 0 )  
     {  
 / / - - -   u s e   d e f a u l t   c o m a p r e r  
       m _ c o m p a r e r = n e w   C D e f a u l t C o m p a r e r < T > ( ) ;  
       m _ d e l e t e _ c o m p a r e r = t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e < T >   c l a s s   t h a t   i s   |  
 / / |   e m p t y   a n d   u s e s   t h e   s p e c i f i e d   c o m p a r e r .                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : C R e d B l a c k T r e e ( I C o m p a r e r < T > * c o m p a r e r ) :   m _ c o u n t ( 0 )  
     {  
 / / - - -   c h e c k   c o m a p r e r  
       i f ( C h e c k P o i n t e r ( c o m p a r e r ) = = P O I N T E R _ I N V A L I D )  
           {  
             / / - - -   u s e   d e f a u l t   c o m a p r e r  
             m _ c o m p a r e r = n e w   C D e f a u l t C o m p a r e r < T > ( ) ;  
             m _ d e l e t e _ c o m p a r e r = t r u e ;  
           }  
       e l s e  
           {  
             / / - - -   u s e   s p e c i f i e d   e q u a l i t y   c o m a p r e r  
             m _ c o m p a r e r = c o m p a r e r ;  
             m _ d e l e t e _ c o m p a r e r = f a l s e ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e < T >   c l a s s   t h a t         |  
 / / |   u s e s   t h e   d e f a u l t   e q u a l i t y   c o m p a r e r ,   c o n t a i n s   e l e m e n t s   c o p i e d   f r o m |  
 / / |   t h e   s p e c i f i e d   c o l l e c t i o n .                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : C R e d B l a c k T r e e ( I C o l l e c t i o n < T > * c o l l e c t i o n ) :   m _ c o u n t ( 0 )  
     {  
 / / - - -   u s e   d e f a u l t   c o m a p r e r  
       m _ c o m p a r e r = n e w   C D e f a u l t C o m p a r e r < T > ( ) ;  
       m _ d e l e t e _ c o m p a r e r = t r u e ;  
 / / - - -   c h e c k   c o l l e c t i o n  
       i f ( C h e c k P o i n t e r ( c o l l e c t i o n ) = = P O I N T E R _ I N V A L I D )  
             r e t u r n ;  
 / / - - -   c o p y   a l l   e l e m e n t s   f r o m   s p e c i f i e d   c o l l e c t i o n   t o   a r r a y  
       T   a r r a y [ ] ;  
       i n t   s i z e = c o l l e c t i o n . C o p y T o ( a r r a y ) ;  
 / / - - -   f i l l   r e d   b l a c k   t r e e   b y   e l e m e n t s   f r o m   t h e   a r r a y  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             A d d ( a r r a y [ i ] ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e < T >   c l a s s   t h a t         |  
 / / |   u s e s   t h e   s p e c i f i e d   c o m p a r e r   a n d   c o n t a i n s   e l e m e n t s     c o p i e d   f r o m       |  
 / / |   t h e   s p e c i f i e d   c o l l e c t i o n .                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : C R e d B l a c k T r e e ( I C o l l e c t i o n < T > * c o l l e c t i o n , I C o m p a r e r < T > * c o m p a r e r ) :   m _ c o u n t ( 0 )  
     {  
 / / - - -   c h e c k   c o m a p r e r  
       i f ( C h e c k P o i n t e r ( c o m p a r e r ) = = P O I N T E R _ I N V A L I D )  
           {  
             / / - - -   u s e   d e f a u l t   c o m a p r e r  
             m _ c o m p a r e r = n e w   C D e f a u l t C o m p a r e r < T > ( ) ;  
             m _ d e l e t e _ c o m p a r e r = t r u e ;  
           }  
       e l s e  
           {  
             / / - - -   u s e   s p e c i f i e d   e q u a l i t y   c o m a p r e r  
             m _ c o m p a r e r = c o m p a r e r ;  
             m _ d e l e t e _ c o m p a r e r = f a l s e ;  
           }  
 / / - - -   c h e c k   c o l l e c t i o n  
       i f ( C h e c k P o i n t e r ( c o l l e c t i o n ) = = P O I N T E R _ I N V A L I D )  
             r e t u r n ;  
 / / - - -   c o p y   a l l   e l e m e n t s   f r o m   s p e c i f i e d   c o l l e c t i o n   t o   a r r a y  
       T   a r r a y [ ] ;  
       i n t   s i z e = c o l l e c t i o n . C o p y T o ( a r r a y ) ;  
 / / - - -   f i l l   r e d   b l a c k   t r e e   b y   e l e m e n t s   f r o m   t h e   a r r a y  
       f o r ( i n t   i = 0 ;   i < s i z e ;   i + + )  
             A d d ( a r r a y [ i ] ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e < T >   c l a s s   t h a t         |  
 / / |   u s e s   t h e   d e f a u l t   e q u a l i t y   c o m p a r e r   a n d   c o n t a i n s   e l e m e n t s   c o p i e d     |  
 / / |   f r o m   t h e   s p e c i f i e d   a r r a y .                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : C R e d B l a c k T r e e ( T   & a r r a y [ ] ) :   m _ c o u n t ( 0 )  
     {  
 / / - - -   u s e   d e f a u l t   c o m a p r e r  
       m _ c o m p a r e r = n e w   C D e f a u l t C o m p a r e r < T > ( ) ;  
       m _ d e l e t e _ c o m p a r e r = t r u e ;  
 / / - - -   f i l l   r e d   b l a c k   t r e e   b y   e l e m e n t s   f r o m   t h e   s p e c i f i e d   a r r a y  
       f o r ( i n t   i = 0 ;   i < A r r a y S i z e ( a r r a y ) ;   i + + )  
             A d d ( a r r a y [ i ] ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z e s   a   n e w   i n s t a n c e   o f   t h e   C R e d B l a c k T r e e < T >   c l a s s   t h a t         |  
 / / |   u s e s   t h e   s p e c i f i e d   c o m p a r e r   a n d   c o n t a i n s   e l e m e n t s     c o p i e d   f r o m       |  
 / / |   t h e   s p e c i f i e d   a r r a y .                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : C R e d B l a c k T r e e ( T   & a r r a y [ ] , I C o m p a r e r < T > * c o m p a r e r ) :   m _ c o u n t ( 0 )  
     {  
 / / - - -   c h e c k   c o m a p r e r  
       i f ( C h e c k P o i n t e r ( c o m p a r e r ) = = P O I N T E R _ I N V A L I D )  
           {  
             / / - - -   u s e   d e f a u l t   c o m a p r e r  
             m _ c o m p a r e r = n e w   C D e f a u l t C o m p a r e r < T > ( ) ;  
             m _ d e l e t e _ c o m p a r e r = t r u e ;  
           }  
       e l s e  
           {  
             / / - - -   u s e   s p e c i f i e d   e q u a l i t y   c o m a p r e r  
             m _ c o m p a r e r = c o m p a r e r ;  
             m _ d e l e t e _ c o m p a r e r = f a l s e ;  
           }  
 / / - - -   f i l l   r e d   b l a c k   t r e e   b y   e l e m e n t s   f r o m   t h e   s p e c i f i e d   a r r a y  
       f o r ( i n t   i = 0 ;   i < A r r a y S i z e ( a r r a y ) ;   i + + )  
             A d d ( a r r a y [ i ] ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   D e s t r u c t o r .                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e : : ~ C R e d B l a c k T r e e ( v o i d )  
     {  
 / / - - -   d e l e t e   c o m p a r e r  
       i f ( m _ d e l e t e _ c o m p a r e r )  
             d e l e t e   m _ c o m p a r e r ;  
 / / - - -   c l e a r   t r e e  
       C l e a r ( ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A d d s   a   n e w   i t e m   t o   t h e   t r e e .   I f   t h e   e l e m e n t   a l r e a d y   b e l o n g s   t o       |  
 / / |   t h i s   t r e e ,   n o   n e w   e l e m e n t   w i l l   b e   a d d e d .                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : A d d ( T   v a l u e )  
     {  
 / / - - -   t r a v e r s e   t r e e   -   f i n d   n o d e   b e l o w  
       i f ( C h e c k P o i n t e r ( F i n d ( v a l u e ) ) ! = P O I N T E R _ I N V A L I D )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c r e a t e   n e w   n o d e  
       C R e d B l a c k T r e e N o d e < T > * n e w _ n o d e = n e w   C R e d B l a c k T r e e N o d e < T > ( v a l u e ) ;  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = m _ r o o t _ n o d e ;  
       w h i l e ( C h e c k P o i n t e r ( w o r k _ n o d e ) ! = P O I N T E R _ I N V A L I D   & &   ! w o r k _ n o d e . I s L e a f ( ) )  
           {  
             / / - - -   f i n d   p a r e n t  
             n e w _ n o d e . P a r e n t ( w o r k _ n o d e ) ;  
             i n t   r e s u l t =   m _ c o m p a r e r . C o m p a r e ( v a l u e ,   w o r k _ n o d e . V a l u e ( ) ) ;  
             i f ( r e s u l t   = =   0 )  
                 {  
                   / / - - -   n o d e   w i t h   s a m e   v a l u e   a l r e a d y   e x i s t s  
                   r e t u r n ( f a l s e ) ;  
                 }  
             w o r k _ n o d e = ( r e s u l t > 0   ?   w o r k _ n o d e . R i g h t ( )   :   w o r k _ n o d e . L e f t ( ) ) ;  
           }  
 / / - - -   i n s e r t   n o d e   i n t o   t r e e   s t a r t i n g   a t   p a r e n t ' s   l o c a t i o n  
       i f ( C h e c k P o i n t e r ( n e w _ n o d e . P a r e n t ( ) ) ! = P O I N T E R _ I N V A L I D )  
           {  
             i f ( m _ c o m p a r e r . C o m p a r e ( n e w _ n o d e . V a l u e ( ) , n e w _ n o d e . P a r e n t ( ) . V a l u e ( ) ) > 0 )  
                 {  
                   i f ( C h e c k P o i n t e r ( n e w _ n o d e . P a r e n t ( ) . R i g h t ( ) ) = = P O I N T E R _ D Y N A M I C   & &   n e w _ n o d e . P a r e n t ( ) . R i g h t ( ) . I s L e a f ( ) )  
                         d e l e t e   n e w _ n o d e . P a r e n t ( ) . R i g h t ( ) ;  
                   n e w _ n o d e . P a r e n t ( ) . R i g h t ( n e w _ n o d e ) ;  
                 }  
             e l s e  
                 {  
                   i f ( C h e c k P o i n t e r ( n e w _ n o d e . P a r e n t ( ) . L e f t ( ) ) = = P O I N T E R _ D Y N A M I C   & &   n e w _ n o d e . P a r e n t ( ) . L e f t ( ) . I s L e a f ( ) )  
                         d e l e t e   n e w _ n o d e . P a r e n t ( ) . L e f t ( ) ;  
                   n e w _ n o d e . P a r e n t ( ) . L e f t ( n e w _ n o d e ) ;  
                 }  
           }  
       e l s e  
           {  
             / / - - -   f i r s t   n o d e   a d d e d  
             m _ r o o t _ n o d e = n e w _ n o d e ;  
           }  
 / / - - -   r e s t o r e   r e d - b l a c k   p r o p e r t i e s  
       B a l a n c e T r e e A f t e r I n s e r t ( n e w _ n o d e ) ;  
       m _ l a s t _ n o d e = n e w _ n o d e ;  
 / / - - -   i n c r e m e n t   c o u n t    
       m _ c o u n t + + ;  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   D e t e r m i n e s   w h e t h e r   t h i s   t r e e   c o n t a i n s   t h e   s p e c i f i e d   i t e m .                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : C o n t a i n s ( T   i t e m )  
     {  
       C R e d B l a c k T r e e N o d e < T > * t r e e _ n o d e = F i n d ( i t e m ) ;  
       r e t u r n ( C h e c k P o i n t e r ( t r e e _ n o d e ) ! = P O I N T E R _ I N V A L I D ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   F i n d s   t h e   m i n i m u m   e l e m e n t   s t o r e d   i n   t h e   t r e e .                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : T r y G e t M i n ( T   & m i n )  
     {  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = m _ r o o t _ n o d e ;  
 / / - - -   c h e c k   t r e e   i s   e m p t y  
       i f ( C h e c k P o i n t e r ( w o r k _ n o d e ) = = P O I N T E R _ I N V A L I D   | |   w o r k _ n o d e . I s L e a f ( ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   t r a v e r s e   t o   t h e   e x t r e m e   l e f t   t o   f i n d   t h e   s m a l l e s t   k e y  
       w h i l e ( ! w o r k _ n o d e . L e f t ( ) . I s L e a f ( ) )  
             w o r k _ n o d e = w o r k _ n o d e . L e f t ( ) ;  
 / / - - -   s t o r e   m i n   v a l u e  
       m _ l a s t _ n o d e = w o r k _ n o d e ;  
       m i n = w o r k _ n o d e . V a l u e ( ) ;  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   F i n d s   t h e   m a x i m u m   e l e m e n t   s t o r e d   i n   t h e   t r e e .                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : T r y G e t M a x ( T   & m a x )  
     {  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = m _ r o o t _ n o d e ;  
 / / - - -   c h e c k   t r e e   i s   e m p t y  
       i f ( C h e c k P o i n t e r ( w o r k _ n o d e ) = = P O I N T E R _ I N V A L I D   | |   w o r k _ n o d e . I s L e a f ( ) )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   t r a v e r s e   t o   t h e   e x t r e m e   r i g h t   t o   f i n d   t h e   l a r g e s t   k e y  
       w h i l e ( ! w o r k _ n o d e . R i g h t ( ) . I s L e a f ( ) )  
             w o r k _ n o d e = w o r k _ n o d e . R i g h t ( ) ;  
 / / - - -   s t o r e   m a x   v a l u e  
       m _ l a s t _ n o d e = w o r k _ n o d e ;  
       m a x = w o r k _ n o d e . V a l u e ( ) ;  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o p i e s   a   r a n g e   o f   e l e m e n t s   f r o m   t h e   t r e e   t o   a   c o m p a t i b l e                   |  
 / / |   o n e - d i m e n s i o n a l   a r r a y .                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 i n t   C R e d B l a c k T r e e : : C o p y T o ( T   & d s t _ a r r a y [ ] , c o n s t   i n t   d s t _ s t a r t = 0 )  
     {  
 / / - - -   c h e c k   r o o t   n o d e  
       i f ( C h e c k P o i n t e r ( m _ r o o t _ n o d e ) = = P O I N T E R _ I N V A L I D )  
             r e t u r n ( 0 ) ;  
 / / - - -   r e s i z e   a r r a y  
       i f ( d s t _ s t a r t + m _ c o u n t > A r r a y S i z e ( d s t _ a r r a y ) )  
             A r r a y R e s i z e ( d s t _ a r r a y , d s t _ s t a r t + m _ c o u n t ) ;  
 / / - - -   s t a r t   c o p y  
       i n t   i n d e x = d s t _ s t a r t ;  
       i f ( ! m _ r o o t _ n o d e . I s L e a f ( ) )  
           {  
             / / - - -   s t o r e   a l l   v a l u e s   i n   t h e   s t a c k  
             W a l k N e x t L e v e l ( m _ r o o t _ n o d e , d s t _ a r r a y , i n d e x ) ;  
             / / - - -   c o p y   v a l u e s   f r o m   s t a c k   t o   a r r a y  
             r e t u r n ( i n d e x - d s t _ s t a r t ) ;  
           }  
       e l s e  
           {  
             / / - - -   t r e e   i s   e m p t y  
             r e t u r n ( 0 ) ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e m o v e s   a l l   n o d e s   f r o m   t h e   t r e e .                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 v o i d   C R e d B l a c k T r e e : : C l e a r ( v o i d )  
     {  
 / / - - -   c h e c k   c o u n t  
       i f ( m _ c o u n t > 0 )  
           {  
             / / - - -   d e l e t e   r o o t   n o d e  
             i f ( C h e c k P o i n t e r ( m _ r o o t _ n o d e ) = = P O I N T E R _ D Y N A M I C )  
                   d e l e t e   m _ r o o t _ n o d e ;  
             / / - - -   d e l e t e   l a s t   n o d e  
             i f ( C h e c k P o i n t e r ( m _ l a s t _ n o d e ) = = P O I N T E R _ D Y N A M I C )  
                   d e l e t e   m _ l a s t _ n o d e ;  
             m _ c o u n t = 0 ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e m o v e s   a   n o d e   w i t h   s p e c i f i e d   v a l u e   f r o m   t h e   t r e e .                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : R e m o v e ( T   v a l u e )  
     {  
 / / - - -   t r y   t o   f i n d   n o d e   w i t h   s p e c i f i e d   v a l u e  
       C R e d B l a c k T r e e N o d e < T > * d e l e t e _ n o d e = F i n d ( v a l u e ) ;  
       i f ( C h e c k P o i n t e r ( d e l e t e _ n o d e ) ! = P O I N T E R _ I N V A L I D )  
             r e t u r n   R e m o v e ( d e l e t e _ n o d e ) ;  
       r e t u r n ( f a l s e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e m o v e s   a   n o d e   f r o m   t h e   t r e e .                                                                         |  
 / / |   A   n o d e   t o   b e   d e l e t e d   w i l l   b e :                                                                         |  
 / / |   1 .   a   l e a f   w i t h   n o   c h i l d r e n                                                                               |  
 / / |   2 .   h a v e   o n e   c h i l d                                                                                                 |  
 / / |   3 .   h a v e   t w o   c h i l d r e n                                                                                           |  
 / / |   I f   t h e   d e l e t e d   n o d e   i s   r e d ,   t h e   r e d   b l a c k   p r o p e r t i e s   s t i l l   h o l d .   |  
 / / |   I f   t h e   d e l e t e d   n o d e   i s   b l a c k ,   t h e   t r e e   n e e d s   r e b a l a n c i n g .                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : R e m o v e ( C R e d B l a c k T r e e N o d e < T > * d e l e t e _ n o d e )  
     {  
 / / - - -   c h e c k   n o d e  
       i f ( C h e c k P o i n t e r ( d e l e t e _ n o d e ) = = P O I N T E R _ I N V A L I D )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   c h e c k   d e l e t e   n o d e   c o n a t i n s   i n   t r e e  
       b o o l   c o n t a i n s = f a l s e ;  
 / / - - -   w a l k   o f   a   t r e e   a n d   t r y   t o   f i n d   t h e   d e l e t e   n o d e  
       C R e d B l a c k T r e e N o d e < T > * t r e e _ n o d e = m _ r o o t _ n o d e ;  
       w h i l e ( C h e c k P o i n t e r ( t r e e _ n o d e ) ! = P O I N T E R _ I N V A L I D   & &   ! t r e e _ n o d e . I s L e a f ( ) )  
           {  
             / / - - -   c h e c k   s p e c i f i e d   n o d e   i s   d e l e t e   n o d e  
             i f ( t r e e _ n o d e = = d e l e t e _ n o d e )  
                 {  
                   c o n t a i n s = t r u e ;  
                   b r e a k ;  
                 }  
             e l s e  
                 {  
                   / / - - -   d e t e r m i n e   q u a l   b e t w e e n   s p e c i f i e d   n o d e   a n d   d e l e t e   n o d e  
                   i n t   r e s u l t = m _ c o m p a r e r . C o m p a r e ( d e l e t e _ n o d e . V a l u e ( ) , t r e e _ n o d e . V a l u e ( ) ) ;  
                   i f ( r e s u l t > 0 )  
                         t r e e _ n o d e = t r e e _ n o d e . R i g h t ( ) ;     / /   w a l k   o f   a   r i g h t   t r e e  
                   e l s e  
                   i f ( r e s u l t < 0 )  
                         t r e e _ n o d e = t r e e _ n o d e . L e f t ( ) ;       / /   w a l k   o f   a   l e f t   t r e e  
                   e l s e  
                         b r e a k ;                                                 / /   v a l u e s   o f   n o d e s   a r e   e q u a l ,   b u t   d e l e t e   n o d e   d o e s   n o t   b e l o n g   t o   t h i s   t r e e  
                 }  
           }  
 / / - - -   c h e c k   d e l e t e   n o d e   n o t   b e l o n g   t o   t h i s   t r e e  
       i f ( ! c o n t a i n s )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   w o r k   n o d e  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e ;  
 / / - - -   f i n d   t h e   r e p l a c e m e n t   n o d e   -   t h e   n o d e   o n e   w i t h   a t   * m o s t *   o n e   c h i l d .    
       i f ( d e l e t e _ n o d e . L e f t ( ) . I s L e a f ( )   | |   d e l e t e _ n o d e . R i g h t ( ) . I s L e a f ( ) )  
           {  
             w o r k _ n o d e = d e l e t e _ n o d e ;  
           }  
       e l s e  
           {  
             / / - - -   t r a v e r s e   r i g h t   s u b t r e e  
             w o r k _ n o d e = d e l e t e _ n o d e . R i g h t ( ) ;  
             / / - - -   t o   f i n d   n e x t   n o d e   i n   s e q u e n c e  
             w h i l e ( ! w o r k _ n o d e . L e f t ( ) . I s L e a f ( ) )  
                   w o r k _ n o d e = w o r k _ n o d e . L e f t ( ) ;  
           }  
 / / - - -   a t   t h i s   p o i n t ,   w o r k _ n o d e   c o n t a i n s   t h e   r e p l a c e m e n t   n o d e .   i t ' s   c o n t e n t   w i l l   b e   c o p i e d   t o   t h e   v a l u l e s   i n   t h e   n o d e   t o   b e   d e l e t e d  
 / / - - -   l i n k e d _ n o d e   i s   t h e   n o d e   t h a t   w i l l   b e   l i n k e d   t o   w o r k _ n o d e ' s   o l d   p a r e n t .    
       C R e d B l a c k T r e e N o d e < T > * l i n k e d _ n o d e = ( w o r k _ n o d e . L e f t ( ) . I s L e a f ( )   ?   w o r k _ n o d e . R i g h t ( )   :   w o r k _ n o d e . L e f t ( ) ) ;  
 / / - - -   r e p l a c e   l i n k e d _ n o d e ' s   p a r e n t   w i t h   w o r k _ n o d e ' s   p a r e n t   a n d    
 / / - - -   l i n k   l i n k e d _ n o d e   t o   p r o p e r   s u b t r e e   i n   p a r e n t  
 / / - - -   t h i s   r e m o v e s   w o r k _ n o d e   f r o m   t h e   c h a i n  
       l i n k e d _ n o d e . P a r e n t ( w o r k _ n o d e . P a r e n t ( ) ) ;  
       i f ( C h e c k P o i n t e r ( w o r k _ n o d e . P a r e n t ( ) ) ! = P O I N T E R _ I N V A L I D )  
           {  
             i f ( w o r k _ n o d e = = w o r k _ n o d e . P a r e n t ( ) . L e f t ( ) )  
                   w o r k _ n o d e . P a r e n t ( ) . L e f t ( l i n k e d _ n o d e ) ;  
             e l s e  
                   w o r k _ n o d e . P a r e n t ( ) . R i g h t ( l i n k e d _ n o d e ) ;  
           }  
       e l s e  
           {  
             / / - - -   m a k e   l i n k e d _ n o d e   t h e   r o o t   n o d e  
             m _ r o o t _ n o d e = l i n k e d _ n o d e ;  
           }  
 / / - - -   c o p y   t h e   v a l u e s   f r o m   w o r k _ n o d e   ( t h e   r e p l a c e m e n t   n o d e )   t o   t h e   n o d e   b e i n g   d e l e t e d .  
       i f ( w o r k _ n o d e ! = d e l e t e _ n o d e )  
             d e l e t e _ n o d e . V a l u e ( w o r k _ n o d e . V a l u e ( ) ) ;  
 / / - - -   r e s t o r e   r e d - b l a c k   p r o p e r t i e s  
       i f ( w o r k _ n o d e . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K )  
             B a l a n c e T r e e A f t e r D e l e t e ( l i n k e d _ n o d e ) ;  
 / / - - -   d e l e t e   n o d e  
       i f ( m _ c o u n t > 1 )  
           {  
             i f ( l i n k e d _ n o d e = = w o r k _ n o d e . L e f t ( ) )  
                   w o r k _ n o d e . L e f t ( N U L L ) ;  
             e l s e  
                   w o r k _ n o d e . R i g h t ( N U L L ) ;  
           }  
       d e l e t e   w o r k _ n o d e ;  
 / / - - -   d e c r e m e n t   c o u n t  
       m _ c o u n t - - ;  
       r e t u r n ( t r u e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e m o v e s   a   n o d e   w i t h   m i n i m u m   v a l u e   f r o m   t h e   t r e e .                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : R e m o v e M i n ( v o i d )  
     {  
 / / - - -   c h e c k   r o o t   n o d e  
       i f ( C h e c k P o i n t e r ( m _ r o o t _ n o d e ) = = P O I N T E R _ I N V A L I D )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   f i n d   a n d   r e m o v e   n o d e   w i t h   m i n i m u m   v a l u e  
       r e t u r n   R e m o v e ( F i n d M i n ( ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e m o v e s   a   n o d e   w i t h   m a x i m u m   v a l u e   f r o m   t h e   t r e e .                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 b o o l   C R e d B l a c k T r e e : : R e m o v e M a x ( v o i d )  
     {  
 / / - - -   c h e c k   r o o t   n o d e  
       i f ( C h e c k P o i n t e r ( m _ r o o t _ n o d e ) = = P O I N T E R _ I N V A L I D )  
             r e t u r n ( f a l s e ) ;  
 / / - - -   f i n d   a n d   r e m o v e   n o d e   w i t h   m a x i m u m   v a l u e  
       r e t u r n   R e m o v e ( F i n d M a x ( ) ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A t t e m p t s   t o   f i n d   a   n o d e   t h a t   c o n t a i n s   t h e   s p e c i f i e d   v a l u e .               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e < T > * C R e d B l a c k T r e e : : F i n d ( T   v a l u e )  
     {  
       i n t   r e s u l t ;  
 / / - - -   c h e c k   l a s t   n o d e    
       i f ( C h e c k P o i n t e r ( m _ l a s t _ n o d e ) ! = P O I N T E R _ I N V A L I D   & &   ! m _ l a s t _ n o d e . I s L e a f ( ) )  
           {  
             r e s u l t = m _ c o m p a r e r . C o m p a r e ( v a l u e , m _ l a s t _ n o d e . V a l u e ( ) ) ;  
             i f ( r e s u l t = = 0 )  
                   r e t u r n ( m _ l a s t _ n o d e ) ;  
           }  
 / / - - -   b e g i n   a t   r o o t  
       C R e d B l a c k T r e e N o d e < T > * t r e e _ n o d e = m _ r o o t _ n o d e ;  
 / / - - -   t r a v e r s e   t r e e   u n t i l   n o d e   i s   f o u n d  
       w h i l e ( C h e c k P o i n t e r ( t r e e _ n o d e ) ! = P O I N T E R _ I N V A L I D   & &   ! t r e e _ n o d e . I s L e a f ( ) )  
           {  
             r e s u l t = m _ c o m p a r e r . C o m p a r e ( v a l u e , t r e e _ n o d e . V a l u e ( ) ) ;  
             i f ( r e s u l t = = 0 )  
                 {  
                   m _ l a s t _ n o d e = t r e e _ n o d e ;  
                   r e t u r n ( t r e e _ n o d e ) ;  
                 }  
             t r e e _ n o d e = ( r e s u l t < 0   ?   t r e e _ n o d e . L e f t ( )   :   t r e e _ n o d e . R i g h t ( ) ) ;  
           }  
       r e t u r n ( N U L L ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A t t e m p t s   t o   f i n d   a   n o d e   t h a t   c o n t a i n s   t h e   m i n i m u m   v a l u e .                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e < T > * C R e d B l a c k T r e e : : F i n d M i n ( v o i d )  
     {  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = m _ r o o t _ n o d e ;  
 / / - - -   c h e c k   t r e e   i s   e m p t y  
       i f ( C h e c k P o i n t e r ( w o r k _ n o d e ) = = P O I N T E R _ I N V A L I D   | |   w o r k _ n o d e . I s L e a f ( ) )  
             r e t u r n ( N U L L ) ;  
 / / - - -   t r a v e r s e   t o   t h e   e x t r e m e   l e f t   t o   f i n d   t h e   s m a l l e s t   k e y  
       w h i l e ( ! w o r k _ n o d e . L e f t ( ) . I s L e a f ( ) )  
             w o r k _ n o d e = w o r k _ n o d e . L e f t ( ) ;  
 / / - - -   s t o r e   m i n   v a l u e  
       m _ l a s t _ n o d e = w o r k _ n o d e ;  
       r e t u r n ( w o r k _ n o d e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A t t e m p t s   t o   f i n d   a   n o d e   t h a t   c o n t a i n s   t h e   m a x i m u m   v a l u e .                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 C R e d B l a c k T r e e N o d e < T > * C R e d B l a c k T r e e : : F i n d M a x ( v o i d )  
     {  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = m _ r o o t _ n o d e ;  
 / / - - -   c h e c k   t r e e   i s   e m p t y  
       i f ( C h e c k P o i n t e r ( w o r k _ n o d e ) = = P O I N T E R _ I N V A L I D   | |   w o r k _ n o d e . I s L e a f ( ) )  
             r e t u r n ( N U L L ) ;  
 / / - - -   t r a v e r s e   t o   t h e   e x t r e m e   r i g h t   t o   f i n d   t h e   l a r g e s t   k e y  
       w h i l e ( ! w o r k _ n o d e . R i g h t ( ) . I s L e a f ( ) )  
             w o r k _ n o d e = w o r k _ n o d e . R i g h t ( ) ;  
 / / - - -   s t o r e   m a x   v a l u e  
       m _ l a s t _ n o d e = w o r k _ n o d e ;  
       r e t u r n ( w o r k _ n o d e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   P u s h i n g   n o d e   r o t a t e _ n o d e   d o w n   a n d   t o   t h e   r i g h t   t o   b a l a n c e   t h e         |  
 / / |   t r e e .   r o t a t e _ n o d e ' s   L e f t   c h i l d   ( w o r k _ n o d e )   r e p l a c e s   r o t a t e _ n o d e     |  
 / / |   ( s i n c e   r o t a t e _ n o d e   <   w o r k _ n o d e ) ,   a n d   w o r k _ n o d e ' s   R i g h t   c h i l d           |  
 / / |   b e c o m e s   r o t a t e _ n o d e ' s   L e f t   c h i l d   ( s i n c e   i t ' s   <   r o t a t e _ n o d e   b u t   >   |  
 / / |   w o r k _ n o d e ) .                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 v o i d   C R e d B l a c k T r e e : : R o t a t e R i g h t ( C R e d B l a c k T r e e N o d e < T > * r o t a t e _ n o d e )  
     {  
 / / - - -   g e t   r o t a t e _ n o d e ' s   L e f t   n o d e ,   t h i s   b e c o m e s   w o r k _ n o d e  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = r o t a t e _ n o d e . L e f t ( ) ;  
 / / - - -   s e t   r o t a t e _ n o d e ' s   R i g h t   l i n k  
 / / - - -   w o r k _ n o d e ' s   R i g h t   c h i l d   b e c o m e s   r o t a t e _ n o d e ' s   L e f t   c h i l d  
       r o t a t e _ n o d e . L e f t ( w o r k _ n o d e . R i g h t ( ) ) ;  
 / / - - -   m o d i f y   p a r e n t s  
       i f ( ! w o r k _ n o d e . R i g h t ( ) . I s L e a f ( ) )  
           {  
             / / - - -   s e t s   w o r k _ n o d e ' s   R i g h t   P a r e n t   t o   r o t a t e _ n o d e  
             w o r k _ n o d e . R i g h t ( ) . P a r e n t ( r o t a t e _ n o d e ) ;  
           }  
       i f ( ! w o r k _ n o d e . I s L e a f ( ) )  
           {  
             / / - - -   s e t   w o r k _ n o d e ' s   P a r e n t   t o   r o t a t e _ n o d e ' s   P a r e n t  
             w o r k _ n o d e . P a r e n t ( r o t a t e _ n o d e . P a r e n t ( ) ) ;  
           }  
       i f ( C h e c k P o i n t e r ( r o t a t e _ n o d e . P a r e n t ( ) ) ! = P O I N T E R _ I N V A L I D )  
           {  
             / / - - -   d e t e r m i n e   w h i c h   s i d e   o f   i t ' s   P a r e n t   r o t a t e _ n o d e   w a s   o n  
             i f ( r o t a t e _ n o d e = = r o t a t e _ n o d e . P a r e n t ( ) . R i g h t ( ) )  
                 {  
                   / / - - -   s e t   R i g h t   P a r e n t   t o   w o r k _ n o d e  
                   r o t a t e _ n o d e . P a r e n t ( ) . R i g h t ( w o r k _ n o d e ) ;  
                 }  
             e l s e  
                 {  
                   / / - - -   s e t   L e f t   P a r e n t   t o   w o r k _ n o d e  
                   r o t a t e _ n o d e . P a r e n t ( ) . L e f t ( w o r k _ n o d e ) ;  
                 }  
           }  
       e l s e  
           {  
             m _ r o o t _ n o d e = w o r k _ n o d e ;  
           }  
 / / - - -   l i n k   r o t a t e _ n o d e   a n d   w o r k _ n o d e    
 / / - - -   p u t   r o t a t e _ n o d e   o n   w o r k _ n o d e ' s   R i g h t  
       w o r k _ n o d e . R i g h t ( r o t a t e _ n o d e ) ;  
 / / - - -   s e t   w o r k _ n o d e   a s   r o t a t e _ n o d e ' s   P a r e n t  
       i f ( ! r o t a t e _ n o d e . I s L e a f ( ) )  
             r o t a t e _ n o d e . P a r e n t ( w o r k _ n o d e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   P u s h i n g   n o d e   r o t a t e _ n o d e   d o w n   a n d   t o   t h e   L e f t   t o   b a l a n c e   t h e           |  
 / / |   t r e e .   r o t a t e _ n o d e ' s   R i g h t   c h i l d   ( w o r k _ n o d e )   r e p l a c e s   r o t a t e _ n o d e   |  
 / / |   ( s i n c e   w o r k _ n o d e   >   r o t a t e _ n o d e ) ,   a n d   w o r k _ n o d e ' s   L e f t   c h i l d             |  
 / / |   b e c o m e s   r o t a t e _ n o d e ' s   R i g h t   c h i l d   ( s i n c e   i t ' s   <   w o r k _ n o d e   b u t   >     |  
 / / |   r o t a t e _ n o d e ) .                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 v o i d   C R e d B l a c k T r e e : : R o t a t e L e f t ( C R e d B l a c k T r e e N o d e < T > * r o t a t e _ n o d e )  
     {  
 / / - - -   g e t   r o t a t e _ n o d e ' s   R i g h t   n o d e ,   t h i s   b e c o m e s   w o r k _ n o d e  
       C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e = r o t a t e _ n o d e . R i g h t ( ) ;  
 / / - - -   s e t   r o t a t e _ n o d e ' s   R i g h t   l i n k  
 / / - - -   w o r k _ n o d e ' s   L e f t   c h i l d ' s   b e c o m e s   r o t a t e _ n o d e ' s   R i g h t   c h i l d  
       r o t a t e _ n o d e . R i g h t ( w o r k _ n o d e . L e f t ( ) ) ;  
 / / - - -   m o d i f y   p a r e n t s  
       i f ( ! w o r k _ n o d e . L e f t ( ) . I s L e a f ( ) )  
           {  
             / / - - -   s e t s   w o r k _ n o d e ' s   L e f t   P a r e n t   t o   r o t a t e _ n o d e  
             w o r k _ n o d e . L e f t ( ) . P a r e n t ( r o t a t e _ n o d e ) ;  
           }  
       i f ( ! w o r k _ n o d e . I s L e a f ( ) )  
           {  
             / / - - -   s e t   w o r k _ n o d e ' s   P a r e n t   t o   r o t a t e _ n o d e ' s   P a r e n t  
             w o r k _ n o d e . P a r e n t ( r o t a t e _ n o d e . P a r e n t ( ) ) ;  
           }  
       i f ( C h e c k P o i n t e r ( r o t a t e _ n o d e . P a r e n t ( ) ) ! = P O I N T E R _ I N V A L I D )  
           {  
             / / - - -   d e t e r m i n e   w h i c h   s i d e   o f   i t ' s   P a r e n t   r o t a t e _ n o d e   w a s   o n  
             i f ( r o t a t e _ n o d e = = r o t a t e _ n o d e . P a r e n t ( ) . L e f t ( ) )  
                 {  
                   / / - - -   s e t   L e f t   P a r e n t   t o   w o r k _ n o d e  
                   r o t a t e _ n o d e . P a r e n t ( ) . L e f t ( w o r k _ n o d e ) ;  
                 }  
             e l s e  
                 {  
                   / / - - -   s e t   R i g h t   P a r e n t   t o   w o r k _ n o d e  
                   r o t a t e _ n o d e . P a r e n t ( ) . R i g h t ( w o r k _ n o d e ) ;  
                 }  
           }  
       e l s e  
           {  
             m _ r o o t _ n o d e = w o r k _ n o d e ;  
           }  
  
 / / - - -   l i n k   r o t a t e _ n o d e   a n d   w o r k _ n o d e  
 / / - - -   p u t   r o t a t e _ n o d e   o n   w o r k _ n o d e ' s   L e f t  
       w o r k _ n o d e . L e f t ( r o t a t e _ n o d e ) ;  
 / / - - -   s e t   w o r k _ n o d e   a s   r o t a t e _ n o d e ' s   P a r e n t  
       i f ( ! r o t a t e _ n o d e . I s L e a f ( ) )  
             r o t a t e _ n o d e . P a r e n t ( w o r k _ n o d e ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A d d i t i o n s   t o   r e d - b l a c k   t r e e s   u s u a l l y   d e s t r o y   t h e   r e d - b l a c k               |  
 / / |   p r o p e r t i e s .   E x a m i n e   t h e   t r e e   a n d   r e s t o r e .   R o t a t i o n s   a r e   n o r m a l l y   |  
 / / |   r e q u i r e d   t o   r e s t o r e   i t .                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 v o i d   C R e d B l a c k T r e e : : B a l a n c e T r e e A f t e r I n s e r t ( C R e d B l a c k T r e e N o d e < T > * i n s e r t _ n o d e )  
     {  
 / / - - -   m a i n t a i n   r e d - b l a c k   t r e e   p r o p e r t i e s   a f t e r   a d d i n g   n e w   n o d e  
       w h i l e ( i n s e r t _ n o d e ! = m _ r o o t _ n o d e   & &   i n s e r t _ n o d e . P a r e n t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ R E D )  
           {  
             / / - - -   p a r e n t   n o d e   i s   c o l o r e d   r e d  
             C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e ;  
             / / - - -   d e t e r m i n e   t r a v e r s a l   p a t h 	 	 	  
             i f ( i n s e r t _ n o d e . P a r e n t ( ) = = i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . L e f t ( ) )  
                 {  
                   / / - - -   g e t   r i g t h   u n c l e  
                   w o r k _ n o d e = i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . R i g h t ( ) ;  
                   i f ( C h e c k P o i n t e r ( w o r k _ n o d e ) ! = P O I N T E R _ I N V A L I D   & &   w o r k _ n o d e . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ R E D )  
                       {  
                         / / - - -   u n c l e   i s   r e d  
                         / / - - -   c h a n g e   p a r e n t   a n d   u n c l e   t o   b l a c k  
                         i n s e r t _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         / / - - -   g r a n d p a r e n t   m u s t   b e   r e d  
                         i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         / / - - -   c o n t i n u e   l o o p   w i t h   g r a n d p a r e n t  
                         i n s e r t _ n o d e = i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) ;  
                       }  
                   e l s e  
                       {  
                         / / - - -   u n c l e   i s   b l a c k  
                         / / - - -   d e t e r m i n e   i f   n e w   n o d e   i s   g r e a t e r   t h a n   p a r e n t  
                         i f ( i n s e r t _ n o d e = = i n s e r t _ n o d e . P a r e n t ( ) . R i g h t ( ) )  
                             {  
                               / / - - -   n e w   n o d e   i s   g r e a t e r   t h a n   p a r e n t  
                               i n s e r t _ n o d e = i n s e r t _ n o d e . P a r e n t ( ) ;  
                               R o t a t e L e f t ( i n s e r t _ n o d e ) ;  
                             }  
                         / / - - -   n e w   n o d e   i s   l e s s   t h a n   p a r e n t  
                         i n s e r t _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         R o t a t e R i g h t ( i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) ) ;  
                       }  
                 }  
             e l s e  
                 {  
                   / / - - -   g e t   l e f t   u n c l e  
                   w o r k _ n o d e = i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . L e f t ( ) ;  
                   i f ( C h e c k P o i n t e r ( w o r k _ n o d e ) ! = P O I N T E R _ I N V A L I D   & &   w o r k _ n o d e . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ R E D )  
                       {  
                         / / - - -   u n c l e   i s   r e d  
                         / / - - -   c h a n g e   p a r e n t   a n d   u n c l e   t o   b l a c k  
                         i n s e r t _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         / / - - -   g r a n d p a r e n t   m u s t   b e   r e d  
                         i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         / / - - -   c o n t i n u e   l o o p   w i t h   g r a n d p a r e n t  
                         i n s e r t _ n o d e = i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) ;  
                       }  
                   e l s e  
                       {  
                         / / - - -   u n c l e   i s   b l a c k  
                         / / - - -   d e t e r m i n e   i f   n e w   n o d e   i s   g r e a t e r   t h a n   p a r e n t  
                         i f ( i n s e r t _ n o d e = = i n s e r t _ n o d e . P a r e n t ( ) . L e f t ( ) )  
                             {  
                               / / - - -   n e w   n o d e   i s   g r e a t e r   t h a n   p a r e n t  
                               i n s e r t _ n o d e = i n s e r t _ n o d e . P a r e n t ( ) ;  
                               R o t a t e R i g h t ( i n s e r t _ n o d e ) ;  
                             }  
                         / / - - -   n e w   n o d e   i s   l e s s   t h a n   p a r e n t  
                         i n s e r t _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         R o t a t e L e f t ( i n s e r t _ n o d e . P a r e n t ( ) . P a r e n t ( ) ) ;  
                       }  
                 }  
           }  
 / / - - -   r o o t   s h o u l d   a l w a y s   b e   b l a c k  
       m _ r o o t _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   D e l e t i o n s   f r o m   r e d - b l a c k   t r e e s   m a y   d e s t r o y   t h e   r e d - b l a c k                   |  
 / / |   p r o p e r t i e s .   E x a m i n e   t h e   t r e e   a n d   r e s t o r e .   R o t a t i o n s   a r e   n o r m a l l y   |  
 / / |   r e q u i r e d   t o   r e s t o r e   i t .                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 v o i d   C R e d B l a c k T r e e : : B a l a n c e T r e e A f t e r D e l e t e ( C R e d B l a c k T r e e N o d e < T > * l i n k e d _ n o d e )  
     {  
 / / - - -   m a i n t a i n   R e d - B l a c k   t r e e   b a l a n c e   a f t e r   d e l e t i n g   n o d e  
       w h i l e ( l i n k e d _ n o d e ! = m _ r o o t _ n o d e   & &   l i n k e d _ n o d e . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K )  
           {  
             C R e d B l a c k T r e e N o d e < T > * w o r k _ n o d e ;  
             / / - - -   d e t e r m i n e   t r a v e r s a l   p a t h  
             i f ( l i n k e d _ n o d e = = l i n k e d _ n o d e . P a r e n t ( ) . L e f t ( ) )  
                 {  
                   / / - - -   w o r k   n o d e   i s   d e l e t e   n o d e   s i b l i n g  
                   w o r k _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) . R i g h t ( ) ;  
                   i f ( w o r k _ n o d e . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ R E D )  
                       {  
                         / / - - -   d e l e t e   n o d e   i s   b l a c k ,   w o r k   n o d e   i s   r e d   -   m a k e   b o t h   b l a c k   a n d   r o t a t e  
                         l i n k e d _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         R o t a t e L e f t ( l i n k e d _ n o d e . P a r e n t ( ) ) ;  
                         w o r k _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) . R i g h t ( ) ;  
                       }  
                   / / - - -   c h e c k   w o r k   n o d e   i s   n o t   l e a f  
                   i f ( w o r k _ n o d e . I s L e a f ( ) )  
                         r e t u r n ;  
                   i f ( w o r k _ n o d e . L e f t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K   & &    
                         w o r k _ n o d e . R i g h t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K )  
                       {  
                         / / - - -   c h i l d r e n   a r e   b o t h   b l a c k  
                         / / - - -   c h a n g e   p a r e n t   t o   r e d  
                         w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         / / - - -   m o v e   u p   t h e   t r e e  
                         l i n k e d _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) ;  
                       }  
                   e l s e  
                       {  
                         i f ( w o r k _ n o d e . R i g h t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K )  
                             {  
                               w o r k _ n o d e . L e f t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                               w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                               R o t a t e R i g h t ( w o r k _ n o d e ) ;  
                               w o r k _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) . R i g h t ( ) ;  
                             }  
                         w o r k _ n o d e . C o l o r ( l i n k e d _ n o d e . P a r e n t ( ) . C o l o r ( ) ) ;  
                         l i n k e d _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         w o r k _ n o d e . R i g h t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         R o t a t e L e f t ( l i n k e d _ n o d e . P a r e n t ( ) ) ;  
                         l i n k e d _ n o d e = m _ r o o t _ n o d e ;  
                       }  
                 }  
             e l s e  
                 {  
                   / / - - -   w o r k   n o d e   i s   d e l e t e   n o d e   s i b l i n g  
                   w o r k _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) . L e f t ( ) ;  
                   i f ( w o r k _ n o d e . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ R E D )  
                       {  
                         / / - - -   d e l e t e   n o d e   i s   b l a c k ,   w o r k   n o d e   i s   r e d   -   m a k e   b o t h   b l a c k   a n d   r o t a t e  
                         l i n k e d _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         R o t a t e R i g h t ( l i n k e d _ n o d e . P a r e n t ( ) ) ;  
                         w o r k _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) . L e f t ( ) ;  
                       }  
                   / / - - -   c h e c k   w o r k   n o d e   i s   n o t   l e a f  
                   i f ( w o r k _ n o d e . I s L e a f ( ) )  
                         r e t u r n ;  
                   i f ( w o r k _ n o d e . R i g h t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K   & &    
                         w o r k _ n o d e . L e f t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K )  
                       {  
                         / / - - -   c h i l d r e n   a r e   b o t h   b l a c k  
                         / / - - -   c h a n g e   p a r e n t   t o   r e d  
                         w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                         / / - - -   m o v e   u p   t h e   t r e e  
                         l i n k e d _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) ;  
                       }  
                   e l s e  
                       {  
                         i f ( w o r k _ n o d e . L e f t ( ) . C o l o r ( ) = = R E D _ B L A C K _ T R E E _ N O D E _ B L A C K )  
                             {  
                               w o r k _ n o d e . R i g h t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                               w o r k _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ R E D ) ;  
                               R o t a t e L e f t ( w o r k _ n o d e ) ;  
                               w o r k _ n o d e = l i n k e d _ n o d e . P a r e n t ( ) . L e f t ( ) ;  
                             }  
                         w o r k _ n o d e . C o l o r ( l i n k e d _ n o d e . P a r e n t ( ) . C o l o r ( ) ) ;  
                         l i n k e d _ n o d e . P a r e n t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         w o r k _ n o d e . L e f t ( ) . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
                         R o t a t e R i g h t ( l i n k e d _ n o d e . P a r e n t ( ) ) ;  
                         l i n k e d _ n o d e = m _ r o o t _ n o d e ;  
                       }  
                 }  
           }  
       l i n k e d _ n o d e . C o l o r ( R E D _ B L A C K _ T R E E _ N O D E _ B L A C K ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   R e c u r s i v e   w a l k   o f   a   t r e e .                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 t e m p l a t e < t y p e n a m e   T >  
 v o i d   C R e d B l a c k T r e e : : W a l k N e x t L e v e l ( C R e d B l a c k T r e e N o d e < T > * n o d e , T   & a r r a y [ ] , i n t   & i n d e x )  
     {  
 / / - - -   w a l k   o f   a   l e f t   s u b t r e e  
       i f ( ! n o d e . L e f t ( ) . I s L e a f ( ) )  
             W a l k N e x t L e v e l ( n o d e . L e f t ( ) , a r r a y , i n d e x ) ;  
 / / - - -   c h e c h   i n d e x  
       i f ( i n d e x > = A r r a y S i z e ( a r r a y ) )  
             r e t u r n ;  
 / / - - -   s t o r e   v a l u e   i n   t h e   a r r a y  
       a r r a y [ i n d e x + + ] = n o d e . V a l u e ( ) ;  
 / / - - -   w a l k   o f   a   r i g h t   s u b t r e e  
       i f ( ! n o d e . R i g h t ( ) . I s L e a f ( ) )  
             W a l k N e x t L e v e l ( n o d e . R i g h t ( ) , a r r a y , i n d e x ) ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                                        Stack.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Generic\Interfaces\ICollection.mqh>
#include <Generic\Internal\ArrayFunction.mqh>
#include <Generic\Internal\EqualFunction.mqh>
//+------------------------------------------------------------------+
//| Class CStack<T>.                                                 |
//| Usage: Represents a variable size last-in-first-out (LIFO)       |
//|        collection of instances of the same specified type.       |
//+------------------------------------------------------------------+
template<typename T>
class CStack: public ICollection<T>
  {
protected:
   T                 m_array[];
   int               m_size;
   const int         m_default_capacity;

public:
                     CStack(void);
                     CStack(const int capacity);
                     CStack(ICollection<T>&collection[]);
                     CStack(T &array[]);
                    ~CStack(void);
   //--- methods of filling data 
   bool              Add(T value);
   bool              Push(T value);
   //--- methods of access to protected data
   int               Count(void);
   bool              Contains(T item);
   void              TrimExcess(void);
   //--- methods of copy data from collection   
   int               CopyTo(T &dst_array[],const int dst_start=0);
   //--- methods of cleaning and removing
   void              Clear(void);
   bool              Remove(T item);   
   //--- methods of access to protected data
   T                 Peek(void);
   T                 Pop(void);
  };
//+------------------------------------------------------------------+
//| Initializes a new instance of the CStack<T> class that is empty  |
//| and has the default initial capacity.                            |
//+------------------------------------------------------------------+
template<typename T>
CStack::CStack(void): m_default_capacity(4),
                      m_size(0)
  {
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CStack<T> class that is empty  |
//| and has the specified initial capacity or the default initial    |
//| capacity, whichever is greater.                                  |
//+------------------------------------------------------------------+
template<typename T>
CStack::CStack(const int capacity): m_default_capacity(4),
                                    m_size(0)
  {
   ArrayResize(m_array,capacity);
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CStack<T> class that contains  |
//| elements copied from the specified array and has sufficient      |
//| capacity to accommodate the number of elements copied.           |
//+------------------------------------------------------------------+
template<typename T>
CStack::CStack(T &array[]): m_default_capacity(4),
                            m_size(0)
  {
   m_size=ArrayCopy(m_array,array);
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CStack<T> class that contains  |
//| elements copied from the specified collection and has sufficient |
//| capacity to accommodate the number of elements copied.           |
//+------------------------------------------------------------------+
template<typename T>
CStack::CStack(ICollection<T>*collection): m_default_capacity(4),
                                           m_size(0)
  {
//--- check collection   
   if(CheckPointer(collection)!=POINTER_INVALID)
      m_size=collection.CopyTo(m_array,0);
  }
//+------------------------------------------------------------------+
//| Destructor.                                                      |
//+------------------------------------------------------------------+
template<typename T>
CStack::~CStack(void)
  {
  }
//+------------------------------------------------------------------+
//| Inserts an value at the top of the CStack<T>.                    |
//+------------------------------------------------------------------+
template<typename T>
bool CStack::Add(T value)
  {
   return Push(value);
  }
//+------------------------------------------------------------------+
//| Gets the number of elements.                                     |
//+------------------------------------------------------------------+
template<typename T>
int CStack::Count(void)
  {
   return(m_size);
  }
//+------------------------------------------------------------------+
//| Removes all values from the CStack<T>.                           |
//+------------------------------------------------------------------+
template<typename T>
bool CStack::Contains(T item)
  {
   int count=m_size;
//--- try to find item in array
   while(count-->0)
     {
      //--- use default equality function
      if(::Equals(m_array[count],item))
         return(true);
     }
   return(false);
  }
//+------------------------------------------------------------------+
//| Copies a range of elements from the stack to a compatible        |
//| one-dimensional array.                                           |
//+------------------------------------------------------------------+
template<typename T>
int CStack::CopyTo(T &dst_array[],const int dst_start=0)
  {
//--- resize array
   if(dst_start+m_size>ArraySize(dst_array))
      ArrayResize(dst_array,dst_start+m_size);
//--- start copy
   int src_index = m_size-1;
   int dst_index = dst_start;
   while(src_index>=0 && dst_index<ArraySize(dst_array))
      dst_array[dst_index++]=m_array[src_index--];
   return(dst_index-dst_start);
  }
//+------------------------------------------------------------------+
//| Removes all values from the CStack<T>.                           |
//+------------------------------------------------------------------+
template<typename T>
void CStack::Clear(void)
  {
//--- check current size
   if(m_size>0)
     {
      ZeroMemory(m_array);
      m_size=0;
     }
  }
//+------------------------------------------------------------------+
//| Removes the first occurrence of a specific value from the stack. |
//+------------------------------------------------------------------+
template<typename T>
bool CStack::Remove(T item)
  {
//--- find index of item
   int index=ArrayIndexOf(m_array,item,0,m_size);
//--- check index
   if(index==-1)
      return(false);
//--- shift the values to the left
   ArrayCopy(m_array,m_array,index,index+1);
//--- decrement size
   m_size--;
   return(true);
  }
//+------------------------------------------------------------------+
//| Inserts an values at the top of the CStack<T>.                   |
//+------------------------------------------------------------------+
template<typename T>
bool CStack::Push(T value)
  {
   int size=ArraySize(m_array);
//--- check array size
   if(m_size==size)
     {
      //--- increase capacity
      if(size==0)
         ArrayResize(m_array,m_default_capacity);
      else
         ArrayResize(m_array,2*size);
     }
//--- add value to the end
   m_array[m_size++]=value;
   return(true);
  }
//+------------------------------------------------------------------+
//| Returns the value at the top of the CStack<T> without removing.  |
//+------------------------------------------------------------------+
template<typename T>
T CStack::Peek(void)
  {
//--- return last value 
   return(m_array[m_size-1]);
  }
//+------------------------------------------------------------------+
//| Removes and returns the value at the top of the CStack<T>.       |
//+------------------------------------------------------------------+
template<typename T>
T CStack::Pop(void)
  {
//--- return last value and decrement size
   T item=m_array[--m_size];
   return(item);
  }
//+------------------------------------------------------------------+
//| Sets the capacity to the actual number of elements in the        |
//| CStack<T>, if that number is less than 90 percent of current     |
//| capacity.                                                        |
//+------------------------------------------------------------------+
template<typename T>
void CStack::TrimExcess(void)
  {
//--- calculate threshold value
   int threshold=(int)(((double)ArraySize(m_array)*0.9));
//--- calculate resize array
   if(m_size<threshold)
      ArrayResize(m_array,m_size);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                   SortedList.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Generic\Interfaces\ISet.mqh>
#include <Generic\Internal\Introsort.mqh>
#include "RedBlackTree.mqh"
#include "HashSet.mqh"
//+------------------------------------------------------------------+
//| Class CSortedSet<T>.                                             |
//| Usage: Represents a collection of objects that is maintained in  |
//|        sorted order.                                             |
//+------------------------------------------------------------------+
template<typename T>
class CSortedSet: public ISet<T>
  {
protected:
   CRedBlackTree<T>*m_tree;

public:
                     CSortedSet(void);
                     CSortedSet(IComparer<T>*comparer);
                     CSortedSet(ICollection<T>*collection);
                     CSortedSet(ICollection<T>*collection,IComparer<T>*comparer);
                     CSortedSet(T &array[]);
                     CSortedSet(T &array[],IComparer<T>*comparer);
                    ~CSortedSet(void);
   //--- methods of filling data 
   bool              Add(T value) { return(m_tree.Add(value));     }
   //--- methods of access to protected data
   int               Count(void)          { return(m_tree.Count());        }
   bool              Contains(T item)     { return(m_tree.Contains(item)); }
   IComparer<T>     *Comparer(void) const { return(m_tree.Comparer());     }
   bool              TryGetMin(T &min)    { return(m_tree.TryGetMin(min)); }
   bool              TryGetMax(T &max)    { return(m_tree.TryGetMax(max)); }
   //--- methods of copy data from collection   
   int               CopyTo(T &dst_array[],const int dst_start=0);
   //--- methods of cleaning and deleting
   void              Clear(void)        { m_tree.Clear();              }
   bool              Remove(T item)     { return(m_tree.Remove(item)); }
   //--- methods of changing sets
   void              ExceptWith(ICollection<T>*collection);
   void              ExceptWith(T &array[]);
   void              IntersectWith(ICollection<T>*collection);
   void              IntersectWith(T &array[]);
   void              SymmetricExceptWith(ICollection<T>*collection);
   void              SymmetricExceptWith(T &array[]);
   void              UnionWith(ICollection<T>*collection);
   void              UnionWith(T &array[]);
   //--- methods for determining the relationship between sets
   bool              IsProperSubsetOf(ICollection<T>*collection);
   bool              IsProperSubsetOf(T &array[]);
   bool              IsProperSupersetOf(ICollection<T>*collection);
   bool              IsProperSupersetOf(T &array[]);
   bool              IsSubsetOf(ICollection<T>*collection);
   bool              IsSubsetOf(T &array[]);
   bool              IsSupersetOf(ICollection<T>*collection);
   bool              IsSupersetOf(T &array[]);
   bool              Overlaps(ICollection<T>*collection);
   bool              Overlaps(T &array[]);
   bool              SetEquals(ICollection<T>*collection);
   bool              SetEquals(T &array[]);
   //--- methods for working with an ordered set
   bool              GetViewBetween(T &array[],T lower_value,T upper_value);
   bool              GetReverse(T &array[]);
  };
//+------------------------------------------------------------------+
//| Initializes a new instance of the CSortedSet<T> class that is    |
//| empty and uses the default equality comparer for the set type.   |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::CSortedSet(void)
  {
   m_tree=new CRedBlackTree<T>();
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CSortedSet<T> class that is    |
//| empty and uses the specified equality comparer for the set type. |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::CSortedSet(IComparer<T>*comparer)
  {
   m_tree=new CRedBlackTree<T>(comparer);
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CSortedSet<T> class that uses  |
//| the default equality comparer for the set type, contains elements|
//| copied from the specified collection, and has sufficient capacity|
//| to accommodate the number of elements copied.                    |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::CSortedSet(ICollection<T>*collection)
  {
   m_tree=new CRedBlackTree<T>(collection);
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CSortedSet<T> class that uses  |
//| the specified equality comparer for the set type, contains       |
//| elements copied from the specified collection, and has sufficient|
//| capacity to accommodate the number of elements copied.           |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::CSortedSet(ICollection<T>*collection,IComparer<T>*comparer)
  {
   m_tree=new CRedBlackTree<T>(collection,comparer);
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CSortedSet<T> class that uses  |
//| the default equality comparer for the set type, contains         |
//| elements copied from the specified array, and has sufficient     |
//| capacity to accommodate the number of elements copied.           |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::CSortedSet(T &array[])
  {
   m_tree=new CRedBlackTree<T>(array);
  }
//+------------------------------------------------------------------+
//| Initializes a new instance of the CSortedSet<T> class that uses  |
//| the specified equality comparer for the set type, contains       |
//| elements copied from the specified array, and has sufficient     |
//| capacity to accommodate the number of elements copied.           |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::CSortedSet(T &array[],IComparer<T>*comparer)
  {
   m_tree=new CRedBlackTree<T>(array,comparer);
  }
//+------------------------------------------------------------------+
//| Destructor.                                                      |
//+------------------------------------------------------------------+
template<typename T>
CSortedSet::~CSortedSet(void)
  {
   delete m_tree;
  }
//+------------------------------------------------------------------+
//| Copies a range of elements from the set to a compatible          |
//| one-dimensional array.                                           |
//+------------------------------------------------------------------+
template<typename T>
int CSortedSet::CopyTo(T &dst_array[],const int dst_start=0)
  {
   return(m_tree.CopyTo(dst_array, dst_start));
  }
//+------------------------------------------------------------------+
//| Removes all elements in the specified collection from the current|
//| set.                                                             |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::ExceptWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- check tree count
   if(m_tree.Count()==0)
      return;
//--- special case if collection is this
//--- a set minus itself is the empty set
   if(collection==GetPointer(this))
     {
      Clear();
      return;
     }
//--- copy collection to array
   T array[];
   int size=collection.CopyTo(array);
//--- find max and min value
   T max;
   T min;
//--- get comaprer
   IComparer<T>*comparer=Comparer();
   if(!m_tree.TryGetMax(max))
      return;
   if(!m_tree.TryGetMin(min))
      return;
//--- remove elements
   for(int i=0; i<size; i++)
     {
      T item=array[i];
      if(!(comparer.Compare(item,min)<0 || comparer.Compare(item,max)>0) && Contains(item))
         m_tree.Remove(item);
     }
  }
//+------------------------------------------------------------------+
//| Removes all elements in the specified array from the current set.|
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::ExceptWith(T &array[])
  {
//--- check tree count
   if(m_tree.Count()==0)
      return;
//--- get array size
   int size=ArraySize(array);
//--- find max and min value
   T max;
   T min;
//--- get comparer
   IComparer<T>*comparer=Comparer();
   if(!m_tree.TryGetMax(max))
      return;
   if(!m_tree.TryGetMin(min))
      return;
//--- remove elements   
   for(int i=0; i<size; i++)
     {
      T item=array[i];
      if(!(comparer.Compare(item,min)<0 || comparer.Compare(item,max)>0) && Contains(item))
         m_tree.Remove(item);
     }
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present in that object and in the specified collection.          |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::IntersectWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- check tree count
   if(m_tree.Count()==0)
      return;
//--- special case if collection is this
//--- a set minus itself is the empty set
   if(collection==GetPointer(this))
      return;
//--- copy collection to array
   T array[];
   int size=collection.CopyTo(array);
//--- create emty tree
   CRedBlackTree<T>*tree=new CRedBlackTree<T>();
//--- store values conatin in tree and array
   for(int i=0; i<size; i++)
      if(m_tree.Contains(array[i]))
         tree.Add(array[i]);
//--- overwrite tree
   delete m_tree;
   m_tree=tree;
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present in that object and in the specified array.               |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::IntersectWith(T &array[])
  {
//--- check tree count
   if(m_tree.Count()==0)
      return;
//--- get array size
   int size=ArraySize(array);
//--- create emty tree
   CRedBlackTree<T>*tree=new CRedBlackTree<T>();
//--- store values conatin in tree and array
   for(int i=0; i<size; i++)
      if(m_tree.Contains(array[i]))
         tree.Add(array[i]);
//--- overwrite tree
   delete m_tree;
   m_tree=tree;
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present either in that set or in the specified collection, but   |
//| not both.                                                        |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::SymmetricExceptWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- check collection count
   if(collection.Count()==0)
      return;
//--- check tree count
   if(m_tree.Count()==0)
     {
      UnionWith(collection);
      return;
     }
//--- special case if collection is this
//--- a set minus itself is the empty set
   if(collection==GetPointer(this))
     {
      Clear();
      return;
     }
//--- copy colleaction to array
   T array[];
   int size=collection.CopyTo(array);
//--- get comparer
   IComparer<T>*comparer=m_tree.Comparer();
//--- sort array
   Introsort<T,T>sort;
   ArrayCopy(sort.keys,array);
   sort.comparer=comparer;
   sort.Sort(0, size);
   ArrayCopy(array,sort.keys);
//--- modify tree
   T last=array[0];
   for(int i=0; i<size; i++)
     {
      while(i<size && i!=0 && comparer.Compare(array[i],last)==0)
         i++;
      if(i>=size)
         break;

      if(m_tree.Contains(array[i]))
         m_tree.Remove(array[i]);
      else
         m_tree.Add(array[i]);

      last=array[i];
     }
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain only elements that are       |
//| present either in that set or in the specified array, but not    |
//| both.                                                            |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::SymmetricExceptWith(T &array[])
  {
//--- check array size
   if(ArraySize(array)==0)
      return;
//--- check tree count
   if(m_tree.Count()==0)
     {
      UnionWith(array);
      return;
     }
//--- get size
   int size=ArraySize(array);
//--- get comparer 
   IComparer<T>*comparer=m_tree.Comparer();
//--- sort array
   Introsort<T,T>sort;
   ArrayCopy(sort.keys,array);
   sort.comparer=comparer;
   sort.Sort(0, size);
   ArrayReverse(sort.keys,0,ArraySize(sort.keys));
//--- modify tree
   T last=sort.keys[0];
   for(int i=0; i<size; i++)
     {
      while(i<size && i!=0 && comparer.Compare(sort.keys[i],last)==0)
         i++;
      if(i>=size)
         break;

      if(m_tree.Contains(sort.keys[i]))
         m_tree.Remove(sort.keys[i]);
      else
         m_tree.Add(sort.keys[i]);

      last=sort.keys[i];
     }
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain all elements that are present|
//| in itself, the specified collection, or both.                    |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::UnionWith(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return;
//--- copy all elements from collecton to array
   T array[];
   int size=collection.CopyTo(array);
//--- add all elemets from array to set
   for(int i=0; i<size; i++)
      m_tree.Add(array[i]);
  }
//+------------------------------------------------------------------+
//| Modifies the current set to contain all elements that are present|
//| in itself, the specified array, or both.                         |
//+------------------------------------------------------------------+
template<typename T>
void CSortedSet::UnionWith(T &array[])
  {
//--- get array size
   int size=ArraySize(array);
//--- add all elemets from array to set
   for(int i=0; i<size; i++)
      m_tree.Add(array[i]);
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper subset of the specified     |
//| collection.                                                      |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsProperSubsetOf(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(false);
//--- check tree count
   if(m_tree.Count()==0)
      return(collection.Count() > 0);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return(ptr_set.IsProperSupersetOf(m_tree));
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return(set.IsProperSupersetOf(m_tree));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper subset of the specified     |
//| array.                                                           |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsProperSubsetOf(T &array[])
  {
   if(m_tree.Count()==0)
      return(ArraySize(array) > 0);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   if(m_tree.Count()>=set.Count())
      return(false);
   return(set.IsProperSupersetOf(m_tree));
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper superset of the specified   |
//| collection.                                                      |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsProperSupersetOf(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(m_tree.Count()>0);
//--- check tree count
   if(m_tree.Count()==0)
      return(false);
//--- check collection count
   if(collection.Count()==0)
      return(true);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return(ptr_set.IsProperSubsetOf(m_tree));
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return(set.IsProperSubsetOf(m_tree));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a proper superset of the specified   |
//| array.                                                           |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsProperSupersetOf(T &array[])
  {
   if(m_tree.Count()==0)
      return(false);
   if(ArraySize(array)==0)
      return(true);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   return(set.IsProperSubsetOf(m_tree));
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a subset of the specified collection.|
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsSubsetOf(ICollection<T>*collection)
  {
//--- cehck collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(m_tree.Count()==0);
//--- check tree count
   if(m_tree.Count()==0)
      return(true);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)==POINTER_DYNAMIC)
     {
      return(ptr_set.IsProperSupersetOf(m_tree));
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return(set.IsProperSupersetOf(m_tree));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a subset of the specified array.     |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsSubsetOf(T &array[])
  {
//--- check tree count
   if(m_tree.Count()==0)
      return(true);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   if(m_tree.Count()>set.Count())
      return(false);
   return(set.IsProperSupersetOf(m_tree));
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a superset of the specified          |
//| collection.                                                      |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsSupersetOf(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(m_tree.Count()>=0);
//--- check collection count
   if(collection.Count()==0)
      return(true);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return(ptr_set.IsSupersetOf(m_tree));
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return(set.IsSupersetOf(m_tree));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether a set is a superset of the specified array.   |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::IsSupersetOf(T &array[])
  {
//--- check array size
   if(ArraySize(array)==0)
      return(true);
//--- create a set based on a specified array
   CHashSet<T>set(array);
   return(set.IsSupersetOf(m_tree));
  }
//+------------------------------------------------------------------+
//| Determines whether the current set and a specified collection    |
//| share common elements.                                           |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::Overlaps(ICollection<T>*collection)
  {
//--- check collection
   if(CheckPointer(collection)==POINTER_INVALID)
      return(false);
//--- check tree count
   if(m_tree.Count()==0)
      return(false);
//--- check collection count
   if(collection.Count()==0)
      return(false);
//--- check collection is set
   CHashSet<T>*ptr_set=dynamic_cast<CHashSet<T>*>(collection);
   if(CheckPointer(ptr_set)!=POINTER_INVALID)
     {
      return(ptr_set.Overlaps(m_tree));
     }
   else
     {
      //--- create a set based on a specified collection
      CHashSet<T>set(collection);
      return(set.Overlaps(m_tree));
     }
  }
//+------------------------------------------------------------------+
//| Determines whether the current set and a specified array share   |
//| common elements.                                                 |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::Overlaps(T &array[])
  {
//--- check tree count
   if(m_tree.Count()==0)
      return(false);
//--- check array size
   if(ArraySize(array)==0)
      return(false);
//--- convert array to set
   CHashSet<T>set(array);
   return(set.Overlaps(m_tree));
  }
//+------------------------------------------------------------------+
//| Determines whether a set and the specified collection contain the|
//| same elements.                                                   |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::SetEquals(ICollection<T>*collection)
  {
   if(CheckPointer(collection)==POINTER_INVALID)
      return(false);
//--- get array from collection
   T array[];
   collection.CopyTo(array);
//--- check current set is equal specified array
   return SetEquals(array);
  }
//+------------------------------------------------------------------+
//| Determines whether a set and the specified array contain the same|
//| elements.                                                        |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::SetEquals(T &array[])
  {
//--- try find all elements in the tree
   for(int i=0; i<ArraySize(array); i++)
      if(!m_tree.Contains(array[i]))
         return(false);
   return(true);
  }
//+------------------------------------------------------------------+
//| Copy a view of a subset in a CSortedSet<T> to array.             |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::GetViewBetween(T &array[],T lower_value,T upper_value)
  {
//--- get comparer
   IComparer<T>*comparer=m_tree.Comparer();
   if(comparer.Compare(lower_value,upper_value)>0)
      return(false);
//--- copy all element from tree to array
   T buff[];
   int size=m_tree.CopyTo(buff);
//--- check range
   if(size==0 || comparer.Compare(buff[0],upper_value)>0 || comparer.Compare(buff[size-1],lower_value)<0)
      return(false);
//--- find first element greater than lower_value
   int index_lower=0;
   while(index_lower<size && comparer.Compare(buff[index_lower],lower_value)<0)
      index_lower++;
//--- find first element less than upper_value
   int index_upper=size-1;
   while(index_upper>0 && comparer.Compare(buff[index_upper],upper_value)>0)
      index_upper--;
//--- check indices
   if(index_lower>index_upper)
      return(false);
//--- copy view between lower_value and upper_value to array
   return(ArrayCopy(array,buff,0,index_lower,index_upper-index_lower+1)>=0);
  }
//+------------------------------------------------------------------+
//| Copy the CSortedSet<T> in reverse order to array.                |
//+------------------------------------------------------------------+
template<typename T>
bool CSortedSet::GetReverse(T &array[])
  {
   int size=m_tree.CopyTo(array);
   return ArrayReverse(array,0,size);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                    Introsort.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Struct Introsort<TKey,TItem>.                                    |
//| Usage: Used by the sort methods for instances of array.          |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
struct Introsort
  {
public:
   IComparer<TKey>*  comparer;
   TKey              keys[];
   TItem             items[];

                     Introsort(void) {}
                    ~Introsort(void) {}
   //--- method for sort array
   void              Sort(const int index,const int length);
private:
   //--- methods for introspective sorting
   void              IntroSort(const int lo,const int hi,int depthLimit);
   int               PickPivotAndPartition(const int lo,const int hi);
   void              InsertionSort(const int lo,const int hi);
   //--- methods for heap sorting
   void              Heapsort(const int lo,const int hi);
   void              DownHeap(const int i,const int n,const int lo);
   //--- swap methods
   void              SwapIfGreaterWithItems(const int a,const int b);
   void              Swap(const int i,const int j);
   //--- service methods
   int               FloorLog2(int n) const;
  };
//+------------------------------------------------------------------+
//| IntrospectiveSort is a hybrid sorting algorithm that provides    |
//| both fast average performance and (asymptotically) optimal       |
//| worst-case performance. It begins with quicksort and switches to |
//| heapsort when the recursion depth exceeds a level based on the   |
//| number of elements being sorted.                                 |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::Sort(const int index,const int length)
  {
   if(length<2)
      return;
   IntroSort(index,length+index-1,2*FloorLog2(ArraySize(keys)));
  }
//+------------------------------------------------------------------+
//| Exchanges the values of a and b, if a greater b.                 |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::SwapIfGreaterWithItems(const int a,const int b)
  {
   if(a!=b)
     {
      if(comparer.Compare(keys[a],keys[b])>0)
        {
         TKey key=keys[a];
         keys[a]=keys[b];
         keys[b]=key;
         if(ArraySize(items)!=NULL)
           {
            TItem item=items[a];
            items[a]=items[b];
            items[b]=item;
           }
        }
     }
  }
//+------------------------------------------------------------------+
//| Exchanges the values of a and b.                                 |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::Swap(const int i,const int j)
  {
   TKey key=keys[i];
   keys[i]=keys[j];
   keys[j]=key;
   if(ArraySize(items)!=NULL)
     {
      TItem item=items[i];
      items[i]=items[j];
      items[j]=item;
     }
  }
//+------------------------------------------------------------------+
//| Returns the closest integer value less than or equal to the base |
//| 2 log of the input value.                                        |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
int Introsort::FloorLog2(int n) const
  {
   int result=0;
   while(n>=1)
     {
      result++;
      n=n/2;
     }
   return(result);
  }
//+------------------------------------------------------------------+
//| Introspective sort.                                              |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::IntroSort(const int lo,int hi,int depthLimit)
  {
   const int IntrosortSizeThreshold=16;
   while(hi>lo)
     {
      int partitionSize = hi - lo + 1;
      if(partitionSize <= IntrosortSizeThreshold)
        {
         if(partitionSize==1)
           {
            return;
           }
         if(partitionSize==2)
           {
            SwapIfGreaterWithItems(lo,hi);
            return;
           }
         if(partitionSize==3)
           {
            SwapIfGreaterWithItems(lo,hi-1);
            SwapIfGreaterWithItems(lo,hi);
            SwapIfGreaterWithItems(hi-1,hi);
            return;
           }
         InsertionSort(lo,hi);
         return;
        }
      if(depthLimit==0)
        {
         Heapsort(lo,hi);
         return;
        }
      depthLimit--;
      int p=PickPivotAndPartition(lo,hi);
      IntroSort(p+1,hi,depthLimit);
      hi=p-1;
     }
  }
//+------------------------------------------------------------------+
//| Insertion sort.                                                  |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::InsertionSort(const int lo,const int hi)
  {
   int i,j;
   TKey t;
   TItem dt;
   for(i=lo; i<hi; i++)
     {
      j = i;
      t = keys[i + 1];
      dt=(ArraySize(items)!=NULL) ? (TItem)items[i+1] : (TItem)NULL;
      while(j>=lo && comparer.Compare(t,keys[j])<0)
        {
         keys[j+1]=keys[j];
         if(ArraySize(items)!=NULL)
           {
            items[j+1]=items[j];
           }
         j--;
        }
      keys[j+1]=t;
      if(ArraySize(items)!=NULL)
        {
         items[j+1]=dt;
        }
     }
  }
//+------------------------------------------------------------------+
//| Array partitioning by a quick sort algorithm.                    |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
int Introsort::PickPivotAndPartition(const int lo,const int hi)
  {
//--- Compute median-of-three.  But also partition them, since we've done the comparison.
   int mid=lo+(hi-lo)/2;
   SwapIfGreaterWithItems(lo,mid);
   SwapIfGreaterWithItems(lo,hi);
   SwapIfGreaterWithItems(mid,hi);
   TKey pivot=keys[mid];
   Swap(mid,hi-1);
   int left=lo,right=hi-1;
   while(left<right)
     {
      while(comparer.Compare(keys[++left], pivot) < 0);
      while(comparer.Compare(pivot, keys[--right]) < 0);
      if(left>=right)
         break;
      Swap(left,right);
     }
//--- Put pivot in the right location.
   Swap(left,(hi-1));
   return (left);
  }
//+------------------------------------------------------------------+
//| Heap sorting algorithm.                                          |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::Heapsort(const int lo,const int hi)
  {
   int n=hi-lo+1;
   for(int i=n/2; i>=1; i=i-1)
     {
      DownHeap(i,n,lo);
     }
   for(int i=n; i>1; i=i-1)
     {
      Swap(lo,lo+i-1);
      DownHeap(1,i-1,lo);
     }
  }
//+------------------------------------------------------------------+
//| Downheap function for heapsort.                                  |
//+------------------------------------------------------------------+
template<typename TKey,typename TItem>
void Introsort::DownHeap(int i,const int n,const int lo)
  {
   bool  f=ArraySize(items)!=0;
   TKey  d=keys[lo+i-1];
   TItem dt=f ? (TItem)items[lo+i-1] : (TItem)NULL;

   while(i<=n/2)
     {
      int child=2*i;
      if(child<n && comparer.Compare(keys[lo+child-1],keys[lo+child])<0)
         child++;
      if(!(comparer.Compare(d,keys[lo+child-1])<0))
         break;
      keys[lo+i-1]=keys[lo+child-1];
      if(f)
         items[lo+i-1]=items[lo+child-1];
      i=child;
     }
   keys[lo+i-1]=d;
   if(f)
      items[lo+i-1]=dt;
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                               PrimeGenerator.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Class CPrimeGenrator.                                            |
//| Usage: Used to generate prime numbers.                           |
//+------------------------------------------------------------------+
class CPrimeGenerator
  {
private:
   const static int  s_primes[];       // table of prime numbers
   const static int  s_hash_prime;

public:
   static bool       IsPrime(const int candidate);
   static int        GetPrime(const int min);
   static int        ExpandPrime(const int old_size);
  };
const static int CPrimeGenerator::s_primes[]=
  {
   3,7,11,17,23,29,37,47,59,71,89,107,131,163,197,239,293,353,431,521,631,761,919,
   1103,1327,1597,1931,2333,2801,3371,4049,4861,5839,7013,8419,10103,12143,14591,
   17519,21023,25229,30293,36353,43627,52361,62851,75431,90523,108631,130363,156437,
   187751,225307,270371,324449,389357,467237,560689,672827,807403,968897,1162687,1395263,
   1674319,2009191,2411033,2893249,3471899,4166287,4999559,5999471,7199369,8332579,
   9999161,11998949,14398753,16665163,19998337,23997907,28797523,33330329,39996683,
   47995853,57595063,66660701,79993367,95991737,115190149,133321403,159986773,191983481,
   230380307,266642809,319973567,383966977,460760623,533285671,639947149,767933981,
   921521257,1066571383,1279894313,1535867969,1843042529,2133142771
  };
const static int CPrimeGenerator::s_hash_prime=101;
//+------------------------------------------------------------------+
//| Determines whether a value is prime.                             |
//+------------------------------------------------------------------+
bool CPrimeGenerator::IsPrime(const int candidate)
  {
   if((candidate&1)!=0)
     {
      int limit=(int)MathSqrt(candidate);
      //--- check value is prime
      for(int divisor=3; divisor<=limit; divisor+=2)
         if((candidate%divisor)==0)
            return(false);
      return(true);
     }
   return(candidate==2);
  }
//+------------------------------------------------------------------+
//| Fast generator of prime value.                                   |
//+------------------------------------------------------------------+
int CPrimeGenerator::GetPrime(const int min)
  {
//--- a typical resize algorithm would pick the smallest prime number in this array
//--- that is larger than twice the previous capacity. 
//--- get next prime value from table
   for(int i=0; i<ArraySize(s_primes); i++)
     {
      int prime=s_primes[i];
      if(prime>=min)
         return(prime);
     }
//--- outside of our predefined table
   for(int i=(min|1); i<=INT_MAX;i+=2)
     {
      if(IsPrime(i) && ((i-1)%s_hash_prime!=0))
         return(i);
     }
   return(min);
  }
//+------------------------------------------------------------------+
//| Generate a new prime value greater than old_size.                |
//+------------------------------------------------------------------+
int CPrimeGenerator::ExpandPrime(const int old_size)
  {
   if(old_size>=INT_MAX/2)
      return(INT_MAX);
   return(GetPrime(old_size*2));
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                      DefaultEqualityComparer.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Generic\Interfaces\IEqualityComparer.mqh>
#include "EqualFunction.mqh"
#include "HashFunction.mqh"
//+------------------------------------------------------------------+
//| Class CDefaultEqualityComparer<T>.                               |
//| Usage: Provides a default class for implementations of the       |
//|        IEqualityComparer<T> generic interface.                   |
//+------------------------------------------------------------------+
template<typename T>
class CDefaultEqualityComparer: public IEqualityComparer<T>
  {
public:
                     CDefaultEqualityComparer(void) {                           }
                    ~CDefaultEqualityComparer(void) {                           }
   //--- determines whether the specified values are equal
   bool              Equals(T x,T y)                { return ::Equals(x,y);     }
   //--- returns a hash code for the specified object
   int               HashCode(T value)              { return ::GetHashCode(value); }
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                              DefaultComparer.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Generic\Interfaces\IComparer.mqh>
#include "CompareFunction.mqh"
//+------------------------------------------------------------------+
//| Class CDefaultComparer<T>.                                       |
//| Usage: Provides a default class for implementations of the       |
//|        IComparer<T> generic interface.                           |
//+------------------------------------------------------------------+
template<typename T>
class CDefaultComparer: public IComparer<T>
  {
public:
                     CDefaultComparer(void) {                        }
                    ~CDefaultComparer(void) {                        }
   //--- compares two values and returns a value describing relationship between them
   int               Compare(T x,T y) { return ::Compare(x,y); }
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                EqualFunction.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Generic\Interfaces\IEqualityComparable.mqh>
//+------------------------------------------------------------------+
//| Indicates whether x object is equal y object of the same type.   |
//+------------------------------------------------------------------+
template<typename T>
bool Equals(T x,T y)
  {
//--- try to convert to equality comparable object  
   IEqualityComparable<T>*equtable=dynamic_cast<IEqualityComparable<T>*>(x);
   if(equtable)
     {
      //--- use specied equality compare method
      return equtable.Equals(y);
     }
   else
     {
      //--- use default equality comparer operator
      return(x==y);
     }
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                ArrayFunction.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "CompareFunction.mqh"
#include <Generic\Interfaces\IComparer.mqh>
//+------------------------------------------------------------------+
//| Searches an entire one-dimensional sorted array for a specific   |
//| element, using the IComparable<T> generic interface implemented  |
//| by each element of the array and by the specified object.        |
//+------------------------------------------------------------------+
template<typename T>
int ArrayBinarySearch(T &array[],const int start_index,const int count, T value,IComparer<T>*comparer)
  {
   int lo=start_index;
   int hi=start_index+count-1;
   int size=ArraySize(array);
//--- check array size
   if(size==0)
      return(-1);
//--- check comaparer
   if(CheckPointer(comparer)==POINTER_INVALID)
      return(-1);
//--- check index
   if(start_index<0 || count<0 || size-start_index<count)
      return(-1);
//--- bianry search value   
   while(lo<=hi)
     {
      int i=lo+((hi-lo)>>1);
      int order=comparer.Compare(array[i],value);
      if(order==0)
        {
         return(i);
        }
      if(order<0)
        {
         lo=i+1;
        }
      else
        {
         hi=i-1;
        }
     }
//--- returns the index of an element nearest in value
   if(lo>0)
      return(lo-1);
   return(lo);
  }
//+------------------------------------------------------------------+
//| Searches for the specified object and returns the index of its   |
//| first occurrence in a one-dimensional array.                     |
//+------------------------------------------------------------------+
template<typename T>
int ArrayIndexOf(T &array[],T value,const int start_index,const int count)
  {
   int size=ArraySize(array);
//--- check array size
   if(size==0)
      return(-1);
//--- check start index and count
   if(start_index<0 || start_index>size || 
      count<0 || count>size-start_index)
      return(-1);
//--- search value
   int end_index=start_index+count;
   for(int i=start_index; i<end_index; i++)
     {
      //--- check the value in array is eqaul to specified value     
      if(::Equals(array[i],value))
        {
         //--- return fist index 
         return(i);
        }
     }
//--- return -1 if value not in array                                     
   return(-1);
  }
//+------------------------------------------------------------------+
//| Returns the index of the last occurrence of a value in a         |
//| one-dimensional array.                                           |
//+------------------------------------------------------------------+
template<typename T>
int ArrayLastIndexOf(T &array[],T value,const int start_index,const int count)
  {
   int size=ArraySize(array);
//--- check array size
   if(size==0)
      return(-1);
//--- check start index and count
   if(start_index<0 || start_index>=size || 
      count<0 || count>start_index+1)
      return(-1);
//--- search value
   int end_index=start_index-count+1;
   for(int i=start_index; i>=end_index; i--)
     {
      //--- check the value in array is eqaul to specified value     
      if(::Equals(array[i],value))
        {
         //--- return fist index from the end         
         return (i);
        }
     }
//--- return -1 if value not in array
   return(-1);
  }
//+------------------------------------------------------------------+
//| Reverses the elements in a range of this array. Following a call |
//| to this method, an element in the range given by index and count |
//| which was previously located at index i will now be located at   |
//| index index + (index + count - i - 1).                           |
//+------------------------------------------------------------------+
template<typename T>
bool ArrayReverse(T &array[],const int start_index,const int count)
  {
   int size=ArraySize(array);
//--- check start index and count
   if(count<0 || size-start_index<count)
      return(false);
//--- reverse elements
   int i = start_index;
   int j = start_index + count - 1;
   while(i<j)
     {
      T temp=array[i];
      array[i] = array[j];
      array[j] = temp;
      i++;
      j--;
     }
   return(true);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                 HashFunction.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Unioun BitInterpreter.                                           |
//| Usage: Provides the ability to interpret the same bit sequence in|
//|        different types.                                          |
//+------------------------------------------------------------------+
union  BitInterpreter
  {
   bool              bool_value;
   char              char_value;
   uchar             uchar_value;
   short             short_value;
   ushort            ushort_value;
   color             color_value;
   int               int_value;
   uint              uint_value;
   datetime          datetime_value;
   long              long_value;
   ulong             ulong_value;
   float             float_value;
   double            double_value;
  };
//+------------------------------------------------------------------+
//| Returns a hashcode for boolean.                                  |
//+------------------------------------------------------------------+
int GetHashCode(const bool value)
  {
   return((value)?true:false);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for character.                                |
//+------------------------------------------------------------------+
int GetHashCode(const char value)
  {
   return((int)value | ((int)value << 16));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for unsigned character.                       |
//+------------------------------------------------------------------+
int GetHashCode(const uchar value)
  {
   return((int)value | ((int)value << 16));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for short.                                    |
//+------------------------------------------------------------------+
int GetHashCode(const short value)
  {
   return(((int)((ushort)value) | (((int)value) << 16)));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for unsigned short.                           |
//+------------------------------------------------------------------+
int GetHashCode(const ushort value)
  {
   return((int)value);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for color.                                    |
//+------------------------------------------------------------------+
int GetHashCode(const color value)
  {
   return((int)value);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for integer.                                  |
//+------------------------------------------------------------------+
int GetHashCode(const int value)
  {
   return(value);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for unsigned integer.                         |
//+------------------------------------------------------------------+ 
int GetHashCode(const uint value)
  {
   return((int)value);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for datetime.                                 |
//+------------------------------------------------------------------+
int GetHashCode(const datetime value)
  {
   long ticks=(long)value;
   return(((int)ticks) ^ (int)(ticks >> 32));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for long.                                     |
//+------------------------------------------------------------------+
int GetHashCode(const long value)
  {
   return(((int)((long)value)) ^ (int)(value >> 32));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for unsigned long.                            |
//+------------------------------------------------------------------+  
int GetHashCode(const ulong value)
  {
   return(((int)value) ^ (int)(value >> 32));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for float.                                    |
//+------------------------------------------------------------------+
int GetHashCode(const float value)
  {
   if(value==0)
     {
      //--- ensure that 0 and -0 have the same hash code
      return(0);
     }
   BitInterpreter convert;
   convert.float_value=value;
   return(convert.int_value);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for string.                                   |
//+------------------------------------------------------------------+
int GetHashCode(const double value)
  {
   if(value==0)
     {
      //--- ensure that 0 and -0 have the same hash code
      return(0);
     }
   BitInterpreter convert;
   convert.double_value=value;
   long lvalue=convert.long_value;
   return(((int)lvalue) ^ ((int)(lvalue >> 32)));
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for string.                                   |
//| The hashcode for a string is computed as:                        |
//|                                                                  |
//| s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1]                     |
//|                                                                  |
//| using int arithmetic, where s[i] is the ith character of the     |
//| string, n is the length of the string, and ^ indicates           |
//| exponentiation. (The hash value of the empty string is zero.)    |
//+------------------------------------------------------------------+
int GetHashCode(const string value)
  {
   int len=StringLen(value);
   int hash=0;
//--- check length of string
   if(len>0)
     {
      //--- calculate a hash as a fucntion of each char
      for(int i=0; i<len; i++)
         hash=31*hash+value[i];
     }
   return(hash);
  }
//+------------------------------------------------------------------+
//| Returns a hashcode for custom object.                            |
//+------------------------------------------------------------------+
template<typename T>
int GetHashCode(T value)
  {
//--- try to convert to equality comparable object  
   IEqualityComparable<T>*equtable=dynamic_cast<IEqualityComparable<T>*>(value);
   if(equtable)
     {
      //--- calculate hash by specied method   
      return equtable.HashCode();
     }
   else
     {
      //--- calculate hash from name of object
      return GetHashCode(typename(value));
     }
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                              CompareFunction.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Generic\Interfaces\IComparable.mqh>
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const bool x,const bool y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const char x,const char y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const uchar x,const uchar y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const short x,const short y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const ushort x,const ushort y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const color x,const color y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const int x,const int y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const uint x,const uint y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const datetime x,const datetime y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const long x,const long y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const ulong x,const ulong y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const float x,const float y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const double x,const double y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
int Compare(const string x,const string y)
  {
   if(x>y)
      return(1);
   else if(x<y)
      return(-1);
   else
      return(0);
  }
//+------------------------------------------------------------------+
//| Compares two objects and returns a value indicating whether one  |
//| is less than, equal to, or greater than the other.               |
//+------------------------------------------------------------------+
template<typename T>
int Compare(T x,T y)
  {
//--- try to convert to comparable object  
   IComparable<T>*comparable=dynamic_cast<IComparable<T>*>(x);
   if(comparable)
     {
      //--- use specied compare method
      return comparable.Compare(y);
     }
   else
     {
      //--- unknown compare function     
      return(0);
     }
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                    StdLibErr.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#define ERR_USER_INVALID_HANDLE                            1
#define ERR_USER_INVALID_BUFF_NUM                          2
#define ERR_USER_ITEM_NOT_FOUND                            3
#define ERR_USER_ARRAY_IS_EMPTY                            1000
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                       Object.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "StdLibErr.mqh"
//+------------------------------------------------------------------+
//| Class CObject.                                                   |
//| Purpose: Base class for storing elements.                        |
//+------------------------------------------------------------------+
class CObject
  {
private:
   CObject          *m_prev;               // previous item of list
   CObject          *m_next;               // next item of list

public:
                     CObject(void): m_prev(NULL),m_next(NULL)            {                 }
                    ~CObject(void)                                       {                 }
   //--- methods to access protected data
   CObject          *Prev(void)                                    const { return(m_prev); }
   void              Prev(CObject *node)                                 { m_prev=node;    }
   CObject          *Next(void)                                    const { return(m_next); }
   void              Next(CObject *node)                                 { m_next=node;    }
   //--- methods for working with files
   virtual bool      Save(const int file_handle)                         { return(true);   }
   virtual bool      Load(const int file_handle)                         { return(true);   }
   //--- method of identifying the object
   virtual int       Type(void)                                    const { return(0);      }
   //--- method of comparing the objects
   virtual int       Compare(const CObject *node,const int mode=0) const { return(0);      }
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                 PositionInfo.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Object.mqh>
//+------------------------------------------------------------------+
//| Class CPositionInfo.                                             |
//| Appointment: Class for access to position info.                  |
//|              Derives from class CObject.                         |
//+------------------------------------------------------------------+
class CPositionInfo : public CObject
  {
protected:
   ENUM_POSITION_TYPE m_type;
   double            m_volume;
   double            m_price;
   double            m_stop_loss;
   double            m_take_profit;

public:
                     CPositionInfo(void);
                    ~CPositionInfo(void);
   //--- fast access methods to the integer position propertyes
   ulong             Ticket(void) const;
   datetime          Time(void) const;
   ulong             TimeMsc(void) const;
   datetime          TimeUpdate(void) const;
   ulong             TimeUpdateMsc(void) const;
   ENUM_POSITION_TYPE PositionType(void) const;
   string            TypeDescription(void) const;
   long              Magic(void) const;
   long              Identifier(void) const;
   //--- fast access methods to the double position propertyes
   double            Volume(void) const;
   double            PriceOpen(void) const;
   double            StopLoss(void) const;
   double            TakeProfit(void) const;
   double            PriceCurrent(void) const;
   double            Commission(void) const;
   double            Swap(void) const;
   double            Profit(void) const;
   //--- fast access methods to the string position propertyes
   string            Symbol(void) const;
   string            Comment(void) const;
   //--- access methods to the API MQL5 functions
   bool              InfoInteger(const ENUM_POSITION_PROPERTY_INTEGER prop_id,long &var) const;
   bool              InfoDouble(const ENUM_POSITION_PROPERTY_DOUBLE prop_id,double &var) const;
   bool              InfoString(const ENUM_POSITION_PROPERTY_STRING prop_id,string &var) const;
   //--- info methods
   string            FormatType(string &str,const uint type) const;
   string            FormatPosition(string &str) const;
   //--- methods for select position
   bool              Select(const string symbol);
   bool              SelectByMagic(const string symbol,const ulong magic);
   bool              SelectByTicket(const ulong ticket);
   bool              SelectByIndex(const int index);
   //---
   void              StoreState(void);
   bool              CheckState(void);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CPositionInfo::CPositionInfo(void) : m_type(WRONG_VALUE),
                                     m_volume(0.0),
                                     m_price(0.0),
                                     m_stop_loss(0.0),
                                     m_take_profit(0.0)
  {
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CPositionInfo::~CPositionInfo(void)
  {
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TICKET"                         |
//+------------------------------------------------------------------+
ulong CPositionInfo::Ticket(void) const
  {
   return((ulong)PositionGetInteger(POSITION_TICKET));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TIME"                           |
//+------------------------------------------------------------------+
datetime CPositionInfo::Time(void) const
  {
   return((datetime)PositionGetInteger(POSITION_TIME));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TIME_MSC"                       |
//+------------------------------------------------------------------+
ulong CPositionInfo::TimeMsc(void) const
  {
   return((ulong)PositionGetInteger(POSITION_TIME_MSC));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TIME_UPDATE"                    |
//+------------------------------------------------------------------+
datetime CPositionInfo::TimeUpdate(void) const
  {
   return((datetime)PositionGetInteger(POSITION_TIME_UPDATE));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TIME_UPDATE_MSC"                |
//+------------------------------------------------------------------+
ulong CPositionInfo::TimeUpdateMsc(void) const
  {
   return((ulong)PositionGetInteger(POSITION_TIME_UPDATE_MSC));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TYPE"                           |
//+------------------------------------------------------------------+
ENUM_POSITION_TYPE CPositionInfo::PositionType(void) const
  {
   return((ENUM_POSITION_TYPE)PositionGetInteger(POSITION_TYPE));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TYPE" as string                 |
//+------------------------------------------------------------------+
string CPositionInfo::TypeDescription(void) const
  {
   string str;
//---
   return(FormatType(str,PositionType()));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_MAGIC"                          |
//+------------------------------------------------------------------+
long CPositionInfo::Magic(void) const
  {
   return(PositionGetInteger(POSITION_MAGIC));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_IDENTIFIER"                     |
//+------------------------------------------------------------------+
long CPositionInfo::Identifier(void) const
  {
   return(PositionGetInteger(POSITION_IDENTIFIER));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_VOLUME"                         |
//+------------------------------------------------------------------+
double CPositionInfo::Volume(void) const
  {
   return(PositionGetDouble(POSITION_VOLUME));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_PRICE_OPEN"                     |
//+------------------------------------------------------------------+
double CPositionInfo::PriceOpen(void) const
  {
   return(PositionGetDouble(POSITION_PRICE_OPEN));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_SL"                             |
//+------------------------------------------------------------------+
double CPositionInfo::StopLoss(void) const
  {
   return(PositionGetDouble(POSITION_SL));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_TP"                             |
//+------------------------------------------------------------------+
double CPositionInfo::TakeProfit(void) const
  {
   return(PositionGetDouble(POSITION_TP));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_PRICE_CURRENT"                  |
//+------------------------------------------------------------------+
double CPositionInfo::PriceCurrent(void) const
  {
   return(PositionGetDouble(POSITION_PRICE_CURRENT));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_COMMISSION"                     |
//+------------------------------------------------------------------+
double CPositionInfo::Commission(void) const
  {
   return(PositionGetDouble(POSITION_COMMISSION));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_SWAP"                           |
//+------------------------------------------------------------------+
double CPositionInfo::Swap(void) const
  {
   return(PositionGetDouble(POSITION_SWAP));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_PROFIT"                         |
//+------------------------------------------------------------------+
double CPositionInfo::Profit(void) const
  {
   return(PositionGetDouble(POSITION_PROFIT));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_SYMBOL"                         |
//+------------------------------------------------------------------+
string CPositionInfo::Symbol(void) const
  {
   return(PositionGetString(POSITION_SYMBOL));
  }
//+------------------------------------------------------------------+
//| Get the property value "POSITION_COMMENT"                        |
//+------------------------------------------------------------------+
string CPositionInfo::Comment(void) const
  {
   return(PositionGetString(POSITION_COMMENT));
  }
//+------------------------------------------------------------------+
//| Access functions PositionGetInteger(...)                         |
//+------------------------------------------------------------------+
bool CPositionInfo::InfoInteger(const ENUM_POSITION_PROPERTY_INTEGER prop_id,long &var) const
  {
   return(PositionGetInteger(prop_id,var));
  }
//+------------------------------------------------------------------+
//| Access functions PositionGetDouble(...)                          |
//+------------------------------------------------------------------+
bool CPositionInfo::InfoDouble(const ENUM_POSITION_PROPERTY_DOUBLE prop_id,double &var) const
  {
   return(PositionGetDouble(prop_id,var));
  }
//+------------------------------------------------------------------+
//| Access functions PositionGetString(...)                          |
//+------------------------------------------------------------------+
bool CPositionInfo::InfoString(const ENUM_POSITION_PROPERTY_STRING prop_id,string &var) const
  {
   return(PositionGetString(prop_id,var));
  }
//+------------------------------------------------------------------+
//| Converts the position type to text                               |
//+------------------------------------------------------------------+
string CPositionInfo::FormatType(string &str,const uint type) const
  {
//--- see the type
   switch(type)
     {
      case POSITION_TYPE_BUY:
         str="buy";
         break;
      case POSITION_TYPE_SELL:
         str="sell";
         break;
      default:
         str="unknown position type "+(string)type;
     }
//--- return the result
   return(str);
  }
//+------------------------------------------------------------------+
//| Converts the position parameters to text                         |
//+------------------------------------------------------------------+
string CPositionInfo::FormatPosition(string &str) const
  {
   string tmp,type;
   long   tmp_long;
   ENUM_ACCOUNT_MARGIN_MODE margin_mode=(ENUM_ACCOUNT_MARGIN_MODE)AccountInfoInteger(ACCOUNT_MARGIN_MODE);
//--- set up
   string symbol_name=this.Symbol();
   int    digits=_Digits;
   if(SymbolInfoInteger(symbol_name,SYMBOL_DIGITS,tmp_long))
      digits=(int)tmp_long;
//--- form the position description
   if(margin_mode==ACCOUNT_MARGIN_MODE_RETAIL_HEDGING)
      str=StringFormat("#%I64u %s %s %s %s",
                       Ticket(),
                       FormatType(type,PositionType()),
                       DoubleToString(Volume(),2),
                       symbol_name,
                       DoubleToString(PriceOpen(),digits+3));
   else
      str=StringFormat("%s %s %s %s",
                       FormatType(type,PositionType()),
                       DoubleToString(Volume(),2),
                       symbol_name,
                       DoubleToString(PriceOpen(),digits+3));
//--- add stops if there are any
   double sl=StopLoss();
   double tp=TakeProfit();
   if(sl!=0.0)
     {
      tmp=StringFormat(" sl: %s",DoubleToString(sl,digits));
      str+=tmp;
     }
   if(tp!=0.0)
     {
      tmp=StringFormat(" tp: %s",DoubleToString(tp,digits));
      str+=tmp;
     }
//--- return the result
   return(str);
  }
//+------------------------------------------------------------------+
//| Access functions PositionSelect(...)                             |
//+------------------------------------------------------------------+
bool CPositionInfo::Select(const string symbol)
  {
   return(PositionSelect(symbol));
  }
//+------------------------------------------------------------------+
//| Access functions PositionSelect(...)                             |
//+------------------------------------------------------------------+
bool CPositionInfo::SelectByMagic(const string symbol,const ulong magic)
  {
   bool res=false;
   uint total=PositionsTotal();
//---
   for(uint i=0; i<total; i++)
     {
      string position_symbol=PositionGetSymbol(i);
      if(position_symbol==symbol && magic==PositionGetInteger(POSITION_MAGIC))
        {
         res=true;
         break;
        }
     }
//---
   return(res);
  }
//+------------------------------------------------------------------+
//| Access functions PositionSelectByTicket(...)                     |
//+------------------------------------------------------------------+
bool CPositionInfo::SelectByTicket(const ulong ticket)
  {
   return(PositionSelectByTicket(ticket));
  }
//+------------------------------------------------------------------+
//| Select a position on the index                                   |
//+------------------------------------------------------------------+
bool CPositionInfo::SelectByIndex(const int index)
  {
   ulong ticket=PositionGetTicket(index);
   return(ticket>0);
  }
//+------------------------------------------------------------------+
//| Stored position's current state                                  |
//+------------------------------------------------------------------+
void CPositionInfo::StoreState(void)
  {
   m_type       =PositionType();
   m_volume     =Volume();
   m_price      =PriceOpen();
   m_stop_loss  =StopLoss();
   m_take_profit=TakeProfit();
  }
//+------------------------------------------------------------------+
//| Check position change                                            |
//+------------------------------------------------------------------+
bool CPositionInfo::CheckState(void)
  {
   if(m_type==PositionType()  &&
      m_volume==Volume()      &&
      m_price==PriceOpen()    &&
      m_stop_loss==StopLoss() &&
      m_take_profit==TakeProfit())
      return(false);
//---
   return(true);
  }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                     DealInfo.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Object.mqh>
//+------------------------------------------------------------------+
//| Class CDealInfo.                                                 |
//| Appointment: Class for access to history deal info.              |
//|              Derives from class CObject.                         |
//+------------------------------------------------------------------+
class CDealInfo : public CObject
 {
protected:
  ulong              m_ticket;             // ticket of history order

public:
                     CDealInfo(void);
                    ~CDealInfo(void);
  //--- methods of access to protected data
  void               Ticket(const ulong ticket)   { m_ticket = ticket;  }
  ulong              Ticket(void)           const { return(m_ticket); }
  //--- fast access methods to the integer position propertyes
  long               Order(void) const;
  datetime           Time(void) const;
  ulong              TimeMsc(void) const;
  ENUM_DEAL_TYPE     DealType(void) const;
  string             TypeDescription(void) const;
  ENUM_DEAL_ENTRY    Entry(void) const;
  string             EntryDescription(void) const;
  long               Magic(void) const;
  long               PositionId(void) const;
  ENUM_DEAL_REASON   Reason(void) const;
  string             ReasonDescription(void) const;
  //--- fast access methods to the double position propertyes
  double             Volume(void) const;
  double             Price(void) const;
  double             Commission(void) const;
  double             Swap(void) const;
  double             Profit(void) const;
  double             Fee(void) const;
  double             StopLoss(void) const;
  double             TackProfit(void) const;
  //--- fast access methods to the string position propertyes
  string             Symbol(void) const;
  string             Comment(void) const;
  string             ExternalId(void) const;
  //--- access methods to the API MQL5 functions
  bool               InfoInteger(ENUM_DEAL_PROPERTY_INTEGER prop_id, long &var) const;
  bool               InfoDouble(ENUM_DEAL_PROPERTY_DOUBLE prop_id, double &var) const;
  bool               InfoString(ENUM_DEAL_PROPERTY_STRING prop_id, string &var) const;
  //--- info methods
  string             FormatAction(string &str, const uint action) const;
  string             FormatEntry(string &str, const uint entry) const;
  string             FormatDeal(string &str) const;
  //--- method for select deal
  bool               SelectByIndex(const int index);
 };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CDealInfo::CDealInfo(void)
 {
 }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CDealInfo::~CDealInfo(void)
 {
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_ORDER"                              |
//+------------------------------------------------------------------+
long CDealInfo::Order(void) const
 {
  return(HistoryDealGetInteger(m_ticket, DEAL_ORDER));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_TIME"                               |
//+------------------------------------------------------------------+
datetime CDealInfo::Time(void) const
 {
  return((datetime)HistoryDealGetInteger(m_ticket, DEAL_TIME));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_TIME_MSC"                           |
//+------------------------------------------------------------------+
ulong CDealInfo::TimeMsc(void) const
 {
  return(HistoryDealGetInteger(m_ticket, DEAL_TIME_MSC));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_TYPE"                               |
//+------------------------------------------------------------------+
ENUM_DEAL_TYPE CDealInfo::DealType(void) const
 {
  return((ENUM_DEAL_TYPE)HistoryDealGetInteger(m_ticket, DEAL_TYPE));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_TYPE" as string                     |
//+------------------------------------------------------------------+
string CDealInfo::TypeDescription(void) const
 {
  string str;
//---
  switch(DealType())
   {
    case DEAL_TYPE_BUY:
      str = "Buy type";
      break;
    case DEAL_TYPE_SELL:
      str = "Sell type";
      break;
    case DEAL_TYPE_BALANCE:
      str = "Balance type";
      break;
    case DEAL_TYPE_CREDIT:
      str = "Credit type";
      break;
    case DEAL_TYPE_CHARGE:
      str = "Charge type";
      break;
    case DEAL_TYPE_CORRECTION:
      str = "Correction type";
      break;
    case DEAL_TYPE_BONUS:
      str = "Bonus type";
      break;
    case DEAL_TYPE_COMMISSION:
      str = "Commission type";
      break;
    case DEAL_TYPE_COMMISSION_DAILY:
      str = "Daily Commission type";
      break;
    case DEAL_TYPE_COMMISSION_MONTHLY:
      str = "Monthly Commission type";
      break;
    case DEAL_TYPE_COMMISSION_AGENT_DAILY:
      str = "Daily Agent Commission type";
      break;
    case DEAL_TYPE_COMMISSION_AGENT_MONTHLY:
      str = "Monthly Agent Commission type";
      break;
    case DEAL_TYPE_INTEREST:
      str = "Interest Rate type";
      break;
    case DEAL_TYPE_BUY_CANCELED:
      str = "Canceled Buy type";
      break;
    case DEAL_TYPE_SELL_CANCELED:
      str = "Canceled Sell type";
      break;
    default:
      str = "Unknown type";
   }
//---
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_ENTRY"                              |
//+------------------------------------------------------------------+
ENUM_DEAL_ENTRY CDealInfo::Entry(void) const
 {
  return((ENUM_DEAL_ENTRY)HistoryDealGetInteger(m_ticket, DEAL_ENTRY));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_ENTRY" as string                    |
//+------------------------------------------------------------------+
string CDealInfo::EntryDescription(void) const
 {
  string str;
//---
  switch(CDealInfo::Entry())
   {
    case DEAL_ENTRY_IN:
      str = "In entry";
      break;
    case DEAL_ENTRY_OUT:
      str = "Out entry";
      break;
    case DEAL_ENTRY_INOUT:
      str = "InOut entry";
      break;
    case DEAL_ENTRY_STATE:
      str = "Status record";
      break;
    case DEAL_ENTRY_OUT_BY:
      str = "Out By entry";
      break;
    default:
      str = "Unknown entry";
   }
//---
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_MAGIC"                              |
//+------------------------------------------------------------------+
long CDealInfo::Magic(void) const
 {
  return(HistoryDealGetInteger(m_ticket, DEAL_MAGIC));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_POSITION_ID"                        |
//+------------------------------------------------------------------+
long CDealInfo::PositionId(void) const
 {
  return(HistoryDealGetInteger(m_ticket, DEAL_POSITION_ID));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_REASON"                             |
//+------------------------------------------------------------------+
ENUM_DEAL_REASON  CDealInfo::Reason(void) const
 {
  return((ENUM_DEAL_REASON)HistoryDealGetInteger(m_ticket, DEAL_REASON));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_REASON" as string                   |
//+------------------------------------------------------------------+
string CDealInfo::ReasonDescription(void) const
 {
  string str;
//---
  switch(CDealInfo::Reason())
   {
    case DEAL_REASON_CLIENT:
      str = "Desktop terminal";
      break;
    case DEAL_REASON_MOBILE:
      str = "Mobile application";
      break;
    case DEAL_REASON_WEB:
      str = "Web platform";
      break;
    case DEAL_REASON_EXPERT:
      str = "Expert Advisor";
      break;
    case DEAL_REASON_SL:
      str = "Stop Loss";
      break;
    case DEAL_REASON_TP:
      str = "Take Profit";
      break;
    case DEAL_REASON_SO:
      str = "Stop Out";
      break;
    case DEAL_REASON_ROLLOVER:
      str = "Rollover";
      break;
    case DEAL_REASON_VMARGIN:
      str = "Variation margin";
      break;
    case DEAL_REASON_SPLIT:
      str = "SPLIT(price reduction)";
      break;
    case DEAL_REASON_CORPORATE_ACTION:
      str = "Corporate action";
      break;
    default:
      str = "Unknown reason";
   }
//---
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_VOLUME"                             |
//+------------------------------------------------------------------+
double CDealInfo::Volume(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_VOLUME));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_PRICE_OPEN"                         |
//+------------------------------------------------------------------+
double CDealInfo::Price(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_PRICE));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_COMMISSION"                         |
//+------------------------------------------------------------------+
double CDealInfo::Commission(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_COMMISSION));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_SWAP"                               |
//+------------------------------------------------------------------+
double CDealInfo::Swap(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_SWAP));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_PROFIT"                             |
//+------------------------------------------------------------------+
double CDealInfo::Profit(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_PROFIT));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_FEE"                                |
//+------------------------------------------------------------------+
double CDealInfo::Fee(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_FEE));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_SL"                                |
//+------------------------------------------------------------------+
double CDealInfo::StopLoss(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_SL));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_TP"                                |
//+------------------------------------------------------------------+
double CDealInfo::TackProfit(void) const
 {
  return(HistoryDealGetDouble(m_ticket, DEAL_TP));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_SYMBOL"                             |
//+------------------------------------------------------------------+
string CDealInfo::Symbol(void) const
 {
  return(HistoryDealGetString(m_ticket, DEAL_SYMBOL));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_COMMENT"                            |
//+------------------------------------------------------------------+
string CDealInfo::Comment(void) const
 {
  return(HistoryDealGetString(m_ticket, DEAL_COMMENT));
 }
//+------------------------------------------------------------------+
//| Get the property value "DEAL_EXTERNAL_ID"                        |
//+------------------------------------------------------------------+
string CDealInfo::ExternalId(void) const
 {
  return(HistoryDealGetString(m_ticket, DEAL_EXTERNAL_ID));
 }
//+------------------------------------------------------------------+
//| Access functions HistoryDealGetInteger(...)                      |
//+------------------------------------------------------------------+
bool CDealInfo::InfoInteger(ENUM_DEAL_PROPERTY_INTEGER prop_id, long &var) const
 {
  return(HistoryDealGetInteger(m_ticket, prop_id, var));
 }
//+------------------------------------------------------------------+
//| Access functions HistoryDealGetDouble(...)                       |
//+------------------------------------------------------------------+
bool CDealInfo::InfoDouble(ENUM_DEAL_PROPERTY_DOUBLE prop_id, double &var) const
 {
  return(HistoryDealGetDouble(m_ticket, prop_id, var));
 }
//+------------------------------------------------------------------+
//| Access functions HistoryDealGetString(...)                       |
//+------------------------------------------------------------------+
bool CDealInfo::InfoString(ENUM_DEAL_PROPERTY_STRING prop_id, string &var) const
 {
  return(HistoryDealGetString(m_ticket, prop_id, var));
 }
//+------------------------------------------------------------------+
//| Converths the type of a  deal to text                            |
//+------------------------------------------------------------------+
string CDealInfo::FormatAction(string &str, const uint action) const
 {
//--- see the type
  switch(action)
   {
    case DEAL_TYPE_BUY:
      str = "buy";
      break;
    case DEAL_TYPE_SELL:
      str = "sell";
      break;
    case DEAL_TYPE_BALANCE:
      str = "balance";
      break;
    case DEAL_TYPE_CREDIT:
      str = "credit";
      break;
    case DEAL_TYPE_CHARGE:
      str = "charge";
      break;
    case DEAL_TYPE_CORRECTION:
      str = "correction";
      break;
    case DEAL_TYPE_BONUS:
      str = "bonus";
      break;
    case DEAL_TYPE_COMMISSION:
      str = "commission";
      break;
    case DEAL_TYPE_COMMISSION_DAILY:
      str = "daily commission";
      break;
    case DEAL_TYPE_COMMISSION_MONTHLY:
      str = "monthly commission";
      break;
    case DEAL_TYPE_COMMISSION_AGENT_DAILY:
      str = "daily agent commission";
      break;
    case DEAL_TYPE_COMMISSION_AGENT_MONTHLY:
      str = "monthly agent commission";
      break;
    case DEAL_TYPE_INTEREST:
      str = "interest rate";
      break;
    case DEAL_TYPE_BUY_CANCELED:
      str = "canceled buy";
      break;
    case DEAL_TYPE_SELL_CANCELED:
      str = "canceled sell";
      break;
    default:
      str = "unknown deal type " + (string)action;
   }
//--- return the result
  return(str);
 }
//+------------------------------------------------------------------+
//| Converts the deal direction to text                              |
//+------------------------------------------------------------------+
string CDealInfo::FormatEntry(string &str, const uint entry) const
 {
//--- see the type
  switch(entry)
   {
    case DEAL_ENTRY_IN:
      str = "in";
      break;
    case DEAL_ENTRY_OUT:
      str = "out";
      break;
    case DEAL_ENTRY_INOUT:
      str = "in/out";
      break;
    case DEAL_ENTRY_OUT_BY:
      str = "out by";
      break;
    default:
      str = "unknown deal entry " + (string)entry;
   }
//--- return the result
  return(str);
 }
//+------------------------------------------------------------------+
//| Converts the deal parameters to text                             |
//+------------------------------------------------------------------+
string CDealInfo::FormatDeal(string &str) const
 {
  string type;
  long   tmp_long;
//--- set up
  string symbol_name = this.Symbol();
  int    digits = _Digits;
  if(SymbolInfoInteger(symbol_name, SYMBOL_DIGITS, tmp_long))
    digits = (int)tmp_long;
//--- form the description of the deal
  switch(DealType())
   {
    //--- Buy-Sell
    case DEAL_TYPE_BUY:
    case DEAL_TYPE_SELL:
      str = StringFormat("#%I64u %s %s %s at %s",
                         Ticket(),
                         FormatAction(type, DealType()),
                         DoubleToString(Volume(), 2),
                         symbol_name,
                         DoubleToString(Price(), digits));
      break;

    //--- balance operations
    case DEAL_TYPE_BALANCE:
    case DEAL_TYPE_CREDIT:
    case DEAL_TYPE_CHARGE:
    case DEAL_TYPE_CORRECTION:
    case DEAL_TYPE_BONUS:
    case DEAL_TYPE_COMMISSION:
    case DEAL_TYPE_COMMISSION_DAILY:
    case DEAL_TYPE_COMMISSION_MONTHLY:
    case DEAL_TYPE_COMMISSION_AGENT_DAILY:
    case DEAL_TYPE_COMMISSION_AGENT_MONTHLY:
    case DEAL_TYPE_INTEREST:
      str = StringFormat("#%I64u %s %s [%s]",
                         Ticket(),
                         FormatAction(type, DealType()),
                         DoubleToString(Profit(), 2),
                         this.Comment());
      break;

    default:
      str = "unknown deal type " + (string)DealType();
   }
//--- return the result
  return(str);
 }
//+------------------------------------------------------------------+
//| Select a deal on the index                                       |
//+------------------------------------------------------------------+
bool CDealInfo::SelectByIndex(const int index)
 {
  ulong ticket = HistoryDealGetTicket(index);
  if(ticket == 0)
    return(false);
  Ticket(ticket);
//---
  return(true);
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                   SymbolInfo.mqh |
//|                             Copyright 2000-2023, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <Object.mqh>
//+------------------------------------------------------------------+
//| Class CSymbolInfo.                                               |
//| Appointment: Class for access to symbol info.                    |
//|              Derives from class CObject.                         |
//+------------------------------------------------------------------+
class CSymbolInfo : public CObject
 {
protected:
  string             m_name;                       // symbol name
  MqlTick            m_tick;                       // structure of tick;
  double             m_point;                      // symbol point
  double             m_tick_value;                 // symbol tick value
  double             m_tick_value_profit;          // symbol tick value profit
  double             m_tick_value_loss;            // symbol tick value loss
  double             m_tick_size;                  // symbol tick size
  double             m_contract_size;              // symbol contract size
  double             m_lots_min;                   // symbol lots min
  double             m_lots_max;                   // symbol lots max
  double             m_lots_step;                  // symbol lots step
  double             m_lots_limit;                 // symbol lots limit
  double             m_swap_long;                  // symbol swap long
  double             m_swap_short;                 // symbol swap short
  int                m_digits;                     // symbol digits
  int                m_order_mode;                 // symbol valid orders
  ENUM_SYMBOL_TRADE_EXECUTION m_trade_execution;  // symbol trade execution
  ENUM_SYMBOL_CALC_MODE m_trade_calcmode;         // symbol trade calcmode
  ENUM_SYMBOL_TRADE_MODE m_trade_mode;            // symbol trade mode
  ENUM_SYMBOL_SWAP_MODE m_swap_mode;              // symbol swap mode
  ENUM_DAY_OF_WEEK   m_swap3;                      // symbol swap3
  double             m_margin_initial;             // symbol margin initial
  double             m_margin_maintenance;         // symbol margin maintenance
  bool               m_margin_hedged_use_leg;      // calculate hedged margin using larger leg
  double             m_margin_hedged;              // symbol margin hedged
  int                m_trade_time_flags;           // symbol trade time flags
  int                m_trade_fill_flags;           // symbol trade fill flags

public:
                     CSymbolInfo(void);
                    ~CSymbolInfo(void);
  //--- methods of access to protected data
  string             Name(void) const { return(m_name); }
  bool               Name(const string name);
  bool               Refresh(void);
  bool               RefreshRates(void);
  //--- fast access methods to the integer symbol propertyes
  bool               Select(void) const;
  bool               Select(const bool select);
  bool               IsSynchronized(void) const;
  //--- volumes
  ulong              Volume(void)     const { return(m_tick.volume); }
  ulong              VolumeHigh(void) const;
  ulong              VolumeLow(void)  const;
  //--- miscellaneous
  datetime           Time(void)           const { return(m_tick.time); }
  int                Spread(void)         const;
  bool               SpreadFloat(void)    const;
  int                TicksBookDepth(void) const;
  //--- trade levels
  int                StopsLevel(void)  const;
  int                FreezeLevel(void) const;
  //--- fast access methods to the double symbol propertyes
  //--- bid parameters
  double             Bid(void)      const { return(m_tick.bid); }
  double             BidHigh(void)  const;
  double             BidLow(void)   const;
  //--- ask parameters
  double             Ask(void)      const { return(m_tick.ask); }
  double             AskHigh(void)  const;
  double             AskLow(void)   const;
  //--- last parameters
  double             Last(void)     const { return(m_tick.last); }
  double             LastHigh(void) const;
  double             LastLow(void)  const;
  //--- fast access methods to the mix symbol propertyes
  int                OrderMode(void) const { return(m_order_mode); }
  //--- terms of trade
  ENUM_SYMBOL_CALC_MODE TradeCalcMode(void)        const { return(m_trade_calcmode); }
  string             TradeCalcModeDescription(void) const;
  ENUM_SYMBOL_TRADE_MODE TradeMode(void)           const { return(m_trade_mode);     }
  string             TradeModeDescription(void)     const;
  //--- execution terms of trade
  ENUM_SYMBOL_TRADE_EXECUTION TradeExecution(void)  const { return(m_trade_execution); }
  string             TradeExecutionDescription(void) const;
  //--- swap terms of trade
  ENUM_SYMBOL_SWAP_MODE SwapMode(void)                 const { return(m_swap_mode); }
  string             SwapModeDescription(void)          const;
  ENUM_DAY_OF_WEEK   SwapRollover3days(void)            const { return(m_swap3);     }
  string             SwapRollover3daysDescription(void) const;
  //--- dates for futures
  datetime           StartTime(void)      const;
  datetime           ExpirationTime(void) const;
  //--- margin parameters
  double             MarginInitial(void)      const { return(m_margin_initial);        }
  double             MarginMaintenance(void)  const { return(m_margin_maintenance);    }
  bool               MarginHedgedUseLeg(void) const { return(m_margin_hedged_use_leg); }
  double             MarginHedged(void)       const { return(m_margin_hedged);         }
  //--- left for backward compatibility
  double             MarginLong(void)      const { return(0.0); }
  double             MarginShort(void)     const { return(0.0); }
  double             MarginLimit(void)     const { return(0.0); }
  double             MarginStop(void)      const { return(0.0); }
  double             MarginStopLimit(void) const { return(0.0); }
  //--- trade flags parameters
  int                TradeTimeFlags(void)  const { return(m_trade_time_flags);  }
  int                TradeFillFlags(void)  const { return(m_trade_fill_flags);  }
  //--- tick parameters
  int                Digits(void)          const { return(m_digits);            }
  double             Point(void)           const { return(m_point);             }
  double             TickValue(void)       const { return(m_tick_value);        }
  double             TickValueProfit(void) const { return(m_tick_value_profit); }
  double             TickValueLoss(void)   const { return(m_tick_value_loss);   }
  double             TickSize(void)        const { return(m_tick_size);         }
  //--- lots parameters
  double             ContractSize(void) const { return(m_contract_size); }
  double             LotsMin(void)      const { return(m_lots_min);      }
  double             LotsMax(void)      const { return(m_lots_max);      }
  double             LotsStep(void)     const { return(m_lots_step);     }
  double             LotsLimit(void)    const { return(m_lots_limit);    }
  //--- swaps
  double             SwapLong(void)  const { return(m_swap_long);  }
  double             SwapShort(void) const { return(m_swap_short); }
  //--- fast access methods to the string symbol propertyes
  string             CurrencyBase(void)   const;
  string             CurrencyProfit(void) const;
  string             CurrencyMargin(void) const;
  string             Bank(void)           const;
  string             Description(void)    const;
  string             Path(void)           const;
  //--- session information
  long               SessionDeals(void)            const;
  long               SessionBuyOrders(void)        const;
  long               SessionSellOrders(void)       const;
  double             SessionTurnover(void)         const;
  double             SessionInterest(void)         const;
  double             SessionBuyOrdersVolume(void)  const;
  double             SessionSellOrdersVolume(void) const;
  double             SessionOpen(void)             const;
  double             SessionClose(void)            const;
  double             SessionAW(void)               const;
  double             SessionPriceSettlement(void)  const;
  double             SessionPriceLimitMin(void)    const;
  double             SessionPriceLimitMax(void)    const;
  //--- access methods to the API MQL5 functions
  bool               InfoInteger(const ENUM_SYMBOL_INFO_INTEGER prop_id, long& var) const;
  bool               InfoDouble(const ENUM_SYMBOL_INFO_DOUBLE prop_id, double& var) const;
  bool               InfoString(const ENUM_SYMBOL_INFO_STRING prop_id, string& var) const;
  bool               InfoMarginRate(const ENUM_ORDER_TYPE order_type, double& initial_margin_rate, double& maintenance_margin_rate) const;
  //--- service methods
  double             NormalizePrice(const double price) const;
  bool               CheckMarketWatch(void);
  //---
  bool               IsSymbolExist(void)     { bool is_custom = false; return ::SymbolExist(m_name, is_custom);}
  bool               IsCustomSymbol(void)
   {
    bool is_custom = false;
    ::SymbolExist(m_name, is_custom);
    return is_custom;
   }
 };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
CSymbolInfo::CSymbolInfo(void) : m_name(NULL),
  m_point(0.0),
  m_tick_value(0.0),
  m_tick_value_profit(0.0),
  m_tick_value_loss(0.0),
  m_tick_size(0.0),
  m_contract_size(0.0),
  m_lots_min(0.0),
  m_lots_max(0.0),
  m_lots_step(0.0),
  m_swap_long(0.0),
  m_swap_short(0.0),
  m_digits(0),
  m_order_mode(0),
  m_trade_execution(0),
  m_trade_calcmode(0),
  m_trade_mode(0),
  m_swap_mode(0),
  m_swap3(0),
  m_margin_initial(0.0),
  m_margin_maintenance(0.0),
  m_margin_hedged_use_leg(false),
  m_margin_hedged(0.0),
  m_trade_time_flags(0),
  m_trade_fill_flags(0)
 {
 }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
CSymbolInfo::~CSymbolInfo(void)
 {
 }
//+------------------------------------------------------------------+
//| Set name                                                         |
//+------------------------------------------------------------------+
bool CSymbolInfo::Name(const string name)
 {
  string symbol_name = StringLen(name) > 0 ? name : _Symbol;
//--- check previous set name
  if(m_name != symbol_name)
   {
    m_name = symbol_name;
    //---
    if(!CheckMarketWatch())
      return(false);
    //---
    if(!Refresh())
     {
      m_name = "";
      Print(__FUNCTION__ + ": invalid data of symbol '" + symbol_name + "'");
      return(false);
     }
   }
//--- succeed
  return(true);
 }
//+------------------------------------------------------------------+
//| Refresh cached data                                              |
//+------------------------------------------------------------------+
bool CSymbolInfo::Refresh(void)
 {
  long tmp_long = 0;
//---
  if(!SymbolInfoDouble(m_name, SYMBOL_POINT, m_point))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_TRADE_TICK_VALUE, m_tick_value))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_TRADE_TICK_VALUE_PROFIT, m_tick_value_profit))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_TRADE_TICK_VALUE_LOSS, m_tick_value_loss))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_TRADE_TICK_SIZE, m_tick_size))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_TRADE_CONTRACT_SIZE, m_contract_size))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_VOLUME_MIN, m_lots_min))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_VOLUME_MAX, m_lots_max))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_VOLUME_STEP, m_lots_step))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_VOLUME_LIMIT, m_lots_limit))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_SWAP_LONG, m_swap_long))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_SWAP_SHORT, m_swap_short))
    return(false);
  if(!SymbolInfoInteger(m_name, SYMBOL_DIGITS, tmp_long))
    return(false);
  m_digits = (int)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_ORDER_MODE, tmp_long))
    return(false);
  m_order_mode = (int)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_TRADE_EXEMODE, tmp_long))
    return(false);
  m_trade_execution = (ENUM_SYMBOL_TRADE_EXECUTION)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_TRADE_CALC_MODE, tmp_long))
    return(false);
  m_trade_calcmode = (ENUM_SYMBOL_CALC_MODE)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_TRADE_MODE, tmp_long))
    return(false);
  m_trade_mode = (ENUM_SYMBOL_TRADE_MODE)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_SWAP_MODE, tmp_long))
    return(false);
  m_swap_mode = (ENUM_SYMBOL_SWAP_MODE)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_SWAP_ROLLOVER3DAYS, tmp_long))
    return(false);
  m_swap3 = (ENUM_DAY_OF_WEEK)tmp_long;
  if(!SymbolInfoDouble(m_name, SYMBOL_MARGIN_INITIAL, m_margin_initial))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_MARGIN_MAINTENANCE, m_margin_maintenance))
    return(false);
  if(!SymbolInfoDouble(m_name, SYMBOL_MARGIN_HEDGED, m_margin_hedged))
    return(false);
  if(!SymbolInfoInteger(m_name, SYMBOL_MARGIN_HEDGED_USE_LEG, tmp_long))
    return(false);
  m_margin_hedged_use_leg = (bool)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_EXPIRATION_MODE, tmp_long))
    return(false);
  m_trade_time_flags = (int)tmp_long;
  if(!SymbolInfoInteger(m_name, SYMBOL_FILLING_MODE, tmp_long))
    return(false);
  m_trade_fill_flags = (int)tmp_long;
//--- succeed
  return(true);
 }
//+------------------------------------------------------------------+
//| Refresh cached data                                              |
//+------------------------------------------------------------------+
bool CSymbolInfo::RefreshRates(void)
 {
  return(SymbolInfoTick(m_name, m_tick));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SELECT"                           |
//+------------------------------------------------------------------+
bool CSymbolInfo::Select(void) const
 {
  return((bool)SymbolInfoInteger(m_name, SYMBOL_SELECT));
 }
//+------------------------------------------------------------------+
//| Set the property value "SYMBOL_SELECT"                           |
//+------------------------------------------------------------------+
bool CSymbolInfo::Select(const bool select)
 {
  return(SymbolSelect(m_name, select));
 }
//+------------------------------------------------------------------+
//| Check synchronize symbol                                         |
//+------------------------------------------------------------------+
bool CSymbolInfo::IsSynchronized(void) const
 {
  return(SymbolIsSynchronized(m_name));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_VOLUMEHIGH"                       |
//+------------------------------------------------------------------+
ulong CSymbolInfo::VolumeHigh(void) const
 {
  return(SymbolInfoInteger(m_name, SYMBOL_VOLUMEHIGH));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_VOLUMELOW"                        |
//+------------------------------------------------------------------+
ulong CSymbolInfo::VolumeLow(void) const
 {
  return(SymbolInfoInteger(m_name, SYMBOL_VOLUMELOW));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SPREAD"                           |
//+------------------------------------------------------------------+
int CSymbolInfo::Spread(void) const
 {
  return((int)SymbolInfoInteger(m_name, SYMBOL_SPREAD));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SPREAD_FLOAT"                     |
//+------------------------------------------------------------------+
bool CSymbolInfo::SpreadFloat(void) const
 {
  return((bool)SymbolInfoInteger(m_name, SYMBOL_SPREAD_FLOAT));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_TICKS_BOOKDEPTH"                  |
//+------------------------------------------------------------------+
int CSymbolInfo::TicksBookDepth(void) const
 {
  return((int)SymbolInfoInteger(m_name, SYMBOL_TICKS_BOOKDEPTH));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_TRADE_STOPS_LEVEL"                |
//+------------------------------------------------------------------+
int CSymbolInfo::StopsLevel(void) const
 {
  return((int)SymbolInfoInteger(m_name, SYMBOL_TRADE_STOPS_LEVEL));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_TRADE_FREEZE_LEVEL"               |
//+------------------------------------------------------------------+
int CSymbolInfo::FreezeLevel(void) const
 {
  return((int)SymbolInfoInteger(m_name, SYMBOL_TRADE_FREEZE_LEVEL));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_BIDHIGH"                          |
//+------------------------------------------------------------------+
double CSymbolInfo::BidHigh(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_BIDHIGH));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_BIDLOW"                           |
//+------------------------------------------------------------------+
double CSymbolInfo::BidLow(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_BIDLOW));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_ASKHIGH"                          |
//+------------------------------------------------------------------+
double CSymbolInfo::AskHigh(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_ASKHIGH));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_ASKLOW"                           |
//+------------------------------------------------------------------+
double CSymbolInfo::AskLow(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_ASKLOW));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_LASTHIGH"                         |
//+------------------------------------------------------------------+
double CSymbolInfo::LastHigh(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_LASTHIGH));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_LASTLOW"                          |
//+------------------------------------------------------------------+
double CSymbolInfo::LastLow(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_LASTLOW));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_TRADE_CALC_MODE" as string        |
//+------------------------------------------------------------------+
string CSymbolInfo::TradeCalcModeDescription(void) const
 {
  string str;
//---
  switch(m_trade_calcmode)
   {
    case SYMBOL_CALC_MODE_FOREX:
      str = "Calculation of profit and margin for Forex";
      break;
    case SYMBOL_CALC_MODE_CFD:
      str = "Calculation of collateral and earnings for CFD";
      break;
    case SYMBOL_CALC_MODE_FUTURES:
      str = "Calculation of collateral and profits for futures";
      break;
    case SYMBOL_CALC_MODE_CFDINDEX:
      str = "Calculation of collateral and earnings for CFD on indices";
      break;
    case SYMBOL_CALC_MODE_CFDLEVERAGE:
      str = "Calculation of collateral and earnings for the CFD when trading with leverage";
      break;
    case SYMBOL_CALC_MODE_EXCH_STOCKS:
      str = "Calculation for exchange stocks";
      break;
    case SYMBOL_CALC_MODE_EXCH_FUTURES:
      str = "Calculation for exchange futures";
      break;
    case SYMBOL_CALC_MODE_EXCH_FUTURES_FORTS:
      str = "Calculation for FORTS futures";
      break;
    default:
      str = "Unknown calculation mode";
   }
//--- result
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_TRADE_MODE" as string             |
//+------------------------------------------------------------------+
string CSymbolInfo::TradeModeDescription(void) const
 {
  string str;
//---
  switch(m_trade_mode)
   {
    case SYMBOL_TRADE_MODE_DISABLED:
      str = "Disabled";
      break;
    case SYMBOL_TRADE_MODE_LONGONLY:
      str = "Long only";
      break;
    case SYMBOL_TRADE_MODE_SHORTONLY:
      str = "Short only";
      break;
    case SYMBOL_TRADE_MODE_CLOSEONLY:
      str = "Close only";
      break;
    case SYMBOL_TRADE_MODE_FULL:
      str = "Full access";
      break;
    default:
      str = "Unknown trade mode";
   }
//--- result
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_TRADE_EXEMODE" as string          |
//+------------------------------------------------------------------+
string CSymbolInfo::TradeExecutionDescription(void) const
 {
  string str;
//---
  switch(m_trade_execution)
   {
    case SYMBOL_TRADE_EXECUTION_REQUEST:
      str = "Trading on request";
      break;
    case SYMBOL_TRADE_EXECUTION_INSTANT:
      str = "Trading on live streaming prices";
      break;
    case SYMBOL_TRADE_EXECUTION_MARKET:
      str = "Execution of orders on the market";
      break;
    case SYMBOL_TRADE_EXECUTION_EXCHANGE:
      str = "Exchange execution";
      break;
    default:
      str = "Unknown trade execution";
   }
//--- result
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SWAP_MODE" as string              |
//+------------------------------------------------------------------+
string CSymbolInfo::SwapModeDescription(void) const
 {
  string str;
//---
  switch(m_swap_mode)
   {
    case SYMBOL_SWAP_MODE_DISABLED:
      str = "No swaps";
      break;
    case SYMBOL_SWAP_MODE_POINTS:
      str = "Swaps are calculated in points";
      break;
    case SYMBOL_SWAP_MODE_CURRENCY_SYMBOL:
      str = "Swaps are calculated in base currency";
      break;
    case SYMBOL_SWAP_MODE_CURRENCY_MARGIN:
      str = "Swaps are calculated in margin currency";
      break;
    case SYMBOL_SWAP_MODE_CURRENCY_DEPOSIT:
      str = "Swaps are calculated in deposit currency";
      break;
    case SYMBOL_SWAP_MODE_INTEREST_CURRENT:
      str = "Swaps are calculated as annual interest using the current price";
      break;
    case SYMBOL_SWAP_MODE_INTEREST_OPEN:
      str = "Swaps are calculated as annual interest using the open price";
      break;
    case SYMBOL_SWAP_MODE_REOPEN_CURRENT:
      str = "Swaps are charged by reopening positions at the close price";
      break;
    case SYMBOL_SWAP_MODE_REOPEN_BID:
      str = "Swaps are charged by reopening positions at the Bid price";
      break;
    default:
      str = "Unknown swap mode";
   }
//--- result
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SWAP_ROLLOVER3DAYS" as string     |
//+------------------------------------------------------------------+
string CSymbolInfo::SwapRollover3daysDescription(void) const
 {
  string str;
//---
  switch(m_swap3)
   {
    case SUNDAY:
      str = "Sunday";
      break;
    case MONDAY:
      str = "Monday";
      break;
    case TUESDAY:
      str = "Tuesday";
      break;
    case WEDNESDAY:
      str = "Wednesday";
      break;
    case THURSDAY:
      str = "Thursday";
      break;
    case FRIDAY:
      str = "Friday";
      break;
    case SATURDAY:
      str = "Saturday";
      break;
    default:
      str = "Unknown";
   }
//--- result
  return(str);
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_START_TIME"                       |
//+------------------------------------------------------------------+
datetime CSymbolInfo::StartTime(void) const
 {
  return((datetime)SymbolInfoInteger(m_name, SYMBOL_START_TIME));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_EXPIRATION_TIME"                  |
//+------------------------------------------------------------------+
datetime CSymbolInfo::ExpirationTime(void) const
 {
  return((datetime)SymbolInfoInteger(m_name, SYMBOL_EXPIRATION_TIME));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_CURRENCY_BASE"                    |
//+------------------------------------------------------------------+
string CSymbolInfo::CurrencyBase(void) const
 {
  return(SymbolInfoString(m_name, SYMBOL_CURRENCY_BASE));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_CURRENCY_PROFIT"                  |
//+------------------------------------------------------------------+
string CSymbolInfo::CurrencyProfit(void) const
 {
  return(SymbolInfoString(m_name, SYMBOL_CURRENCY_PROFIT));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_CURRENCY_MARGIN"                  |
//+------------------------------------------------------------------+
string CSymbolInfo::CurrencyMargin(void) const
 {
  return(SymbolInfoString(m_name, SYMBOL_CURRENCY_MARGIN));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_BANK"                             |
//+------------------------------------------------------------------+
string CSymbolInfo::Bank(void) const
 {
  return(SymbolInfoString(m_name, SYMBOL_BANK));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_DESCRIPTION"                      |
//+------------------------------------------------------------------+
string CSymbolInfo::Description(void) const
 {
  return(SymbolInfoString(m_name, SYMBOL_DESCRIPTION));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_PATH"                             |
//+------------------------------------------------------------------+
string CSymbolInfo::Path(void) const
 {
  return(SymbolInfoString(m_name, SYMBOL_PATH));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_DEALS"                    |
//+------------------------------------------------------------------+
long CSymbolInfo::SessionDeals(void) const
 {
  return(SymbolInfoInteger(m_name, SYMBOL_SESSION_DEALS));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_BUY_ORDERS"               |
//+------------------------------------------------------------------+
long CSymbolInfo::SessionBuyOrders(void) const
 {
  return(SymbolInfoInteger(m_name, SYMBOL_SESSION_BUY_ORDERS));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_SELL_ORDERS"              |
//+------------------------------------------------------------------+
long CSymbolInfo::SessionSellOrders(void) const
 {
  return(SymbolInfoInteger(m_name, SYMBOL_SESSION_SELL_ORDERS));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_TURNOVER"                 |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionTurnover(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_TURNOVER));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_INTEREST"                 |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionInterest(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_INTEREST));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_BUY_ORDERS_VOLUME"        |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionBuyOrdersVolume(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_BUY_ORDERS_VOLUME));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_SELL_ORDERS_VOLUME"       |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionSellOrdersVolume(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_SELL_ORDERS_VOLUME));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_OPEN"                     |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionOpen(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_OPEN));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_CLOSE"                    |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionClose(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_CLOSE));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_AW"                       |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionAW(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_AW));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_PRICE_SETTLEMENT"         |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionPriceSettlement(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_PRICE_SETTLEMENT));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_PRICE_LIMIT_MIN"          |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionPriceLimitMin(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_PRICE_LIMIT_MIN));
 }
//+------------------------------------------------------------------+
//| Get the property value "SYMBOL_SESSION_PRICE_LIMIT_MAX"          |
//+------------------------------------------------------------------+
double CSymbolInfo::SessionPriceLimitMax(void) const
 {
  return(SymbolInfoDouble(m_name, SYMBOL_SESSION_PRICE_LIMIT_MAX));
 }
//+------------------------------------------------------------------+
//| Access functions SymbolInfoInteger(...)                          |
//+------------------------------------------------------------------+
bool CSymbolInfo::InfoInteger(const ENUM_SYMBOL_INFO_INTEGER prop_id, long &var) const
 {
  return(SymbolInfoInteger(m_name, prop_id, var));
 }
//+------------------------------------------------------------------+
//| Access functions SymbolInfoDouble(...)                           |
//+------------------------------------------------------------------+
bool CSymbolInfo::InfoDouble(const ENUM_SYMBOL_INFO_DOUBLE prop_id, double &var) const
 {
  return(SymbolInfoDouble(m_name, prop_id, var));
 }
//+------------------------------------------------------------------+
//| Access functions SymbolInfoString(...)                           |
//+------------------------------------------------------------------+
bool CSymbolInfo::InfoString(const ENUM_SYMBOL_INFO_STRING prop_id, string &var) const
 {
  return(SymbolInfoString(m_name, prop_id, var));
 }
//+------------------------------------------------------------------+
//| Access functions SymbolInfoMarginRate(...)                           |
//+------------------------------------------------------------------+
bool CSymbolInfo::InfoMarginRate(const ENUM_ORDER_TYPE order_type, double& initial_margin_rate, double& maintenance_margin_rate) const
 {
  return(SymbolInfoMarginRate(m_name, order_type, initial_margin_rate, maintenance_margin_rate));
 }
//+------------------------------------------------------------------+
//| Normalize price                                                  |
//+------------------------------------------------------------------+
double CSymbolInfo::NormalizePrice(const double price) const
 {
  if(m_tick_size != 0)
    return(NormalizeDouble(MathRound(price / m_tick_size) * m_tick_size, m_digits));
//---
  return(NormalizeDouble(price, m_digits));
 }
//+------------------------------------------------------------------+
//| Checks if symbol is selected in the MarketWatch                  |
//| and adds symbol to the MarketWatch, if necessary                 |
//+------------------------------------------------------------------+
bool CSymbolInfo::CheckMarketWatch(void)
 {
//--- check if symbol is selected in the MarketWatch
  if(!Select())
   {
    if(GetLastError() == ERR_MARKET_UNKNOWN_SYMBOL)
     {
      printf(__FUNCTION__ + ": Unknown symbol '%s'", m_name);
      return(false);
     }
    if(!Select(true))
     {
      printf(__FUNCTION__ + ": Error adding symbol %d", GetLastError());
      return(false);
     }
   }
//--- succeed
  return(true);
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                     DateTime.mqh |
//|                               Copyright (c) 2019-2021, Marketeer |
//|                          https://www.mql5.com/en/users/marketeer |
//+------------------------------------------------------------------+

//+------------------------------------------------------------------+
//| Date and Time field extractor                                    |
//+------------------------------------------------------------------+
class DateTime
{
private:
   MqlDateTime mdtstruct;
   datetime origin;

   DateTime() : origin(0)
   {
      TimeToStruct(0, mdtstruct);
   }
   
   void convert(const datetime &dt)
   {
      if(origin != dt)
      {
         origin = dt;
         TimeToStruct(dt, mdtstruct);
      }
   }

public:
   static DateTime *assign(const datetime dt)
   {
      _DateTime.convert(dt);
      return &_DateTime;
   }
   ENUM_DAY_OF_WEEK timeDayOfWeek() const
   {
      return (ENUM_DAY_OF_WEEK)mdtstruct.day_of_week;
   }
   int timeDayOfYear() const
   {
      return mdtstruct.day_of_year;
   }
   int timeYear() const
   {
      return mdtstruct.year;
   }
   int timeMonth() const
   {
      return mdtstruct.mon;
   }
   int timeDay() const
   {
      return mdtstruct.day;
   }
   int timeHour() const
   {
      return mdtstruct.hour;
   }
   int timeMinute() const
   {
      return mdtstruct.min;
   }
   int timeSeconds() const
   {
      return mdtstruct.sec;
   }

   static DateTime _DateTime;
};

static DateTime DateTime::_DateTime;

#define TimeDayOfWeek(T) DateTime::assign(T).timeDayOfWeek()
#define TimeDayOfYear(T) DateTime::assign(T).timeDayOfYear()
#define TimeYear(T) DateTime::assign(T).timeYear()
#define TimeMonth(T) DateTime::assign(T).timeMonth()
#define TimeDay(T) DateTime::assign(T).timeDay()
#define TimeHour(T) DateTime::assign(T).timeHour()
#define TimeMinute(T) DateTime::assign(T).timeMinute()
#define TimeSeconds(T) DateTime::assign(T).timeSeconds()

#define _TimeDayOfWeek DateTime::_DateTime.timeDayOfWeek
#define _TimeDayOfYear DateTime::_DateTime.timeDayOfYear
#define _TimeYear DateTime::_DateTime.timeYear
#define _TimeMonth DateTime::_DateTime.timeMonth
#define _TimeDay DateTime::_DateTime.timeDay
#define _TimeHour DateTime::_DateTime.timeHour
#define _TimeMinute DateTime::_DateTime.timeMinute
#define _TimeSeconds DateTime::_DateTime.timeSeconds

//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                  Permissions.mqh |
//|                             Copyright 2021-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "DateTime.mqh"

#define RESTRICTIONS 6
//+------------------------------------------------------------------+
//| Check various permissions                                        |
//+------------------------------------------------------------------+
class CPermissions
 {
  static uint        lastRestrictionBitMask;
  static bool        pass(const uint bitflag)
   {
    lastRestrictionBitMask |= bitflag;
    return lastRestrictionBitMask == 0;
   }

public:
  enum TRADE_RESTRICTIONS
   {
    NO_RESTRICTIONS      = 0,
    TERMINAL_RESTRICTION = 1,  // user disabled trades for all programs
    PROGRAM_RESTRICTION  = 2,  // user disabled trades for specific program
    SYMBOL_RESTRICTION   = 4,  // symbol is not tradable by specification
    SESSION_RESTRICTION  = 8,  // symbol session - market closed
    ACCOUNT_RESTRICTION  = 16, // investment login or broker limitation
    EXPERTS_RESTRICTION  = 32, // algotrading is disabled by broker
   };
  //---
  static uint        getLastRestrictionBitMask()
   {
    return lastRestrictionBitMask;
   }
  //---
  static string      explainLastRestrictionBitMask()
   {
    string result = "";
    for(int i = 0; i < RESTRICTIONS; ++i)
     {
      if(((1 << i) & lastRestrictionBitMask) != 0)
       {
        result += EnumToString((TRADE_RESTRICTIONS)(1 << i)) + " ";
       }
     }
    return result;
   }
  //---
  static uint        getTradeRestrictionsOnSymbol
  (
    const string symbol,
    datetime now = 0,
    const ENUM_SYMBOL_TRADE_MODE mode = SYMBOL_TRADE_MODE_FULL
  )
   {
    // check sessions
    if(now == 0)
      now = TimeTradeServer();
    bool found = false;
    const static ulong day = 60 * 60 * 24;
    const ulong time = (ulong)now % day;
    datetime from, to;
    int i = 0;

    ENUM_DAY_OF_WEEK d = TimeDayOfWeek(now);

    while(!found && SymbolInfoSessionTrade(symbol, d, i++, from, to))
     {
      found = time >= (ulong)from && time < (ulong)to;
     }
    // check symbol trade mode
    const ENUM_SYMBOL_TRADE_MODE m = (ENUM_SYMBOL_TRADE_MODE)SymbolInfoInteger(symbol, SYMBOL_TRADE_MODE);
    // retern
    return (found ? 0 : SESSION_RESTRICTION) | (((m & mode) != 0) || (m == SYMBOL_TRADE_MODE_FULL) ? 0 : SYMBOL_RESTRICTION);
   }
  //---
  static bool        isTradeOnSymbolEnabled(const string symbol, const datetime now = 0,
      const ENUM_SYMBOL_TRADE_MODE mode = SYMBOL_TRADE_MODE_FULL)
   {
    lastRestrictionBitMask = 0;
    return pass(getTradeRestrictionsOnSymbol(symbol, now, mode));
   }
  //---
  static uint        getTradeRestrictionsOnAccount()
   {
    return (AccountInfoInteger(ACCOUNT_TRADE_ALLOWED) ? 0 : ACCOUNT_RESTRICTION)
           | (AccountInfoInteger(ACCOUNT_TRADE_EXPERT) ? 0 : EXPERTS_RESTRICTION);
   }
  //---
  static bool        isTradeOnAccountEnabled()
   {
    lastRestrictionBitMask = 0;
    return pass(getTradeRestrictionsOnAccount());
   }
  //---
  static uint        getTradeRestrictionsOnProgram()
   {
    return (TerminalInfoInteger(TERMINAL_TRADE_ALLOWED) ? 0 : TERMINAL_RESTRICTION)
           | (MQLInfoInteger(MQL_TRADE_ALLOWED) ? 0 : PROGRAM_RESTRICTION);
   }
  //---
  static uint        getTradeRestrictions(const string symbol = NULL, const datetime now = 0,
                                          const ENUM_SYMBOL_TRADE_MODE mode = SYMBOL_TRADE_MODE_FULL)
   {
    return getTradeRestrictionsOnProgram()
           | getTradeRestrictionsOnSymbol(symbol == NULL ? _Symbol : symbol, now, mode)
           | getTradeRestrictionsOnAccount();
   }
  //---
  static bool        isTradeEnabled(const string symbol = NULL, const datetime now = 0,
                                    const ENUM_SYMBOL_TRADE_MODE mode = SYMBOL_TRADE_MODE_FULL)
   {
    lastRestrictionBitMask = 0;
    return pass(getTradeRestrictions(symbol, now, mode));
   }
  //---
  static bool        isDllsEnabledByDefault()
   {
    return (bool)TerminalInfoInteger(TERMINAL_DLLS_ALLOWED);
   }
  //---
  static bool        isDllsEnabled()
   {
    return (bool)MQLInfoInteger(MQL_DLLS_ALLOWED);
   }
  //---
  static bool        isEmailEnabled()
   {
    return (bool)TerminalInfoInteger(TERMINAL_EMAIL_ENABLED);
   }
  //---
  static bool        isFtpEnabled()
   {
    return (bool)TerminalInfoInteger(TERMINAL_FTP_ENABLED);
   }
  //---
  static bool        isPushEnabled()
   {
    return (bool)TerminalInfoInteger(TERMINAL_NOTIFICATIONS_ENABLED);
   }
  //---
  static bool        isSignalsEnabled()
   {
    return (bool)MQLInfoInteger(MQL_SIGNALS_ALLOWED);
   }
  //---
  static bool        isTerminalConnected()
   {
    return (bool)TerminalInfoInteger(TERMINAL_CONNECTED);
   }
 };
static uint CPermissions::lastRestrictionBitMask;
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                       Mocros.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property strict
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
//template<typename T> 
//bool FnIsValidPointer(T *_obj) { if(::CheckPointer(_obj) == POINTER_DYNAMIC) return true; else return false;}
//+------------------------------------------------------------------+
//| Macro                                                            |
//+------------------------------------------------------------------+
#define IS_POINTER_DYNAMIC(P) (::CheckPointer(P) == POINTER_DYNAMIC)
#define FREE(P) if(::CheckPointer(P) == POINTER_DYNAMIC) delete (P);
#define STR_TIME_MSC(T) (TimeToString((T) / 1000, TIME_DATE|TIME_SECONDS) + StringFormat("'%03d", (T) % 1000))
//#define PUSH(A,V) (A[ArrayResize(A, ArrayRange(A, 0) + 1, ArrayRange(A, 0) * 2) - 1] = V)
#define EXPAND(A) (ArrayResize(A, ArrayRange(A, 0) + 1, ArrayRange(A, 0) * 2) - 1)
#define IS_EMPTY_STRING(S) (S == NULL || S == "")
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                        Crypt.mqh |
//|                                     Copyright 2022,Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2022,Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
#property strict

/*
"WARNING: hashes can not be used to restore data! CryptDecode will fail."
/---
Electronic Codebook(ECB) encryption mode and Padding equal to zero

Note 1:
in AES - 128 the key maximum size is 16 bytes, if the size is minor then 16, fill the remaining bytes with zeros;
Note 2:
in DES the key maximum size is 8, if the size is minor then 8, fill the remaining bytes with zeros and the last byte must be zero too.
Note 3:
in DES the size of the text must be multiple of 8 with the extra bytes filled by zero;

Configuration for AES - 128(C# code) :--------------------------------------
byte[] arrKey = Encoding.UTF8.GetBytes(key);
if(arrKey.Length != 16)
  Array.Resize(ref arrKey, 16);

using(Aes aesAlg = Aes.Create())
 {
  aesAlg.Mode = CipherMode.ECB;
  aesAlg.Padding = PaddingMode.Zeros;
  aesAlg.BlockSize = 128;
  aesAlg.KeySize = 128;
  aesAlg.Key = arrKey;
  aesAlg.IV = new byte[16];
 }
----------------------------------------------------------------------------
Configuration for DES(C# code) :--------------------------------------------

// Encode and check message and password
byte[] arrText = Encoding.UTF8.GetBytes(originalString);
byte[] arrKey = Encoding.UTF8.GetBytes(keyString);

if (arrKey.Length != 8) Array.Resize(ref arrKey, 8);
arrKey[7] = 0;

if (arrText.Length % 8 == 0) Array.Resize(ref arrText, arrText.Length + 8);

// Set encryption settings
DESCryptoServiceProvider provider = new DESCryptoServiceProvider();
provider.Mode = CipherMode.ECB;
provider.Padding = PaddingMode.Zeros;
provider.BlockSize = 64;
provider.KeySize = 64;
provider.Key = arrKey;
provider.IV = new byte[8];
*/
#include <ErrorDescription.mqh>
#include "Func.mqh"
#define DEF_CRYPT_CODE_PAGE     CP_MACCP
/*
CP_ACP         0     The current Windows ANSI code page.
CP_OEMCP       1     The current system OEM code page.
CP_MACCP       2     The current system Macintosh code page.   Note: This value is mostly used in earlier created program codes and is of no use now, since modern Macintosh computers use Unicode for encoding.
CP_THREAD_ACP  3     The Windows ANSI code page for the current thread.
CP_SYMBOL      42    Symbol code page
CP_UTF7        65000 UTF-7 code page.
CP_UTF8        65001 UTF-8 code page.
*/
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CCrypt
 {
private:
  enum ENUM_CRYPT_REDABLE_METHOD
   {
    REDABLE_NONE,
    REDABLE_HEX,
    REDABLE_HEX_LOW,
    REDABLE_BASE64
   };
  //------------------------------------------------------------------
  static bool        IsKeyCorrect(ENUM_CRYPT_METHOD _method, string _key)
   {
    int len = ::StringLen(_key);
    switch(_method)
     {
      case CRYPT_AES128:
        if(len != 16)
          return false;
        break;
      case CRYPT_AES256:
        if(len != 32)
          return false;
        break;
      case CRYPT_DES:
        if(len != 7)
          return false;
        break;
     }
    return true;
   }
  //------------------------------------------------------------------
  static string      CorrectKey(string _key, uint _len)
   {
    uint len = ::StringLen(_key);
    for(uint i = len; i < _len; i++)
      _key += "=";
    //--
    return ::StringSubstr(_key, 0, _len);
   }
  //------------------------------------------------------------------
  static int         EnCode(uchar            &_result[],
                            ENUM_CRYPT_METHOD _method,
                            string            _key,
                            uchar            &_data[])
   {
    if(!IsKeyCorrect(_method, _key))
      return 0;

    uchar key[];
    CFunc::TextToCharArray(_key, key);

    ::ArrayFree(_result);
    ::ResetLastError();

    int res = ::CryptEncode(_method, _data, key, _result);

    if(res <= 0)
      Print(__FUNCSIG__, " :: ", ErrorDescription(_LastError), " Code: ", (string)_LastError);

    return res;
   }
  //------------------------------------------------------------------
  static int         EnCode(uchar            &_result[],
                            ENUM_CRYPT_METHOD _method,
                            string           _key,
                            string           _text)
   {
    uchar data[];
    CFunc::TextToCharArray(_text, data);

    return EnCode(_result, _method, _key, data);
   };
  //------------------------------------------------------------------
  static string      EnCodeToString(ENUM_CRYPT_METHOD          _method,
                                    string                     _key,
                                    string                     _text,
                                    ENUM_CRYPT_REDABLE_METHOD  _readbling = REDABLE_HEX)
   {
    uchar result[];
    if(EnCode(result, _method, _key, _text))
     {
      if(_readbling == REDABLE_HEX)
        return CFunc::ArrayToHex(result);
      if(_readbling == REDABLE_HEX_LOW)
        return CFunc::ArrayToHex(result, -1, true);
      if(_readbling == REDABLE_BASE64)
       {
        uchar base64[];
        if(EnCode(base64, CRYPT_BASE64, NULL, result))
          return ::CharArrayToString(base64, 0, WHOLE_ARRAY, DEF_CRYPT_CODE_PAGE);
       }
      return ::CharArrayToString(result, 0, WHOLE_ARRAY, DEF_CRYPT_CODE_PAGE);
     }
    return NULL;
   }
  //------------------------------------------------------------------
  static int         DeCode(uchar            &_result[],
                            ENUM_CRYPT_METHOD _method,
                            string           _key,
                            uchar            &_data[])
   {
    if(!IsKeyCorrect(_method, _key))
      return 0;

    uchar key[];
    CFunc::TextToCharArray(_key, key);

    ::ArrayFree(_result);
    ::ResetLastError();

    int res = ::CryptDecode(_method, _data, key, _result);

    if(res <= 0)
      Print(__FUNCSIG__, " :: ", ErrorDescription(_LastError), " Code: ", (string)_LastError);

    return res;
   }
  //------------------------------------------------------------------
  static int         DeCode(uchar                    &_result[],
                            ENUM_CRYPT_METHOD         _method,
                            string                    _key,
                            string                    _hash,
                            ENUM_CRYPT_REDABLE_METHOD _readbling = REDABLE_HEX)
   {
    uchar data[];
    switch(_readbling)
     {
      case REDABLE_HEX :
      case REDABLE_HEX_LOW :
        CFunc::HexToArray(_hash, data);
        break;
      case REDABLE_BASE64 :
        DeCode(data, CRYPT_BASE64, NULL, _hash, REDABLE_NONE);
        break;
      default:
        CFunc::TextToCharArray(_hash, data);
        break;
     }

    ::ArrayFree(_result);
    ::ResetLastError();

    return DeCode(_result, _method, _key, data);
   };
  //------------------------------------------------------------------
  static string      DeCodeToString(ENUM_CRYPT_METHOD         _method,
                                    string                    _key,
                                    string                    _hash,
                                    ENUM_CRYPT_REDABLE_METHOD _readbling = REDABLE_HEX)
   {
    uchar result[];
    if(DeCode(result, _method, _key, _hash, _readbling))
      return ::CharArrayToString(result, 0, WHOLE_ARRAY, DEF_CRYPT_CODE_PAGE);
    return NULL;
   }

public :
                     CCrypt(void) {};
                    ~CCrypt(void) {};
  //--- EnCrypt
  static string      DES(const string _text, const string _key7)              { return EnCodeToString(CRYPT_DES, _key7, _text, REDABLE_NONE);}
  static string      AES128(const string _text, const string _key16)          { return EnCodeToString(CRYPT_AES128, _key16, _text, REDABLE_NONE);}
  static string      AES256(const string _text, const string _key32)          { return EnCodeToString(CRYPT_AES256, _key32, _text, REDABLE_NONE);}
  static string      Base64(const string _text)                               { return EnCodeToString(CRYPT_BASE64, NULL, _text, REDABLE_NONE);}
  //---
  static string      DES_Hex(const string _text, const string _key7)          { return EnCodeToString(CRYPT_DES, _key7, _text, REDABLE_HEX);}
  static string      AES128_Hex(const string _text, const string _key16)      { return EnCodeToString(CRYPT_AES128, _key16, _text, REDABLE_HEX);}
  static string      AES256_Hex(const string _text, const string _key32)      { return EnCodeToString(CRYPT_AES256, _key32, _text, REDABLE_HEX);}
  static string      Base64_Hex(const string _text)                           { return EnCodeToString(CRYPT_BASE64, NULL, _text, REDABLE_HEX);}
  //---
  static string      DES_HexLow(const string _text, const string _key7)       { return EnCodeToString(CRYPT_DES, _key7, _text, REDABLE_HEX_LOW);}
  static string      AES128_HexLow(const string _text, const string _key16)   { return EnCodeToString(CRYPT_AES128, _key16, _text, REDABLE_HEX_LOW);}
  static string      AES256_HexLow(const string _text, const string _key32)   { return EnCodeToString(CRYPT_AES256, _key32, _text, REDABLE_HEX_LOW);}
  static string      Base64_HexLow(const string _text)                        { return EnCodeToString(CRYPT_BASE64, NULL, _text, REDABLE_HEX_LOW);}
  //---
  static string      DES_BASE64(const string _text, const string _key7)       { return EnCodeToString(CRYPT_DES, _key7, _text, REDABLE_BASE64);}
  static string      AES128_BASE64(const string _text, const string _key16)   { return EnCodeToString(CRYPT_AES128, _key16, _text, REDABLE_BASE64);}
  static string      AES256_BASE64(const string _text, const string _key32)   { return EnCodeToString(CRYPT_AES256, _key32, _text, REDABLE_BASE64);}
  //--- DeCrypt
  static string      DeDES(const string _hash, const string _key7)            { return DeCodeToString(CRYPT_DES, _key7, _hash, REDABLE_NONE);}
  static string      DeAES128(const string _hash, const string _key16)        { return DeCodeToString(CRYPT_AES128, _key16, _hash, REDABLE_NONE);}
  static string      DeAES256(const string _hash, const string _key32)        { return DeCodeToString(CRYPT_AES256, _key32, _hash, REDABLE_NONE);}
  static string      DeBase64(const string _hash)                             { return DeCodeToString(CRYPT_BASE64, NULL, _hash, REDABLE_NONE);}
  //---
  static string      DeDES_Hex(const string _hash, const string _key7)        { return DeCodeToString(CRYPT_DES, _key7, _hash, REDABLE_HEX);}
  static string      DeAES128_Hex(const string _hash, const string _key16)    { return DeCodeToString(CRYPT_AES128, _key16, _hash, REDABLE_HEX);}
  static string      DeAES256_Hex(const string _hash, const string _key32)    { return DeCodeToString(CRYPT_AES256, _key32, _hash, REDABLE_HEX);}
  static string      DeBase64_Hex(const string _hash)                         { return DeCodeToString(CRYPT_BASE64, NULL, _hash, REDABLE_HEX);}
  //---
  static string      DeDES_HexLow(const string _hash, const string _key7)     { return DeCodeToString(CRYPT_DES, _key7, _hash, REDABLE_HEX_LOW);}
  static string      DeAES128_HexLow(const string _hash, const string _key16) { return DeCodeToString(CRYPT_AES128, _key16, _hash, REDABLE_HEX_LOW);}
  static string      DeAES256_HexLow(const string _hash, const string _key32) { return DeCodeToString(CRYPT_AES256, _key32, _hash, REDABLE_HEX_LOW);}
  static string      DeBase64_HexLow(const string _hash)                      { return DeCodeToString(CRYPT_BASE64, NULL, _hash, REDABLE_HEX_LOW);}
  //---
  static string      DeDES_BASE64(const string _hash, const string _key7)     { return DeCodeToString(CRYPT_DES, _key7, _hash, REDABLE_BASE64);}
  static string      DeAES128_BASE64(const string _hash, const string _key16) { return DeCodeToString(CRYPT_AES128, _key16, _hash, REDABLE_BASE64);}
  static string      DeAES256_BASE64(const string _hash, const string _key32) { return DeCodeToString(CRYPT_AES256, _key32, _hash, REDABLE_BASE64);}
  //--- Hash
  static string      MD5(const string _text)                                  { return EnCodeToString(CRYPT_HASH_MD5, NULL, _text, REDABLE_NONE);}
  static string      SHA1(const string _text)                                 { return EnCodeToString(CRYPT_HASH_SHA1, NULL, _text, REDABLE_NONE);}
  static string      SHA256(const string _text)                               { return EnCodeToString(CRYPT_HASH_SHA256, NULL, _text, REDABLE_NONE);}
  //---
  static string      MD5_Hex(const string _text)                              { return EnCodeToString(CRYPT_HASH_MD5, NULL, _text, REDABLE_HEX);}
  static string      SHA1_Hex(const string _text)                             { return EnCodeToString(CRYPT_HASH_SHA1, NULL, _text, REDABLE_HEX);}
  static string      SHA256_Hex(const string _text)                           { return EnCodeToString(CRYPT_HASH_SHA256, NULL, _text, REDABLE_HEX);}
  //---
  static string      MD5_HexLow(const string _text)                           { return EnCodeToString(CRYPT_HASH_MD5, NULL, _text, REDABLE_HEX_LOW);}
  static string      SHA1_HexLow(const string _text)                          { return EnCodeToString(CRYPT_HASH_SHA1, NULL, _text, REDABLE_HEX_LOW);}
  static string      SHA256_HexLow(const string _text)                        { return EnCodeToString(CRYPT_HASH_SHA256, NULL, _text, REDABLE_HEX_LOW);}
  //---
  static string      MD5_BASE64(const string _text)                           { return EnCodeToString(CRYPT_HASH_MD5, NULL, _text, REDABLE_BASE64);}
  static string      SHA1_BASE64(const string _text)                          { return EnCodeToString(CRYPT_HASH_SHA1, NULL, _text, REDABLE_BASE64);}
  static string      SHA256_BASE64(const string _text)                        { return EnCodeToString(CRYPT_HASH_SHA256, NULL, _text, REDABLE_BASE64);}
  //----
  static string      HashID(string &_arr[], string _seprator = "|")
   {
    string text = NULL;
    for(uint i = 0; i < _arr.Size(); i++)
     {
      if(i != 0)
        text += _seprator;
      text += _arr[i];
     }
    return DES_BASE64(text,"A6jkdW7");
   }

  static string      HashID(string _text)
   {
    string arr[1] = { _text };
    return HashID(arr);
   }

  static string      DbEnCrypt(const string _text)                            { return (_text == NULL || _text == "") ? NULL : Base64(_text);}
  static string      DbDeCrypt(const string _hash)                            { return (_hash == NULL || _hash == "") ? NULL : DeBase64(_hash);}

  static string      MyEnCrypt(const string _text, const string _key32)       { return (_text == NULL || _text == "") ? NULL : AES256_Hex(_text, CorrectKey(_key32, 32));}
  static string      MyDeCrypt(const string _hash, const string _key32)       { return (_hash == NULL || _hash == "") ? NULL : DeAES256_Hex(_hash, CorrectKey(_key32, 32));}
 };
//+------------------------------------------------------------------+
#undef DEF_CRYPT_CODE_PAGE
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                 C T r a d e S t a t i s t i c s . m q h   |  
 / / |                                                                                                                 j a f f e r w i l s o n   |  
 / / |                                                     h t t p s : / / w w w . m q l 5 . c o m / e n / u s e r s / j a f f e r w i l s o n   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " j a f f e r w i l s o n "  
 # p r o p e r t y   l i n k             " h t t p s : / / w w w . m q l 5 . c o m / e n / u s e r s / j a f f e r w i l s o n "  
  
 # d e f i n e   N U M B E R _ O F _ T R Y _ G E T _ H I S T O R Y   2 0  
  
 # i n c l u d e   < _ A t a \ I n f o \ D e a l I n f o . m q h >  
 # i n c l u d e   < A r r a y s \ A r r a y D o u b l e . m q h >  
 e n u m   E N U M _ C A L C _ S T A T E  
   {  
     C A L C _ I N I T ,  
     C A L C _ T I C K ,  
     C A L C _ D E I N I T  
   } ;  
 e n u m   d e a l _ r e s u l t  
   {  
     N O _ V A L U E   =   0 ,  
     W I N   =   1 ,  
     L O S S  
   } ;  
 e n u m   E N U M _ S T A T I S T I C S _ P L U S  
   {  
     S T A T _ B A L A N C E   =   1 0 0 0 0 ,  
     S T A T _ E Q U I T Y ,  
     S T A T _ A H P R ,  
     S T A T _ G H P R ,  
     S T A T _ Z _ S C O R E ,  
     S T A T _ L R _ C O R R E L A T I O N ,  
     S T A T _ L R _ S T A N D A R D _ E R R O R ,  
     S T A T _ A V G _ P R O F I T _ T R A D E ,  
     S T A T _ A V G _ L O S S _ T R A D E ,  
     S T A T _ B A L A N C E _ D D _ A B S O L U T E  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C T r a d e S t a t i s t i c s  
   {  
 p r i v a t e :  
     C D e a l I n f o                     m _ d e a l ;  
     C A r r a y D o u b l e               m _ p r o f i t _ d a t a ;  
     C A r r a y D o u b l e               m _ b a l a n c e _ d a t a ;  
     C A r r a y D o u b l e               m _ s h a r p _ b a l a n c e ;  
     C A r r a y D o u b l e               m _ b a l a n c e _ l i n e ;  
     s t r i n g                           m _ e r r _ m s g ;  
  
     / / - - -  
     d o u b l e                           m _ i n i t i a l _ d e p o s i t ;  
     d o u b l e                           m _ w i t h d r a w a l ;  
     i n t                                 m _ d e a l s ;  
     i n t                                 m _ t r a d e s ;  
  
     d o u b l e                           m _ p r o f i t _ f a c t o r ;  
  
     d o u b l e                           m _ p r o f i t ;  
     d o u b l e                           m _ g r o s s _ p r o f i t ;  
     d o u b l e                           m _ g r o s s _ l o s s ;  
  
     d o u b l e                           m _ e x p e c t e d _ p a y o f f ;  
  
     d o u b l e                           m _ b a l a n c e _ m i n ;  
     d o u b l e                           m _ b a l a n c e _ d d ;  
     d o u b l e                           m _ b a l a n c e _ d d _ p e r c e n t ;  
     d o u b l e                           m _ b a l a n c e _ d d _ r e l a t i v e ;  
     d o u b l e                           m _ b a l a n c e _ d d _ r e l a t i v e _ p e r c e n t ;  
     d o u b l e                           m _ b a l a n c e _ d d _ a b s o l u t e ;  
     / / - - -  
     d o u b l e                           m _ e q u i t y _ m i n ;  
     d o u b l e                           m _ e q u i t y _ d d ;  
     d o u b l e                           m _ e q u i t y _ d d _ p e r c e n t ;  
     d o u b l e                           m _ e q u i t y _ d d _ r e l a t i v e ;  
     d o u b l e                           m _ e q u i t y _ d d _ r e l a t i v e _ p e r c e n t ;  
     d o u b l e                           m _ e q u i t y _ d d _ a b s o l u t e ;  
     / / - - -  
     i n t                                 m _ s h o r t _ t r a d e s ;  
     i n t                                 m _ p r o f i t _ s h o r t _ t r a d e s ;  
  
     i n t                                 m _ l o n g _ t r a d e s ;  
     i n t                                 m _ p r o f i t _ l o n g _ t r a d e s ;  
  
     i n t                                 m _ p r o f i t _ t r a d e s ;  
     d o u b l e                           m _ p r o f i t _ t r a d e s _ p e r c e n t ;  
  
     i n t                                 m _ l o s s _ t r a d e s ;  
     d o u b l e                           m _ l o s s _ t r a d e s _ p e r c e n t ;  
  
     / / - - -  
     i n t                                 m _ p r o f i t _ t r a d e s _ a v g _ c o n ;  
     i n t                                 m _ l o s s _ t r a d e s _ a v g _ c o n ;  
  
     / / - - -  
     d o u b l e                           m _ l a r g _ p r o f i t _ t r a d e ;  
     d o u b l e                           m _ l a r g _ l o s s _ t r a d e ;  
  
     / / - - -  
     d o u b l e                           m _ c o n _ p r o f i t _ m a x ;  
     i n t                                 m _ c o n _ p r o f i t _ m a x _ t r a d e s ;  
     d o u b l e                           m _ m a x _ c o n _ w i n s ;  
     i n t                                 m _ m a x _ c o n _ p r o f i t _ t r a d e s ;  
  
     d o u b l e                           m _ c o n _ l o s s _ m a x ;  
     i n t                                 m _ c o n _ l o s s _ m a x _ t r a d e s ;  
     d o u b l e                           m _ m a x _ c o n _ l o s s e s ;  
     i n t                                 m _ m a x _ c o n _ l o s s _ t r a d e s ;  
  
     / / - - -  
     d o u b l e                           m _ r e c o v e r y _ f a c t o r ;  
     d o u b l e                           m _ s h a p e _ r a t i o ;  
     d o u b l e                           m _ m i n _ m a r g i n _ l e v e l ;  
  
     / / - - -  
     d o u b l e                           m _ z _ s c o r e ;  
     d o u b l e                           m _ z _ s c o r e _ p e r c e n t ;  
  
     d o u b l e                           m _ s h a r p e _ r a t i o ;  
  
     / / - - -  
     d o u b l e                           m _ g h p r ;  
     d o u b l e                           m _ g h p r _ p e r c e n t ;  
  
     d o u b l e                           m _ a h p r ;  
     d o u b l e                           m _ a h p r _ p e r c e n t ;  
  
     d o u b l e                           m _ l r _ c o r r e l a t i o n ;  
     d o u b l e                           m _ l r _ s t a n d a r d _ e r r o r ;  
  
     / / - - -  
     i n t                                 m _ s e r i e s _ c o u n t ;  
     i n t                                 m _ w i n s _ s e r i e s _ c o u n t ;  
     i n t                                 m _ l o s s _ s e r i e s _ c o u n t ;  
  
 p r o t e c t e d :  
     b o o l                               C a l c u l a t e R L ( C A r r a y D o u b l e   & d a t a ,   C A r r a y D o u b l e   & l i n e ,   d o u b l e   & S t a n d a r d _ E r r o r ,   d o u b l e   & C o r r e l a t i o n ) ;  
     v o i d                               C a l c E q u i t y D r a w d o w n ( b o o l   f i n a l l y ) ;  
     d o u b l e                           C a l c Z S c o r e P e r c e n t ( d o u b l e   z _ s c o r e ) ;  
  
 p u b l i c :  
     d o u b l e                           I n i t i a l D e p o s i t ( )   { r e t u r n ( m _ i n i t i a l _ d e p o s i t ) ; }  
     d o u b l e                           W i t h d r a w a l ( )   { r e t u r n ( m _ w i t h d r a w a l ) ; }  
     d o u b l e                           P r o f i t ( )   { r e t u r n ( m _ p r o f i t ) ; } ;  
     d o u b l e                           G r o s s P r o f i t ( )   { r e t u r n ( m _ g r o s s _ p r o f i t ) ; }  
     d o u b l e                           G r o s s L o s s ( )   { r e t u r n ( m _ g r o s s _ l o s s ) ; }  
     / / - - -  
     d o u b l e                           L a r g e s t P r o f i t T r a d e ( )   { r e t u r n ( m _ l a r g _ p r o f i t _ t r a d e ) ; }  
     d o u b l e                           L a r g e s t L o s s T r a d e ( )   { r e t u r n ( m _ l a r g _ l o s s _ t r a d e ) ; } ;  
     d o u b l e                           C o n P r o f i t M a x ( )   { r e t u r n ( m _ c o n _ p r o f i t _ m a x ) ; }  
     i n t                                 C o n P r o f i t M a x T r a d e s ( )   { r e t u r n ( m _ c o n _ p r o f i t _ m a x _ t r a d e s ) ; }  
     d o u b l e                           M a x C o n W i n s ( )   { r e t u r n ( m _ m a x _ c o n _ w i n s ) ; } ;  
     i n t                                 M a x C o n P r o f i t T r a d e s ( )   { r e t u r n ( m _ m a x _ c o n _ p r o f i t _ t r a d e s ) ; }  
     d o u b l e                           C o n L o s s M a x ( )   { r e t u r n ( m _ c o n _ l o s s _ m a x ) ; }  
     i n t                                 C o n L o s s M a x T r a d e s ( )   { r e t u r n ( m _ c o n _ l o s s _ m a x _ t r a d e s ) ; }  
     d o u b l e                           M a x C o n L o s s e s ( )   { r e t u r n ( m _ m a x _ c o n _ l o s s e s ) ; }  
     i n t                                 M a x C o n L o s s T r a d e s ( )   { r e t u r n ( m _ m a x _ c o n _ l o s s _ t r a d e s ) ; }  
     / / - - -  
     d o u b l e                           B a l a n c e M i n ( )   { r e t u r n ( m _ b a l a n c e _ m i n ) ; } ;  
     d o u b l e                           B a l a n c e D D ( )   { r e t u r n ( m _ b a l a n c e _ d d ) ; } ;  
     d o u b l e                           B a l a n c e D D P e r c e n t ( )   { r e t u r n ( m _ b a l a n c e _ d d _ p e r c e n t ) ; } ;  
     d o u b l e                           B a l a n c e D D R e l a t i v e ( )   { r e t u r n ( m _ b a l a n c e _ d d _ r e l a t i v e ) ; } ;  
     d o u b l e                           B a l a n c e D D R e l a t i v e P e r c e n t ( )   { r e t u r n ( m _ b a l a n c e _ d d _ r e l a t i v e _ p e r c e n t ) ; } ;  
     / / - - -  
     d o u b l e                           E q u i t y M i n ( )   { r e t u r n ( m _ e q u i t y _ m i n ) ; } ;  
     d o u b l e                           E q u i t y D D ( )   { r e t u r n ( m _ e q u i t y _ d d ) ; } ;  
     d o u b l e                           E q u i t y D D P e r c e n t ( )   { r e t u r n ( m _ e q u i t y _ d d _ p e r c e n t ) ; } ;  
     d o u b l e                           E q u i t y D D R e l a t i v e ( )   { r e t u r n ( m _ e q u i t y _ d d _ r e l a t i v e ) ; } ;  
     d o u b l e                           E q u i t y D D R e l a t i v e P e r c e n t ( )   { r e t u r n ( m _ e q u i t y _ d d _ r e l a t i v e _ p e r c e n t ) ; } ;  
     / / - - -  
     d o u b l e                           E x p e c t e d P a y o f f ( )   { r e t u r n ( m _ e x p e c t e d _ p a y o f f ) ; }  
     d o u b l e                           P r o f i t F a c t o r ( )   { r e t u r n ( m _ p r o f i t _ f a c t o r ) ; }  
     d o u b l e                           R e c o v e r y F a c t o r ( )   { r e t u r n ( m _ r e c o v e r y _ f a c t o r ) ; }  
     d o u b l e                           S h a r p e R a t i o ( )   { r e t u r n ( m _ s h a r p e _ r a t i o ) ; }  
     d o u b l e                           M i n M a r g i n L e v e l ( )   { r e t u r n ( m _ m i n _ m a r g i n _ l e v e l ) ; }  
     / / - - -  
     i n t                                 D e a l s ( )   { r e t u r n ( m _ d e a l s ) ; }  
     i n t                                 T r a d e s ( )   { r e t u r n ( m _ t r a d e s ) ; }  
     i n t                                 P r o f i t T r a d e s ( )   { r e t u r n ( m _ p r o f i t _ t r a d e s ) ; } ;  
     i n t                                 L o s s T r a d e s ( )   { r e t u r n ( m _ l o s s _ t r a d e s ) ; } ;  
     i n t                                 S h o r t T r a d e s ( )   { r e t u r n ( m _ s h o r t _ t r a d e s ) ; } ;  
     i n t                                 L o n g T r a d e s ( )   { r e t u r n ( m _ l o n g _ t r a d e s ) ; } ;  
     / / - - -  
     i n t                                 P r o f i t S h o r t T r a d e s ( )   { r e t u r n ( m _ p r o f i t _ s h o r t _ t r a d e s ) ; }  
     i n t                                 P r o f i t L o n g T r a d e s ( )   { r e t u r n ( m _ p r o f i t _ l o n g _ t r a d e s ) ; }  
     / / - - -  
     i n t                                 P r o f i t T r a d e s A v g C o n ( )   { r e t u r n ( m _ p r o f i t _ t r a d e s _ a v g _ c o n ) ; }  
     i n t                                 L o s s T r a d e s A v g C o n ( )   { r e t u r n ( m _ l o s s _ t r a d e s _ a v g _ c o n ) ; }  
  
     d o u b l e                           A H P R ( )   { r e t u r n ( m _ a h p r ) ; }  
     d o u b l e                           A H P R P e r c e n t ( )   { r e t u r n ( m _ a h p r _ p e r c e n t ) ; }  
  
     d o u b l e                           G H P R ( )   { r e t u r n ( m _ g h p r ) ; }  
     d o u b l e                           G H P R P e r c e n t ( )   { r e t u r n ( m _ g h p r _ p e r c e n t ) ; }  
  
     d o u b l e                           Z S c o r e ( )   { r e t u r n ( m _ z _ s c o r e ) ; }  
     d o u b l e                           Z S c o r e P e r c e n t ( )   { r e t u r n ( m _ z _ s c o r e _ p e r c e n t ) ; }  
  
     d o u b l e                           L R C o r r e l a t i o n ( )   { r e t u r n ( m _ l r _ c o r r e l a t i o n ) ; }  
     d o u b l e                           L R S t a n d a r d E r r o r ( )   { r e t u r n ( m _ l r _ s t a n d a r d _ e r r o r ) ; }  
  
     b o o l                               C a l c u l a t e ( d a t e t i m e   t i m e _ s t a r t ,   d a t e t i m e   t i m e _ e n d ,   d o u b l e   i n i t i a l _ d e p o s i t ) ;  
     v o i d                               P r i n t S t a t i s t i c s ( ) ;  
     s t r i n g                           G e t L a s t E r r o r S t r i n g ( )   { r e t u r n ( m _ e r r _ m s g ) ; } ;  
     b o o l                               C a l c u l a t e E q u i t y D D ( E N U M _ C A L C _ S T A T E   s t a t e ) ;  
     d o u b l e                           P e r c e n t ( d o u b l e   v a l u e ,   d o u b l e   d i v i d e r ) ;  
     d o u b l e                           D i v i d e ( d o u b l e   v a l u e ,   d o u b l e   d i v i d e r ) ;  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   C T r a d e S t a t i s t i c s : : P e r c e n t ( d o u b l e   v a l u e ,   d o u b l e   d i v i d e r )  
   {  
     i f ( M a t h A b s ( v a l u e )   < =   F L T _ E P S I L O N   | |   d i v i d e r   = =   0 )  
         r e t u r n ( 0 ) ;  
     r e t u r n ( 1 0 0   *   v a l u e   /   d i v i d e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   C T r a d e S t a t i s t i c s : : D i v i d e ( d o u b l e   v a l u e ,   d o u b l e   d i v i d e r )  
   {  
     i f ( M a t h A b s ( v a l u e )   < =   F L T _ E P S I L O N   | |   d i v i d e r   = =   0 )  
         r e t u r n ( 0 ) ;  
     r e t u r n ( v a l u e   /   d i v i d e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C T r a d e S t a t i s t i c s : : C a l c u l a t e ( d a t e t i m e   t i m e _ s t a r t   =   0 ,   d a t e t i m e   t i m e _ e n d   =   0 ,   d o u b l e   i n i t i a l _ d e p o s i t   =   0 . 0 )  
   {  
     m _ e r r _ m s g   =   " " ;  
     i f ( t i m e _ e n d   = =   0 )  
         t i m e _ e n d   =   T i m e T r a d e S e r v e r ( ) ;  
     m _ i n i t i a l _ d e p o s i t   =   i n i t i a l _ d e p o s i t ;  
  
     m _ w i t h d r a w a l   =   0 ;  
     m _ p r o f i t   =   0 ;  
     m _ g r o s s _ p r o f i t   =   0 ;  
     m _ g r o s s _ l o s s   =   0 ;  
  
     m _ s h o r t _ t r a d e s   =   0 ;  
     m _ l a r g _ p r o f i t _ t r a d e   =   0 ;  
     m _ l o n g _ t r a d e s   =   0 ;  
     m _ l a r g _ l o s s _ t r a d e   =   0 ;  
     m _ p r o f i t _ s h o r t _ t r a d e s   =   0 ;  
     m _ p r o f i t _ l o n g _ t r a d e s   =   0 ;  
     m _ l a r g _ p r o f i t _ t r a d e   =   0 ;  
     m _ l a r g _ l o s s _ t r a d e   =   0 ;  
  
     m _ c o n _ p r o f i t _ m a x   =   0 ;  
     m _ c o n _ p r o f i t _ m a x _ t r a d e s   =   0 ;  
     m _ c o n _ l o s s _ m a x   =   0 ;  
     m _ c o n _ l o s s _ m a x _ t r a d e s   =   0 ;  
     m _ m a x _ c o n _ l o s s e s   =   0 ;  
     m _ m a x _ c o n _ l o s s _ t r a d e s   =   0 ;  
     m _ b a l a n c e _ m i n   =   0 . 0 ;  
     m _ b a l a n c e _ d d _ a b s o l u t e   =   0 ;  
     m _ b a l a n c e _ d d   =   0 ;  
     m _ b a l a n c e _ d d _ p e r c e n t   =   0 ;  
     m _ b a l a n c e _ d d _ r e l a t i v e   =   0 ;  
     m _ b a l a n c e _ d d _ r e l a t i v e _ p e r c e n t   =   0 ;  
  
     m _ e x p e c t e d _ p a y o f f   =   0 ;  
     m _ p r o f i t _ f a c t o r   =   0 ;  
     m _ r e c o v e r y _ f a c t o r   =   0 ;  
     m _ s h a r p e _ r a t i o   =   0 ;  
  
     m _ d e a l s   =   0 ;  
     m _ t r a d e s   =   0 ;  
     m _ p r o f i t _ t r a d e s   =   0 ;  
     m _ l o s s _ t r a d e s   =   0 ;  
     m _ s h o r t _ t r a d e s   =   0 ;  
     m _ l o n g _ t r a d e s   =   0 ;  
  
     m _ s e r i e s _ c o u n t   =   0 ;  
     m _ w i n s _ s e r i e s _ c o u n t   =   0 ;  
     m _ l o s s _ s e r i e s _ c o u n t   =   0 ;  
     m _ p r o f i t _ t r a d e s _ a v g _ c o n   =   0 ;  
     m _ l o s s _ t r a d e s _ a v g _ c o n   =   0 ;  
  
     d o u b l e   m i n _ p e a k   =   0 . 0 ;  
     d o u b l e   m a x _ p e a k   =   0 . 0 ;  
  
     d o u b l e   b a l a n c e   =   0 ,   s h a r p _ b a l a n c e   =   0 ;  
     d o u b l e   p r o f i t   =   0 ;  
  
     d o u b l e   s e q u e n t i a l   =   0 . 0 ;  
     i n t   p r o f i t _ l e n g t h   =   0 ,   l o s s _ l e n g t h   =   0 ;  
  
     d e a l _ r e s u l t   r e s u l t   =   N O _ V A L U E ;  
  
     m _ b a l a n c e _ d a t a . C l e a r ( ) ;  
     m _ p r o f i t _ d a t a . C l e a r ( ) ;  
     m _ s h a r p _ b a l a n c e . C l e a r ( ) ;  
  
     i n t   t r y _   =   0 ;  
     b o o l   r e s   =   H i s t o r y S e l e c t ( t i m e _ s t a r t ,   t i m e _ e n d ) ;  
     i f ( ! r e s   & &   t r y _   <   N U M B E R _ O F _ T R Y _ G E T _ H I S T O R Y )  
       {  
         S l e e p ( 1 0 0 ) ;  
         r e s   =   H i s t o r y S e l e c t ( t i m e _ s t a r t ,   t i m e _ e n d ) ;  
         t r y _ + + ;  
       }  
     i f ( ! r e s )  
       {  
         m _ e r r _ m s g   =   " U n a b l e   t o   g e t   t h e   t r a d e   h i s t o r y " ;  
         r e t u r n ( f a l s e ) ;  
       }  
  
     i n t   d e a l s _ t o t a l   =   H i s t o r y D e a l s T o t a l ( ) ;  
     f o r ( i n t   i   =   0 ;   i   <   d e a l s _ t o t a l ;   i + + )  
       {  
         i f ( ! m _ d e a l . S e l e c t B y I n d e x ( i ) )  
           {  
             m _ e r r _ m s g   =   " E r r o r   f u n c t i o n   S e l e c t B y I n d e x ( ) " ;  
             r e t u r n ( f a l s e ) ;  
           }  
  
         i f ( m _ d e a l . D e a l T y p e ( )   = =   D E A L _ T Y P E _ B A L A N C E )  
           {  
             / / - - -   c u r r e n t   b a l a n c e  
             p r o f i t   =   N o r m a l i z e D o u b l e ( m _ d e a l . P r o f i t ( )   +   m _ d e a l . S w a p ( ) ,   2 ) ;  
             b a l a n c e   + =   p r o f i t ;  
             m _ b a l a n c e _ d a t a . A d d ( b a l a n c e ) ;  
  
             i f ( m i n _ p e a k   = =   0 . 0 )  
                 m i n _ p e a k   =   b a l a n c e ;  
             e l s e  
                 m i n _ p e a k   + =   p r o f i t ;  
             i f ( m a x _ p e a k   = =   0 . 0 )  
                 m a x _ p e a k   =   b a l a n c e ;  
             e l s e  
                 m a x _ p e a k   + =   p r o f i t ;  
             i f ( p r o f i t   > =   0 . 0 )  
               {  
                 i f ( m _ b a l a n c e _ m i n   = =   0 . 0 )  
                     m _ b a l a n c e _ m i n   =   b a l a n c e ;  
                 e l s e  
                     m _ b a l a n c e _ m i n   + =   p r o f i t ;  
                 r e s u l t   =   W I N ;  
                 i f ( i n i t i a l _ d e p o s i t   = =   0 . 0 )  
                     i f ( m _ i n i t i a l _ d e p o s i t   = =   0 . 0 )  
                       {  
                         m _ i n i t i a l _ d e p o s i t   =   m _ d e a l . P r o f i t ( ) ;  
                         s h a r p _ b a l a n c e   + =   p r o f i t ;  
                         m _ s h a r p _ b a l a n c e . A d d ( s h a r p _ b a l a n c e ) ;  
                       }  
                     e l s e  
                         m _ i n i t i a l _ d e p o s i t   + =   m _ d e a l . P r o f i t ( ) ;  
               }  
             e l s e  
               {  
                 m _ w i t h d r a w a l   - =   m _ d e a l . P r o f i t ( ) ;  
                 r e s u l t   =   L O S S ;  
               }  
  
           }  
  
         i f ( m _ d e a l . D e a l T y p e ( )   = =   D E A L _ T Y P E _ B U Y   | |   m _ d e a l . D e a l T y p e ( )   = =   D E A L _ T Y P E _ S E L L )  
           {  
             m _ d e a l s + + ;  
             p r o f i t   =   N o r m a l i z e D o u b l e ( m _ d e a l . P r o f i t ( )   +   m _ d e a l . S w a p ( )   +   m _ d e a l . C o m m i s s i o n ( ) ,   2 ) ;  
             m _ p r o f i t _ d a t a . A d d ( p r o f i t ) ;  
             i f ( p r o f i t   > =   0 . 0 )  
               {  
                 m _ g r o s s _ p r o f i t   + =   p r o f i t ;  
               }  
             e l s e  
               {  
                 m _ g r o s s _ l o s s   + =   p r o f i t ;  
               }  
             b a l a n c e   =   b a l a n c e   +   p r o f i t ;  
             m _ b a l a n c e _ d a t a . A d d ( b a l a n c e ) ;  
  
             i f ( b a l a n c e   <   m _ b a l a n c e _ m i n )  
                 m _ b a l a n c e _ m i n   =   b a l a n c e ;  
  
             i f ( m i n _ p e a k   = =   0 . 0 )  
                 m i n _ p e a k   =   b a l a n c e ;  
             i f ( m a x _ p e a k   = =   0 . 0 )  
                 m a x _ p e a k   =   b a l a n c e ;  
             d o u b l e   d r a w d o w n   =   m a x _ p e a k   -   b a l a n c e ;  
             d o u b l e   d r a w d o w n _ p e r c e n t   =   d r a w d o w n   /   m a x _ p e a k   *   1 0 0 . 0 ;  
  
             / / - - -   p r i c e   d d   m a x i m u m  
             i f ( d r a w d o w n   >   m _ b a l a n c e _ d d )  
               {  
                 m _ b a l a n c e _ d d   =   d r a w d o w n ;  
                 m _ b a l a n c e _ d d _ p e r c e n t   =   d r a w d o w n _ p e r c e n t ;  
               }  
  
             i f ( d r a w d o w n _ p e r c e n t   >   m _ b a l a n c e _ d d _ r e l a t i v e _ p e r c e n t )  
               {  
                 m _ b a l a n c e _ d d _ r e l a t i v e _ p e r c e n t   =   d r a w d o w n _ p e r c e n t ;  
                 m _ b a l a n c e _ d d _ r e l a t i v e   =   d r a w d o w n ;  
               }  
  
             i f ( m a x _ p e a k   <   b a l a n c e )  
                 m a x _ p e a k   =   b a l a n c e ;  
             i f ( m _ d e a l . E n t r y ( )   = =   D E A L _ E N T R Y _ O U T   | |   m _ d e a l . E n t r y ( )   = =   D E A L _ E N T R Y _ I N O U T )  
               {  
                 s h a r p _ b a l a n c e   + =   p r o f i t ;  
                 m _ s h a r p _ b a l a n c e . A d d ( s h a r p _ b a l a n c e ) ;  
                 m _ t r a d e s + + ;  
  
                 i f ( p r o f i t   > =   0 . 0 )  
                     m _ p r o f i t _ t r a d e s + + ;  
  
                 i f ( p r o f i t   <   0 )  
                     m _ l o s s _ t r a d e s + + ;  
                 i f ( p r o f i t   > =   0 . 0 )  
                   {  
                     i f ( p r o f i t   >   m _ l a r g _ p r o f i t _ t r a d e )  
                         m _ l a r g _ p r o f i t _ t r a d e   =   p r o f i t ;  
  
                     i f ( r e s u l t   ! =   W I N )  
                       {  
                         r e s u l t   =   W I N ;  
                         m _ s e r i e s _ c o u n t + + ;  
                         m _ w i n s _ s e r i e s _ c o u n t + + ;  
                         p r o f i t _ l e n g t h   =   0 ;  
                         s e q u e n t i a l   =   0 . 0 ;  
                       }  
  
                     s e q u e n t i a l   + =   p r o f i t ;  
                     p r o f i t _ l e n g t h + + ;  
                     / / - - -  
                     i f ( m _ m a x _ c o n _ p r o f i t _ t r a d e s   < =   p r o f i t _ l e n g t h )  
                       {  
                         m _ m a x _ c o n _ p r o f i t _ t r a d e s   =   p r o f i t _ l e n g t h ;  
                         m _ m a x _ c o n _ w i n s   =   s e q u e n t i a l ;  
                       }  
                     / / - - -  
                     i f ( m _ c o n _ p r o f i t _ m a x   < =   s e q u e n t i a l )  
                       {  
                         m _ c o n _ p r o f i t _ m a x   =   s e q u e n t i a l ;  
                         m _ c o n _ p r o f i t _ m a x _ t r a d e s   =   p r o f i t _ l e n g t h ;  
                       }  
  
                   }  
                 e l s e  
                   {  
                     i f ( p r o f i t   <   m _ l a r g _ l o s s _ t r a d e )  
                         m _ l a r g _ l o s s _ t r a d e   =   p r o f i t ;  
  
  
                     i f ( r e s u l t   ! =   L O S S )  
                       {  
                         r e s u l t   =   L O S S ;  
                         m _ s e r i e s _ c o u n t + + ;  
                         m _ l o s s _ s e r i e s _ c o u n t + + ;  
                         l o s s _ l e n g t h   =   0 ;  
                         s e q u e n t i a l   =   0 . 0 ;  
                       }  
  
                     s e q u e n t i a l   + =   p r o f i t ;  
                     l o s s _ l e n g t h + + ;  
                     i f ( m _ m a x _ c o n _ l o s s _ t r a d e s   <   l o s s _ l e n g t h )  
                       {  
                         m _ m a x _ c o n _ l o s s _ t r a d e s   =   l o s s _ l e n g t h ;  
                         m _ m a x _ c o n _ l o s s e s   =   s e q u e n t i a l ;  
                       }  
                     i f ( m _ c o n _ l o s s _ m a x   >   s e q u e n t i a l )  
                       {  
                         m _ c o n _ l o s s _ m a x   =   s e q u e n t i a l ;  
                         m _ c o n _ l o s s _ m a x _ t r a d e s   =   l o s s _ l e n g t h ;  
                       }  
                   }  
  
                 i f ( m _ d e a l . D e a l T y p e ( )   = =   D E A L _ T Y P E _ S E L L )  
                   {  
                     i f ( p r o f i t   > =   0 . 0 )  
                         m _ p r o f i t _ l o n g _ t r a d e s + + ;  
                     m _ l o n g _ t r a d e s + + ;  
                   }  
  
                 i f ( m _ d e a l . D e a l T y p e ( )   = =   D E A L _ T Y P E _ B U Y )  
                   {  
                     i f ( p r o f i t   > =   0 . 0 )  
                         m _ p r o f i t _ s h o r t _ t r a d e s + + ;  
                     m _ s h o r t _ t r a d e s + + ;  
                   }  
               }  
           }  
       }  
  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       A H P R ,   G H P R ,   S h a r p e _ R a t i o                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
     m _ a h p r   =   0 ;  
     m _ a h p r _ p e r c e n t   =   0 ;  
  
     m _ g h p r   =   0 ;  
     m _ g h p r _ p e r c e n t   =   0 ;  
  
 / / - - -  
     i n t   l i m i t   =   m _ s h a r p _ b a l a n c e . T o t a l ( ) ;  
     i f ( l i m i t   >   1 )  
       {  
         d o u b l e   h p r   =   0 ;  
         d o u b l e   h p r 2   =   0 ;  
  
         d o u b l e   H P R [ ] ;  
         A r r a y R e s i z e ( H P R ,   l i m i t   -   1 ) ;  
         f o r ( i n t   i   =   1 ;   i   <   l i m i t ;   i + + )  
           {  
             i f ( m _ s h a r p _ b a l a n c e . A t ( i )   ! =   0 . 0   & &   m _ s h a r p _ b a l a n c e . A t ( i   -   1 ) )  
               {  
                 H P R [ i   -   1 ]   =   m _ s h a r p _ b a l a n c e . A t ( i )   /   m _ s h a r p _ b a l a n c e . A t ( i   -   1 ) ;  
                 m _ a h p r   + =   H P R [ i   -   1 ] ;  
               }  
           }  
         m _ a h p r   =   m _ a h p r   /   ( l i m i t   -   1 ) ;  
         m _ a h p r _ p e r c e n t   =   ( m _ a h p r   -   1 )   *   1 0 0 ;  
  
         m _ g h p r   =   : : M a t h P o w ( m _ s h a r p _ b a l a n c e . A t ( l i m i t   -   1 )   /   m _ i n i t i a l _ d e p o s i t ,   1 . 0   /   ( l i m i t   -   1 ) ) ;  
         m _ g h p r _ p e r c e n t   =   ( m _ g h p r   -   1 )   *   1 0 0 ;  
  
         / / - - -   S h a r p e _ R a t i o  
         m _ s h a r p e _ r a t i o   =   0 ;  
         i f ( l i m i t   >   2 )  
           {  
             d o u b l e   S t d   =   0 . 0 ;  
             d o u b l e   R i s k F r e e R a t e   =   0 . 0 ; / /  
             f o r ( i n t   i   =   0 ;   i   <   l i m i t   -   2 ;   i + + )  
               {  
                 S t d   + =   ( m _ a h p r   -   H P R [ i ] )   *   ( m _ a h p r   -   H P R [ i ] ) ;  
               }  
             S t d   =   M a t h P o w ( S t d   /   ( l i m i t   -   2 ) ,   0 . 5 ) ;  
  
             m _ s h a r p e _ r a t i o   =   ( m _ a h p r   -   ( 1 . 0   +   R i s k F r e e R a t e ) )   /   S t d ;  
           }  
       }  
  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       Z - S c o r e                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
     m _ z _ s c o r e   =   0 . 0 ;  
     m _ z _ s c o r e _ p e r c e n t   =   0 . 0 ;  
     l o n g   N   =   m _ p r o f i t _ d a t a . T o t a l ( ) ;  
  
     i f ( N   >   2 )  
       {  
         l o n g   W   =   0 ;  
         l o n g   L   =   0 ;  
         l o n g   R   =   0 ;  
         d e a l _ r e s u l t   o u t c o m e   =   N O _ V A L U E ;  
  
         f o r ( i n t   i   =   0 ;   i   <   N ;   i + + )  
           {  
             i f ( m _ p r o f i t _ d a t a . A t ( i )   > =   0 . 0 )  
               {  
                 i f ( o u t c o m e   ! =   W I N )  
                   {  
                     o u t c o m e   =   W I N ;  
                     R + + ;  
                   }  
                 W + + ;  
               }  
             e l s e  
               {  
                 i f ( o u t c o m e   ! =   L O S S )  
                   {  
                     o u t c o m e   =   L O S S ;  
                     R + + ;  
                   }  
                 L + + ;  
               }  
           }  
         d o u b l e   P   =   2 . 0   *   W   *   L ;  
  
         / / - - -   c h e c k   f o r   d i v i s i o n   b y   z e r o  
         i f ( M a t h A b s ( M a t h S q r t ( ( P   *   ( P   -   N ) )   /   ( N   -   1 ) ) )   > =   F L T _ E P S I L O N )  
           {  
             m _ z _ s c o r e   =   ( N   *   ( R   -   0 . 5 )   -   P )   /   M a t h S q r t ( ( P   *   ( P   -   N ) )   /   ( N   -   1 ) ) ;  
             m _ z _ s c o r e _ p e r c e n t   =   C a l c Z S c o r e P e r c e n t ( m _ z _ s c o r e )   *   1 0 0 ;  
           }  
       }  
  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       O t h e r                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
  
 / / - - -   T o t a l _ N e t _ P r o f i t  
     m _ p r o f i t   =   m _ g r o s s _ p r o f i t   +   m _ g r o s s _ l o s s ;  
  
 / / - - -   P r o f i t   F a c t o r  
     m _ p r o f i t _ f a c t o r   =   0 . 0 ;  
     i f ( M a t h A b s ( m _ g r o s s _ l o s s )   >   F L T _ E P S I L O N )  
         m _ p r o f i t _ f a c t o r   =   M a t h A b s ( m _ g r o s s _ p r o f i t   /   m _ g r o s s _ l o s s ) ;  
  
 / / - - -  
     m _ p r o f i t _ t r a d e s _ p e r c e n t   =   0 ;  
     m _ l o s s _ t r a d e s _ p e r c e n t   =   0 ;  
     m _ e x p e c t e d _ p a y o f f   =   0 ;  
     i f ( m _ t r a d e s   >   0 )  
       {  
         m _ e x p e c t e d _ p a y o f f   =   m _ p r o f i t   /   m _ t r a d e s ;  
         m _ p r o f i t _ t r a d e s _ p e r c e n t   =   ( d o u b l e ) m _ p r o f i t _ t r a d e s   /   m _ t r a d e s   *   1 0 0 ;  
         m _ l o s s _ t r a d e s _ p e r c e n t       =   ( d o u b l e ) m _ l o s s _ t r a d e s   /   m _ t r a d e s   *   1 0 0 ;  
       }  
  
     m _ p r o f i t _ t r a d e s _ a v g _ c o n   =   0 ;  
     i f ( m _ w i n s _ s e r i e s _ c o u n t   >   0 )  
         m _ p r o f i t _ t r a d e s _ a v g _ c o n   =   ( i n t ) M a t h R o u n d ( ( d o u b l e ) m _ p r o f i t _ t r a d e s   /   m _ w i n s _ s e r i e s _ c o u n t ) ;  
  
     m _ l o s s _ t r a d e s _ a v g _ c o n   =   0 ;  
     i f ( m _ l o s s _ s e r i e s _ c o u n t   >   0 )  
         m _ l o s s _ t r a d e s _ a v g _ c o n   =   ( i n t ) M a t h R o u n d ( ( d o u b l e ) m _ l o s s _ t r a d e s   /   m _ l o s s _ s e r i e s _ c o u n t ) ;  
  
     i f ( M a t h A b s ( m _ b a l a n c e _ d d )   >   F L T _ E P S I L O N )  
         m _ r e c o v e r y _ f a c t o r   =   m _ p r o f i t   /   m _ b a l a n c e _ d d ;  
  
     C a l c u l a t e R L ( m _ b a l a n c e _ d a t a ,   m _ b a l a n c e _ l i n e ,   m _ l r _ s t a n d a r d _ e r r o r ,   m _ l r _ c o r r e l a t i o n ) ;  
  
     r e t u r n ( t r u e ) ;  
   }  
  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       L a p l a s   a r r a y                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c o n s t   d o u b l e   L a p l a s [ ] [ 2 ]   =  
   {  
       { 0 . 0 0 ,   0 . 0 0 0 0 0 } ,   { 0 . 0 1 ,   0 . 0 0 7 9 8 } ,   { 0 . 0 2 ,   0 . 0 1 5 9 6 } ,   { 0 . 0 3 ,   0 . 0 2 3 9 3 } ,   { 0 . 0 4 ,   0 . 0 3 1 9 1 } ,   { 0 . 0 5 ,   0 . 0 3 9 8 8 } ,  
       { 0 . 0 6 ,   0 . 0 4 7 8 4 } ,   { 0 . 0 7 ,   0 . 0 5 5 8 1 } ,   { 0 . 0 8 ,   0 . 0 6 3 7 6 } ,   { 0 . 0 9 ,   0 . 0 7 1 7 1 } ,   { 0 . 1 0 ,   0 . 0 7 9 6 6 } ,   { 0 . 1 1 ,   0 . 0 8 7 5 9 } ,  
       { 0 . 1 2 ,   0 . 0 9 5 5 2 } ,   { 0 . 1 3 ,   0 . 1 0 3 4 8 } ,   { 0 . 1 4 ,   0 . 1 1 1 3 4 } ,   { 0 . 1 5 ,   0 . 1 1 9 2 4 } ,   { 0 . 1 6 ,   0 . 1 2 7 1 2 } ,   { 0 . 1 7 ,   0 . 1 3 4 9 9 } ,  
       { 0 . 1 8 ,   0 . 1 4 2 8 5 } ,   { 0 . 1 9 ,   0 . 1 5 0 6 9 } ,   { 0 . 2 0 ,   0 . 1 5 8 5 2 } ,   { 0 . 2 1 ,   0 . 1 6 6 3 3 } ,   { 0 . 2 2 ,   0 . 1 7 4 1 3 } ,   { 0 . 2 3 ,   0 . 1 8 1 9 1 } ,  
       { 0 . 2 4 ,   0 . 1 8 9 6 7 } ,   { 0 . 2 5 ,   0 . 1 9 7 4 1 } ,   { 0 . 2 6 ,   0 . 2 0 5 1 4 } ,   { 0 . 2 7 ,   0 . 2 1 2 8 4 } ,   { 0 . 2 8 ,   0 . 2 2 0 5 2 } ,   { 0 . 2 9 ,   0 . 2 2 8 1 8 } ,  
       { 0 . 3 0 ,   0 . 2 3 5 8 2 } ,   { 0 . 3 1 ,   0 . 2 4 3 4 4 } ,   { 0 . 3 2 ,   0 . 2 5 1 0 3 } ,   { 0 . 3 3 ,   0 . 2 5 8 6 0 } ,   { 0 . 3 4 ,   0 . 2 6 6 1 4 } ,   { 0 . 3 5 ,   0 . 2 7 3 6 6 } ,  
       { 0 . 3 6 ,   0 . 2 8 1 1 5 } ,   { 0 . 3 7 ,   0 . 2 8 8 6 2 } ,   { 0 . 3 8 ,   0 . 2 9 6 0 5 } ,   { 0 . 3 9 ,   0 . 3 0 3 4 6 } ,   { 0 . 4 0 ,   0 . 3 1 0 8 4 } ,   { 0 . 4 1 ,   0 . 3 1 8 1 9 } ,  
       { 0 . 4 2 ,   0 . 3 2 5 5 2 } ,   { 0 . 4 3 ,   0 . 3 3 2 8 0 } ,   { 0 . 4 4 ,   0 . 3 4 0 0 6 } ,   { 0 . 4 5 ,   0 . 3 4 7 2 9 } ,   { 0 . 4 6 ,   0 . 3 5 4 4 8 } ,   { 0 . 4 7 ,   0 . 3 6 1 6 4 } ,  
       { 0 . 4 8 ,   0 . 3 6 8 7 7 } ,   { 0 . 4 9 ,   0 . 3 7 5 8 7 } ,   { 0 . 5 0 ,   0 . 3 8 2 9 2 } ,   { 0 . 5 1 ,   0 . 3 8 9 9 5 } ,   { 0 . 5 2 ,   0 . 3 9 6 9 4 } ,   { 0 . 5 3 ,   0 . 4 0 3 8 9 } ,  
       { 0 . 5 4 ,   0 . 4 1 0 8 0 } ,   { 0 . 5 5 ,   0 . 4 1 7 6 8 } ,   { 0 . 5 6 ,   0 . 4 2 4 5 2 } ,   { 0 . 5 7 ,   0 . 4 3 1 3 2 } ,   { 0 . 5 8 ,   0 . 4 3 8 0 9 } ,   { 0 . 5 9 ,   0 . 4 4 4 8 1 } ,  
       { 0 . 6 0 ,   0 . 4 5 1 4 9 } ,   { 0 . 6 1 ,   0 . 4 5 8 1 4 } ,   { 0 . 6 2 ,   0 . 4 6 4 7 4 } ,   { 0 . 6 3 ,   0 . 4 7 1 3 1 } ,   { 0 . 6 4 ,   0 . 4 7 7 8 3 } ,   { 0 . 6 5 ,   0 . 4 8 4 3 1 } ,  
       { 0 . 6 6 ,   0 . 4 9 0 7 5 } ,   { 0 . 6 7 ,   0 . 4 9 7 1 4 } ,   { 0 . 6 8 ,   0 . 5 0 3 5 0 } ,   { 0 . 6 9 ,   0 . 5 0 9 8 1 } ,   { 0 . 7 0 ,   0 . 5 1 6 0 7 } ,   { 0 . 7 1 ,   0 . 5 2 2 3 0 } ,  
       { 0 . 7 2 ,   0 . 5 2 8 4 8 } ,   { 0 . 7 3 ,   0 . 5 3 4 6 1 } ,   { 0 . 7 4 ,   0 . 5 4 0 7 0 } ,   { 0 . 7 5 ,   0 . 5 4 6 7 5 } ,   { 0 . 7 6 ,   0 . 5 5 2 7 5 } ,   { 0 . 7 7 ,   0 . 5 5 8 7 0 } ,  
       { 0 . 7 8 ,   0 . 5 6 4 6 1 } ,   { 0 . 7 9 ,   0 . 5 7 0 4 7 } ,   { 0 . 8 0 ,   0 . 5 7 6 2 9 } ,   { 0 . 8 1 ,   0 . 5 8 2 0 6 } ,   { 0 . 8 2 ,   0 . 5 8 7 7 8 } ,   { 0 . 8 3 ,   0 . 5 9 3 4 6 } ,  
       { 0 . 8 4 ,   0 . 5 9 9 0 9 } ,   { 0 . 8 5 ,   0 . 6 0 4 6 8 } ,   { 0 . 8 6 ,   0 . 6 1 0 2 1 } ,   { 0 . 8 7 ,   0 . 6 1 5 7 0 } ,   { 0 . 8 8 ,   0 . 6 2 1 1 4 } ,   { 0 . 8 9 ,   0 . 6 2 6 5 3 } ,  
       { 0 . 9 0 ,   0 . 6 3 1 8 8 } ,   { 0 . 9 1 ,   0 . 6 3 7 1 8 } ,   { 0 . 9 2 ,   0 . 6 4 2 4 3 } ,   { 0 . 9 3 ,   0 . 6 4 7 6 3 } ,   { 0 . 9 4 ,   0 . 6 5 2 7 8 } ,   { 0 . 9 5 ,   0 . 6 5 7 8 9 } ,  
       { 0 . 9 6 ,   0 . 6 6 2 9 4 } ,   { 0 . 9 7 ,   0 . 6 6 7 9 5 } ,   { 0 . 9 8 ,   0 . 6 7 2 9 1 } ,   { 0 . 9 9 ,   0 . 6 7 7 8 3 } ,   { 1 . 0 0 ,   0 . 6 8 2 6 9 } ,   { 1 . 0 1 ,   0 . 6 8 7 5 0 } ,  
       { 1 . 0 2 ,   0 . 6 9 2 2 7 } ,   { 1 . 0 3 ,   0 . 6 9 6 9 9 } ,   { 1 . 0 4 ,   0 . 7 0 1 6 6 } ,   { 1 . 0 5 ,   0 . 7 0 6 2 8 } ,   { 1 . 0 6 ,   0 . 7 1 0 8 6 } ,   { 1 . 0 7 ,   0 . 7 1 5 3 8 } ,  
       { 1 . 0 8 ,   0 . 7 1 9 8 6 } ,   { 1 . 0 9 ,   0 . 7 2 4 2 9 } ,   { 1 . 1 0 ,   0 . 7 2 8 6 7 } ,   { 1 . 1 1 ,   0 . 7 3 3 0 0 } ,   { 1 . 1 2 ,   0 . 7 3 7 2 9 } ,   { 1 . 1 3 ,   0 . 7 4 1 5 2 } ,  
       { 1 . 1 4 ,   0 . 7 4 5 7 1 } ,   { 1 . 1 5 ,   0 . 7 4 9 8 6 } ,   { 1 . 1 6 ,   0 . 7 5 3 9 5 } ,   { 1 . 1 7 ,   0 . 7 5 8 0 0 } ,   { 1 . 1 8 ,   0 . 7 6 2 0 0 } ,   { 1 . 1 9 ,   0 . 7 6 5 9 5 } ,  
       { 1 . 2 0 ,   0 . 7 6 9 8 6 } ,   { 1 . 2 1 ,   0 . 7 7 3 7 2 } ,   { 1 . 2 2 ,   0 . 7 7 7 5 4 } ,   { 1 . 2 3 ,   0 . 7 8 1 3 0 } ,   { 1 . 2 4 ,   0 . 7 8 5 0 2 } ,   { 1 . 2 5 ,   0 . 7 8 8 7 0 } ,  
       { 1 . 2 6 ,   0 . 7 9 2 3 3 } ,   { 1 . 2 7 ,   0 . 7 9 5 9 2 } ,   { 1 . 2 8 ,   0 . 7 9 9 4 5 } ,   { 1 . 2 9 ,   0 . 8 0 2 9 5 } ,   { 1 . 3 0 ,   0 . 8 0 6 4 0 } ,   { 1 . 3 1 ,   0 . 8 0 9 8 0 } ,  
       { 1 . 3 2 ,   0 . 8 1 3 1 6 } ,   { 1 . 3 3 ,   0 . 8 1 6 4 8 } ,   { 1 . 3 4 ,   0 . 8 1 9 7 5 } ,   { 1 . 3 5 ,   0 . 8 2 2 9 8 } ,   { 1 . 3 6 ,   0 . 8 2 6 1 7 } ,   { 1 . 3 7 ,   0 . 8 2 9 3 1 } ,  
       { 1 . 3 8 ,   0 . 8 3 2 4 1 } ,   { 1 . 3 9 ,   0 . 8 3 5 4 7 } ,   { 1 . 4 0 ,   0 . 8 3 8 4 9 } ,   { 1 . 4 1 ,   0 . 8 4 1 4 6 } ,   { 1 . 4 2 ,   0 . 8 4 4 3 9 } ,   { 1 . 4 3 ,   0 . 8 4 7 2 8 } ,  
       { 1 . 4 4 ,   0 . 8 5 0 1 3 } ,   { 1 . 4 5 ,   0 . 8 5 2 9 4 } ,   { 1 . 4 6 ,   0 . 8 5 5 7 1 } ,   { 1 . 4 7 ,   0 . 8 5 8 4 4 } ,   { 1 . 4 8 ,   0 . 8 6 1 1 3 } ,   { 1 . 4 9 ,   0 . 8 6 3 7 8 } ,  
       { 1 . 5 0 ,   0 . 8 6 6 3 9 } ,   { 1 . 5 1 ,   0 . 8 6 6 9 6 } ,   { 1 . 5 2 ,   0 . 8 7 1 4 9 } ,   { 1 . 5 3 ,   0 . 8 7 3 9 8 } ,   { 1 . 5 4 ,   0 . 8 7 6 4 4 } ,   { 1 . 5 5 ,   0 . 8 7 8 8 6 } ,  
       { 1 . 5 6 ,   0 . 8 8 1 2 4 } ,   { 1 . 5 7 ,   0 . 8 8 3 5 8 } ,   { 1 . 5 8 ,   0 . 8 8 5 8 9 } ,   { 1 . 5 9 ,   0 . 8 8 8 1 7 } ,   { 1 . 6 0 ,   0 . 8 9 0 4 0 } ,   { 1 . 6 1 ,   0 . 8 9 2 6 0 } ,  
       { 1 . 6 2 ,   0 . 8 9 4 7 7 } ,   { 1 . 6 3 ,   0 . 8 9 6 9 0 } ,   { 1 . 6 4 ,   0 . 8 9 8 9 9 } ,   { 1 . 6 5 ,   0 . 9 0 1 0 6 } ,   { 1 . 6 6 ,   0 . 9 0 3 0 9 } ,   { 1 . 6 7 ,   0 . 9 0 5 0 8 } ,  
       { 1 . 6 8 ,   0 . 9 0 7 0 4 } ,   { 1 . 6 9 ,   0 . 9 0 8 9 7 } ,   { 1 . 7 0 ,   0 . 9 1 0 8 7 } ,   { 1 . 7 1 ,   0 . 9 1 2 7 3 } ,   { 1 . 7 2 ,   0 . 9 1 4 5 7 } ,   { 1 . 7 3 ,   0 . 9 1 6 3 7 } ,  
       { 1 . 7 4 ,   0 . 9 1 8 1 4 } ,   { 1 . 7 5 ,   0 . 9 1 9 8 8 } ,   { 1 . 7 6 ,   0 . 9 2 1 5 9 } ,   { 1 . 7 7 ,   0 . 9 2 3 2 7 } ,   { 1 . 7 8 ,   0 . 9 2 4 9 2 } ,   { 1 . 7 9 ,   0 . 9 2 6 5 5 } ,  
       { 1 . 8 0 ,   0 . 9 2 8 1 4 } ,   { 1 . 8 1 ,   0 . 9 2 9 7 0 } ,   { 1 . 8 2 ,   0 . 9 3 1 2 4 } ,   { 1 . 8 3 ,   0 . 9 3 2 7 5 } ,   { 1 . 8 4 ,   0 . 9 3 4 2 3 } ,   { 1 . 8 5 ,   0 . 9 3 5 6 9 } ,  
       { 1 . 8 6 ,   0 . 9 3 7 1 1 } ,   { 1 . 8 7 ,   0 . 9 3 8 5 2 } ,   { 1 . 8 8 ,   0 . 9 3 9 8 9 } ,   { 1 . 8 9 ,   0 . 9 4 1 2 4 } ,   { 1 . 9 0 ,   0 . 9 4 2 5 7 } ,   { 1 . 9 1 ,   0 . 9 4 3 8 7 } ,  
       { 1 . 9 2 ,   0 . 9 4 5 1 4 } ,   { 1 . 9 3 ,   0 . 9 4 6 3 9 } ,   { 1 . 9 4 ,   0 . 9 4 7 6 2 } ,   { 1 . 9 5 ,   0 . 9 4 8 8 2 } ,   { 1 . 9 6 ,   0 . 9 5 0 0 0 } ,   { 1 . 9 7 ,   0 . 9 5 1 1 6 } ,  
       { 1 . 9 8 ,   0 . 9 5 2 3 0 } ,   { 1 . 9 9 ,   0 . 9 5 3 4 1 } ,   { 2 . 0 0 ,   0 . 9 5 4 5 0 } ,   { 2 . 0 1 ,   0 . 9 5 5 5 7 } ,   { 2 . 0 2 ,   0 . 9 5 6 6 2 } ,   { 2 . 0 3 ,   0 . 9 5 7 6 4 } ,  
       { 2 . 0 4 ,   0 . 9 5 8 6 5 } ,   { 2 . 0 5 ,   0 . 9 5 9 6 4 } ,   { 2 . 0 6 ,   0 . 9 6 0 6 0 } ,   { 2 . 0 7 ,   0 . 9 6 1 5 5 } ,   { 2 . 0 8 ,   0 . 9 6 2 4 7 } ,   { 2 . 0 9 ,   0 . 9 6 3 3 8 } ,  
       { 2 . 1 0 ,   0 . 9 6 4 2 7 } ,   { 2 . 1 1 ,   0 . 9 6 5 1 4 } ,   { 2 . 1 2 ,   0 . 9 6 5 9 9 } ,   { 2 . 1 3 ,   0 . 9 6 6 8 3 } ,   { 2 . 1 4 ,   0 . 9 6 7 6 5 } ,   { 2 . 1 5 ,   0 . 9 6 8 4 4 } ,  
       { 2 . 1 6 ,   0 . 9 6 9 2 3 } ,   { 2 . 1 7 ,   0 . 9 6 9 9 9 } ,   { 2 . 1 8 ,   0 . 9 7 0 7 4 } ,   { 2 . 1 9 ,   0 . 9 7 1 4 8 } ,   { 2 . 2 0 ,   0 . 9 7 2 1 9 } ,   { 2 . 2 1 ,   0 . 9 7 2 8 9 } ,  
       { 2 . 2 2 ,   0 . 9 7 3 5 8 } ,   { 2 . 2 3 ,   0 . 9 7 4 2 5 } ,   { 2 . 2 4 ,   0 . 9 7 4 9 1 } ,   { 2 . 2 5 ,   0 . 9 7 5 5 5 } ,   { 2 . 2 6 ,   0 . 9 7 6 1 8 } ,   { 2 . 2 7 ,   0 . 9 7 6 7 9 } ,  
       { 2 . 2 8 ,   0 . 9 7 7 3 9 } ,   { 2 . 2 9 ,   0 . 9 7 7 9 8 } ,   { 2 . 3 0 ,   0 . 9 7 8 5 5 } ,   { 2 . 3 1 ,   0 . 9 7 9 1 1 } ,   { 2 . 3 2 ,   0 . 9 7 9 6 6 } ,   { 2 . 3 3 ,   0 . 9 8 0 1 9 } ,  
       { 2 . 3 4 ,   0 . 9 8 0 7 2 } ,   { 2 . 3 5 ,   0 . 9 8 1 2 3 } ,   { 2 . 3 6 ,   0 . 9 8 1 7 2 } ,   { 2 . 3 7 ,   0 . 9 8 2 2 1 } ,   { 2 . 3 8 ,   0 . 9 8 2 6 9 } ,   { 2 . 3 9 ,   0 . 9 8 3 1 5 } ,  
       { 2 . 4 0 ,   0 . 9 8 3 6 0 } ,   { 2 . 4 1 ,   0 . 9 8 4 0 5 } ,   { 2 . 4 2 ,   0 . 9 8 4 4 8 } ,   { 2 . 4 3 ,   0 . 9 8 4 9 0 } ,   { 2 . 4 4 ,   0 . 9 8 5 3 1 } ,   { 2 . 4 5 ,   0 . 9 8 5 7 1 } ,  
       { 2 . 4 6 ,   0 . 9 8 6 1 1 } ,   { 2 . 4 7 ,   0 . 9 8 6 4 9 } ,   { 2 . 4 8 ,   0 . 9 8 6 8 6 } ,   { 2 . 4 9 ,   0 . 9 8 7 2 3 } ,   { 2 . 5 0 ,   0 . 9 8 7 5 8 } ,   { 2 . 5 1 ,   0 . 9 8 7 9 3 } ,  
       { 2 . 5 2 ,   0 . 9 8 8 2 6 } ,   { 2 . 5 3 ,   0 . 9 8 8 5 9 } ,   { 2 . 5 4 ,   0 . 9 8 8 9 1 } ,   { 2 . 5 5 ,   0 . 9 8 9 2 3 } ,   { 2 . 5 6 ,   0 . 9 8 9 5 3 } ,   { 2 . 5 7 ,   0 . 9 8 9 8 3 } ,  
       { 2 . 5 8 ,   0 . 9 9 0 1 2 } ,   { 2 . 5 9 ,   0 . 9 9 0 4 0 } ,   { 2 . 6 0 ,   0 . 9 9 0 6 8 } ,   { 2 . 6 1 ,   0 . 9 9 0 9 5 } ,   { 2 . 6 2 ,   0 . 9 9 1 2 1 } ,   { 2 . 6 3 ,   0 . 9 9 1 4 6 } ,  
       { 2 . 6 4 ,   0 . 9 9 1 7 1 } ,   { 2 . 6 5 ,   0 . 9 9 1 9 5 } ,   { 2 . 6 6 ,   0 . 9 9 2 1 9 } ,   { 2 . 6 7 ,   0 . 9 9 2 4 1 } ,   { 2 . 6 8 ,   0 . 9 9 2 6 3 } ,   { 2 . 6 9 ,   0 . 9 9 2 8 5 } ,  
       { 2 . 7 0 ,   0 . 9 9 3 0 7 } ,   { 2 . 7 1 ,   0 . 9 9 3 2 7 } ,   { 2 . 7 2 ,   0 . 9 9 3 4 7 } ,   { 2 . 7 3 ,   0 . 9 9 3 6 7 } ,   { 2 . 7 4 ,   0 . 9 9 3 8 6 } ,   { 2 . 7 5 ,   0 . 9 9 4 0 4 } ,  
       { 2 . 7 6 ,   0 . 9 9 4 2 2 } ,   { 2 . 7 7 ,   0 . 9 9 4 3 9 } ,   { 2 . 7 8 ,   0 . 9 9 4 5 6 } ,   { 2 . 7 9 ,   0 . 9 9 4 7 3 } ,   { 2 . 8 0 ,   0 . 9 9 4 8 9 } ,   { 2 . 8 1 ,   0 . 9 9 5 0 5 } ,  
       { 2 . 8 2 ,   0 . 9 9 5 2 0 } ,   { 2 . 8 3 ,   0 . 9 9 5 3 5 } ,   { 2 . 8 4 ,   0 . 9 9 5 4 9 } ,   { 2 . 8 5 ,   0 . 9 9 5 6 3 } ,   { 2 . 8 6 ,   0 . 9 9 5 7 6 } ,   { 2 . 8 7 ,   0 . 9 9 5 9 0 } ,  
       { 2 . 8 8 ,   0 . 9 9 6 0 2 } ,   { 2 . 8 9 ,   0 . 9 9 6 1 5 } ,   { 2 . 9 0 ,   0 . 9 9 6 2 7 } ,   { 2 . 9 1 ,   0 . 9 9 6 3 9 } ,   { 2 . 9 2 ,   0 . 9 9 6 5 0 } ,   { 2 . 9 3 ,   0 . 9 9 6 6 1 } ,  
       { 2 . 9 4 ,   0 . 9 9 6 7 2 } ,   { 2 . 9 5 ,   0 . 9 9 6 8 2 } ,   { 2 . 9 6 ,   0 . 9 9 6 9 2 } ,   { 2 . 9 7 ,   0 . 9 9 7 0 2 } ,   { 2 . 9 8 ,   0 . 9 9 7 1 2 } ,   { 2 . 9 9 ,   0 . 9 9 7 2 1 } ,  
       { 3 . 0 0 ,   0 . 9 9 7 3 0 } ,   { 3 . 0 1 ,   0 . 9 9 7 3 9 }  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       C a l c Z S c o r e P e r c e n t                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   C T r a d e S t a t i s t i c s : : C a l c Z S c o r e P e r c e n t ( d o u b l e   z _ s c o r e )  
   {  
     i n t   t o t a l   =   A r r a y R a n g e ( L a p l a s ,   0 ) ;  
     d o u b l e   v a l u e   =   N o r m a l i z e D o u b l e ( M a t h A b s ( z _ s c o r e ) ,   2 ) ;  
  
     i f ( v a l u e   >   L a p l a s [ t o t a l   -   2 ] [ 0 ] )  
         r e t u r n ( L a p l a s [ t o t a l   -   1 ] [ 1 ] ) ;  
  
     f o r ( i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
         i f ( L a p l a s [ i ] [ 0 ]   = =   v a l u e )  
             r e t u r n ( L a p l a s [ i ] [ 1 ] ) ;  
  
     r e t u r n ( 0 ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       P r i n t S t a t i s t i c s                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C T r a d e S t a t i s t i c s : : P r i n t S t a t i s t i c s ( )  
   {  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ I N I T I A L _ D E P O S I T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ I N I T I A L _ D E P O S I T ) ,   I n i t i a l D e p o s i t ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ W I T H D R A W A L ) ,   T e s t e r S t a t i s t i c s ( S T A T _ W I T H D R A W A L ) ,   W i t h d r a w a l ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ P R O F I T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ P R O F I T ) ,   P r o f i t ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ G R O S S _ P R O F I T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ G R O S S _ P R O F I T ) ,   G r o s s P r o f i t ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ G R O S S _ L O S S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ G R O S S _ L O S S ) ,   G r o s s L o s s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ M A X _ P R O F I T T R A D E ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M A X _ P R O F I T T R A D E ) ,   L a r g e s t P r o f i t T r a d e ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ M A X _ L O S S T R A D E ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M A X _ L O S S T R A D E ) ,   L a r g e s t L o s s T r a d e ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ C O N P R O F I T M A X ) ,   T e s t e r S t a t i s t i c s ( S T A T _ C O N P R O F I T M A X ) ,   C o n P r o f i t M a x ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ C O N P R O F I T M A X _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ C O N P R O F I T M A X _ T R A D E S ) ,   C o n P r o f i t M a x T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ M A X _ C O N W I N S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M A X _ C O N W I N S ) ,   M a x C o n W i n s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ M A X _ C O N P R O F I T _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M A X _ C O N P R O F I T _ T R A D E S ) ,   M a x C o n P r o f i t T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ C O N L O S S M A X ) ,   T e s t e r S t a t i s t i c s ( S T A T _ C O N L O S S M A X ) ,   C o n L o s s M a x ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ C O N L O S S M A X _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ C O N L O S S M A X _ T R A D E S ) ,   C o n L o s s M a x T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ M A X _ C O N L O S S E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M A X _ C O N L O S S E S ) ,   M a x C o n L o s s e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ M A X _ C O N L O S S _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M A X _ C O N L O S S _ T R A D E S ) ,   M a x C o n L o s s T r a d e s ( ) ) ;  
  
 / / - - -   B a l a n c e  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ B A L A N C E M I N ) ,   T e s t e r S t a t i s t i c s ( S T A T _ B A L A N C E M I N ) ,   B a l a n c e M i n ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ B A L A N C E _ D D ) ,   T e s t e r S t a t i s t i c s ( S T A T _ B A L A N C E _ D D ) ,   B a l a n c e D D ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ B A L A N C E D D _ P E R C E N T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ B A L A N C E D D _ P E R C E N T ) ,   B a l a n c e D D P e r c e n t ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ B A L A N C E _ D D _ R E L A T I V E ) ,   T e s t e r S t a t i s t i c s ( S T A T _ B A L A N C E _ D D _ R E L A T I V E ) ,   B a l a n c e D D R e l a t i v e ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ B A L A N C E _ D D R E L _ P E R C E N T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ B A L A N C E _ D D R E L _ P E R C E N T ) ,   B a l a n c e D D R e l a t i v e P e r c e n t ( ) ) ;  
  
 / / - - -   E q u i t y  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ E Q U I T Y M I N ) ,   T e s t e r S t a t i s t i c s ( S T A T _ E Q U I T Y M I N ) ,   E q u i t y M i n ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ E Q U I T Y _ D D ) ,   T e s t e r S t a t i s t i c s ( S T A T _ E Q U I T Y _ D D ) ,   E q u i t y D D ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ E Q U I T Y D D _ P E R C E N T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ E Q U I T Y D D _ P E R C E N T ) ,   E q u i t y D D P e r c e n t ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ E Q U I T Y _ D D _ R E L A T I V E ) ,   T e s t e r S t a t i s t i c s ( S T A T _ E Q U I T Y _ D D _ R E L A T I V E ) ,   E q u i t y D D R e l a t i v e ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ E Q U I T Y _ D D R E L _ P E R C E N T ) ,   T e s t e r S t a t i s t i c s ( S T A T _ E Q U I T Y _ D D R E L _ P E R C E N T ) ,   E q u i t y D D R e l a t i v e P e r c e n t ( ) ) ;  
  
     / *  
           P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " , E n u m T o S t r i n g ( A C C O U N T _ B A L A N C E ) , A c c o u n t I n f o D o u b l e ( A C C O U N T _ B A L A N C E ) , B a l a n c e ) ;  
  
           P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " , E n u m T o S t r i n g ( A C C O U N T _ P R O F I T ) , A c c o u n t I n f o D o u b l e ( A C C O U N T _ P R O F I T ) , P r o f i t ) ;  
  
           P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " , E n u m T o S t r i n g ( A C C O U N T _ E Q U I T Y ) , A c c o u n t I n f o D o u b l e ( A C C O U N T _ E Q U I T Y ) , E q u i t y ) ;  
     * /  
  
 / / - - -  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ E X P E C T E D _ P A Y O F F ) ,   T e s t e r S t a t i s t i c s ( S T A T _ E X P E C T E D _ P A Y O F F ) ,   E x p e c t e d P a y o f f ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ P R O F I T _ F A C T O R ) ,   T e s t e r S t a t i s t i c s ( S T A T _ P R O F I T _ F A C T O R ) ,   P r o f i t F a c t o r ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ R E C O V E R Y _ F A C T O R ) ,   T e s t e r S t a t i s t i c s ( S T A T _ R E C O V E R Y _ F A C T O R ) ,   R e c o v e r y F a c t o r ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ S H A R P E _ R A T I O ) ,   T e s t e r S t a t i s t i c s ( S T A T _ S H A R P E _ R A T I O ) ,   S h a r p e R a t i o ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ M I N _ M A R G I N L E V E L ) ,   T e s t e r S t a t i s t i c s ( S T A T _ M I N _ M A R G I N L E V E L ) ,   M i n M a r g i n L e v e l ( ) ) ;  
  
 / /   P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " , E n u m T o S t r i n g ( S T A T _ C U S T O M _ O N T E S T E R ) , T e s t e r S t a t i s t i c s ( S T A T _ C U S T O M _ O N T E S T E R ) , C u s t o m O n T e s t e r ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ D E A L S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ D E A L S ) ,   D e a l s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ T R A D E S ) ,   T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ P R O F I T _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ P R O F I T _ T R A D E S ) ,   P r o f i t T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ L O S S _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ L O S S _ T R A D E S ) ,   L o s s T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ S H O R T _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ S H O R T _ T R A D E S ) ,   S h o r t T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ L O N G _ T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ L O N G _ T R A D E S ) ,   L o n g T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ P R O F I T _ S H O R T T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ P R O F I T _ S H O R T T R A D E S ) ,   P r o f i t S h o r t T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ P R O F I T _ L O N G T R A D E S ) ,   T e s t e r S t a t i s t i c s ( S T A T _ P R O F I T _ L O N G T R A D E S ) ,   P r o f i t L o n g T r a d e s ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ P R O F I T T R A D E S _ A V G C O N ) ,   T e s t e r S t a t i s t i c s ( S T A T _ P R O F I T T R A D E S _ A V G C O N ) ,   P r o f i t T r a d e s A v g C o n ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 0 f   -   % . 0 f " ,   E n u m T o S t r i n g ( S T A T _ L O S S T R A D E S _ A V G C O N ) ,   T e s t e r S t a t i s t i c s ( S T A T _ L O S S T R A D E S _ A V G C O N ) ,   L o s s T r a d e s A v g C o n ( ) ) ;  
  
 / / - - -   G H P R  
     P r i n t F o r m a t ( " % s :   % . 4 f ( % . 2 f )   -   % . 4 f ( % . 2 f ) " ,   E n u m T o S t r i n g ( S T A T _ G H P R ) ,   0 ,   0 ,   G H P R ( ) ,   G H P R P e r c e n t ( ) ) ;  
  
 / / - - -   A H P R  
     P r i n t F o r m a t ( " % s :   % . 4 f ( % . 2 f )   -   % . 4 f ( % . 2 f ) " ,   E n u m T o S t r i n g ( S T A T _ A H P R ) ,   0 ,   0 ,   A H P R ( ) ,   A H P R P e r c e n t ( ) ) ;  
  
 / / - - -   Z   S C O R E  
     P r i n t F o r m a t ( " % s :   % . 2 f ( % . 2 f )   -   % . 2 f ( % . 2 f ) " ,   E n u m T o S t r i n g ( S T A T _ Z _ S C O R E ) ,   0 ,   0 ,   Z S c o r e ( ) ,   Z S c o r e P e r c e n t ( ) ) ;  
  
 / / - - -   L R  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ L R _ C O R R E L A T I O N ) ,   0 ,   L R C o r r e l a t i o n ( ) ) ;  
  
     P r i n t F o r m a t ( " % s :   % . 2 f   -   % . 2 f " ,   E n u m T o S t r i n g ( S T A T _ L R _ S T A N D A R D _ E R R O R ) ,   0 ,   L R S t a n d a r d E r r o r ( ) ) ;  
  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C T r a d e S t a t i s t i c s : : C a l c u l a t e E q u i t y D D ( E N U M _ C A L C _ S T A T E   s t a t e )  
   {  
     s w i t c h ( s t a t e )  
       {  
         c a s e   C A L C _ I N I T :  
             m _ e q u i t y _ m i n   =   A c c o u n t I n f o D o u b l e ( A C C O U N T _ E Q U I T Y ) ;  
             m _ e q u i t y _ d d   =   0 . 0 ;  
             m _ e q u i t y _ d d _ p e r c e n t   =   0 . 0 ;  
             m _ e q u i t y _ d d _ r e l a t i v e   =   0 . 0 ;  
             m _ e q u i t y _ d d _ r e l a t i v e _ p e r c e n t   =   0 . 0 ;  
             m _ m i n _ m a r g i n _ l e v e l   =   A c c o u n t I n f o D o u b l e ( A C C O U N T _ M A R G I N _ L E V E L ) ;  
             b r e a k ;  
  
         c a s e   C A L C _ T I C K :  
             C a l c E q u i t y D r a w d o w n ( f a l s e ) ;  
             b r e a k ;  
  
         c a s e   C A L C _ D E I N I T :  
             C a l c E q u i t y D r a w d o w n ( t r u e ) ;  
             b r e a k ;  
       }  
  
     r e t u r n ( t r u e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |       C a l c E q u i t y D r a w d o w n                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d     C T r a d e S t a t i s t i c s : : C a l c E q u i t y D r a w d o w n ( b o o l   f i n a l l y )  
   {  
  
     s t a t i c   d o u b l e   m a x p e a k   =   0 . 0 ;  
     s t a t i c   d o u b l e   m i n p e a k   =   0 . 0 ;  
  
     d o u b l e   e q u i t y   =   A c c o u n t I n f o D o u b l e ( A C C O U N T _ E Q U I T Y ) ;  
     i f ( e q u i t y   <   m _ e q u i t y _ m i n )  
         m _ e q u i t y _ m i n   =   e q u i t y ;  
  
     i f ( A c c o u n t I n f o D o u b l e ( A C C O U N T _ M A R G I N _ L E V E L )   <   m _ m i n _ m a r g i n _ l e v e l )  
         m _ m i n _ m a r g i n _ l e v e l   =   A c c o u n t I n f o D o u b l e ( A C C O U N T _ M A R G I N _ L E V E L ) ;  
  
     i f ( m a x p e a k   = =   0 . 0 )  
         m a x p e a k   =   e q u i t y ;  
     i f ( m i n p e a k   = =   0 . 0 )  
         m i n p e a k   =   e q u i t y ;  
  
     i f ( ( m a x p e a k   <   e q u i t y )   | |   ( f i n a l l y ) )  
       {  
         d o u b l e   d r a w d o w n   =   m a x p e a k   -   m i n p e a k ;  
         d o u b l e   d r a w d o w n _ p e r c e n t   =   d r a w d o w n   /   m a x p e a k   *   1 0 0 . 0 ;  
  
         i f ( m _ e q u i t y _ d d _ r e l a t i v e _ p e r c e n t   <   d r a w d o w n _ p e r c e n t )  
           {  
             m _ e q u i t y _ d d _ r e l a t i v e _ p e r c e n t   =   d r a w d o w n _ p e r c e n t ;  
             m _ e q u i t y _ d d _ r e l a t i v e   =   d r a w d o w n ;  
           }  
  
         i f ( m _ e q u i t y _ d d   <   d r a w d o w n )  
           {  
             m _ e q u i t y _ d d   =   d r a w d o w n ;  
             m _ e q u i t y _ d d _ p e r c e n t   =   d r a w d o w n _ p e r c e n t ;  
           }  
  
         m a x p e a k   =   e q u i t y ;  
         m i n p e a k   =   e q u i t y ;  
       }  
  
     i f ( m i n p e a k   >   e q u i t y )  
         m i n p e a k   =   e q u i t y ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C T r a d e S t a t i s t i c s : : C a l c u l a t e R L ( C A r r a y D o u b l e   & d a t a ,   C A r r a y D o u b l e   & l i n e ,   d o u b l e   & S t a n d a r d _ E r r o r ,   d o u b l e   & C o r r e l a t i o n )  
   {  
     i n t   t o t a l   =   d a t a . T o t a l ( ) ;  
     i f ( t o t a l   < =   2 )  
         r e t u r n ( t r u e ) ;  
  
     d o u b l e   s 1   =   0 ;  
     d o u b l e   s 2   =   0 ;  
     d o u b l e   a 1   =   0 ;  
     d o u b l e   a 2   =   0 ;  
     d o u b l e   b 1   =   0 ;  
     d o u b l e   b 2   =   t o t a l ;  
  
     f o r ( i n t   i   =   1 ;   i   < =   t o t a l ;   i + + )  
       {  
         s 1   =   s 1   +   d a t a . A t ( i   -   1 )   *   i ;  
         s 2   =   s 2   +   d a t a . A t ( i   -   1 ) ;  
         a 1   =   a 1   +   i   *   i ;  
         a 2   =   a 2   +   i ;  
       }  
  
     b 1   =   a 2 ;  
  
     d o u b l e   d i f   =   a 1   *   b 2   -   a 2   *   b 1 ;  
     d o u b l e   A       =   ( s 1   *   b 2   -   s 2   *   b 1 )   /   d i f ;  
     d o u b l e   B       =   ( a 1   *   s 2   -   a 2   *   s 1 )   /   d i f ;  
  
     i n t   s i g n   =   1 ;  
     i f ( A   <   0 . 0 )  
         s i g n   =   - 1 ;  
  
     l i n e . C l e a r ( ) ;  
     s t r i n g   s t r   =   " " ;  
     f o r ( i n t   i   =   1 ;   i   < =   t o t a l ;   i + + )  
       {  
         s t r   =   s t r   +   S t r i n g F o r m a t ( " |   % i   % . 2 f " ,   i ,   A   *   i   +   B ) ;  
         l i n e . A d d ( A   *   i   +   B ) ;  
       }  
  
     S t a n d a r d _ E r r o r   =   0 ;  
     d o u b l e   s u m   =   0 ;  
     f o r ( i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
  
         d o u b l e   d e l t a   =   M a t h A b s ( d a t a . A t ( i )   -   l i n e . A t ( i ) ) ;  
         s u m   =   s u m   +   d e l t a   *   d e l t a ;  
         / / P r i n t F o r m a t ( " B = % . 2 f   L = % . 2 f   D = % . 2 f " , m _ b a l a n c e _ d a t a . A t ( i ) , B a l a n c e L i n e . A t ( i ) , d e l t a ) ;  
       }  
     S t a n d a r d _ E r r o r   =   M a t h S q r t ( s u m   /   ( t o t a l   -   2 ) ) ;  
  
  
 / / - - -   L R   C o r r e l a t i o n  
     d o u b l e   a v g _ b a l a n c e   =   0 ;  
     d o u b l e   a v g _ l i n e   =   0 ;  
     f o r ( i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         a v g _ b a l a n c e   =   a v g _ b a l a n c e   +   d a t a . A t ( i ) ;  
         a v g _ l i n e   =   a v g _ l i n e   +   l i n e . A t ( i ) ;  
       }  
  
     a v g _ b a l a n c e   =   a v g _ b a l a n c e   /   t o t a l ;  
     a v g _ l i n e         =   a v g _ l i n e   /   t o t a l ;  
  
  
     d o u b l e   c o v   =   0 ;  
     d o u b l e   S x   =   0 ;  
     d o u b l e   S y   =   0 ;  
  
     f o r ( i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         c o v   =   c o v   +   ( d a t a . A t ( i )   -   a v g _ b a l a n c e )   *   ( l i n e . A t ( i )   -   a v g _ l i n e ) ;  
         S x     =   S x   +   M a t h P o w ( d a t a . A t ( i )   -   a v g _ b a l a n c e ,   2 ) ;  
         S y     =   S y   +   M a t h P o w ( l i n e . A t ( i )   -   a v g _ l i n e ,   2 ) ;  
       }  
     c o v   =   ( c o v   /   t o t a l ) ;  
     S x     =   M a t h S q r t ( S x   /   t o t a l ) ;  
     S y     =   M a t h S q r t ( S y   /   t o t a l ) ;  
  
     C o r r e l a t i o n   =   s i g n   *   c o v   /   ( S x   *   S y ) ;  
  
     r e t u r n ( f a l s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                 L o g i n . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   v e r s i o n       " 1 . 0 0 "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   < W i n A P I \ w i n a p i . m q h >  
 # i n c l u d e   " F u n c . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # d e f i n e   D E F _ L O G I N _ F I L E _ M E N U _ N O _ C H A R T _ M A X     1  
 # d e f i n e   D E F _ L O G I N _ F I L E _ M E N U _ N O _ C H A R T _ N O R     0  
 # d e f i n e   D E F _ L O G I N _ T O _ T R A D E _ A C C _ M E N U E _ I T E M   1 6  
  
 # d e f i n e   D E F _ L O G I N _ G A _ R O O T                                   0 x 0 0 0 0 0 0 0 2     / /   R e t r i e v e s   t h e   r o o t   w i n d o w   b y   w a l k i n g   t h e   c h a i n   o f   p a r e n t   w i n d o w s  
 # d e f i n e   D E F _ L O G I N _ W M _ C O M M A N D                             0 x 0 0 0 0 0 1 1 1  
 # d e f i n e   D E F _ L O G I N _ W M _ C L O S E                                 0 x 0 0 1 0  
 # d e f i n e   D E F _ L O G I N _ B M _ C L I C K                                 0 x 0 0 0 0 0 0 F 5  
 # d e f i n e   D E F _ L O G I N _ T R Y _ L O G I N _ M A X                       3  
 # d e f i n e   D E F _ L O G I N _ T R Y _ L O G I N _ S L E E P _ M S C           1 0 0 0  
 # d e f i n e   D E F _ L O G I N _ T R Y _ T E R M _ C O N _ M A X                 1 0 0  
 # d e f i n e   D E F _ L O G I N _ T R Y _ T E R M _ C O N _ S L E E P _ M S C     1 0 0  
 # d e f i n e   D E F _ L O G I N _ T R Y _ P O S T _ S L E E P _ M S C             0  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 e n u m   E N U M _ L O G I N _ R E S U L T  
   {  
     L O G I N _ S U C S E S                         =   0 ,  
     L O G I N _ F A I L                             =   1 ,  
     L O G I N _ C O N N _ F A I L                   =   2 ,  
     L O G I N _ L O A D _ D E A L S _ F A I L       =   3 ,  
     L O G I N _ I N I T _ B A L A N C E _ F A I L   =   4 ,  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C L o g i n  
   {  
 p r i v a t e :  
     l o n g                               m _ c h a r t _ i d ,  
                                           m _ h l _ m a i n _ c h a r t _ i d ,  
                                           m _ h l _ r o o t ,  
                                           m _ h l _ h m e n u ,  
                                           m _ h l _ s u b _ m e n u ,  
                                           m _ h l _ s u b _ m e n u _ i t e m ,  
                                           m _ h l _ l o g i n _ p o p u p ,  
                                           m _ h l _ l o g i n _ p o p u p _ b t n _ o k ,  
                                           m _ h l _ l o g i n _ p o p u p _ e d t _ p a s s ,  
                                           m _ h l _ l o g i n _ p o p u p _ e d t _ l o g i n ,  
                                           m _ h l _ l o g i n _ p o p u p _ c b x _ s e r v e r ;  
     b o o l                               m _ i s _ i n v a l i d ,  
                                           m _ c l o s e _ c h a r t s ;  
  
     v o i d                               R e s e t ( v o i d ) ;  
     v o i d                               R e s t P o p u p H a n d e l s ( v o i d ) ;  
     b o o l                               S a f e P o s t M e s s a g e ( H A N D L E   w n d ,   u i n t   m s g ,   P V O I D   _ w p a r a m ,   P V O I D   _ l p a r a m )  
       {  
         i f ( P o s t M e s s a g e W ( w n d ,   m s g ,   _ w p a r a m ,   _ l p a r a m )   >   0 )  
           {  
             : : S l e e p ( D E F _ L O G I N _ T R Y _ P O S T _ S L E E P _ M S C ) ;  
             r e t u r n   t r u e ;  
           }  
         r e t u r n   f a l s e ;  
       }  
  
     b o o l                               I s T r u e C o n n e c t i o n ( v o i d ) ;  
     b o o l                               I s V a l i d L o g i n ( b o o l   & _ i s _ v a l i d _ b a l a n c e ,  
                                                                     b o o l   & _ i s _ v a l i d _ i n t i _ b a l a n c e ,  
                                                                     c o n s t   d o u b l e   _ i n i t _ b a l a c e ) ;  
     b o o l                               I s C u r r e n t L o g i n T r u e ( c o n s t   l o n g   _ l o g i n ,   c o n s t   s t r i n g   _ s e r v e r ) ;  
     b o o l                               G e t M e t a T r a d e r H a n d e l s ( v o i d ) ;  
     b o o l                               S e t L o g i n F i l d ( c o n s t   s t r i n g   _ l o g i n ,  
                                                                     c o n s t   s t r i n g   _ p a s s ,  
                                                                     c o n s t   s t r i n g   _ s e r v e r ) ;  
     l o n g                               G e t C h a r t I D ( v o i d ) ;  
     l o n g                               C h a r t W i n d o w s H a n d l e ( l o n g   _ c h a r t _ i d ) ;  
     s t r i n g                           R e a d J o u r n a l ( v o i d ) ;  
  
 p u b l i c :  
     b o o l                               O p e n L o g i n P o p u p ( v o i d ) ;  
  
     b o o l                               D e s t r o y P o p u p s ( v o i d )  
       {  
         i f ( ! G e t M e t a T r a d e r H a n d e l s ( ) )  
             r e t u r n   f a l s e ;  
         / / - - -  
         H A N D L E   h l _ p o p u p   =   I N V A L I D _ H A N D L E ;  
         u i n t   c t r y   =   1 0 0 ;  
         d o  
           {  
             h l _ p o p u p   =   G e t L a s t A c t i v e P o p u p ( m _ h l _ r o o t ) ;  
             i f ( h l _ p o p u p   = =   m _ h l _ r o o t )  
                 b r e a k ;  
             i f ( P o s t M e s s a g e W ( h l _ p o p u p ,   D E F _ L O G I N _ W M _ C L O S E ,   0 ,   0 )   = =   0 )  
               {  
                 c t r y - - ;  
                 c o n t i n u e ;  
               }  
           }  
         w h i l e ( h l _ p o p u p   >   0   | |   c t r y   < =   0 ) ;  
         / / - - -  
         r e t u r n   t r u e ;  
       }  
  
                                           C L o g i n ( ) ;  
                                         ~ C L o g i n ( ) ;  
     b o o l                               L o g i n T o A c c o u n t ( c o n s t   s t r i n g   _ l o g i n ,  
                                                                         c o n s t   s t r i n g   _ p a s s ,  
                                                                         c o n s t   s t r i n g   _ s e r v e r ) ;  
     i n t                                 T r y L o g i n ( c o n s t   l o n g   _ l o g i n ,  
                                                             c o n s t   s t r i n g   _ p a s s ,  
                                                             c o n s t   s t r i n g   _ s e r v e r ,  
                                                             c o n s t   d o u b l e   _ i n i t _ b a l a c e ) ;  
     b o o l                               I s I n v a l i d ( v o i d )                                     c o n s t   {   r e t u r n   m _ i s _ i n v a l i d ; }  
  
     v o i d                               C h e c k I n v a l i d A c c o u n t ( c o n s t   l o n g   _ l o g i n ,  
                                                                                   c o n s t   s t r i n g   _ s e r v e r ) ;  
     v o i d                               A d d L e b l e T o C h a r t ( c o n s t   s t r i n g   _ t x t ) ;  
     v o i d                               C l o s e A l l C h a r t ( c o n s t   b o o l   _ v a l u e )   {   m _ c l o s e _ c h a r t s   =   _ v a l u e ; }  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C L o g i n : : C L o g i n ( )  
   {  
     m _ c l o s e _ c h a r t s   =   f a l s e ;  
     R e s e t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C L o g i n : : ~ C L o g i n ( )  
   {  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C L o g i n : : R e s e t ( v o i d )  
   {  
     m _ c h a r t _ i d   =   W R O N G _ V A L U E ;  
     m _ h l _ m a i n _ c h a r t _ i d   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ r o o t   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ h m e n u   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ s u b _ m e n u   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ s u b _ m e n u _ i t e m   =   I N V A L I D _ H A N D L E ;  
     R e s t P o p u p H a n d e l s ( ) ;  
     m _ i s _ i n v a l i d   =   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C L o g i n : : R e s t P o p u p H a n d e l s ( v o i d )  
   {  
     m _ h l _ l o g i n _ p o p u p   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ l o g i n _ p o p u p _ b t n _ o k   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ l o g i n _ p o p u p _ e d t _ p a s s   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ l o g i n _ p o p u p _ e d t _ l o g i n   =   I N V A L I D _ H A N D L E ;  
     m _ h l _ l o g i n _ p o p u p _ c b x _ s e r v e r   =   I N V A L I D _ H A N D L E ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : I s T r u e C o n n e c t i o n ( v o i d )  
   {  
     i n t   c o n n e c t i o n _ t r y   =   0 ;  
     w h i l e ( ( ! ( b o o l ) : : T e r m i n a l I n f o I n t e g e r ( T E R M I N A L _ C O N N E C T E D )   | |  
                   ! : : H i s t o r y S e l e c t ( 0 ,   : : T i m e T r a d e S e r v e r ( )   +   : : P e r i o d S e c o n d s ( P E R I O D _ M N 1 ) )   | |  
                   : : H i s t o r y D e a l s T o t a l ( )   < =   0   | |  
                   : : S y m b o l s T o t a l ( f a l s e )   < =   0 )   & &  
                 c o n n e c t i o n _ t r y   <   D E F _ L O G I N _ T R Y _ T E R M _ C O N _ M A X )  
       {  
         c o n n e c t i o n _ t r y + + ;  
         : : S l e e p ( D E F _ L O G I N _ T R Y _ T E R M _ C O N _ S L E E P _ M S C ) ;  
       }  
     i f ( c o n n e c t i o n _ t r y   > =   D E F _ L O G I N _ T R Y _ T E R M _ C O N _ M A X )  
         r e t u r n   f a l s e ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : I s V a l i d L o g i n ( b o o l   & _ i s _ v a l i d _ b a l a n c e ,  
                                                     b o o l   & _ i s _ v a l i d _ i n t i _ b a l a n c e ,  
                                                     c o n s t   d o u b l e   _ i n i t _ b a l a c e )  
   {  
     f o r ( i n t   p e r i o d   =   0 ;   p e r i o d   <   D E F _ L O G I N _ T R Y _ T E R M _ C O N _ M A X ;   p e r i o d + + )  
       {  
         i f ( p e r i o d   >   0 )  
             : : S l e e p ( D E F _ L O G I N _ T R Y _ T E R M _ C O N _ S L E E P _ M S C ) ;  
  
         _ i s _ v a l i d _ b a l a n c e   =   f a l s e ;  
         _ i s _ v a l i d _ i n t i _ b a l a n c e   =   _ i n i t _ b a l a c e   >   0   ?   f a l s e   :   t r u e ;  
         / / - - -  
         i f ( : : H i s t o r y S e l e c t ( 0 ,   : : T i m e T r a d e S e r v e r ( )   +   : : P e r i o d S e c o n d s ( P E R I O D _ M N 1 ) ) )  
           {  
             d o u b l e   c u r r _ b a l a n c e   =   : : A c c o u n t I n f o D o u b l e ( A C C O U N T _ B A L A N C E ) ,  
                           b a l a n e   =   0 . 0 ,  
                           i n i t _ b a l a n e   =   0 . 0 ;  
             b o o l   f i n d _ f i r s t _ d e a l   =   f a l s e ;  
  
             i n t   t o t a l _ d e a l s   =   : : H i s t o r y D e a l s T o t a l ( ) ;  
             f o r ( i n t   i   =   0 ;   i   <   t o t a l _ d e a l s ;   i + + )  
               {  
                 u l o n g   t i c k e t   =   : : H i s t o r y D e a l G e t T i c k e t ( i ) ;  
                 i f ( t i c k e t   >   0 )  
                   {  
                     l o n g   t y p e     =   : : H i s t o r y D e a l G e t I n t e g e r ( t i c k e t ,   D E A L _ T Y P E ) ;  
                     i f ( t y p e   = =   D E A L _ T Y P E _ B U Y   | |   t y p e   = =   D E A L _ T Y P E _ S E L L )  
                         f i n d _ f i r s t _ d e a l   =   t r u e ;  
  
                     d o u b l e   v a l u e   =   : : H i s t o r y D e a l G e t D o u b l e ( t i c k e t ,   D E A L _ P R O F I T )   +  
                                                   : : H i s t o r y D e a l G e t D o u b l e ( t i c k e t ,   D E A L _ C O M M I S S I O N )   +  
                                                   : : H i s t o r y D e a l G e t D o u b l e ( t i c k e t ,   D E A L _ S W A P )   +  
                                                   : : H i s t o r y D e a l G e t D o u b l e ( t i c k e t ,   D E A L _ F E E ) ;  
                     b a l a n e   + =   v a l u e ;  
                     i f ( ! f i n d _ f i r s t _ d e a l )  
                         i n i t _ b a l a n e   + =   v a l u e ;  
                   }  
               }  
             / / - - -  
             _ i s _ v a l i d _ b a l a n c e   =   : : M a t h A b s ( b a l a n e   -   c u r r _ b a l a n c e )   <   1 ;  
  
             i f ( ! _ i s _ v a l i d _ i n t i _ b a l a n c e )  
                 _ i s _ v a l i d _ i n t i _ b a l a n c e   =   : : M a t h A b s ( i n i t _ b a l a n e   -   _ i n i t _ b a l a c e )   <   1 ;  
           }  
  
         i f ( _ i s _ v a l i d _ b a l a n c e   & &   _ i s _ v a l i d _ i n t i _ b a l a n c e )  
             b r e a k ;  
       }  
     r e t u r n   _ i s _ v a l i d _ b a l a n c e   & &   _ i s _ v a l i d _ i n t i _ b a l a n c e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : I s C u r r e n t L o g i n T r u e ( c o n s t   l o n g   _ l o g i n ,   c o n s t   s t r i n g   _ s e r v e r )  
   {  
     i f ( : : A c c o u n t I n f o I n t e g e r ( A C C O U N T _ L O G I N )   ! =   _ l o g i n   | |  
           : : A c c o u n t I n f o S t r i n g ( A C C O U N T _ S E R V E R )   ! =   _ s e r v e r )  
         r e t u r n   f a l s e ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C l i c k   o n   t h e   i t e m   " L o g i n   t o   t r a d i n g   a c c o u n t "                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : L o g i n T o A c c o u n t ( c o n s t   s t r i n g   _ l o g i n ,  
                                                         c o n s t   s t r i n g   _ p a s s ,  
                                                         c o n s t   s t r i n g   _ s e r v e r )  
   {  
     i f ( G e t M e t a T r a d e r H a n d e l s ( )                                                                                         & &  
           O p e n L o g i n P o p u p ( )                                                                                                     & &  
           S e t L o g i n F i l d ( _ l o g i n ,   _ p a s s ,   _ s e r v e r )                                                             & &  
           S a f e P o s t M e s s a g e ( m _ h l _ l o g i n _ p o p u p _ b t n _ o k ,   D E F _ L O G I N _ B M _ C L I C K ,   0 ,   0 ) )  
         r e t u r n   t r u e ;  
 / / - - -  
     R e s e t ( ) ;  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : O p e n L o g i n P o p u p ( v o i d )  
   {  
 / / - - -   c h e c k   i s   p o p u p   o p e n  
     i f ( m _ h l _ l o g i n _ p o p u p   >   0 )  
       {  
         l o n g   l a s t _ p o p u p   =   G e t L a s t A c t i v e P o p u p ( m _ h l _ r o o t ) ;  
         i f ( m _ h l _ l o g i n _ p o p u p   = =   l a s t _ p o p u p )  
             r e t u r n   t r u e ;  
       }  
 / / - - -   O p e n   L o g i n   T o   T r a d e   A c c o u n t   P o p u p  
     i f ( ! S a f e P o s t M e s s a g e ( m _ h l _ r o o t ,   D E F _ L O G I N _ W M _ C O M M A N D ,   m _ h l _ s u b _ m e n u _ i t e m ,   0 ) )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   L o g i n   T o   T r a d e   A c c o u n t   P o p u p   h a n d l e  
     m _ h l _ l o g i n _ p o p u p   =   G e t L a s t A c t i v e P o p u p ( m _ h l _ r o o t ) ;  
     i f ( m _ h l _ l o g i n _ p o p u p   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   L o g i n   T o   T r a d e   A c c o u n t   P o p u p   B t n   O k   h a n d l e  
     m _ h l _ l o g i n _ p o p u p _ b t n _ o k   =   G e t D l g I t e m ( m _ h l _ l o g i n _ p o p u p ,   0 x 0 0 0 0 0 0 0 1 ) ;  
     i f ( m _ h l _ l o g i n _ p o p u p _ b t n _ o k   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   L o g i n   T o   T r a d e   A c c o u n t   P o p u p   E d i t   P a s s   h a n d l e  
     m _ h l _ l o g i n _ p o p u p _ e d t _ p a s s   =   F i n d W i n d o w E x W ( m _ h l _ l o g i n _ p o p u p ,   N U L L ,   " E d i t " ,   " " ) ;  
     i f ( m _ h l _ l o g i n _ p o p u p _ e d t _ p a s s   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   L o g i n   T o   T r a d e   A c c o u n t   P o p u p   E d i t   L o g i n   h a n d l e  
     m _ h l _ l o g i n _ p o p u p _ e d t _ l o g i n   =   F i n d W i n d o w E x W ( m _ h l _ l o g i n _ p o p u p ,   N U L L ,   " C o m b o B o x " ,   " " ) ;  
     i f ( m _ h l _ l o g i n _ p o p u p _ e d t _ l o g i n   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   L o g i n   T o   T r a d e   A c c o u n t   P o p u p   C o m b o B o x   S e r v e r   h a n d l e  
     m _ h l _ l o g i n _ p o p u p _ c b x _ s e r v e r   =   F i n d W i n d o w E x W ( m _ h l _ l o g i n _ p o p u p ,   m _ h l _ l o g i n _ p o p u p _ e d t _ l o g i n ,   " C o m b o B o x " ,   " " ) ;  
     i f ( m _ h l _ l o g i n _ p o p u p _ c b x _ s e r v e r   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : G e t M e t a T r a d e r H a n d e l s ( v o i d )  
   {  
     i f ( m _ h l _ r o o t   >   0   & &   m _ h l _ s u b _ m e n u _ i t e m   >   0 )  
         r e t u r n   t r u e ;  
     R e s e t ( ) ;  
 / / - - -  
     l o n g   m a i n C h a r t I D   =   G e t C h a r t I D ( ) ;  
     i f ( m a i n C h a r t I D   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   t h e   C h a r t   w i n d o w   h a n d l e   ( H W N D )  
     m _ h l _ m a i n _ c h a r t _ i d   =   C h a r t W i n d o w s H a n d l e ( m a i n C h a r t I D ) ;   ;  
     i f ( m _ h l _ m a i n _ c h a r t _ i d   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   t h e   M e t a T r a d e r   h a n d l e  
     m _ h l _ r o o t   =   G e t A n c e s t o r ( m _ h l _ m a i n _ c h a r t _ i d ,   D E F _ L O G I N _ G A _ R O O T ) ;  
     i f ( m _ h l _ r o o t   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   t h e   M e t a T r a d e r   M e n u e   h a n d l e  
     m _ h l _ h m e n u   =   G e t M e n u ( m _ h l _ r o o t ) ;  
     i f ( m _ h l _ h m e n u   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   t h e   M e t a T r a d e r   S u b   M e n u e   h a n d l e  
     b o o l   i s _ c h a r t _ m a x i m a i z   =   : : C h a r t G e t I n t e g e r ( m _ c h a r t _ i d ,   C H A R T _ I S _ M A X I M I Z E D ,   0 ) ;  
     i n t   n u m b e r _ m e n u   =   i s _ c h a r t _ m a x i m a i z   ?   D E F _ L O G I N _ F I L E _ M E N U _ N O _ C H A R T _ M A X   :   D E F _ L O G I N _ F I L E _ M E N U _ N O _ C H A R T _ N O R ;  
     m _ h l _ s u b _ m e n u   =   G e t S u b M e n u ( m _ h l _ h m e n u ,   n u m b e r _ m e n u ) ;  
     i f ( m _ h l _ s u b _ m e n u   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -   G e t   t h e   M e t a T r a d e r   S u b   M e n u e   L o g i n   T o   T r a d e   A c c o u n t   I t e m   h a n d l e  
     m _ h l _ s u b _ m e n u _ i t e m   =   G e t M e n u I t e m I D ( m _ h l _ s u b _ m e n u ,   D E F _ L O G I N _ T O _ T R A D E _ A C C _ M E N U E _ I T E M ) ;  
     i f ( m _ h l _ s u b _ m e n u _ i t e m   < =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C L o g i n : : S e t L o g i n F i l d ( c o n s t   s t r i n g   _ l o g i n ,  
                                                     c o n s t   s t r i n g   _ p a s s ,  
                                                     c o n s t   s t r i n g   _ s e r v e r )  
   {  
     i f ( S e t W i n d o w T e x t W ( m _ h l _ l o g i n _ p o p u p _ e d t _ p a s s ,   _ p a s s )   = =   0 )  
         r e t u r n   f a l s e ;  
     i f ( S e t W i n d o w T e x t W ( m _ h l _ l o g i n _ p o p u p _ e d t _ l o g i n ,   _ l o g i n )   = =   0 )  
         r e t u r n   f a l s e ;  
     i f ( S e t W i n d o w T e x t W ( m _ h l _ l o g i n _ p o p u p _ c b x _ s e r v e r ,   _ s e r v e r )   = =   0 )  
         r e t u r n   f a l s e ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 l o n g   C L o g i n : : G e t C h a r t I D ( v o i d )  
   {  
     m _ c h a r t _ i d   =   : : C h a r t F i r s t ( ) ;  
 / / - - -  
     i f ( m _ c h a r t _ i d   < =   0 )  
       {  
         s t r i n g   n a m e ;  
         i f ( : : S y m b o l s T o t a l ( f a l s e )   < =   0 )  
             r e t u r n   W R O N G _ V A L U E ;  
  
         n a m e   =   : : S y m b o l N a m e ( 0 ,   f a l s e ) ;  
  
         i f ( ! : : S y m b o l S e l e c t ( n a m e ,   t r u e ) )  
             r e t u r n   W R O N G _ V A L U E ;  
         / / - - -  
         m _ c h a r t _ i d   =   : : C h a r t O p e n ( n a m e ,   P E R I O D _ D 1 ) ;  
         i f ( m _ c h a r t _ i d   < =   0 )  
             r e t u r n   W R O N G _ V A L U E ;  
       }  
     r e t u r n   m _ c h a r t _ i d ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T h e   f u n c t i o n   g e t s   t h e   h a n d l e   g r a p h i c s                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 l o n g   C L o g i n : : C h a r t W i n d o w s H a n d l e ( l o n g   _ c h a r t _ i d )  
   {  
 / / - - -   p r e p a r e   t h e   v a r i a b l e   t o   g e t   t h e   p r o p e r t y   v a l u e  
     l o n g   r e s u l t   =   W R O N G _ V A L U E ;  
 / / - - -   r e s e t   t h e   e r r o r   v a l u e  
     : : R e s e t L a s t E r r o r ( ) ;  
 / / - - -   r e c e i v e   t h e   p r o p e r t y   v a l u e  
     i f ( ! : : C h a r t G e t I n t e g e r ( _ c h a r t _ i d ,   C H A R T _ W I N D O W _ H A N D L E ,   0 ,   r e s u l t ) )  
       {  
         / / - - -   d i s p l a y   t h e   e r r o r   m e s s a g e   i n   E x p e r t s   j o u r n a l  
         : : P r i n t ( _ _ F U N C T I O N _ _   +   " ,   E r r o r   C o d e   =   " ,   : : G e t L a s t E r r o r ( ) ) ;  
       }  
 / / - - -   r e t u r n   t h e   v a l u e   o f   t h e   c h a r t   p r o p e r t y  
     r e t u r n ( r e s u l t ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 i n t   C L o g i n : : T r y L o g i n ( c o n s t   l o n g   _ l o g i n ,  
                                           c o n s t   s t r i n g   _ p a s s ,  
                                           c o n s t   s t r i n g   _ s e r v e r ,  
                                           c o n s t   d o u b l e   _ i n i t _ b a l a c e )  
   {  
     i n t   r e s   =   L O G I N _ S U C S E S ;  
     m _ i s _ i n v a l i d   =   f a l s e ;  
 / / - - - - - -  
     b o o l   i s _ c u r r _ l o g i n _ t r u e   =   I s C u r r e n t L o g i n T r u e ( _ l o g i n ,   _ s e r v e r ) ;  
     b o o l   i s _ l o g i n   =   f a l s e ,  
               i s _ c o n n e c t e d   =   f a l s e ;  
     f o r ( i n t   l o g i n _ t r y   =   0 ;   l o g i n _ t r y   <   D E F _ L O G I N _ T R Y _ L O G I N _ M A X ;   l o g i n _ t r y + + )  
       {  
         i f ( l o g i n _ t r y   ! =   0 )  
             : : S l e e p ( D E F _ L O G I N _ T R Y _ L O G I N _ S L E E P _ M S C ) ;  
  
         / / - - -   D o   L o g i n  
         i f ( ! i s _ c u r r _ l o g i n _ t r u e )  
           {  
             i f ( ! L o g i n T o A c c o u n t ( ( s t r i n g ) _ l o g i n ,   _ p a s s ,   _ s e r v e r ) )  
                 c o n t i n u e ;  
             i f ( _ l o g i n   ! =   : : A c c o u n t I n f o I n t e g e r ( A C C O U N T _ L O G I N ) )  
                 c o n t i n u e ;  
           }  
         i s _ c u r r _ l o g i n _ t r u e   =   f a l s e ;  
  
         / / - - -   C h e c k   C o n n e c t i o n  
         i s _ c o n n e c t e d   =   I s T r u e C o n n e c t i o n ( ) ;  
         i f ( ! i s _ c o n n e c t e d )  
             c o n t i n u e ;  
         i s _ l o g i n   =   t r u e ;  
         b r e a k ;  
       }  
 / / - - - - - -   V a l i d i t i o n  
     b o o l   i s _ v a l i d _ b a l a n c e   =   f a l s e ,  
               i s _ v a l i d _ i n t i _ b a l a n c e   =   _ i n i t _ b a l a c e   >   0   ?   f a l s e   :   t r u e ;  
     i f ( i s _ l o g i n   & &   i s _ c o n n e c t e d )  
       {  
         f o r ( i n t   l o g i n _ t r y   =   0 ;   l o g i n _ t r y   <   D E F _ L O G I N _ T R Y _ L O G I N _ M A X ;   l o g i n _ t r y + + )  
           {  
             i f ( ! I s V a l i d L o g i n ( i s _ v a l i d _ b a l a n c e ,   i s _ v a l i d _ i n t i _ b a l a n c e ,   _ i n i t _ b a l a c e ) )  
                 c o n t i n u e ;  
             b r e a k ;  
           }  
       }  
 / / - - -  
     i f ( ! i s _ l o g i n   | |   ! i s _ c o n n e c t e d   | |   ! i s _ v a l i d _ b a l a n c e   | |   ! i s _ v a l i d _ i n t i _ b a l a n c e )  
       {  
         C h e c k I n v a l i d A c c o u n t ( _ l o g i n ,   _ s e r v e r ) ;  
  
         i f ( ! i s _ l o g i n )  
             r e s   =   L O G I N _ F A I L ;  
         e l s e  
             i f ( ! i s _ c o n n e c t e d )  
                 r e s   =   L O G I N _ C O N N _ F A I L ;  
             e l s e  
                 i f ( ! i s _ v a l i d _ b a l a n c e )  
                     r e s   =   L O G I N _ L O A D _ D E A L S _ F A I L ;  
                 e l s e  
                     i f ( ! i s _ v a l i d _ i n t i _ b a l a n c e )  
                         r e s   =   L O G I N _ I N I T _ B A L A N C E _ F A I L ;  
       }  
 / / - - -  
     r e t u r n   r e s ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C L o g i n : : C h e c k I n v a l i d A c c o u n t ( c o n s t   l o n g   _ l o g i n ,  
                                                                   c o n s t   s t r i n g   _ s e r v e r )  
   {  
     m _ i s _ i n v a l i d   =   f a l s e ;  
 / / - - -  
     s t r i n g   t x t   =   S t r i n g F o r m a t ( " ' % s ' :   a u t h o r i z a t i o n   o n   % s   f a i l e d   ( I n v a l i d   a c c o u n t ) " ,   ( s t r i n g ) _ l o g i n ,   _ s e r v e r ) ;  
  
     i f ( ! : : S t r i n g T o L o w e r ( t x t ) )  
         r e t u r n ;  
 / / - - -  
     M q l D a t e T i m e   s t r u t ;  
     : : T i m e C u r r e n t ( s t r u t ) ;  
     i n t   y e a r   =   s t r u t . y e a r ;  
     i n t   m o n     =   s t r u t . m o n ;  
     i n t   d a y     =   s t r u t . d a y ;  
  
     s t r i n g   n a m e   =   ( s t r i n g ) y e a r   +   ( m o n   <   1 0   ?   " 0 "   +   ( s t r i n g ) m o n   :   ( s t r i n g ) m o n )   +   ( d a y   <   1 0   ?   " 0 "   +   ( s t r i n g ) d a y   :   ( s t r i n g ) d a y )   +   " . l o g " ;  
  
     s t r i n g   j o u r n a l _ f i l e   =   : : T e r m i n a l I n f o S t r i n g ( T E R M I N A L _ D A T A _ P A T H )   +   " \ \ l o g s \ \ "   +   n a m e ;  
     s t r i n g   n e w _ f i l e   =   : : T e r m i n a l I n f o S t r i n g ( T E R M I N A L _ C O M M O N D A T A _ P A T H )   +   " \ \ F i l e s \ \ "   +   n a m e ;  
 / / - - -   W i n   A P I  
     i f ( ! C o p y F i l e W ( j o u r n a l _ f i l e ,   n e w _ f i l e ,   f a l s e ) )  
         r e t u r n ;  
  
 / / - - -   o p e n   t h e   f i l e   u s i n g   M Q L 5  
     : : R e s e t L a s t E r r o r ( ) ;  
     i n t   f i l e _ h a n d l e   =   : : F i l e O p e n ( n a m e ,   F I L E _ R E A D   |   F I L E _ T X T   |   F I L E _ C O M M O N ) ;  
     i n t   s t r _ s i z e ;  
     s t r i n g   s t r ;  
  
     i f ( f i l e _ h a n d l e   ! =   I N V A L I D _ H A N D L E )  
       {  
         / / - - -   r e a d   d a t a   f r o m   t h e   f i l e  
         w h i l e ( ! : : F i l e I s E n d i n g ( f i l e _ h a n d l e ) )  
           {  
             / / - - -   f i n d   o u t   h o w   m a n y   s y m b o l s   a r e   u s e d   f o r   w r i t i n g   t h e   t i m e  
             s t r _ s i z e   =   : : F i l e R e a d I n t e g e r ( f i l e _ h a n d l e ,   I N T _ V A L U E ) ;  
             / / - - -   r e a d   t h e   s t r i n g  
             s t r   =   : : F i l e R e a d S t r i n g ( f i l e _ h a n d l e ,   s t r _ s i z e ) ;  
             / / - - -  
             i f ( : : S t r i n g T o L o w e r ( s t r )   & & : : S t r i n g F i n d ( s t r ,   t x t )   > =   0 )  
               {  
                 m _ i s _ i n v a l i d   =   t r u e ;  
                 b r e a k ;  
               }  
           }  
       }  
  
     i f ( f i l e _ h a n d l e   ! =   I N V A L I D _ H A N D L E   & &   ! : : F i l e D e l e t e ( n a m e ,   F I L E _ C O M M O N ) )  
         : : F i l e C l o s e ( f i l e _ h a n d l e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                                       Mocros.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property strict
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CFunc
 {
public:
  //template<typename T>
  //static bool        AddToArray(const T _element, T &_array[])
  // {
  //  uint size = _array.Size();
  //  if(::ArrayResize(_array, size + 1) != size + 1)
  //    return false;
  //  _array[size] = _element;
  //  return true;
  // }
  static bool        AddToArray(const ulong _element, ulong &_array[])
   {
    uint size = _array.Size();
    if(::ArrayResize(_array, size + 1) != size + 1)
      return false;
    _array[size] = _element;
    return true;
   }
  //+------------------------------------------------------------------+
  //| Check Is Tex Symbol                                              |
  //+------------------------------------------------------------------+
  static bool        IsSymbol(const string _symbol)
   {
    bool is_custom = true;
    if(!::SymbolExist(_symbol, is_custom))
      return false;
    if(is_custom)
      return false;
    //--- succeed
    return true;
   }
  //+------------------------------------------------------------------+
  //| Safe Expert Remove                                               |
  //+------------------------------------------------------------------+
  static void        SafeExpertRemove(const string _message = NULL)
   {
    if(_message != NULL && _message != "")
      ::Alert(_message);
    ::ExpertRemove();
   }
  //+------------------------------------------------------------------+
  //| Safe Divide                                                      |
  //+------------------------------------------------------------------+
  static double      SafeDivide(const double _value, const double _divider)
   {
    if(::MathAbs(_value) <= FLT_EPSILON)
      return 0.0;
    if(_divider == 0)
      return 0.0;
    return _value / _divider;
   }
  //+------------------------------------------------------------------+
  //| Safe Percent                                                     |
  //+------------------------------------------------------------------+
  static double      SafePercent(const double _value, const double _divider)
   {
    return SafeDivide(_value, _divider) * 100;
   }
  //+------------------------------------------------------------------+
  //| 34256454.23 => 34,256,454.23                                     |
  //+------------------------------------------------------------------+
  static string      FormatNumber(double _numb, int _degit = 2, string _unit = "", string _delim = ",", string _dec = ".")
   {
    string numb = ::DoubleToString(_numb, _degit),
           nnumb,
           enumb;

    int pos = StringFind(numb, _dec);
    if(pos == -1)
     {
      nnumb = numb;
      enumb = "";
     }
    else
     {
      nnumb = StringSubstr(numb, 0, pos);
      enumb = StringSubstr(numb, pos);
     }

    int cnt = StringLen(nnumb);
    if(cnt < 4)
      if(_unit != NULL && _unit != "")
        return(numb + " " + _unit);
      else
        return(numb);

    int x = (int)MathFloor(cnt / 3);
    int y = cnt - x * 3;

    string forma = "";
    if(y != 0)
      forma = ::StringSubstr(nnumb, 0, y) + _delim;

    for(int i = 0; i < x; i++)
     {
      if(i != x - 1)
        forma += ::StringSubstr(nnumb, y + i * 3, 3) + _delim;
      else
        forma += ::StringSubstr(nnumb, y + i * 3, 3);
     }
    if(_unit != NULL && _unit != "")
      forma += enumb + " " + _unit;
    else
      forma += enumb;

    return(forma);
   }
  //+------------------------------------------------------------------+
  //| Array To Hex                                                     |
  //+------------------------------------------------------------------+
  static string      ArrayToHex(uchar &_arr[], int _count = -1, bool _is_low = false)
   {
    string res = "";
    //--- check
    if(_count < 0 || _count > ArraySize(_arr))
      _count = ArraySize(_arr);
    //--- transform to HEX string
    string format = _is_low ? "%.2x" : "%.2X";
    for(int i = 0; i < _count; i++)
      res += StringFormat(format, _arr[i]);
    //---
    return(res);
   }
  //+------------------------------------------------------------------+
  //| Hex To Array                                                     |
  //+------------------------------------------------------------------+
  static void        HexToArray(string _hex, uchar &_arr[])
   {
    for(uint i = 0; i < _hex.Length(); i += 2)
     {
      ArrayResize(_arr, _arr.Size() + 1);
      _arr[_arr.Size() - 1] = (uchar)HexToInteger(StringSubstr(_hex, i, 2));
     }
   }
  //+------------------------------------------------------------------+
  //| Hex To Integer                                                   |
  //+------------------------------------------------------------------+
  static int         HexToInteger(string _str)
   {
    int result = 0;
    int power = 0;
    for(int pos = StringLen(_str) - 1; pos >= 0; pos--)
     {

      int c = StringGetCharacter(_str, pos);
      int value = 0;
      if(c >= '0' && c <= '9')
        value = c - '0';
      else
        if(c >= 'a' && c <= 'f')
          value = c - 'a' + 10;
        else
          if(c >= 'A' && c <= 'F')
            value = c - 'A' + 10;

      result += int(value * MathPow(16.0, power));
      power++;
     }
    return(result);
   }
  //+------------------------------------------------------------------+
  //| convert integer to string contained input's hexadecimal notation |
  //+------------------------------------------------------------------+
  static string      IntegerToHex(int integer_number)
   {
    string hex_string = "00000000";
    int    value, shift = 28;
    //---
    for(int i = 0; i < 8; i++)
     {
      value = (integer_number >> shift) & 0x0F;
      if(value < 10)
        bool check = StringSetCharacter(hex_string, i, ushort(value + '0'));
      else
        bool check = StringSetCharacter(hex_string, i, ushort((value - 10) + 'A'));
      shift -= 4;
     }
    //---
    return(hex_string);
   }
  //+------------------------------------------------------------------+
  //| Text To CharArray                                                |
  //+------------------------------------------------------------------+
  static void        TextToCharArray(const string _text, uchar &_array[], uint _code_page = CP_MACCP)
   {
    ::ArrayFree(_array);
    ::StringToCharArray(_text, _array, 0, ::StringLen(_text), _code_page);
   }
  //+------------------------------------------------------------------+
  //| convert red, green and blue values to color                      |
  //+------------------------------------------------------------------+
  static int         RGB(int red_value, int green_value, int blue_value)
   {
    //--- check parameters
    if(red_value < 0)
      red_value = 0;
    if(red_value > 255)
      red_value = 255;
    if(green_value < 0)
      green_value = 0;
    if(green_value > 255)
      green_value = 255;
    if(blue_value < 0)
      blue_value = 0;
    if(blue_value > 255)
      blue_value = 255;
    //---
    green_value <<= 8;
    blue_value <<= 16;
    return(red_value + green_value + blue_value);
   }
  //+------------------------------------------------------------------+
  //| right comparison of 2 doubles                                    |
  //+------------------------------------------------------------------+
  static bool        CompareDoubles(double number1, double number2)
   {
    if(NormalizeDouble(number1 - number2, 8) == 0)
      return(true);
    else
      return(false);
   }
  //+------------------------------------------------------------------+
  //| up to 16 digits after decimal point                              |
  //+------------------------------------------------------------------+
  static string      DoubleToStrMorePrecision(double number, int precision)
   {
    static double DecimalArray[17] =
     {
      1.0,
      10.0,
      100.0,
      1000.0,
      10000.0,
      100000.0,
      1000000.0,
      10000000.0,
      100000000.0,
      1000000000.0,
      10000000000.0,
      100000000000.0,
      1000000000000.0,
      10000000000000.0,
      100000000000000.0,
      1000000000000000.0,
      10000000000000000.0
     };

    double rem, integer, integer2;
    string intstring, remstring, retstring;
    bool   isnegative = false;
    int    rem2;
    //---
    if(precision < 0)
      precision = 0;
    if(precision > 16)
      precision = 16;
    //---
    double p = DecimalArray[precision];
    if(number < 0.0)
     {
      isnegative = true;
      number = -number;
     }
    integer = MathFloor(number);
    rem = MathRound((number - integer) * p);
    remstring = "";
    for(int i = 0; i < precision; i++)
     {
      integer2 = MathFloor(rem / 10);
      rem2 = (int)NormalizeDouble(rem - integer2 * 10, 0);
      remstring = IntegerToString(rem2) + remstring;
      rem = integer2;
     }
    //---
    intstring = DoubleToString(integer, 0);
    if(isnegative)
      retstring = "-" + intstring;
    else
      retstring = intstring;

    if(precision > 0)
      retstring = retstring + "." + remstring;
    //---
    return(retstring);
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      CSymbol.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou"
#property link      "https://t.me/ProTraderSoft "

#define DEF_TRY_LOAD_RATE           10000
//--- include
//#include <Trade\SymbolInfo.mqh>
#include <_Ata\Info\SymbolInfo.mqh>
//+------------------------------------------------------------------+
//| Class CSymbol                                                    |
//+------------------------------------------------------------------+
class CSymbol : public CSymbolInfo
 {
  //--- === Data members === ---
private:
  ENUM_TIMEFRAMES    m_tf;
  matrix             m_ticks_mx;
  datetime           m_start_date;
  ulong              m_last_idx;
  //--- === Methods === ---
public:
  //--- constructor/destructor
  void               CSymbol(void);
  void              ~CSymbol(void) {};
  //---
  bool               Init(const string          pSymbol,
                          const ENUM_TIMEFRAMES pTimeframe,
                          const datetime        pStartDate);
  int                CheckLoadHistory(void);
  bool               LoadTicks(const datetime pStopDate,
                               const uint     pFlags);
  matrix             GetTicks(void) const { return m_ticks_mx; };
  bool               SearchTickLessOrEqual(const double pDblTime, vector &pResRow);
  bool               CopyLastTick(vector &pResRow);
 };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
void CSymbol::CSymbol(void)
 {
  m_ticks_mx.Init(0, 0);
  m_start_date = 0;
  m_last_idx = 0;
 };
//+------------------------------------------------------------------+
//| Initialization                                                   |
//+------------------------------------------------------------------+
bool CSymbol::Init(const string          pSymbol,
                   const ENUM_TIMEFRAMES pTimeframe,
                   const datetime        pStartDate)
 {
  if(Name(pSymbol))
    if(Select(true))
     {
      m_tf         = pTimeframe;
      m_start_date = pStartDate;
      return true;
     }
//---
  return false;
 }
//+------------------------------------------------------------------+
//| Check and load quotes history                                    |
//+------------------------------------------------------------------+
int CSymbol::CheckLoadHistory(void)
 {
  ::ResetLastError();
//---
  datetime first_date = 0;
  datetime times[100];
  string curr_symbol = Name();
//--- check if symbol is selected in the Market Watch
  if(!Select())
   {
    Select(true);
    if(!Select())
     {
      if(::GetLastError() == ERR_MARKET_UNKNOWN_SYMBOL)
        return -1;
      Select(true);
     }
   }
//--- check if data is present
  ::SeriesInfoInteger(curr_symbol, m_tf, SERIES_FIRSTDATE, first_date);
  if(first_date > 0 && first_date <= m_start_date)
    return 1;
//--- don't ask for load of its own data if it is an indicator
  if(::MQLInfoInteger(MQL_PROGRAM_TYPE) == PROGRAM_INDICATOR &&
     ::Period() == m_tf &&::Symbol() == curr_symbol)
    return -4;
//--- second attempt
  if(::SeriesInfoInteger(curr_symbol, PERIOD_M1, SERIES_TERMINAL_FIRSTDATE, first_date))
   {
    //--- there is loaded data to build timeseries
    if(first_date > 0)
     {
      //--- force timeseries build
      ::CopyTime(curr_symbol, m_tf, first_date +::PeriodSeconds(m_tf), 1, times);
      //--- check date
      if(::SeriesInfoInteger(curr_symbol, m_tf, SERIES_FIRSTDATE, first_date))
        if(first_date > 0 && first_date <= m_start_date)
          return 2;
     }
   }
//--- max bars in chart from terminal options
  int max_bars =::TerminalInfoInteger(TERMINAL_MAXBARS);
//--- load symbol history info
  datetime first_server_date = 0;
  uint ltry = 0;
  while(!::SeriesInfoInteger(curr_symbol, PERIOD_M1, SERIES_SERVER_FIRSTDATE, first_server_date) &&
        ltry < DEF_TRY_LOAD_RATE &&
        !::IsStopped())
   {
    ltry++;
   }
  //if(::IsStopped() || ltry >= DEF_TRY_LOAD_RATE)
  //  return -1;
  ::Sleep(5);
//--- fix start date for loading
  if(first_server_date > m_start_date)
    m_start_date = first_server_date;
  if(first_date > 0 && first_date < first_server_date)
    ::Print("Warning: first server date ", first_server_date, " for ", curr_symbol,
            " does not match to first series date ", first_date);
//--- load data step by step
  int fail_cnt = 0;
  while(!::IsStopped())
   {
    //--- wait for timeseries build
    ltry = 0;
    while(!::SeriesInfoInteger(curr_symbol, m_tf, SERIES_SYNCHRONIZED) &&
          ltry < DEF_TRY_LOAD_RATE &&
          !::IsStopped())
     {
      ltry++;
     }
    if(::IsStopped() || ltry >= DEF_TRY_LOAD_RATE)
      return -3;
    ::Sleep(5);
    //--- ask for built bars
    int bars =::Bars(curr_symbol, m_tf);
    if(bars > 0)
     {
      if(bars >= max_bars)
        return(-2);
      //--- ask for first date
      if(::SeriesInfoInteger(curr_symbol, m_tf, SERIES_FIRSTDATE, first_date))
        if(first_date > 0 && first_date <= m_start_date)
          return 0;
     }
    //--- copying of next part forces data loading
    int copied =::CopyTime(curr_symbol, m_tf, bars, 100, times);
    if(copied > 0)
     {
      //--- check for data
      if(times[0] <= m_start_date)
        return 0;
      if(bars + copied >= max_bars)
        return -2;
      fail_cnt = 0;
     }
    else
     {
      //--- no more than 100 failed attempts
      fail_cnt++;
      if(fail_cnt >= 100)
        return -5;
      ::Sleep(10);
     }
   }
//--- stopped
  return -3;
 }
//+------------------------------------------------------------------+
//| Load ticks                                                       |
//+------------------------------------------------------------------+
bool CSymbol::LoadTicks(const datetime pStopDate,
                        const uint     pFlags)
 {
  string curr_symbol = Name();
  ulong from_msc     = 1000 * m_start_date,
        to_msc       = 1000 * pStopDate;
  if(m_ticks_mx.CopyTicksRange(curr_symbol, pFlags, from_msc, to_msc))
   {
    m_ticks_mx = m_ticks_mx.Transpose();
    return true;
   }
//---
  return false;
 }
//+------------------------------------------------------------------+
//| Search a tick less or equal                                      |
//+------------------------------------------------------------------+
bool CSymbol::SearchTickLessOrEqual(const double pDblTime, vector &pResRow)
 {
  ulong ticks_size = m_ticks_mx.Rows();
  if(pResRow.Resize(2))
   {
    pResRow.Fill(0.);
    double prev_dbl_time, curr_dbl_time;
    prev_dbl_time = curr_dbl_time = 0.;
    for(ulong idx = m_last_idx; idx < ticks_size && prev_dbl_time < pDblTime; idx++)
     {
      curr_dbl_time = m_ticks_mx[idx][0];
      if(idx > 0)
        prev_dbl_time = m_ticks_mx[idx - 1][0];;
      ulong idx_for_tick = WRONG_VALUE;
      if(curr_dbl_time == pDblTime)
       {
        idx_for_tick = idx;
       }
      else
        if(prev_dbl_time < pDblTime && curr_dbl_time > pDblTime)
         {
          if(prev_dbl_time > 0.)
            idx_for_tick = idx - 1;
         }
      if(idx_for_tick != WRONG_VALUE)
       {
        pResRow[0] = m_ticks_mx[idx_for_tick][1];
        pResRow[1] = m_ticks_mx[idx_for_tick][2];
        m_last_idx = idx_for_tick; // todo
        return true;
       }
     }
   }
//---
  return false;
 }
//+------------------------------------------------------------------+
//| Copy the last tick                                               |
//+------------------------------------------------------------------+
bool CSymbol::CopyLastTick(vector &pResRow)
 {
  if(pResRow.Resize(2))
   {
    pResRow.Fill(0.);
    if(RefreshRates())
     {
      pResRow[0] = Bid();
      pResRow[1] = Ask();
      return true;
     }
   }
//---
  return false;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                          URL.mqh |
//|                                  Copyright 2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| URL components                                                   |
//+------------------------------------------------------------------+
enum URL_PARTS
 {
  URL_COMPLETE,
  URL_SCHEME,   // protocol
  URL_USER,     // deprecated/not supported/null
  URL_HOST,
  URL_PORT,
  URL_PATH,
  URL_QUERY,
  URL_FRAGMENT, // not extracted/null
  URL_ENUM_LENGTH
 };
//+------------------------------------------------------------------+
//| URL parser                                                       |
//+------------------------------------------------------------------+
class URL
 {
public:
  static bool        isAlpha(const uchar c)
   {
    return (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z');
   }

  static bool        isDigit(const uchar c)
   {
    return c >= '0' && c <= '9';
   }
  static bool        isAlNum(const uchar c)
   {
    return isAlpha(c) || isDigit(c);
   }

  static string      encode(const string str)
   {
    string new_str = "";
    uchar c;

    uchar chars[];
    const int len = StringToCharArray(str, chars);

    for(int i = 0; i < len; i++)
     {
      c = chars[i];
      if(c == ' ')
        new_str += "+";
      else
        if(isAlNum(c) || c == '-' || c == '_' || c == '.' || c == '~')
          new_str += (string)c;
        else
         {
          new_str += "%" + StringFormat("%%%.2X", c);
         }
     }
    return new_str;
   }

  static uchar       hex2value(const uchar hex)
   {
    uint result = hex - '0';
    if(result > 9)
     {
      result = hex - 'A' + 10;
      if(result > 15)
       {
        result = hex - 'a' + 10;
       }
     }
    return (uchar)result;
   }

  // TODO: 2-byte/3-byte encodings support

  static string      decode(const string str)
   {
    string ret;
    uchar chars[];
    const int len = StringToCharArray(str, chars);

    for(int i = 0; i < len; i++)
     {
      if(chars[i] != '%')
       {
        if(chars[i] == '+')
          ret += " ";
        else
          ret += (string)chars[i];
       }
      else
       {
        ret += (string)(uchar)(hex2value(chars[i + 1]) * 16 + hex2value(chars[i + 2]));
        i += 2;
       }
     }
    return ret;
   }

  static string      trim(string &str)
   {
    StringTrimLeft(str);
    StringTrimRight(str);
    return str;
   }

  // scheme://example.com:80/path?query#hash
  static void        parse(string url, string &parts[])
   {
    const static string start = "://";
    const static string comma = ":";
    const static string slash = "/";
    const static string question = "?";

    ArrayResize(parts, URL_PARTS::URL_ENUM_LENGTH);
    for(int i = 0; i < URL_PARTS::URL_ENUM_LENGTH; i++)
     {
      parts[i] = NULL;
     }

    parts[0] = url; // TODO: re-assemble url from parts

    int c = 0;
    int p = StringFind(url, start);
    if(p > -1)
     {
      parts[URL_SCHEME] = StringSubstr(url, 0, p);
      p += StringLen(start);
      c = p;
     }

    p = StringFind(url, comma, c);
    int path = StringFind(url, slash, c);
    int port = -1;
    if(p > -1 && (p < path || path == -1))
     {
      port = p;
      parts[URL_HOST] = StringSubstr(url, c, p - c);
     }

    if(path > -1)
     {
      parts[URL_HOST] = StringSubstr(url, c, (port != -1 ? port : path) - c);
      c = path + 1;
     }
    else
     {
      parts[URL_HOST] = StringSubstr(url, c, (port != -1 ? port : StringLen(url)) - c);
      c = StringLen(url) + 1;
     }

    if(port > -1)
     {
      parts[URL_PORT] = StringSubstr(url, port + 1, c - port - 2);
     }

    if(path > -1)
     {
      p = StringFind(url, question, path);
      c = p;
      if(p == -1)
        p = StringLen(url);
      parts[URL_PATH] = StringSubstr(url, path, p - path);
      if(c > -1)
       {
        parts[URL_QUERY] = StringSubstr(url, c + 1);
       }
     }
    else
     {
      parts[URL_PATH] = "/";
     }
   }
 };
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                             R e q u e s t . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 3 ,   L e j j o   D i g i t a l   |  
 / / |                                                       h t t p s : / / w w w . m q l 5 . c o m / p t / u s e r s / 1 4 1 3 4 5 9 7   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 3 ,   L e j j o   D i g i t a l "  
 # p r o p e r t y   l i n k             " h t t p s : / / w w w . m q l 5 . c o m / p t / u s e r s / 1 4 1 3 4 5 9 7 "  
 # p r o p e r t y   v e r s i o n       " 1 . 0 0 "  
  
 # d e f i n e   E R R _ H T T P _ E R R O R _ F I R S T                 E R R _ U S E R _ E R R O R _ F I R S T + 1 0 0 0   / / + 5 1 1  
 # d e f i n e   H T T P _ M E T H O D _ G E T                           " G E T "  
 # d e f i n e   H T T P _ M E T H O D _ P O S T                         " P O S T "  
 # d e f i n e   H T T P _ M E T H O D _ P U T                           " P U T "  
 # d e f i n e   H T T P _ M E T H O D _ P A T C H                       " P A T C H "  
 # d e f i n e   H T T P _ M E T H O D _ D E L E T E                     " D E L E T E "  
 # d e f i n e   H T T P _ M E T H O D _ H E A D                         " H E A D "  
 # d e f i n e   H T T P _ M E T H O D _ O P T I O N S                   " O P T I O N S "  
  
 # d e f i n e   H T T P _ H E A D E R _ J S O N                         " C o n t e n t - T y p e :   a p p l i c a t i o n / j s o n \ r \ n "  
  
 # i n c l u d e   < O b j e c t . m q h >  
 # i n c l u d e   < e r r o r d e s c r i p t i o n . m q h >  
 # i n c l u d e   " J A s o n . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C R e q u e s t   :   p u b l i c   C O b j e c t  
   {  
     s t r i n g                           m _ o u t ;  
     s t r i n g                           m _ u r l ;  
     s t r i n g                           m _ q u e r y _ p a r a m ;  
     s t r i n g                           m _ h e a d e r s ;  
     s t r i n g                           m _ b o d y ;  
     s t r i n g                           m _ c o o k i e ;  
     s t r i n g                           m _ r e f e r e r ;  
     i n t                                 m _ t i m e o u t ;  
  
     s t r i n g                           m _ r e s u l t _ t x t ;  
     s t r i n g                           m _ r e s u l t _ h e a d e r s ;  
     i n t                                 m _ r e s u l t _ n u m b e r ;  
     s t r i n g                           m _ r e s u l t _ d e s c ;  
  
     b o o l                               S e n d R e q u e s t ( s t r i n g             & _ r e s p o n s e ,  
                                                                   s t r i n g               _ m e t h o d ,  
                                                                   c o n s t   s t r i n g   _ u r l ,  
                                                                   c o n s t   s t r i n g   _ h e a d e r s ,  
                                                                   c o n s t   s t r i n g   _ b o d y ,  
                                                                   c o n s t   s t r i n g   _ q u e r y _ p a r a m ,  
                                                                   c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                                   c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                                   c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
  
 p u b l i c :  
     s t r i n g                           O u t p u t ( v o i d )                                           c o n s t   {   r e t u r n   m _ o u t ; }  
     s t r i n g                           U r l ( v o i d )                                                 c o n s t   {   r e t u r n   m _ u r l ; }  
     v o i d                               U r l ( c o n s t   s t r i n g   _ v a l u e )                               {   m _ u r l   =   _ v a l u e ; }  
     s t r i n g                           Q u e r y P a r a m ( v o i d )                                   c o n s t   {   r e t u r n   m _ q u e r y _ p a r a m ; }  
     v o i d                               Q u e r y P a r a m ( c o n s t   s t r i n g   _ v a l u e )                 {   m _ q u e r y _ p a r a m   =   _ v a l u e ; }  
     s t r i n g                           H e a d e r s ( v o i d )                                         c o n s t   {   r e t u r n   m _ h e a d e r s ; }  
     v o i d                               H e a d e r s ( c o n s t   s t r i n g   _ v a l u e )                       {   m _ h e a d e r s   =   _ v a l u e ; }  
     s t r i n g                           B o d y ( v o i d )                                               c o n s t   {   r e t u r n   m _ b o d y ; }  
     v o i d                               B o d y ( c o n s t   s t r i n g   _ v a l u e )                             { m _ b o d y   =   _ v a l u e ; }  
     s t r i n g                           C o o k i e ( v o i d )                                           c o n s t   {   r e t u r n   m _ c o o k i e ; }  
     v o i d                               C o o k i e ( c o n s t   s t r i n g   _ v a l u e )                         {   m _ c o o k i e   =   _ v a l u e ; }  
     s t r i n g                           R e f e r e r ( v o i d )                                         c o n s t   {   r e t u r n   m _ r e f e r e r ; }  
     v o i d                               R e f e r e r ( c o n s t   s t r i n g   _ v a l u e )                       {   m _ r e f e r e r   =   _ v a l u e ; }  
     i n t                                 T i m e o u t ( v o i d )                                         c o n s t   {   r e t u r n   m _ t i m e o u t ; }  
     v o i d                               T i m e o u t ( c o n s t   i n t   _ v a l u e )                             {   m _ t i m e o u t   =   _ v a l u e ; }  
  
     s t r i n g                           R e s p o n s e ( v o i d )                                       c o n s t   {   r e t u r n   m _ r e s u l t _ t x t ; }  
     s t r i n g                           R e s u l t H e a d e r s ( v o i d )                             c o n s t   {   r e t u r n   m _ r e s u l t _ h e a d e r s ; }  
     i n t                                 R e s u l t N u m b e r ( v o i d )                               c o n s t   {   r e t u r n   m _ r e s u l t _ n u m b e r ; }  
     s t r i n g                           R e s u l t D e s c r i p t i o n ( v o i d )                     c o n s t   {   r e t u r n   m _ r e s u l t _ d e s c ; }  
  
  
                                           C R e q u e s t ( c o n s t   s t r i n g   _ h e a d e r s   =   N U L L ,   c o n s t   i n t   _ t i m e o u t   =   5 0 0 0 ) ;  
                                         ~ C R e q u e s t ( v o i d ) ;  
  
     v o i d                               R e s e t ( v o i d ) ;  
     v o i d                               I n i t ( c o n s t   s t r i n g   _ u r l ,  
                                                     c o n s t   s t r i n g   _ h e a d e r s   =   N U L L ,  
                                                     c o n s t   s t r i n g   _ q u e r y _ p a r a m   =   N U L L ,  
                                                     c o n s t   i n t         _ t i m e o u t   =   5 0 0 0 ,  
                                                     c o n s t   s t r i n g   _ c o o k i e   =   N U L L ,  
                                                     c o n s t   s t r i n g   _ r e f e r e r   =   N U L L ,  
                                                     c o n s t   s t r i n g   _ b o d y   =   N U L L ) ;  
  
     / / - - -  
     b o o l                               G e t ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               G e t ( s t r i n g             & _ r e s p o n s e ,  
                                                   c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               G e t ( s t r i n g             & _ r e s p o n s e ,  
                                                   c o n s t   s t r i n g   _ u r l ,  
                                                   c o n s t   s t r i n g   _ h e a d e r s ,  
                                                   c o n s t   s t r i n g   _ b o d y ,  
                                                   c o n s t   s t r i n g   _ q u e r y _ p a r a m   =   " " ,  
                                                   c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                   c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                   c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
     / / - - -  
     b o o l                               P o s t ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               P o s t ( s t r i n g             & _ r e s p o n s e ,  
                                                     c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               P o s t ( s t r i n g             & _ r e s p o n s e ,  
                                                     c o n s t   s t r i n g   _ u r l ,  
                                                     c o n s t   s t r i n g   _ h e a d e r s ,  
                                                     c o n s t   s t r i n g   _ b o d y ,  
                                                     c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                     c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                     c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
     / / - - -  
     b o o l                               P u t ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               P u t ( s t r i n g             & _ r e s p o n s e ,  
                                                   c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               P u t ( s t r i n g             & _ r e s p o n s e ,  
                                                   c o n s t   s t r i n g   _ u r l ,  
                                                   c o n s t   s t r i n g   _ h e a d e r s ,  
                                                   c o n s t   s t r i n g   _ b o d y ,  
                                                   c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                   c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                   c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
     / / - - -  
     b o o l                               P a t c h ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               P a t c h ( s t r i n g             & _ r e s p o n s e ,  
                                                       c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               P a t c h ( s t r i n g             & _ r e s p o n s e ,  
                                                       c o n s t   s t r i n g   _ u r l ,  
                                                       c o n s t   s t r i n g   _ h e a d e r s ,  
                                                       c o n s t   s t r i n g   _ b o d y ,  
                                                       c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                       c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                       c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
     / / - - -  
     b o o l                               D e l e t e ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               D e l e t e ( s t r i n g             & _ r e s p o n s e ,  
                                                         c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               D e l e t e ( s t r i n g             & _ r e s p o n s e ,  
                                                         c o n s t   s t r i n g   _ u r l ,  
                                                         c o n s t   s t r i n g   _ h e a d e r s ,  
                                                         c o n s t   s t r i n g   _ b o d y ,  
                                                         c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                         c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                         c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
     / / - - -  
     b o o l                               H e a d ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               H e a d ( s t r i n g             & _ r e s p o n s e ,  
                                                     c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               H e a d ( s t r i n g             & _ r e s p o n s e ,  
                                                     c o n s t   s t r i n g   _ u r l ,  
                                                     c o n s t   s t r i n g   _ h e a d e r s ,  
                                                     c o n s t   s t r i n g   _ b o d y ,  
                                                     c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                     c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                     c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
     / / - - -  
     b o o l                               O p t i o n s ( s t r i n g             & _ r e s p o n s e ) ;  
     b o o l                               O p t i o n s ( s t r i n g             & _ r e s p o n s e ,  
                                                           c o n s t   s t r i n g   _ b o d y ) ;  
     b o o l                               O p t i o n s ( s t r i n g             & _ r e s p o n s e ,  
                                                           c o n s t   s t r i n g   _ u r l ,  
                                                           c o n s t   s t r i n g   _ h e a d e r s ,  
                                                           c o n s t   s t r i n g   _ b o d y ,  
                                                           c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                           c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                           c o n s t   s t r i n g   _ r e f e r e r           =   N U L L ) ;  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C R e q u e s t : : C R e q u e s t ( c o n s t   s t r i n g   _ h e a d e r s   =   N U L L ,   c o n s t   i n t   _ t i m e o u t   =   5 0 0 0 )  
   {  
     m _ o u t   =   N U L L ;  
     m _ u r l   =   N U L L ;  
     m _ h e a d e r s   =   N U L L ;  
     m _ b o d y   =   N U L L ;  
     m _ q u e r y _ p a r a m   =   N U L L ;  
     m _ t i m e o u t           =   5 0 0 0 ;  
     m _ c o o k i e   =   N U L L ;  
     m _ r e f e r e r   =   N U L L ;  
  
     R e s e t ( ) ;  
  
     H e a d e r s ( _ h e a d e r s ) ;  
     T i m e o u t ( _ t i m e o u t ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C R e q u e s t : : ~ C R e q u e s t ( v o i d )  
   {  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C R e q u e s t : : R e s e t ( v o i d )  
   {  
     m _ r e s u l t _ t x t   =   N U L L ;  
     m _ r e s u l t _ h e a d e r s   =   N U L L ;  
     m _ r e s u l t _ n u m b e r   =   0 ;  
     m _ r e s u l t _ d e s c   =   N U L L ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C R e q u e s t : : I n i t ( c o n s t   s t r i n g   _ u r l ,  
                                         c o n s t   s t r i n g   _ h e a d e r s   =   N U L L ,  
                                         c o n s t   s t r i n g   _ q u e r y _ p a r a m   =   N U L L ,  
                                         c o n s t   i n t         _ t i m e o u t   =   5 0 0 0 ,  
                                         c o n s t   s t r i n g   _ c o o k i e   =   N U L L ,  
                                         c o n s t   s t r i n g   _ r e f e r e r   =   N U L L ,  
                                         c o n s t   s t r i n g   _ b o d y   =   N U L L )  
   {  
     U r l ( _ u r l ) ;  
     H e a d e r s ( _ h e a d e r s ) ;  
     B o d y ( _ b o d y ) ;  
     Q u e r y P a r a m ( _ q u e r y _ p a r a m ) ;  
     T i m e o u t ( _ t i m e o u t ) ;  
     C o o k i e ( _ c o o k i e ) ;  
     R e f e r e r ( _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : S e n d R e q u e s t ( s t r i n g             & _ r e s p o n s e ,  
                                                       s t r i n g               _ m e t h o d ,  
                                                       c o n s t   s t r i n g   _ u r l ,  
                                                       c o n s t   s t r i n g   _ h e a d e r s ,  
                                                       c o n s t   s t r i n g   _ b o d y ,  
                                                       c o n s t   s t r i n g   _ q u e r y _ p a r a m ,  
                                                       c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                                       c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                                       c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
     R e s e t ( ) ;  
     : : R e s e t L a s t E r r o r ( ) ;  
 / / - - -  
     s t r i n g   u r l   =   _ u r l ;  
     i f ( : : S t r i n g L e n ( _ q u e r y _ p a r a m )   >   0 )  
         u r l   + =   " ? "   +   _ q u e r y _ p a r a m ;  
 / / - - -  
     u c h a r   r e s u l t s [ ] ;  
     m _ r e s u l t _ h e a d e r s   =   N U L L ;  
 / / - - -  
     c h a r     b o d y s [ ] ;  
     i n t   d a t a _ s i z e   =   : : S t r i n g L e n ( _ b o d y ) ;  
     i f ( d a t a _ s i z e   >   0 )  
         : : S t r i n g T o C h a r A r r a y ( _ b o d y ,   b o d y s ,   0 ,   d a t a _ s i z e ) ;  
 / / - - -  
     i f ( m _ c o o k i e   ! =   N U L L   & &   m _ r e f e r e r   ! =   N U L L )  
         m _ r e s u l t _ n u m b e r   =   : : W e b R e q u e s t ( _ m e t h o d ,   u r l ,   _ c o o k i e ,   _ r e f e r e r ,   _ t i m e o u t ,   b o d y s ,   d a t a _ s i z e ,   r e s u l t s ,   m _ r e s u l t _ h e a d e r s ) ;  
     e l s e  
         m _ r e s u l t _ n u m b e r   =   : : W e b R e q u e s t ( _ m e t h o d ,   u r l ,   _ h e a d e r s ,   _ t i m e o u t ,   b o d y s ,   r e s u l t s ,   m _ r e s u l t _ h e a d e r s ) ;  
 / / - - -  
     i f ( m _ r e s u l t _ n u m b e r   > =   2 0 0   & &   m _ r e s u l t _ n u m b e r   < =   2 0 4 )     / /   O K  
       {  
         / / - - -   d e l e t e   B O M  
         i n t   s t a r t _ i n d e x   =   0 ;  
         i n t   s i z e   =   : : A r r a y S i z e ( r e s u l t s ) ;  
         f o r ( i n t   i   =   0 ;   i   <   : : f m i n ( s i z e ,   8 ) ;   i + + )  
           {  
             i f ( r e s u l t s [ i ]   = =   0 x e f   | |   r e s u l t s [ i ]   = =   0 x b b   | |   r e s u l t s [ i ]   = =   0 x b f )  
                 s t a r t _ i n d e x   =   i   +   1 ;  
             e l s e  
                 b r e a k ;  
           }  
         _ r e s p o n s e   =   : : C h a r A r r a y T o S t r i n g ( r e s u l t s ,   s t a r t _ i n d e x ,   W H O L E _ A R R A Y ,   C P _ U T F 8 ) ;  
         m _ r e s u l t _ t x t   =   _ r e s p o n s e ;  
         m _ r e s u l t _ d e s c   =   " s u c c e s s " ;  
         r e t u r n   ( t r u e ) ;  
       }  
     e l s e  
       {  
         i f ( m _ r e s u l t _ n u m b e r   = =   - 1 )  
           {  
             m _ r e s u l t _ d e s c   =   " f a i l :   "   +   E r r o r D e s c r i p t i o n ( _ L a s t E r r o r )   +   "   > >   C o d e :   "   +   ( s t r i n g ) _ L a s t E r r o r ;  
             : : P r i n t ( m _ r e s u l t _ d e s c ) ;  
             r e t u r n   ( f a l s e ) ;  
           }  
         e l s e  
           {  
             / / - - -   H T T P   e r r o r s  
             i f ( m _ r e s u l t _ n u m b e r   > =   1 0 0   & &   m _ r e s u l t _ n u m b e r   < =   5 1 1 )  
               {  
                 _ r e s p o n s e   =   : : C h a r A r r a y T o S t r i n g ( r e s u l t s ,   0 ,   W H O L E _ A R R A Y ,   C P _ U T F 8 ) ;  
                 m _ r e s u l t _ d e s c   =   " f a i l   h t t p :   "   +   _ r e s p o n s e ;  
                 : : P r i n t ( m _ r e s u l t _ d e s c ) ;  
                 r e t u r n   ( f a l s e ) ;  
               }  
             m _ r e s u l t _ d e s c   =   " f a i l :   "   +   E r r o r D e s c r i p t i o n ( _ L a s t E r r o r )   +   "   > >   C o d e :   "   +   ( s t r i n g ) _ L a s t E r r o r ;  
             : : P r i n t ( m _ r e s u l t _ d e s c ) ;  
             r e t u r n   ( f a l s e ) ;  
           }  
       }  
     r e t u r n   ( t r u e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : G e t ( s t r i n g             & _ r e s p o n s e ,  
                                       c o n s t   s t r i n g   _ u r l ,  
                                       c o n s t   s t r i n g   _ h e a d e r s ,  
                                       c o n s t   s t r i n g   _ b o d y ,  
                                       c o n s t   s t r i n g   _ q u e r y _ p a r a m   =   " " ,  
                                       c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                       c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                       c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ G E T ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   _ q u e r y _ p a r a m ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : G e t ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   G e t ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ q u e r y _ p a r a m ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : G e t ( s t r i n g             & _ r e s p o n s e ,  
                                       c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   G e t ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P o s t ( s t r i n g             & _ r e s p o n s e ,  
                                         c o n s t   s t r i n g   _ u r l ,  
                                         c o n s t   s t r i n g   _ h e a d e r s ,  
                                         c o n s t   s t r i n g   _ b o d y ,  
                                         c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                         c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                         c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P O S T ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P o s t ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   P o s t ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P o s t ( s t r i n g             & _ r e s p o n s e ,  
                                         c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   P o s t ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P u t ( s t r i n g             & _ r e s p o n s e ,  
                                       c o n s t   s t r i n g   _ u r l ,  
                                       c o n s t   s t r i n g   _ h e a d e r s ,  
                                       c o n s t   s t r i n g   _ b o d y ,  
                                       c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                       c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                       c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
 / /   FE/'FE  E*/  3'~H1*  E4H/  '  .1(1'  GEF  /H  E*/  1'  B1'1  E/GE  *3*  4H/  G1  /'E  ,H'(  /'/  1H4  /1  -0A  4H/ 
  
 / /   1H4  'HD  '1  E*/3'~H1*  E4H/  ( *H5G  4/G)  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P U T ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
  
 / /   1H4  /HE  '1  E*/  3'~H1*  FE4H/ 
     s t r i n g   h e a d e r s   =   _ h e a d e r s   +   " X - H T T P - M e t h o d - O v e r r i d e : "   +   H T T P _ M E T H O D _ P U T   +   " \ r \ n " ;  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P O S T ,   _ u r l ,   h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
 / /   '1  /H  1H4  ('D'  ,H'(  F/G/  *FG'  1'G  -D  '3*A'/G  '2  d l l  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P u t ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   P u t ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P u t ( s t r i n g             & _ r e s p o n s e ,  
                                       c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   P u t ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P a t c h ( s t r i n g             & _ r e s p o n s e ,  
                                           c o n s t   s t r i n g   _ u r l ,  
                                           c o n s t   s t r i n g   _ h e a d e r s ,  
                                           c o n s t   s t r i n g   _ b o d y ,  
                                           c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                           c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                           c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
 / /   FE/'FE  E*/  3'~H1*  E4H/  '  .1(1'  GEF  /H  E*/  1'  B1'1  E/GE  *3*  4H/  G1  /'E  ,H'(  /'/  1H4  /1  -0A  4H/ 
  
 / /   1H4  'HD  '1  E*/3'~H1*  E4H/  ( *H5G  4/G)  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P A T C H ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
  
 / /   1H4  /HE  '1  E*/  3'~H1*  FE4H/ 
     s t r i n g   h e a d e r s   =   _ h e a d e r s   +   " X - H T T P - M e t h o d - O v e r r i d e : "   +   H T T P _ M E T H O D _ P A T C H   +   " \ r \ n " ;  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P O S T ,   _ u r l ,   h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
 / /   '1  /H  1H4  ('D'  ,H'(  F/G/  *FG'  1'G  -D  '3*A'/G  '2  d l l  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P a t c h ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   P a t c h ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : P a t c h ( s t r i n g             & _ r e s p o n s e ,  
                                           c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   P a t c h ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : D e l e t e ( s t r i n g             & _ r e s p o n s e ,  
                                             c o n s t   s t r i n g   _ u r l ,  
                                             c o n s t   s t r i n g   _ h e a d e r s ,  
                                             c o n s t   s t r i n g   _ b o d y ,  
                                             c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                             c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                             c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
 / /   FE/'FE  E*/  3'~H1*  E4H/  '  .1(1'  GEF  /H  E*/  1'  B1'1  E/GE  *3*  4H/  G1  /'E  ,H'(  /'/  1H4  /1  -0A  4H/ 
  
 / /   1H4  'HD  '1  E*/3'~H1*  E4H/  ( *H5G  4/G)  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ D E L E T E ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
  
 / /   1H4  /HE  '1  E*/  3'~H1*  FE4H/ 
     s t r i n g   h e a d e r s   =   _ h e a d e r s   +   " X - H T T P - M e t h o d - O v e r r i d e : "   +   H T T P _ M E T H O D _ D E L E T E   +   " \ r \ n " ;  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P O S T ,   _ u r l ,   h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
 / /   '1  /H  1H4  ('D'  ,H'(  F/G/  *FG'  1'G  -D  '3*A'/G  '2  d l l  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : D e l e t e ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   D e l e t e ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : D e l e t e ( s t r i n g             & _ r e s p o n s e ,  
                                             c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   D e l e t e ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : H e a d ( s t r i n g             & _ r e s p o n s e ,  
                                         c o n s t   s t r i n g   _ u r l ,  
                                         c o n s t   s t r i n g   _ h e a d e r s ,  
                                         c o n s t   s t r i n g   _ b o d y ,  
                                         c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                         c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                         c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
 / /   FE/'FE  E*/  3'~H1*  E4H/  '  .1(1'  GEF  /H  E*/  1'  B1'1  E/GE  *3*  4H/  G1  /'E  ,H'(  /'/  1H4  /1  -0A  4H/ 
  
 / /   1H4  'HD  '1  E*/3'~H1*  E4H/  ( *H5G  4/G)  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ H E A D ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
  
 / /   1H4  /HE  '1  E*/  3'~H1*  FE4H/ 
     s t r i n g   h e a d e r s   =   _ h e a d e r s   +   " X - H T T P - M e t h o d - O v e r r i d e : "   +   H T T P _ M E T H O D _ H E A D   +   " \ r \ n " ;  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P O S T ,   _ u r l ,   h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
 / /   '1  /H  1H4  ('D'  ,H'(  F/G/  *FG'  1'G  -D  '3*A'/G  '2  d l l  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : H e a d ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   H e a d ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : H e a d ( s t r i n g             & _ r e s p o n s e ,  
                                         c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   H e a d ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : O p t i o n s ( s t r i n g             & _ r e s p o n s e ,  
                                               c o n s t   s t r i n g   _ u r l ,  
                                               c o n s t   s t r i n g   _ h e a d e r s ,  
                                               c o n s t   s t r i n g   _ b o d y ,  
                                               c o n s t   i n t         _ t i m e o u t           =   5 0 0 0 ,  
                                               c o n s t   s t r i n g   _ c o o k i e             =   N U L L ,  
                                               c o n s t   s t r i n g   _ r e f e r e r           =   N U L L )  
   {  
   / /   n e m i d o n a m   m e t h o d   s u p o r t   m i s h e   y a   n a   b a r a y   h a m i n   2   m e t h o d   r a   g h a r a r   m i d a m   h a r k o d o m   j a v a b   d a d   d i g a r i   h a z f   s h a v a d  
 / / - - -   m e t h o d   1   ( t o s i e   m i s h e )  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ O P T I O N S ,   _ u r l ,   _ h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
 / / - - -   m e h o d   2  
     s t r i n g   h e a d e r s   =   _ h e a d e r s   +   " X - H T T P - M e t h o d - O v e r r i d e : "   +   H T T P _ M E T H O D _ O P T I O N S   +   " \ r \ n " ;  
     r e t u r n   S e n d R e q u e s t ( _ r e s p o n s e ,   H T T P _ M E T H O D _ P O S T ,   _ u r l ,   h e a d e r s ,   _ b o d y ,   " " ,   _ t i m e o u t ,   _ c o o k i e ,   _ r e f e r e r ) ;  
 / /   a g a r   n a s h o d   d l l  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : O p t i o n s ( s t r i n g   & _ r e s p o n s e )  
   {  
     r e t u r n   O p t i o n s ( _ r e s p o n s e ,   m _ u r l ,   m _ h e a d e r s ,   m _ b o d y ,   m _ t i m e o u t ,   m _ c o o k i e ,   m _ r e f e r e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C R e q u e s t : : O p t i o n s ( s t r i n g             & _ r e s p o n s e ,  
                                               c o n s t   s t r i n g   _ b o d y )  
   {  
     B o d y ( _ b o d y ) ;  
     r e t u r n   O p t i o n s ( _ r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                                      wstools.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "..\URL.mqh"

//+------------------------------------------------------------------+
//| Various helper functions                                         |
//+------------------------------------------------------------------+
namespace WsTools
{
// Parse HTTP headers (multiline) to an array of key[][0]/value[][1]
int parseHeaders(const string header, string &retVal[][2])
 {
  string fields[];
  const int n = StringSplit(header, '\n', fields);

  ArrayResize(retVal, 0);

  for(int i = 0; i < n; i++)
   {
    StringReplace(fields[i], "\t", " ");
    string match[];

    if(StringSplit(URL::trim(fields[i]), ':', match) >= 2)
     {
      const int m = ArrayRange(retVal, 0);
      ArrayResize(retVal, m + 1);
      StringToLower(match[0]);  // make key case-insensitive
      retVal[m][0] = match[0];  // NB: if the same header key occured many times, it'll be added many times
      StringTrimLeft(match[1]); // skip leading blank after ':'
      retVal[m][1] = match[1];
      for(int j = 2; j < ArraySize(match); j++)
       {
        retVal[m][1] += ":" + match[j];
       }
     }
   }

  if(StringFind(header, "GET ") == 0)
   {
    const int p = StringFind(header, " HTTP/");
    if(p > 0)
     {
      const int m = ArrayRange(retVal, 0);
      ArrayResize(retVal, m + 1);
      retVal[m][0] = "GET";
      retVal[m][1] = StringSubstr(header, 4, p - 4);
     }
   }

  return ArrayRange(retVal, 0);
 }

string arrayToHex(const uchar &array[], const int max = -1)
 {
  string res = "";
  const int count = max == -1 ? ArraySize(array) : fmin(max, ArraySize(array));
  for(int i = 0; i < count; i++)
   {
    res += StringFormat("%.02X ", array[i]);
   }
  if(count < ArraySize(array))
    res += "...";
  return res;
 }

int charCount(const string data, const uchar c)
 {
  int count = 0;
  for(int i = 0; i < StringLen(data); i++)
   {
    if(data[i] == c)
      count++;
   }
  return count;
 }

union BYTES4
 {
  uchar chars[4];
  uint  num;
  BYTES4(): num(0) { }
  BYTES4(uint n): num(n) { }
  BYTES4(const string &data) { WsTools::StringToByteArray(data, chars, 0, 4); }
  BYTES4(const uchar &data[], const int offset = 0) { ArrayCopy(chars, data, 0, offset, 4); }
  uchar operator[](int i) { return chars[i]; }
 };

void pack4(uint number, uchar &data[], const int offset = 0)
 {
  BYTES4 b;
  b.num = MathSwap(number);
  ArrayCopy(data, b.chars, offset);
 }

uint unpack4(const string data, const int offset = 0)
 {
  BYTES4 b;
  b.chars[0] = (uchar)data[0 + offset];
  b.chars[1] = (uchar)data[1 + offset];
  b.chars[2] = (uchar)data[2 + offset];
  b.chars[3] = (uchar)data[3 + offset];
  return MathSwap(b.num); // TODO: consider redo without swap
 }

uint unpack4(const uchar &data[], const int offset = 0)
 {
  BYTES4 b;
  b.chars[0] = (uchar)data[0 + offset];
  b.chars[1] = (uchar)data[1 + offset];
  b.chars[2] = (uchar)data[2 + offset];
  b.chars[3] = (uchar)data[3 + offset];
  return MathSwap(b.num); // TODO: consider redo without swap
 }

union BYTES2
 {
  uchar chars[2];
  ushort  num;
  BYTES2(): num(0) { }
  BYTES2(ushort n): num(n) { }
  uchar operator[](int i) { return chars[i]; }
 };

void pack2(ushort number, uchar &data[], const int offset = 0)
 {
  BYTES2 b;
  b.num = MathSwap(number);
  ArrayCopy(data, b.chars, offset);
 }

ushort unpack2(const string data, const int offset = 0)
 {
  BYTES2 b;
  b.chars[0] = (uchar)data[0 + offset];
  b.chars[1] = (uchar)data[1 + offset];
  return MathSwap(b.num);
 }

ushort unpack2(const uchar &data[], const int offset = 0)
 {
  BYTES2 b;
  b.chars[0] = (uchar)data[0 + offset];
  b.chars[1] = (uchar)data[1 + offset];
  return MathSwap(b.num);
 }

template<typename T>
void push(T *&array[], T *ptr)
 {
  const int n = ArraySize(array);
  ArrayResize(array, n + 1);
  array[n] = ptr;
 }

template<typename T>
void push(T &array[][2], T key, T value)
 {
  const int n = ArrayRange(array, 0);
  ArrayResize(array, n + 1);
  array[n][0] = key;
  array[n][1] = value;
 }

// NB: StringToCharArray copies to specific part (start/count) of the receiving array (which is confusing)
// StringToByteArray is intended to copy specific part of the given string
int StringToByteArray(const string text, uchar &array[], const int start = 0, const int count = -1, const uint cp = CP_ACP)
 {
  if(cp == CP_ACP)
   {
    const int n = count == -1 ? StringLen(text) - start : count;
    ArrayResize(array, n);
    for(int i = 0; i < n; i++)
     {
      array[i] = (uchar)StringGetCharacter(text, i + start);
     }
    return n;
   }
  else
   {
    int n = StringToCharArray((start || count != -1) ?
                              StringSubstr(text, start, count) : text, array, 0, -1, cp);
    if(n > 0 && array[n - 1] == 0)
     {
      ArrayResize(array, --n);
     }
    return n;
   }
  return 0;
 }

string stringify(const uchar &data[], const int limit = -1)
 {
  string result = "";
  const int count = limit == -1 ? ArraySize(data) : MathMin(limit, ArraySize(data));
  StringReserve(result, count);
  for(int i = 0; i < count; i++)
   {
    result += StringFormat("%C", data[i]);
   }
  return result;
 }
};
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                 wsinterfaces.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
//+------------------------------------------------------------------+
//| Defines                                                          |
//+------------------------------------------------------------------+
#define WS_APP_TYPE_CLIENT 1
#define WS_APP_TYPE_SERVER 0 // not supported in MQL5, can be used for unmasking only (frame debugging)

#ifndef WS_APP_TYPE
#define WS_APP_TYPE WS_APP_TYPE_CLIENT // masking is enabled in client, disabled in server
#endif

#define WS_BUFFSIZE 1024
#define CRLFCRLF "\r\n\r\n"

//+------------------------------------------------------------------+
//| Communication level abstraction: a wrapper for built-in          |
//| Socket-functions or other DLL-based implemenations               |
//+------------------------------------------------------------------+
interface IWebSocketTransport
 {
  int write(const uchar &data[]);
  int read(uchar &buffer[]);
  bool isConnected(void) const;
  bool isReadable(void) const;
  bool isWritable(void) const;
  int getHandle(void) const;
  void close(void);
 };

//+------------------------------------------------------------------+
//| Enum with all frame codes defined in WebSocket protocol          |
//+------------------------------------------------------------------+
enum WS_FRAME_OPCODE
 {
  WS_DEFAULT = 0,

  WS_CONTINUATION_FRAME = 0x00,
  WS_TEXT_FRAME = 0x01,
  WS_BINARY_FRAME = 0x02,

  WS_CLOSE_FRAME = 0x08,

  WS_PING_FRAME = 0x09,
  WS_PONG_FRAME = 0x0A
 };

//+------------------------------------------------------------------+
//| Interface for WebSocket frames, which compose a message          |
//| (defined as a class because of default/nested implementation)    |
//+------------------------------------------------------------------+
class IWebSocketFrame
 {
public:

  //+------------------------------------------------------------------+
  //| Interface for static methods in IWebSocketFrame                  |
  //+------------------------------------------------------------------+
  class StaticCreator
   {
  public:
    virtual IWebSocketFrame *decode(uchar &data[], IWebSocketFrame *head = NULL) = 0;
    virtual IWebSocketFrame *create(WS_FRAME_OPCODE type, const string data = NULL, const bool deflate = false) = 0;
    virtual IWebSocketFrame *create(WS_FRAME_OPCODE type, const uchar &data[], const bool deflate = false) = 0;
   };

protected:
  //+------------------------------------------------------------------+
  //| Require all the static methods to exist in P                     |
  //+------------------------------------------------------------------+
  template<typename P>
  class Creator: public StaticCreator
   {
  public:
    // decode received binary data into a IWebSocketFrame (use head for continuation frames)
    virtual IWebSocketFrame *decode(uchar &data[], IWebSocketFrame *head = NULL) override
     {
      return P::decode(data, head);
     }
    // create a text/close/other frame with optional payload
    virtual IWebSocketFrame *create(WS_FRAME_OPCODE type, const string data = NULL, const bool deflate = false) override
     {
      return P::create(type, data, deflate);
     };
    // create a binary/text/close/other frame with payload
    virtual IWebSocketFrame *create(WS_FRAME_OPCODE type, const uchar &data[], const bool deflate = false) override
     {
      return P::create(type, data, deflate);
     };
   };

public:
  // require creator itself to exist, hence all static methods must be implemented
  virtual IWebSocketFrame::StaticCreator *getCreator() = 0;

  // using frame content, prepare and return its raw data to be sent over network
  virtual int        encode(uchar &encoded[]) = 0;

  // read payload as text
  virtual string     getData() = 0;

  // read payload as raw data, return size
  virtual int        getData(uchar &buf[]) = 0;

  // return frame type (opcode)
  virtual WS_FRAME_OPCODE getType() = 0;

  // check if the frame is a control frame:
  // control frames should be handled internally by websocket classes
  virtual bool       isControlFrame()
   {
    return (getType() >= WS_CLOSE_FRAME);
   }

  virtual bool       isReady() { return true; }
  virtual bool       isFinal() { return true; }
  virtual bool       isMasked() { return false; }
  virtual bool       isCompressed() { return false; }
 };

//+------------------------------------------------------------------+
//| Interface for WebSocket messages                                 |
//+------------------------------------------------------------------+
class IWebSocketMessage
 {
public:
  // retreive an array of frames of which this message is composed
  virtual void       getFrames(IWebSocketFrame *&frames[]) = 0;

  // set text as message content
  virtual bool       setString(const string &data) = 0;

  // return message content as text
  virtual string     getString() = 0;

  // set binary data as message content
  virtual bool       setData(const uchar &data[]) = 0;

  // return message content raw
  virtual bool       getData(uchar &data[]) = 0;

  // return if all frames of the message are received
  virtual bool       isFinalised() = 0;

  // add a frame into message
  virtual bool       takeFrame(IWebSocketFrame *frame) = 0;
 };

//+------------------------------------------------------------------+
//| Interface for WebSocket connection functionality                 |
//+------------------------------------------------------------------+
interface IWebSocketConnection
 {
// open a connection
  bool handshake(const string url, const string host, const string origin, const string custom = NULL);

// low-level get incoming frame(s) from a server
  int readFrame(IWebSocketFrame *&frames[]);

  int checkMessages();

// low-level send raw frame (for example, close or ping)
  bool sendFrame(IWebSocketFrame *frame);

// low-level send raw message
  bool sendMessage(IWebSocketMessage *msg);

// user-level send text
  bool sendString(const string msg);

// user-level send binary data
  bool sendData(const uchar &data[]);

// close connection
  bool disconnect(void);
 };

//+------------------------------------------------------------------+
//| Interface for WebSocket events callbacks                         |
//+------------------------------------------------------------------+
interface IWebSocketObserver
 {
  void onDisconnect();
  void onConnected();
  void onMessage(IWebSocketMessage *msg);
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                    wsmessage.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "wstools.mqh"
#include "wsinterfaces.mqh"
#include "wsframe.mqh"

//+------------------------------------------------------------------+
//| WebSocket messaging according to Hixie RFC (back compatibility)  |
//+------------------------------------------------------------------+
class WebSocketMessageHixie: public IWebSocketMessage
 {
protected:
  IWebSocketFrame    *frame;

public:
                     WebSocketMessageHixie(IWebSocketFrame *f = NULL): frame(f) { }
                     WebSocketMessageHixie(const string &text): frame(NULL)
   {
    setString(text);
   }

                    ~WebSocketMessageHixie()
   {
    if(frame)
      delete frame;
   }

  void               getFrames(IWebSocketFrame *&frames[]) override
   {
    WsTools::push(frames, frame);
   }

  bool               setString(const string &d) override
   {
    if(frame != NULL)
      delete frame;
    frame = WebSocketFrameHixie::create(WS_FRAME_OPCODE::WS_TEXT_FRAME, d);
    return frame != NULL;
   }

  string             getString() override
   {
    return isFinalised() ? frame.getData() : NULL;
   }

  bool               setData(const uchar &[]) override
   {
    return false;
   }

  bool               getData(uchar &[]) override
   {
    return false;
   }

  bool               isFinalised() override
   {
    return frame != NULL;
   }

  virtual bool       takeFrame(IWebSocketFrame *f) override
   {
    if(!frame)
     {
      frame = f;
      return true;
     }
    return false;
   }
 };

//+------------------------------------------------------------------+
//| WebSocket messaging according to Hybi RFC (current standard)     |
//+------------------------------------------------------------------+
class WebSocketMessage: public IWebSocketMessage
 {
protected:
  IWebSocketFrame    *frames[];
  uchar              _data[];
  bool               compressed;
  bool               binary;

  bool               compose()
   {
    if(compressed)
     {
      uchar key[] = {1, 0, 0, 0};
      uchar load[], result[];
      const int n = CryptEncode(CRYPT_ARCH_ZIP, _data, key, result);
      if(n == 0)
       {
        Print("Can't compress: ", _LastError);
        compressed = false; // fallback (need to clear deflate flag)
       }
      else
       {
        ArraySwap(_data, result);
       }
     }
    WsTools::push(frames, WebSocketFrame::create(/*compressed || */binary ?
                  WS_FRAME_OPCODE::WS_BINARY_FRAME : WS_FRAME_OPCODE::WS_TEXT_FRAME, _data, compressed));
    return true;
   }

  bool               extract()
   {
    if(!isFinalised())
     {
      Print("Can't get data from NotFinalised message");
      return false;
     }

    ArrayResize(_data, 0);

    for(int i = 0; i < ArraySize(frames); i++)
     {
      uchar temp[];
      frames[i].getData(temp);
      ArrayCopy(_data, temp, ArraySize(_data));
     }

    if(compressed)
     {
      uchar key[] = {1, 0, 0, 0};
      uchar result[];
      if(CryptDecode(CRYPT_ARCH_ZIP, _data, key, result) == 0)
       {
        Print("Can't decompress: ", _LastError);
       }
      else
       {
        ArraySwap(_data, result);
       }
     }
    return true;
   }

public:
                     WebSocketMessage(const bool deflate = false): compressed(deflate), binary(false) { }

                     WebSocketMessage(const uchar &bytes[], bool deflate = false): compressed(deflate), binary(true)
   {
    setData(bytes);
   }

                     WebSocketMessage(const string &text, bool deflate = false): compressed(deflate), binary(false)
   {
    setString(text);
   }

                    ~WebSocketMessage()
   {
    for(int i = 0; i < ArraySize(frames); i++)
     {
      if(CheckPointer(frames[i]) == POINTER_DYNAMIC)
        delete frames[i];
     }
    ArrayResize(frames, 0);
   }

  bool               setData(const uchar &data[]) override
   {
    ArrayCopy(_data, data);
    return compose();
   }

  bool               setString(const string &d) override
   {
    StringToCharArray(d, _data, 0, WHOLE_ARRAY, CP_UTF8);
    ArrayResize(_data, ArraySize(_data) - 1); // cut trailing '\0'
    return compose();
   }

  bool               getData(uchar &data[]) override
   {
    return extract() && ArrayCopy(data, _data);
   }

  string             getString() override
   {
    if(extract())
     {
      // NB. return string even if it's binary data, just for logging,
      // calling code should check applicability
      return CharArrayToString(_data, 0, WHOLE_ARRAY, CP_UTF8);
     }
    return NULL;
   }

  void               getFrames(IWebSocketFrame *&_frames[]) override
   {
    ArrayCopy(_frames, this.frames);
   }

  bool               isFinalised() override
   {
    if(ArraySize(frames) == 0)
      return false;

    return frames[ArraySize(frames) - 1].isFinal();
   }

  // append frame to the message
  virtual bool       takeFrame(IWebSocketFrame *frame) override
   {
    if(CheckPointer(frame) != POINTER_INVALID)
     {
      WsTools::push(frames, frame);
      return true;
     }
    return false;
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                   wsprotocol.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "wstools.mqh"
#include "wsframe.mqh"
#include "wsmessage.mqh"
#include "wsinterfaces.mqh"

#define Hybi WebSocketConnectionHybi
#define Hixie WebSocketConnectionHixie

//+------------------------------------------------------------------+
//| WebSocket protocol common part                                   |
//+------------------------------------------------------------------+
class WebSocketConnection: public IWebSocketConnection
 {
protected:
  IWebSocketObserver *owner;
  IWebSocketTransport *socket;
  bool               deflate;

  bool               disconnecting;  // hard close at socket level
  bool               closeRequested; // soft close at protocol level
  uchar              writeBuffer[];
  uchar              tail[];

  string             headers[][2];

  void               adjustCompression()
   {
    for(int i = 0; i < ArrayRange(headers, 0); i++)
     {
      if(StringFind(headers[i][0], "sec-websocket-extensions") == 0
         && StringFind(headers[i][1], "permessage-deflate") >= 0)
       {
        return;
       }
     }
    deflate = false;
    Print("Deflate doesn't supported by server");
   }

  bool               writeInternalBuffer()
   {
    uchar buff[];
    const int n = ArraySize(writeBuffer);
    if(n > WS_BUFFSIZE)
     {
      ArrayCopy(buff, writeBuffer, 0, 0, WS_BUFFSIZE);
      ArrayCopy(writeBuffer, writeBuffer, 0, WS_BUFFSIZE);
      ArrayResize(writeBuffer, n - WS_BUFFSIZE);
     }
    else
     {
      ArrayCopy(buff, writeBuffer);
      ArrayResize(writeBuffer, 0);
     }

    if(!writePacketToNet(buff))
     {
      close();
      return false;
     }

    if(ArraySize(writeBuffer) == 0 && disconnecting)
     {
      close();
     }
    return true;
   }

  int                writePacketToNet(const uchar &data[])
   {
    const int n = ArraySize(data);
    int fwrite = 0;
    int written = 0;
    uchar buffer[];
    for(; written < n; written += fwrite)
     {
      if(written > 0)
       {
        ArrayResize(buffer, 0); // shrink to 0 if something left from previous iteration
        ArrayCopy(buffer, data, 0, written);
        fwrite = socket.write(buffer);
       }
      else
       {
        fwrite = socket.write(data);
       }
      if(fwrite == -1)
       {
        Print("Write failed: ", _LastError);
        return 0; // can't
       }
     }
    return written;
   }

  int                readPacketFromNet(uchar &data[], const bool waitForHeaders = false)
   {
    uchar buffer[];
    int read = 0;
    int cursor = 0;

    do
     {
      read = socket.read(buffer);
      if(read > 0)
       {
        ArrayCopy(data, buffer, cursor, 0, read);
        cursor += read;
       }

      if(waitForHeaders)
       {
        if(ArraySize(data) > 4 && StringFind(CharArrayToString(data), CRLFCRLF) > 0)
         {
          break;
         }
       }
     }
    while(((socket.isReadable() && read > 0)
           || (waitForHeaders && read != -1 && !_LastError)) && !IsStopped());

    if(!socket.isConnected())
     {
      close(); // notify subscribers
     }

    return cursor;
   }

  bool               write(const uchar &data[])
   {
    ArrayCopy(writeBuffer, data, ArraySize(writeBuffer));

    while(ArraySize(writeBuffer) > 0)
     {
      if(!writeInternalBuffer())
        return false;
     }
    return true;
   }

  int                bufferSwap(uchar &buff1[], uchar &buff2[])
   {
    return ArraySwap(buff1, buff2) ? fmax(ArraySize(buff1), ArraySize(buff2)) : 0;
   }

  void               close()
   {
    if(!disconnecting)
     {
      disconnecting = true;
      socket.close();
      owner.onDisconnect();
     }
   }

  string             serializeHeaders(const string custom = NULL)
   {
    string str = "";

    for(int i = 0; i < ArrayRange(headers, 0); i++)
     {
      str += headers[i][0] + " " + headers[i][1] + "\r\n";
     }
    if(StringLen(custom))
      str += custom;

    str += "\r\n";

    return str;
   }

public:
                     WebSocketConnection(IWebSocketObserver *client, IWebSocketTransport *trans, const bool compression = false): deflate(compression)
   {
    owner = client;
    socket = trans;
    disconnecting = false;
    closeRequested = false;
   }

  virtual bool       handshake(const string url, const string host, const string origin, const string custom = NULL)
   {
    uchar buffer[];
    WsTools::StringToByteArray(serializeHeaders(custom), buffer);

    socket.write(buffer);

    ArrayResize(buffer, 0); // shrink

    // wait for response with headers
    const int len = readPacketFromNet(buffer, true);
    string response = CharArrayToString(buffer, 0, WHOLE_ARRAY, CP_UTF8);
    PrintFormat("Buffer: '%s'", response);
    if(len == 0)
      return false;
    const int end = StringFind(response, CRLFCRLF);
    if(ArraySize(buffer) > end + StringLen(CRLFCRLF))
     {
      ArrayCopy(tail, buffer, 0, end + StringLen(CRLFCRLF));
      StringSetLength(response, end);
     }
    WsTools::parseHeaders(response, headers); // re-fill headers from responce
    Print("Headers: ");
    ArrayPrint(headers);

    if(deflate)
      adjustCompression(); // look for "Sec-WebSocket-Extensions: permessage-deflate"
    owner.onConnected();
    return true;
   }

  bool               sendFrame(IWebSocketFrame *frame) override
   {
    uchar encoded[];
    frame.encode(encoded);
    const bool sent = writePacketToNet(encoded);
    if(sent && frame.getType() == WS_CLOSE_FRAME)
     {
      Print("Close requested");
      closeRequested = true;
     }
    return sent;
   }

  bool               sendMessage(IWebSocketMessage *msg) override
   {
    IWebSocketFrame *frames[];
    msg.getFrames(frames);
    for(int i = 0; i < ArraySize(frames); i++)
     {
      if(!sendFrame(frames[i]))
        return false;
     }

    return true;
   }

  int                checkMessages() override
   {
    IWebSocketFrame *dummy[1];
    return readFrame(dummy);
   }
 };

//+------------------------------------------------------------------+
//| WebSocket protocol Hybi specific part                            |
//+------------------------------------------------------------------+
class WebSocketConnectionHybi: public WebSocketConnection
 {
protected:
  IWebSocketMessage  *openMessage;
  IWebSocketFrame    *lastFrame;

  // Process single frame: create a new message from it or append to existing message;
  // when message is complete (all frames received), it's sent to onMessage() handler
  void               processMessageFrame(IWebSocketFrame *frame)
   {
    if(openMessage && !openMessage.isFinalised())
     {
      openMessage.takeFrame(frame);
     }
    else
     {
      openMessage = new WebSocketMessage(frame.isCompressed());
      openMessage.takeFrame(frame);
     }

    if(openMessage && openMessage.isFinalised())
     {
      owner.onMessage(openMessage);
      openMessage = NULL;
     }
   }

  // Handle incoming control frames: sends Pong on Ping and close connection after a Close request
  void               processControlFrame(IWebSocketFrame *frame)
   {
    switch(frame.getType())
     {
      case WS_FRAME_OPCODE::WS_CLOSE_FRAME:
        if(closeRequested) // our close was confirmed
         {
          Print("Server close ack");
         }
        else
          if(!disconnecting) // server initiated close
           {
            if(openMessage) // still not finalized(!)
             {
              owner.onMessage(openMessage);
              openMessage = NULL;
             }

            WebSocketFrame temp(WS_FRAME_OPCODE::WS_CLOSE_FRAME); // send our ack
            sendFrame(&temp);
           }
        close();
        break;
      case WS_FRAME_OPCODE::WS_PING_FRAME:
       {
        IWebSocketFrame *temp = WebSocketFrame::create(WS_FRAME_OPCODE::WS_PONG_FRAME, frame.getData());
        sendFrame(temp);
        delete temp;
       }
      break;
     }
   }

  bool               send(WebSocketMessage *m)
   {
    return sendMessage(m) || disconnect(); // success status
   }

public:
                     WebSocketConnectionHybi(IWebSocketObserver *client, IWebSocketTransport *trans,
                          const bool compression = false): WebSocketConnection(client, trans, compression)
   {
    openMessage = NULL;
    lastFrame = NULL;
   }

                    ~WebSocketConnectionHybi()
   {
    if(CheckPointer(openMessage) == POINTER_DYNAMIC)
      delete openMessage; // incomplete message
    if(CheckPointer(lastFrame) == POINTER_DYNAMIC)
      delete lastFrame; // orphan frame
   }

  static string      randHybiKey()
   {
    uchar chars[16];
    for(int i = 0; i < 16; i++)
     {
      chars[i] = (uchar)(rand() % 256);
     }

    uchar key[];
    uchar encoded[];
    CryptEncode(CRYPT_BASE64, chars, key, encoded);
    return CharArrayToString(encoded);
   }

  bool               handshake(const string url, const string host, const string origin, const string custom = NULL) override
   {
    const string handshakeChallenge = randHybiKey();

    WsTools::push(headers, "GET", url + " HTTP/1.1");
    WsTools::push(headers, "Connection:", "Upgrade");
    WsTools::push(headers, "Host:", host);
    WsTools::push(headers, "Sec-WebSocket-Key:", handshakeChallenge);
    WsTools::push(headers, "Origin:", origin);
    WsTools::push(headers, "Sec-WebSocket-Version:", (string)13);
    WsTools::push(headers, "Upgrade:", "websocket");
    if(deflate)
     {
      WsTools::push(headers, "Sec-WebSocket-Extensions:", "permessage-deflate; server_no_context_takeover; client_no_context_takeover; client_max_window_bits=15; server_max_window_bits=15");//client_max_window_bits; server_max_window_bits=15; client_max_window_bits=15
     }
    return WebSocketConnection::handshake(url, host, origin, custom);
   }

  int                readFrame(IWebSocketFrame *&frames[]) override
   {
    uchar data[];
    bool closed = false;
    const int n = (ArraySize(tail) > 0) ? bufferSwap(tail, data) : readPacketFromNet(data);
    while(ArraySize(data) > 0 && !closed)
     {
      IWebSocketFrame *frame = WebSocketFrame::decode(data, lastFrame);
      if(frame)
       {
        if(frame.isReady())
         {
          if(frame.isControlFrame())
           {
            processControlFrame(frame);
            closed = (frame.getType() == WS_FRAME_OPCODE::WS_CLOSE_FRAME);
            delete frame;
            frame = NULL;
           }
          else
           {
            processMessageFrame(frame);
            if(ArrayIsDynamic(frames))
             {
              WsTools::push(frames, frame);
             }
           }

          lastFrame = NULL;
         }
        else
         {
          lastFrame = frame;
         }
       }
      else
       {
        Print(__FUNCSIG__, " unexpected content - not a valid frame");
        return 0;
       }
     }
    return ArraySize(frames);
   }

  bool               sendString(const string msg) override
   {
    WebSocketMessage m(msg, deflate);
    return send(&m);
   }

  bool               sendData(const uchar &data[]) override
   {
    WebSocketMessage m(data, deflate);
    return send(&m);
   }

  bool               disconnect() override
   {
    WebSocketFrame f(WS_FRAME_OPCODE::WS_CLOSE_FRAME);
    sendFrame(&f);

    int i = 0;
    do
     {
      i++;
      Print("Waiting...");
      Sleep(100);
      checkMessages();
     }
    while(i < 5 && socket.isConnected());

    return false;
   }
 };

//+------------------------------------------------------------------+
//| WebSocket protocol Hixie specific part (not tested in MQL5!)     |
//+------------------------------------------------------------------+
class WebSocketConnectionHixie: public WebSocketConnection
 {
  // In Hixie protocol, a message contains 1 frame always
public:
                     WebSocketConnectionHixie(IWebSocketObserver *client, IWebSocketTransport *trans,
                           const bool = false): WebSocketConnection(client, trans)
   {
   }

  struct HixieKey
   {
    long             number;
    string           key;
   };

  static HixieKey    randHixieKey()
   {
    int spaces_n = rand() % 12 + 1;
    int max_n = INT_MAX / spaces_n;
    int number_n = rand() % max_n;
    long product_n = number_n * spaces_n;
    string key_n = IntegerToString(product_n);
    int range = rand() % 12 + 1;
    for(int i = 0; i < range; i++)
     {
      uchar c;
      if(rand() > 32767 / 2)
       {
        c = (uchar)(rand() % (0x2f + 1 - 0x21 + 1) + 0x21);
       }
      else
       {
        c = (uchar)(rand() % (0x7e + 1 - 0x3a + 1) + 0x3a);
       }
      int len = StringLen(key_n);
      int pos = rand() % len;
      string key_n1 = StringSubstr(key_n, 0, pos);
      string key_n2 = StringSubstr(key_n, pos);
      key_n = key_n1 + (string)c + key_n2;
     }

    for(int i = 0; i < spaces_n; i++)
     {
      int len = StringLen(key_n);
      int pos = rand() % (len - 1) + 1;
      string key_n1 = StringSubstr(key_n, 0, pos);
      string key_n2 = StringSubstr(key_n, pos);
      key_n = key_n1 + " " + key_n2;
     }
    HixieKey result;
    result.number = number_n;
    result.key = key_n;
    return result;
   }

  bool               handshake(const string url, const string host, const string origin, const string custom = NULL) override
   {
    const string hixieKey1 = randHixieKey().key;
    const string hixieKey2 = randHixieKey().key;
    WsTools::push(headers, "GET", url + " HTTP/1.1");
    WsTools::push(headers, "Connection:", "Upgrade");
    WsTools::push(headers, "Host:", host);
    WsTools::push(headers, "Origin:", origin);
    WsTools::push(headers, "Sec-WebSocket-Key1:", hixieKey1);
    WsTools::push(headers, "Sec-WebSocket-Key2:", hixieKey2);
    WsTools::push(headers, "Upgrade:", "websocket");
    return WebSocketConnection::handshake(url, host, origin, custom);
   }

  int                readFrame(IWebSocketFrame *&frames[]) override
   {
    uchar data[];
    const int n = (ArraySize(tail) > 0) ? bufferSwap(tail, data) : readPacketFromNet(data);
    IWebSocketFrame *f = WebSocketFrameHixie::decode(data);
    if(f)
     {
      IWebSocketMessage *m = new WebSocketMessageHixie(f);
      if(m)
       {
        WsTools::push(frames, f);
        owner.onMessage(m); // user code is responsible for message object from now on
        return 1;
       }
     }
    return 0;
   }

  bool               sendString(const string msg) override
   {
    WebSocketMessageHixie m(msg);
    return sendMessage(&m);
   }

  bool               sendData(const uchar &data[]) override
   {
    return false; // not supported
   }

  bool               disconnect() override
   {
    WebSocketFrameHixie f(WS_FRAME_OPCODE::WS_CLOSE_FRAME);
    sendFrame(&f);
    close();
    return false;
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      wsframe.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "wstools.mqh"
#include "wsinterfaces.mqh"

//+------------------------------------------------------------------+
//| WebSocket frame according to Hybi RFC (current standard)         |
//+------------------------------------------------------------------+
class WebSocketFrame: public IWebSocketFrame
 {
protected:
  // first byte
  uchar              FIN;
  uchar              RSV1;
  uchar              RSV2;
  uchar              RSV3;
  WS_FRAME_OPCODE    opcode;

  // second byte
  uchar              mask;
  uint               payloadLength; // NB: this lib supports 32 bit length only

  // if mask is enabled
  uint               maskingKey;

  uchar              payloadData[];
  uint               actualLength;
  /*
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-------+-+-------------+-------------------------------+
    |F|R|R|R| opcode|M| Payload len |    Extended payload length    |
    |I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
    |N|V|V|V|       |S|             |   (if payload len==126/127)   |
    | |1|2|3|       |K|             |                               |
    +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
    |     Extended payload length continued, if payload len == 127  |
    + - - - - - - - - - - - - - - - +-------------------------------+
    |                               |Masking-key, if MASK set to 1  |
    +-------------------------------+-------------------------------+
    | Masking-key (continued)       |          Payload Data         |
    +-------------------------------- - - - - - - - - - - - - - - - +
    :                     Payload Data continued ...                :
    + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
    |                     Payload Data continued ...                |
    +---------------------------------------------------------------+
  */

  void               setType(WS_FRAME_OPCODE type)
   {
    opcode = type;
    if(type == WS_FRAME_OPCODE::WS_CLOSE_FRAME) // needed to make frame larger than 1 byte
     {
      mask = 1;
     }
   }

  static bool        IsBitSet(uchar byte, int pos)
   {
    return (byte & (1 << pos)) > 0;
   }

  static void        rotMask(uchar &data[], uint key, int offset = 0)
   {
    WsTools::BYTES4 u4b(key);
    for(int i = 0; i < ArraySize(data); i++)
     {
      int j = (i + offset) % 4;
      data[i] = (data[i] ^ u4b[j]);
     }
   }

  class Creator1: public IWebSocketFrame::Creator<WebSocketFrame>
   {
   };

  virtual IWebSocketFrame::StaticCreator *getCreator() override
   {
    static Creator1 c1;
    return &c1;
   }

  void               assign(WS_FRAME_OPCODE type, const bool fin, const bool deflate, const int n)
   {
    setType(type);
    FIN = fin;         // TODO: adjust this for continuation frames
    RSV1 = deflate;    // NB: this can be set in the first frame only
    payloadLength = n;
   }

public:
                     WebSocketFrame(WS_FRAME_OPCODE deftype = WS_FRAME_OPCODE::WS_TEXT_FRAME)
   {
    setType(deftype);
    FIN = true;
    RSV1 = 0;
    RSV2 = 0;
    RSV3 = 0;
    mask = WS_APP_TYPE;
    payloadLength = 0;
    maskingKey = 0;
    actualLength = 0;
   }

                    ~WebSocketFrame()
   {
   }

  static IWebSocketFrame *create(WS_FRAME_OPCODE type, const string data = NULL, const bool deflate = false)
   {
    WebSocketFrame *f = new WebSocketFrame();

    const int n = WsTools::StringToByteArray(data, f.payloadData, 0, WHOLE_ARRAY,
                  type == WS_FRAME_OPCODE::WS_TEXT_FRAME && !deflate ? CP_UTF8 : CP_ACP);

    f.assign(type, true, deflate, n);
    return f;
   }

  static IWebSocketFrame *create(WS_FRAME_OPCODE type, const uchar &data[], const bool deflate = false)
   {
    WebSocketFrame *f = new WebSocketFrame();

    const int n = ArrayCopy(f.payloadData, data, 0, 0);

    f.assign(type, true, deflate, n);
    return f;
   }

  bool               isMasked() override
   {
    return mask == 1;
   }

  bool               isCompressed() override
   {
    return RSV1 == 1;
   }

  WS_FRAME_OPCODE    getType() override
   {
    return opcode;
   }

  int                encode(uchar &encoded[]) override
   {
    payloadLength = ArraySize(payloadData);

    uchar firstByte = (uchar)opcode;
    uchar secondByte = 0;

    firstByte += FIN * 128 + RSV1 * 64 + RSV2 * 32 + RSV3 * 16;

    ArrayResize(encoded, 14); // allocate memory for maximal header
    encoded[0] = firstByte;
    int filled = 0;

    if(payloadLength <= 125)
     {
      secondByte = (uchar)payloadLength;
      secondByte += mask * 128;
      encoded[1] = secondByte;
      filled = 2;
     }
    else
      if(payloadLength <= 255 * 255 - 1)
       {
        secondByte = 126;
        secondByte += mask * 128;
        encoded[1] = secondByte;
        WsTools::pack2((ushort)payloadLength, encoded, 2); // 16 bit, big endian byte order
        filled = 4;
       }
      else
       {
        // TODO: max length is now 32 bits instead of 64
        secondByte = 127;
        secondByte += mask * 128;
        encoded[1] = secondByte;
        WsTools::pack4(0, encoded, 2);
        WsTools::pack4(payloadLength, encoded, 6);
        filled = 10;
       }

    uint key = 0;
    if(mask)
     {
      key = ((uint)rand() | ((uint)rand() << 16)) % (4228250625); // rand is 2 bytes wide
      WsTools::pack4(key, encoded, filled);
      filled += 4;
      key = MathSwap(key);
     }

    ArrayResize(encoded, filled + ArraySize(payloadData));

    if(ArraySize(payloadData))
     {
      if(mask == 1)
        rotMask(payloadData, key);
      ArrayCopy(encoded, payloadData, filled);
     }

    return ArraySize(encoded);
   }

  static IWebSocketFrame *decode(uchar &data[], IWebSocketFrame *head = NULL)
   {
    uint remaining = 0;
    uint consumed = 0;

    WebSocketFrame *frame = NULL;
    if(head != NULL)
     {
      frame = head;
      remaining = ArraySize(data);
     }
    else
     {
      if(ArraySize(data) < 2)
       {
        Print("Insufficient data for frame ", ArraySize(data));
        return NULL;
       }

      frame = new WebSocketFrame();

      // read the first two bytes, then chop them off
      uchar firstByte = (uchar)data[0];
      uchar secondByte = (uchar)data[1];

      const uint n = ArraySize(data);

      frame.FIN = IsBitSet(firstByte, 7);
      frame.RSV1 = IsBitSet(firstByte, 6);
      frame.RSV2 = IsBitSet(firstByte, 5);
      frame.RSV3 = IsBitSet(firstByte, 4);
      frame.mask = IsBitSet(secondByte, 7);
      frame.opcode = (WS_FRAME_OPCODE)(firstByte & 0x0F);

      if(!(frame.opcode >= WS_CONTINUATION_FRAME && frame.opcode <= WS_PONG_FRAME))
       {
        Print("Bad frame opcode:" + string(frame.opcode));
       }

      int len = secondByte & ~128;

      if(len <= 125)
       {
        frame.payloadLength = len;
        consumed = 2;
       }
      else
        if(len == 126)
         {
          frame.payloadLength = WsTools::unpack2(data, 2);
          consumed = 4;
         }
        else
          if(len == 127)
           {
            uint h = WsTools::unpack4(data, 2);
            uint l = WsTools::unpack4(data, 6);
            frame.payloadLength = (uint)(l + (h * 0x0100000000));
            consumed = 10;
           }

      if(frame.mask)
       {
        WsTools::BYTES4 u4b(data, consumed);
        frame.maskingKey = u4b.num;
        consumed += 4;
       }
      remaining = n - consumed;
     }

    uint currentOffset = frame.actualLength;
    uint fullLength = MathMin(frame.payloadLength - frame.actualLength, remaining);
    frame.actualLength += fullLength;

    uchar frameData[];
    if(fullLength < remaining) // data contains current frame and beginning of the next frame
     {
      ArrayCopy(frameData, data, 0, consumed, fullLength);
      ArrayCopy(data, data, 0, consumed + fullLength);
      ArrayResize(data, remaining - fullLength);
     }
    else
     {
      ArrayCopy(frameData, data, 0, consumed);
      ArrayResize(data, 0);
     }

    if(frame.mask)
     {
      rotMask(frameData, frame.maskingKey, currentOffset);
     }
    ArrayCopy(frame.payloadData, frameData, ArraySize(frame.payloadData));

    return frame;
   }

  bool               isReady()
   {
    if(actualLength > payloadLength)
     {
      Print("WebSocket frame size mismatch");
      return true;
     }
    return (actualLength == payloadLength);
   }

  bool               isFinal() override
   {
    return FIN == 1;
   }

  string             getData() override
   {
    return CharArrayToString(payloadData, 0, WHOLE_ARRAY, CP_UTF8);
   }

  int                getData(uchar &buf[]) override
   {
    return ArrayCopy(buf, payloadData);
   }
 };

//+------------------------------------------------------------------+
//| WebSocket frame according to Hixie RFC (back compatibility)      |
//+------------------------------------------------------------------+
class WebSocketFrameHixie: public IWebSocketFrame
 {
protected:
  WS_FRAME_OPCODE    opcode;
  string             payloadData;

public:

  class Creator1: public IWebSocketFrame::Creator<WebSocketFrameHixie>
   {
   };

  virtual IWebSocketFrame::StaticCreator *getCreator() override
   {
    static Creator1 c1;
    return &c1;
   }

                     WebSocketFrameHixie(WS_FRAME_OPCODE deftype = WS_FRAME_OPCODE::WS_TEXT_FRAME): opcode(deftype) { }

  static WebSocketFrameHixie *create(WS_FRAME_OPCODE type, const string data = NULL, const bool deflate = false)
   {
    WebSocketFrameHixie *o = new WebSocketFrameHixie();

    o.payloadData = data;

    return o;
   }

  static WebSocketFrameHixie *create(WS_FRAME_OPCODE type, const uchar &data[], const bool deflate = false)
   {
    return NULL; // binary data not supported by design
   }

  int                encode(uchar &encoded[]) override
   {
    if(opcode == WS_FRAME_OPCODE::WS_CLOSE_FRAME)
     {
      static const uchar closing[] = {0xFF, 0x00};
      return ArrayCopy(encoded, closing);
     }
    return WsTools::StringToByteArray(CharToString(0) + payloadData + CharToString(255), encoded);
   }

  string             getData() override
   {
    return payloadData;
   }

  int                getData(uchar &buf[]) override
   {
    return StringToCharArray(payloadData, buf, 0, WHOLE_ARRAY, CP_UTF8);
   }

  WS_FRAME_OPCODE    getType() override
   {
    return opcode;
   }

  static WebSocketFrameHixie *decode(uchar &str[], WebSocketFrameHixie *head = NULL)
   {
    if(ArraySize(str) < 2)
      return NULL;
    if(str[0] == 0 && str[ArraySize(str) - 1] == 255) // NB: frames with 0x01+ first byte not supported here
     {
      WebSocketFrameHixie *o = new WebSocketFrameHixie();
      o.payloadData = CharArrayToString(str, 1, ArraySize(str) - 2, CP_UTF8);
      return o;
     }
    // NB: frames with length prefix (0x80+) not supported here
    return NULL;
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                  wstransport.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "wstools.mqh"
#include "wsinterfaces.mqh"

//+------------------------------------------------------------------+
//| Network processing based on built-in MQL5 Socket-functions       |
//+------------------------------------------------------------------+
class MqlWebSocketTransport: public IWebSocketTransport
 {
protected:
  int                handle;
  uint               timeout;
  bool               TLS;
  bool               connected;

                     MqlWebSocketTransport(const string scheme, const string host, const uint port, const uint t = 1)
   {
    handle = SocketCreate();
    timeout = t;
    TLS = scheme == "wss";
    if(handle != INVALID_HANDLE)
     {
      Print("Connecting to ", host, ":", port);
      if(SocketConnect(handle, host, port, timeout))
       {
        SocketTimeouts(handle, timeout, timeout);

        string subject, issuer, serial, thumbprint;
        datetime expiration;
        if(TLS)
         {
          if(!SocketTlsHandshake(handle, host))
           {
            Print("TLS handshake error: ", _LastError);
            TLS = false;
           }
          else
           {
            Print("TLS enabled");
           }
          if(SocketTlsCertificate(handle, subject, issuer, serial, thumbprint, expiration))
           {
            Print("TLS:");
            Print("  Owner:      ", subject);
            Print("  Issuer:     ", issuer);
            Print("  Number:     ", serial);
            Print("  Signature:  ", thumbprint);
            Print("  Expiration: ", expiration);
           }
         }
       }
      else
       {
        Print("Can't connect: ", GetLastError());
       }
     }
    else
     {
      Print("Can't create socket: ", GetLastError());
     }
   }

                    ~MqlWebSocketTransport()
   {
    SocketClose(handle);
   }

public:
  static MqlWebSocketTransport *create(const string scheme, const string host, const uint port, const uint timeout)
   {
    MqlWebSocketTransport *result = new MqlWebSocketTransport(scheme, host, port, timeout);
    if(result.getHandle() == INVALID_HANDLE)
     {
      Print("Socket create failed: ", _LastError);
      delete result;
      result = NULL;
     }

    return result;
   }

  bool               isConnected(void) const override
   {
    return SocketIsConnected(handle);
   }

  int                getHandle() const override
   {
    return handle;
   }

  int                write(const uchar &buffer[]) override
   {
    if(!SocketIsConnected(handle))
     {
      Print("Can't write to non-connected socket");
      return -1;
     }

    const uint len = ArraySize(buffer);

    int written = 0;
    ResetLastError();

    if(TLS)
     {
      written = SocketTlsSend(handle, buffer, len);
     }
    else
     {
      written = SocketSend(handle, buffer, len);
     }
    return written;
   }

  int                read(uchar &buffer[]) override
   {
    // can be disconnected already but still having data in internal buffer
    if(!SocketIsConnected(handle) && SocketIsReadable(handle) == 0)
     {
      Print("Can't read from non-connected socket");
      return -1;
     }

    ResetLastError();
    ArrayResize(buffer, 0); // ensure buffer is of zero size

    uint available = SocketIsReadable(handle);
    int received = 0;

#ifdef NETWORK_PURGE
    ResetLastError();
    // depending from network conditions it may require to call
    // SocketIsReadable twice in a row!
    // yes, this is ridiculous but may help here
    available = SocketIsReadable(handle);
#endif

    if(!available)
      return 0;
    else
      if(available == !_LastError && TLS)
        return 0;

    if(TLS)
     {
      // SocketIsReadable is not compatible with SocketTlsRead!
      // first returns raw data count, second tries to read clean deciphered bytes count
      received = SocketTlsReadAvailable(handle, buffer, available); // waiting for data (block)
     }
    else
     {
      received = SocketRead(handle, buffer, available, timeout);
     }

    if(received == -1)
     {
      // NB: even if we got -1 result and _LastError = 5273,
      // buffer may contain valid data received before connection was lost/closed
      Print("SocketRead failed: ", _LastError, " Available: ", available);
      if(_LastError == 5273 && available == 1 && !TLS)
        return -1;
     }

    return ArraySize(buffer);
   }

  bool               isReadable(void) const override
   {
    return SocketIsReadable(handle) > 0;
   }

  bool               isWritable(void) const override
   {
    return SocketIsWritable(handle);
   }

  void               close(void) override
   {
    SocketClose(handle);
    handle = INVALID_HANDLE;
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                     wsclient.mqh |
//|                             Copyright 2020-2022, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "..\URL.mqh"
#include "wsframe.mqh";
#include "wsmessage.mqh";
#include "wstransport.mqh"
#include "wsprotocol.mqh"

//+------------------------------------------------------------------+
//| Main WebSocket API for client applications                       |
//+------------------------------------------------------------------+
template<typename T>
class WebSocketClient: public IWebSocketObserver
 {
protected:
  IWebSocketTransport   *socket;
  IWebSocketConnection  *connection;
  IWebSocketMessage     *messages[];

  string             scheme;
  string             host;
  string             port;
  string             origin;
  string             url;

  bool               compression;

  int                timeOut;

public:
                     WebSocketClient(const string address, const bool useCompression = false)
   {
    string parts[];
    URL::parse(address, parts);

    url = address;
    compression = useCompression;
    timeOut = 5000;

    scheme = parts[URL_SCHEME];
    if(scheme != "ws" && scheme != "wss")
     {
      Print("WebSocket invalid url scheme: ", scheme);
      scheme = "ws";
     }

    host = parts[URL_HOST];
    port = parts[URL_PORT];

    origin = (scheme == "wss" ? "https://" : "http://") + host;
   }

                    ~WebSocketClient()
   {
    if(socket)
      delete socket;
    if(connection)
      delete connection;
    if(ArraySize(messages))
     {
      Print("Deleting messages left unhandled");
      for(int i = 0; i < ArraySize(messages); i++)
       {
        delete messages[i];
       }
     }
   }

  bool               isConnected() const
   {
    return socket && socket.isConnected();
   }

  void               setTimeOut(const int ms)
   {
    timeOut = fabs(ms);
   }

  int                getTimeOut() const
   {
    return timeOut;
   }

  //+------------------------------------------------------------------+
  //| Default event handlers: to redefine them - create a derived class|
  //+------------------------------------------------------------------+
  void               onDisconnect() override
   {
    Print(" > Disconnected ", url);
   }

  void               onConnected() override
   {
    Print(" > Connected ", url);
   }

  void               onMessage(IWebSocketMessage *msg) override
   {
    // NB: message can be binary, logging as string is just for informing you
    Print(" > Message ", url, " ", msg.getString());
    WsTools::push(messages, msg);
   }

  //+------------------------------------------------------------------+
  //| Main public methods                                              |
  //+------------------------------------------------------------------+
  bool               open(const string custom_headers = NULL)
   {
    uint _port = (uint)StringToInteger(port);
    if(_port == 0)
     {
      if(scheme == "ws")
        _port = 80;
      else
        _port = 443;
     }

    socket = MqlWebSocketTransport::create(scheme, host, _port, timeOut);
    if(!socket || !socket.isConnected())
     {
      return false;
     }

    connection = new T(&this, socket, compression);
    return connection.handshake(url, host, origin, custom_headers);
   }

  bool               send(const string str)
   {
    return connection ? connection.sendString(str) : false;
   }

  bool               send(const uchar &data[])
   {
    return connection ? connection.sendData(data) : false;
   }

  bool               sendMessage(IWebSocketMessage *msg)
   {
    return connection ? connection.sendMessage(msg) : false;
   }

  bool               sendFrame(IWebSocketFrame *frame)
   {
    return connection ? connection.sendFrame(frame) : false;
   }

  void               checkMessages(const bool blocking = true)
   {
    if(connection == NULL)
      return;

    uint stop = GetTickCount() + (blocking ? timeOut : 1);
    while(ArraySize(messages) == 0 && GetTickCount() < stop && isConnected())
     {
      // all frames are collected into corresponding messages (onMessage)
      // except for control frames, which are already processed and discarded
      if(!connection.checkMessages())
       {
        Sleep(100);
       }
     }
   }

  IWebSocketMessage  *readMessage(const bool blocking = true)
   {
    if(ArraySize(messages) == 0)
      checkMessages(blocking);

    if(ArraySize(messages) > 0)
     {
      IWebSocketMessage *top = messages[0];
      ArrayRemove(messages, 0, 1);
      return top;
     }
    return NULL;
   }

  void               close()
   {
    if(isConnected())
     {
      if(connection)
       {
        connection.disconnect(); // this closes socket internally after server ack
        delete connection;
        connection = NULL;
       }
      if(socket)
       {
        delete socket;
        socket = NULL;
       }
     }
   }
 };
//+------------------------------------------------------------------+
-e 

//+----------------------------------------------------------------------------+
//|                                                              mql4-http.mqh |
//+----------------------------------------------------------------------------+
//|                                                      Built by Sergey Lukin |
//|                                                    contact@sergeylukin.com |
//|                                                                            |
//| This libarry is highly based on following:                                 |
//|                                                                            |
//| - HTTP Wininet sample: http://codebase.mql4.com/8115                       |
//| - EasyXML parser: http://www.mql5.com/code/1998                            |
//|                                                                            |
//+----------------------------------------------------------------------------+

#import "shell32.dll"
int ShellExecuteW(
  int hwnd,
  string Operation,
  string File,
  string Parameters,
  string Directory,
  int ShowCmd
);
#import

#import "wininet.dll"
int InternetOpenW(
  string     sAgent,
  int        lAccessType,
  string     sProxyName = "",
  string     sProxyBypass = "",
  int     lFlags = 0
);
int InternetOpenUrlW(
  int     hInternetSession,
  string     sUrl,
  string     sHeaders = "",
  int     lHeadersLength = 0,
  uint     lFlags = 0,
  int     lContext = 0
);
int InternetReadFile(
  int     hFile,
  uchar  &   sBuffer[],
  int     lNumBytesToRead,
  int&     lNumberOfBytesRead
);
int InternetCloseHandle(
  int     hInet
);
#import

#define INTERNET_FLAG_RELOAD            0x80000000
#define INTERNET_FLAG_NO_CACHE_WRITE    0x04000000
#define INTERNET_FLAG_PRAGMA_NOCACHE    0x00000100

int hSession_IEType;
int hSession_Direct;
int Internet_Open_Type_Preconfig = 0;
int Internet_Open_Type_Direct = 1;

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
int hSession(bool Direct)
 {
  string InternetAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; Q312461)";

  if(Direct)
   {
    if(hSession_Direct == 0)
     {
      hSession_Direct = InternetOpenW(InternetAgent, Internet_Open_Type_Direct, "0", "0", 0);
     }

    return(hSession_Direct);
   }
  else
   {
    if(hSession_IEType == 0)
     {
      hSession_IEType = InternetOpenW(InternetAgent, Internet_Open_Type_Preconfig, "0", "0", 0);
     }

    return(hSession_IEType);
   }
 }

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string httpGET(string strUrl)
 {
  int handler = hSession(false);
  int response = InternetOpenUrlW(handler, strUrl, NULL, 0,
                                  INTERNET_FLAG_NO_CACHE_WRITE |
                                  INTERNET_FLAG_PRAGMA_NOCACHE |
                                  INTERNET_FLAG_RELOAD, 0);
  if(response == 0)
    return("");

  uchar ch[100];
  string toStr = "";
  int dwBytes, h = -1;
  while(InternetReadFile(response, ch, 100, dwBytes))
   {
    if(dwBytes <= 0)
      break;
    toStr = toStr + CharArrayToString(ch, 0, dwBytes);
   }

  InternetCloseHandle(response);
  return toStr;
 }

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void httpOpen(string strUrl)
 {
  shell32::ShellExecuteW(0, "open", strUrl, "", "", 3);
 }
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                           D a t a b a s e . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   v e r s i o n       " 1 . 1 3 . 0 "  
 # p r o p e r t y   s t r i c t  
  
 # i f d e f   D E B U G  
 # d e f i n e   D E B U G _ P R I N T _ K E Y   P r i n t ( k e y + "   " + s t r i n g ( _ _ L I N E _ _ ) ) ;  
 # e l s e  
 # d e f i n e   D E B U G _ P R I N T _ K E Y  
 # e n d i f  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   e n u m   e n J A T y p e  
 e n u m   e n J A T y p e   {   j t U N D E F ,   j t N U L L ,   j t B O O L ,   j t I N T ,   j t D B L ,   j t S T R ,   j t A R R A Y ,   j t O B J   } ;  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   c l a s s   C J A V a l  
 c l a s s   C J A V a l  
   {  
  
 p u b l i c :  
     C J A V a l                           c h i l d r e n [ ] ;  
     s t r i n g                           k e y ;  
     s t r i n g                           l _ k e y ;  
     C J A V a l *                         p a r e n t ;  
     e n J A T y p e                       t y p e ;  
  
     b o o l                               b o o l _ v ;  
     l o n g                               i n t _ v ;  
     d o u b l e                           d b l _ v ;  
     i n t                                 d b l _ p r e c i s i o n ;  
     s t r i n g                           s t r _ v ;  
  
     s t a t i c   i n t                   c o d e _ p a g e ;  
  
     / /   c o n s t r u c t o r s   &   d e s t r u c t o r  
                                           C J A V a l ( )  
       {  
         C l e a r ( ) ;  
       }  
  
                                           C J A V a l ( C J A V a l *   a _ p a r e n t ,   e n J A T y p e   a _ t y p e )  
       {  
         C l e a r ( ) ;  
         t y p e   =   a _ t y p e ;  
         p a r e n t   =   a _ p a r e n t ;  
       }  
  
                                           C J A V a l ( e n J A T y p e   t ,   s t r i n g   s t r )  
       {  
         C l e a r ( ) ;  
         F r o m S t r ( t ,   s t r ) ;  
       }  
  
                                           C J A V a l ( c o n s t   i n t   v )  
       {  
         C l e a r ( ) ;  
         t y p e   =   j t I N T ;  
         i n t _ v   =   v ;  
         d b l _ v   =   ( d o u b l e ) i n t _ v ;  
         s t r _ v   =   I n t e g e r T o S t r i n g ( i n t _ v ) ;  
         b o o l _ v   =   i n t _ v   ! =   0 ;  
       }  
  
                                           C J A V a l ( c o n s t   l o n g   v )  
       {  
         C l e a r ( ) ;  
         t y p e   =   j t I N T ;  
         i n t _ v   =   v ;  
         d b l _ v   =   ( d o u b l e ) i n t _ v ;  
         s t r _ v   =   I n t e g e r T o S t r i n g ( i n t _ v ) ;  
         b o o l _ v   =   i n t _ v   ! =   0 ;  
       }  
  
                                           C J A V a l ( c o n s t   d o u b l e   v ,   i n t   p r e c i s i o n   =   - 1 0 0 )  
       {  
         C l e a r ( ) ;  
         t y p e   =   j t D B L ;  
         d b l _ v   =   v ;  
         i f ( p r e c i s i o n   >   - 1 0 0 )  
             d b l _ p r e c i s i o n   =   p r e c i s i o n ;  
         i n t _ v   =   ( l o n g ) d b l _ v ;  
         s t r _ v   =   D o u b l e T o S t r i n g ( d b l _ v ,   d b l _ p r e c i s i o n ) ;  
         b o o l _ v   =   i n t _ v   ! =   0 ;  
       }  
  
                                           C J A V a l ( c o n s t   b o o l   v )  
       {  
         C l e a r ( ) ;  
         t y p e   =   j t B O O L ;  
         b o o l _ v   =   v ;  
         i n t _ v   =   b o o l _ v ;  
         d b l _ v   =   b o o l _ v ;  
         s t r _ v   =   I n t e g e r T o S t r i n g ( i n t _ v ) ;  
       }  
  
                                           C J A V a l ( c o n s t   C J A V a l &   a )  
       {  
         C l e a r ( ) ;  
         C o p y ( a ) ;  
       }  
  
                                         ~ C J A V a l ( )   {   C l e a r ( ) ;   }  
  
     / /   - - -   M E T H O D S   - - -  
     i n t                                 S i z e ( )   {   r e t u r n   A r r a y S i z e ( c h i l d r e n ) ;   }  
  
     v i r t u a l   b o o l               I s N u m e r i c ( )  
       {  
         r e t u r n   t y p e   = =   j t D B L   | |   t y p e   = =   j t I N T ;  
       }  
  
     v i r t u a l   v o i d               C l e a r ( e n J A T y p e   j t   =   j t U N D E F ,   b o o l   s a v e _ k e y   =   f a l s e )  
       {  
         p a r e n t   =   N U L L ;  
         i f ( ! s a v e _ k e y )  
             k e y   =   " " ;  
         t y p e   =   j t ;  
         b o o l _ v   =   f a l s e ;  
         i n t _ v   =   0 ;  
         d b l _ v   =   0 ;  
         d b l _ p r e c i s i o n   =   8 ;  
         s t r _ v   =   " " ;  
         A r r a y R e s i z e ( c h i l d r e n ,   0 ,   1 0 0 ) ;  
       }  
  
     / /   -   c o p y   -  
     v i r t u a l   b o o l               C o p y ( c o n s t   C J A V a l   & a )  
       {  
         i f ( k e y   = =   " " )  
             k e y   =   a . k e y ;  
         C o p y D a t a ( a ) ;  
         r e t u r n   t r u e ;  
       }  
  
     v i r t u a l   v o i d               C o p y D a t a ( c o n s t   C J A V a l &   a )  
       {  
         t y p e   =   a . t y p e ;  
         b o o l _ v   =   a . b o o l _ v ;  
         i n t _ v   =   a . i n t _ v ;  
         d b l _ v   =   a . d b l _ v ;  
         d b l _ p r e c i s i o n   =   a . d b l _ p r e c i s i o n ;  
         s t r _ v   =   a . s t r _ v ;  
         C o p y A r r ( a ) ;  
       }  
  
     v i r t u a l   v o i d               C o p y A r r ( c o n s t   C J A V a l &   a )  
       {  
         i n t   n   =   A r r a y R e s i z e ( c h i l d r e n ,   A r r a y S i z e ( a . c h i l d r e n ) ) ;  
         f o r ( i n t   i   =   0 ;   i   <   n ;   i + + )  
           {  
             c h i l d r e n [ i ]   =   a . c h i l d r e n [ i ] ;  
             c h i l d r e n [ i ] . p a r e n t   =   G e t P o i n t e r ( t h i s ) ;  
           }  
       }  
  
     / /   -   s e a r c h   -  
     v i r t u a l   C J A V a l *         F i n d K e y ( s t r i n g   a _ k e y )  
       {  
         f o r ( i n t   i   =   S i z e ( )   -   1 ;   i   > =   0 ;   - - i )  
             i f ( c h i l d r e n [ i ] . k e y   = =   a _ k e y )  
                 r e t u r n   G e t P o i n t e r ( c h i l d r e n [ i ] ) ;  
  
         r e t u r n   N U L L ;  
       }  
  
     v i r t u a l   b o o l               H a s K e y ( s t r i n g   a _ k e y ,   e n J A T y p e   a _ t y p e   =   j t U N D E F )  
       {  
         C J A V a l *   e   =   F i n d K e y ( a _ k e y ) ;  
  
         i f ( C h e c k P o i n t e r ( e )   ! =   P O I N T E R _ I N V A L I D   & &   ( a _ t y p e   = =   j t U N D E F   | |   a _ t y p e   = =   e . t y p e ) )  
             r e t u r n   t r u e ;  
  
         r e t u r n   f a l s e ;  
       }  
  
     / /   -   g e t   &   a s s i g n m e n t s   -  
     v i r t u a l   C J A V a l *         o p e r a t o r [ ] ( s t r i n g   a _ k e y ) ;  
     v i r t u a l   C J A V a l *         o p e r a t o r [ ] ( i n t   i ) ;  
  
     v o i d                               o p e r a t o r = ( c o n s t   C J A V a l   & a )  
       {  
         C o p y ( a ) ;  
       }  
  
     v o i d                               o p e r a t o r = ( c o n s t   i n t   v )  
       {  
         t y p e   =   j t I N T ;  
         i n t _ v   =   v ;  
         d b l _ v   =   ( d o u b l e ) i n t _ v ;  
         b o o l _ v   =   i n t _ v   ! =   0 ;  
       }  
  
     v o i d                               o p e r a t o r = ( c o n s t   l o n g   v )  
       {  
         t y p e   =   j t I N T ;  
         i n t _ v   =   v ;  
         d b l _ v   =   ( d o u b l e ) i n t _ v ;  
         b o o l _ v   =   i n t _ v   ! =   0 ;  
       }  
  
     v o i d                               o p e r a t o r = ( c o n s t   d o u b l e   v )  
       {  
         t y p e   =   j t D B L ;  
         d b l _ v   =   v ;  
         i n t _ v   =   ( l o n g ) d b l _ v ;  
         b o o l _ v   =   i n t _ v   ! =   0 ;  
       }  
     v o i d                               o p e r a t o r = ( c o n s t   b o o l   v )  
       {  
         t y p e   =   j t B O O L ;  
         b o o l _ v   =   v ;  
         i n t _ v   =   ( l o n g ) b o o l _ v ;  
         d b l _ v   =   ( d o u b l e ) b o o l _ v ;  
       }  
  
     v o i d                               o p e r a t o r = ( s t r i n g   v )  
       {  
         t y p e   =   ( v   ! =   N U L L )   ?   j t S T R   :   j t N U L L ;  
         s t r _ v   =   v ;  
         i n t _ v   =   S t r i n g T o I n t e g e r ( s t r _ v ) ;  
         d b l _ v   =   S t r i n g T o D o u b l e ( s t r _ v ) ;  
         b o o l _ v   =   v   ! =   N U L L ;  
       }  
  
     / /   -   c o m p a r a s i o n s   -  
     b o o l                               o p e r a t o r = = ( c o n s t   i n t   v )   { r e t u r n   i n t _ v   = =   v ;   }  
     b o o l                               o p e r a t o r = = ( c o n s t   l o n g   v )   {   r e t u r n   i n t _ v   = =   v ;   }  
     b o o l                               o p e r a t o r = = ( c o n s t   d o u b l e   v )   {   r e t u r n   d b l _ v   = =   v ;   }  
     b o o l                               o p e r a t o r = = ( c o n s t   b o o l   v )   {   r e t u r n   b o o l _ v   = =   v ;   }  
     b o o l                               o p e r a t o r = = ( s t r i n g   v )   {   r e t u r n   s t r _ v   = =   v ;   }  
  
     b o o l                               o p e r a t o r ! = ( c o n s t   i n t   v )   {   r e t u r n   i n t _ v   ! =   v ;   }  
     b o o l                               o p e r a t o r ! = ( c o n s t   l o n g   v )   {   r e t u r n   i n t _ v   ! =   v ;   }  
     b o o l                               o p e r a t o r ! = ( c o n s t   d o u b l e   v )   {   r e t u r n   d b l _ v   ! =   v ;   }  
     b o o l                               o p e r a t o r ! = ( c o n s t   b o o l   v )   {   r e t u r n   b o o l _ v   ! =   v ;   }  
     b o o l                               o p e r a t o r ! = ( s t r i n g   v )   {   r e t u r n   s t r _ v   ! =   v ;   }  
  
     / /   -   t o   f o r m a t s   -  
     l o n g                               T o I n t ( )   c o n s t   {   r e t u r n   i n t _ v ;   }  
     d o u b l e                           T o D b l ( )   c o n s t   {   r e t u r n   d b l _ v ;   }  
     b o o l                               T o B o o l ( )   c o n s t   {   r e t u r n   b o o l _ v ;   }  
     s t r i n g                           T o S t r ( )   {   r e t u r n   s t r _ v ;   }  
  
     / /   -   f r o m   /   g e t   s t r   -  
     v i r t u a l   v o i d               F r o m S t r ( e n J A T y p e   t ,   s t r i n g   s t r )  
       {  
         t y p e   =   t ;  
         s w i t c h ( t y p e )  
           {  
             c a s e   j t B O O L :  
                 b o o l _ v   =   ( S t r i n g T o I n t e g e r ( s t r )   ! =   0 ) ;  
                 i n t _ v   =   ( l o n g ) b o o l _ v ;  
                 d b l _ v   =   ( d o u b l e ) b o o l _ v ;  
                 s t r _ v   =   s t r ;  
                 b r e a k ;  
             c a s e   j t I N T :  
                 i n t _ v   =   S t r i n g T o I n t e g e r ( s t r ) ;  
                 d b l _ v   =   ( d o u b l e ) i n t _ v ;  
                 s t r _ v   =   s t r ;  
                 b o o l _ v   =   i n t _ v   ! =   0 ;  
                 b r e a k ;  
             c a s e   j t D B L :  
                 d b l _ v   =   S t r i n g T o D o u b l e ( s t r ) ;  
                 i n t _ v   =   ( l o n g ) d b l _ v ;  
                 s t r _ v   =   s t r ;  
                 b o o l _ v   =   i n t _ v   ! =   0 ;  
                 b r e a k ;  
             c a s e   j t S T R :  
                 s t r _ v   =   U n e s c a p e ( s t r ) ;  
                 t y p e   =   ( s t r _ v   ! =   N U L L )   ?   j t S T R   :   j t N U L L ;  
                 i n t _ v   =   S t r i n g T o I n t e g e r ( s t r _ v ) ;  
                 d b l _ v   =   S t r i n g T o D o u b l e ( s t r _ v ) ;  
                 b o o l _ v   =   s t r _ v   ! =   N U L L ;  
                 b r e a k ;  
           }  
       }  
  
     v i r t u a l   s t r i n g           G e t S t r ( c h a r &   j s o n [ ] ,   i n t   i ,   i n t   l e n )  
       {  
         i f ( l e n   = =   0 )  
             r e t u r n   " " ;  
         r e t u r n   C h a r A r r a y T o S t r i n g ( j s o n ,   i ,   l e n ,   C J A V a l : : c o d e _ p a g e ) ;  
       }  
  
     / /   -   S e t   m e t h o d s   -  
     v i r t u a l   v o i d               S e t ( c o n s t   C J A V a l &   a )  
       {  
         i f ( t y p e   = =   j t U N D E F )  
             t y p e   =   j t O B J ;  
         C o p y D a t a ( a ) ;  
       }  
  
     v i r t u a l   v o i d               S e t ( c o n s t   C J A V a l &   l i s t [ ] )  
       {  
         i f ( t y p e   = =   j t U N D E F )  
             t y p e   =   j t A R R A Y ;  
         i n t   n   =   A r r a y R e s i z e ( c h i l d r e n ,   A r r a y S i z e ( l i s t ) ,   1 0 0 ) ;  
         f o r ( i n t   i   =   0 ;   i   <   n ;   + + i )  
           {  
             c h i l d r e n [ i ]   =   l i s t [ i ] ;  
             c h i l d r e n [ i ] . p a r e n t   =   G e t P o i n t e r ( t h i s ) ;  
           }  
       }  
  
     / /   -   A d d   m e t h o d s   -  
     v i r t u a l   C J A V a l *         A d d ( c o n s t   C J A V a l &   i t e m )         / /   a d d i n g  
       {  
         i f ( t y p e   = =   j t U N D E F )  
             t y p e   =   j t A R R A Y ;  
         / * A S S E R T ( t y p e   = =   j t O B J   | |   t y p e   = =   j t A R R A Y ) ; * /  
         r e t u r n   A d d B a s e ( i t e m ) ;  
       }  
  
     v i r t u a l   C J A V a l *         A d d ( c o n s t   i n t   v )  
       {  
         C J A V a l   i t e m ( v ) ;  
         r e t u r n   A d d ( i t e m ) ;  
       }  
  
     v i r t u a l   C J A V a l *         A d d ( c o n s t   l o n g   v )  
       {  
         C J A V a l   i t e m ( v ) ;  
         r e t u r n   A d d ( i t e m ) ;  
       }  
  
     v i r t u a l   C J A V a l *         A d d ( c o n s t   d o u b l e   v ,   i n t   p r e c i s i o n   =   - 2 )  
       {  
         C J A V a l   i t e m ( v ,   p r e c i s i o n ) ;  
         r e t u r n   A d d ( i t e m ) ;  
       }  
  
     v i r t u a l   C J A V a l *         A d d ( c o n s t   b o o l   v )  
       {  
         C J A V a l   i t e m ( v ) ;  
         r e t u r n   A d d ( i t e m ) ;  
       }  
  
     v i r t u a l   C J A V a l *         A d d ( s t r i n g   v )  
       {  
         C J A V a l   i t e m ( j t S T R ,   v ) ;  
         r e t u r n   A d d ( i t e m ) ;  
       }  
  
     / /   -   h e l p e r   a d d i n g   m e t h o d s   -  
     v i r t u a l   C J A V a l *         A d d B a s e ( c o n s t   C J A V a l   & i t e m )  
       {  
         i n t   c   =   S i z e ( ) ;  
         A r r a y R e s i z e ( c h i l d r e n ,   c   +   1 ,   1 0 0 ) ;  
         c h i l d r e n [ c ]   =   i t e m ;  
         c h i l d r e n [ c ] . p a r e n t   =   G e t P o i n t e r ( t h i s ) ;  
         r e t u r n   G e t P o i n t e r ( c h i l d r e n [ c ] ) ;  
       }  
  
     v i r t u a l   C J A V a l *         N e w ( )  
       {  
         i f ( t y p e   = =   j t U N D E F )  
             t y p e   =   j t A R R A Y ;  
         / * A S S E R T ( t y p e   = =   j t O B J   | |   t y p e   = =   j t A R R A Y ) ; * /  
         r e t u r n   N e w B a s e ( ) ;  
       }  
  
     v i r t u a l   C J A V a l *         N e w B a s e ( )  
       {  
         i n t   c   =   S i z e ( ) ;  
         A r r a y R e s i z e ( c h i l d r e n ,   c   +   1 ,   1 0 0 ) ;  
         r e t u r n   G e t P o i n t e r ( c h i l d r e n [ c ] ) ;  
       }  
  
     / /   -   E s c a p e   &   U n e s c a p e   -  
     v i r t u a l   s t r i n g           E s c a p e ( s t r i n g   v ) ;  
     v i r t u a l   s t r i n g           U n e s c a p e ( s t r i n g   v ) ;  
  
     / /   -   s e r i a l i z e s   &   d e s e r i a l i z e s   -  
     v i r t u a l   v o i d               S e r i a l i z e ( s t r i n g   & j s o n ,   b o o l   i s _ k e y   =   f a l s e ,   b o o l   u s e _ c o m m a   =   f a l s e ) ;  
  
     v i r t u a l   s t r i n g           S e r i a l i z e ( )  
       {  
         s t r i n g   j s o n ;  
         S e r i a l i z e ( j s o n ) ;  
         r e t u r n   j s o n ;  
       }  
  
     v i r t u a l   b o o l               D e s e r i a l i z e ( c h a r &   j s o n [ ] ,   i n t   l e n ,   i n t   & i ) ;  
     v i r t u a l   b o o l               E x t r S t r ( c h a r &   j s o n [ ] ,   i n t   l e n ,   i n t   & i ) ;  
  
     v i r t u a l   b o o l               D e s e r i a l i z e ( s t r i n g   j s o n ,   i n t   a c p   =   C P _ A C P )  
       {  
         i n t   i   =   0 ;  
         C l e a r ( ) ;  
         C J A V a l : : c o d e _ p a g e   =   a c p ;  
         c h a r   a r r [ ] ;  
         i n t   l e n   =   S t r i n g T o C h a r A r r a y ( j s o n ,   a r r ,   0 ,   W H O L E _ A R R A Y ,   C J A V a l : : c o d e _ p a g e ) ;  
         r e t u r n   D e s e r i a l i z e ( a r r ,   l e n ,   i ) ;  
       }  
  
     v i r t u a l   b o o l               D e s e r i a l i z e ( c h a r &   j s o n [ ] ,   i n t   a c p   =   C P _ A C P )  
       {  
         i n t   i   =   0 ;  
         C l e a r ( ) ;  
         C J A V a l : : c o d e _ p a g e   =   a c p ;  
         r e t u r n   D e s e r i a l i z e ( j s o n ,   A r r a y S i z e ( j s o n ) ,   i ) ;  
       }  
   } ;  
  
 i n t   C J A V a l : : c o d e _ p a g e   =   C P _ A C P ;  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   o p e r a t o r [ ]  
 C J A V a l *   C J A V a l : : o p e r a t o r [ ] ( s t r i n g   a _ k e y )  
   {  
     i f ( t y p e   = =   j t U N D E F )  
         t y p e   =   j t O B J ;  
     C J A V a l *   v   =   F i n d K e y ( a _ k e y ) ;  
     i f ( v )  
         r e t u r n   v ;  
  
     C J A V a l   b ( G e t P o i n t e r ( t h i s ) ,   j t U N D E F ) ;  
     b . k e y   =   a _ k e y ;  
     v   =   A d d ( b ) ;  
     r e t u r n   v ;  
   }  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   o p e r a t o r [ ]  
 C J A V a l *   C J A V a l : : o p e r a t o r [ ] ( i n t   i )  
   {  
     i f ( t y p e   = =   j t U N D E F )  
         t y p e   =   j t A R R A Y ;  
     w h i l e ( i   > =   S i z e ( ) )  
       {  
         C J A V a l   b ( G e t P o i n t e r ( t h i s ) ,   j t U N D E F ) ;  
  
         i f ( C h e c k P o i n t e r ( A d d ( b ) )   = =   P O I N T E R _ I N V A L I D )  
             r e t u r n   N U L L ;  
       }  
     r e t u r n   G e t P o i n t e r ( c h i l d r e n [ i ] ) ;  
   }  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   S e r i a l i z e  
 v o i d   C J A V a l : : S e r i a l i z e ( s t r i n g &   j s o n ,   b o o l   i s _ k e y / * = f a l s e * / ,   b o o l   u s e _ c o m m a / * = f a l s e * / )  
   {  
     i f ( t y p e   = =   j t U N D E F )  
         r e t u r n ;  
     i f ( u s e _ c o m m a )  
         j s o n   + =   " , " ;  
     i f ( i s _ k e y )  
         j s o n   + =   S t r i n g F o r m a t ( " \ " % s \ " : " ,   k e y ) ;  
  
     i n t   _ n   =   S i z e ( ) ;  
  
     s w i t c h ( t y p e )  
       {  
         c a s e   j t N U L L :  
             j s o n   + =   " n u l l " ;  
             b r e a k ;  
         c a s e   j t B O O L :  
             j s o n   + =   ( b o o l _ v   ?   " t r u e "   :   " f a l s e " ) ;  
             b r e a k ;  
         c a s e   j t I N T :  
             j s o n   + =   I n t e g e r T o S t r i n g ( i n t _ v ) ;  
             b r e a k ;  
         c a s e   j t D B L :  
             j s o n   + =   D o u b l e T o S t r i n g ( d b l _ v ,   d b l _ p r e c i s i o n ) ;  
             b r e a k ;  
         c a s e   j t S T R :  
           {   s t r i n g   s s   =   E s c a p e ( s t r _ v ) ;   i f ( S t r i n g L e n ( s s )   >   0 )   j s o n   + =   S t r i n g F o r m a t ( " \ " % s \ " " ,   s s ) ;   e l s e   j s o n   + =   " n u l l " ;   }  
         b r e a k ;  
         c a s e   j t A R R A Y :  
             j s o n   + =   " [ " ;  
             f o r ( i n t   i   =   0 ;   i   <   _ n ;   i + + )  
                 c h i l d r e n [ i ] . S e r i a l i z e ( j s o n ,   f a l s e ,   i   >   0 ) ;  
             j s o n   + =   " ] " ;  
             b r e a k ;  
         c a s e   j t O B J :  
             j s o n   + =   " { " ;  
             f o r ( i n t   i   =   0 ;   i   <   _ n ;   i + + )  
                 c h i l d r e n [ i ] . S e r i a l i z e ( j s o n ,   t r u e ,   i   >   0 ) ;  
             j s o n   + =   " } " ;  
             b r e a k ;  
       }  
   }  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   D e s e r i a l i z e  
 b o o l   C J A V a l : : D e s e r i a l i z e ( c h a r &   j s o n [ ] ,   i n t   l e n ,   i n t   & i )  
   {  
     s t r i n g   n u m   =   " 0 1 2 3 4 5 6 7 8 9 + - . e E " ;  
     i n t   i 0   =   i ;  
     f o r ( ;   i   <   l e n ;   i + + )  
       {  
         c h a r   c   =   j s o n [ i ] ;  
         i f ( c   = =   0 )  
             b r e a k ;  
  
         s w i t c h ( c )  
           {  
             / /   m i s s   s p a c e s   f r o m   n a m e  
             c a s e   ' \ t ' :  
             c a s e   ' \ r ' :  
             c a s e   ' \ n ' :  
             c a s e   '   ' :  
               {  
                 i 0   =   i   +   1 ;  
                 b r e a k ;  
               }  
  
             / /   t h e   b e g i n n i n g   o f   t h e   a r r a y .   c r e a t e   o b j e c t s   a n d   t a k e   t h e m   f r o m   j s o n  
             c a s e   ' [ ' :  
               {  
                 i 0   =   i   +   1 ;  
                 i f ( t y p e   ! =   j t U N D E F )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;     / /   i f   v a l u e   a l r e a d y   h a s   t y p e ,   t h e n   t h i s   i s   a n   e r r o r  
                     r e t u r n   f a l s e ;  
                   }  
  
                 t y p e   =   j t A R R A Y ;     / /   s e t   t h e   v a l u e   t y p e  
                 i + + ;  
                 C J A V a l   v a l ( G e t P o i n t e r ( t h i s ) ,   j t U N D E F ) ;  
                 w h i l e ( v a l . D e s e r i a l i z e ( j s o n ,   l e n ,   i ) )  
                   {  
                     i f ( v a l . t y p e   ! =   j t U N D E F )  
                         A d d ( v a l ) ;  
                     i f ( v a l . t y p e   = =   j t I N T   | |   v a l . t y p e   = =   j t D B L   | |   v a l . t y p e   = =   j t A R R A Y )  
                         i + + ;  
                     v a l . C l e a r ( ) ;  
                     v a l . p a r e n t   =   G e t P o i n t e r ( t h i s ) ;  
                     i f ( j s o n [ i ]   = =   ' ] ' )  
                         b r e a k ;  
                     i + + ;  
                     i f ( i   > =   l e n )  
                       {  
                         D E B U G _ P R I N T _ K E Y ;  
                         r e t u r n   f a l s e ;  
                       }  
                   }  
                 r e t u r n   j s o n [ i ]   = =   ' ] '   | |   j s o n [ i ]   = =   0 ;  
  
                 b r e a k ;  
               }  
  
             / /   e n d   o f   a r r a y ,   c u r r e n t   v a l u e   m u s t   b e   a n   a r r a y  
             c a s e   ' ] ' :  
               {  
                 i f ( ! p a r e n t )  
                     r e t u r n   f a l s e ;  
  
                 r e t u r n   p a r e n t . t y p e   = =   j t A R R A Y ;  
               }  
  
             c a s e   ' : ' :  
               {  
                 i f ( l _ k e y   = =   " " )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;  
                     r e t u r n   f a l s e ;  
                   }  
  
                 C J A V a l   v a l ( G e t P o i n t e r ( t h i s ) ,   j t U N D E F ) ;  
                 C J A V a l   * o c   =   A d d ( v a l ) ;     / /   o b j e c t   t y p e   n o t   y e t   d e f i n e d  
                 o c . k e y   =   l _ k e y ;  
                 l _ k e y   =   " " ;     / /   s e t   n a m e   o f   k e y  
                 i + + ;  
                 i f ( ! o c . D e s e r i a l i z e ( j s o n ,   l e n ,   i ) )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;  
                     r e t u r n   f a l s e ;  
                   }  
                 b r e a k ;  
               }  
  
             / /   d e l i m i t e r ;   t h e   v a l u e   t y p e   m u s t   a l r e a d y   b e   d e f i n e d  
             c a s e   ' , ' :  
               {  
                 i 0   =   i   +   1 ;  
                 i f ( ! p a r e n t   & &   t y p e   ! =   j t O B J )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;  
                     r e t u r n   f a l s e ;  
                   }  
                 e l s e  
                     i f ( p a r e n t )  
                       {  
                         i f ( p a r e n t . t y p e   ! =   j t A R R A Y   & &   p a r e n t . t y p e   ! =   j t O B J )  
                           {  
                             D E B U G _ P R I N T _ K E Y ;  
                             r e t u r n   f a l s e ;  
                           }  
                         i f ( p a r e n t . t y p e   = =   j t A R R A Y   & &   t y p e   = =   j t U N D E F )  
                             r e t u r n   t r u e ;  
                       }  
                 b r e a k ;  
               }  
  
             / /   -   p r i m i t i v e s   c a n   O N L Y   b e   i n   a n   a r r a y   /   o r   o n   t h e i r   o w n   -  
             / /   b e g i n n i n g   o f   t h e   o b j e c t .   C r e a t e   a n   o b j e c t   a n d   f e t c h   i t   f r o m   j s o n  
             c a s e   ' { ' :  
               {  
                 i 0   =   i   +   1 ;  
                 i f ( t y p e   ! =   j t U N D E F )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;     / /   t y p e   e r r o r  
                     r e t u r n   f a l s e ;  
                   }  
                 t y p e   =   j t O B J ;     / /   s e t   t h e   v a l u e   t y p e  
                 i + + ;  
                 i f ( ! D e s e r i a l i z e ( j s o n ,   l e n ,   i ) )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;     / /   p u l l   i t   o u t  
                     r e t u r n   f a l s e ;  
                   }  
                 i f ( i   > =   l e n )  
                     r e t u r n   f a l s e ;  
                 r e t u r n   j s o n [ i ]   = =   ' } '   | |   j s o n [ i ]   = =   0 ;  
                 b r e a k ;  
               }  
  
             / /   e n d   o f   o b j e c t ,   c u r r e n t   v a l u e   m u s t   b e   o b j e c t  
             c a s e   ' } ' :  
                 r e t u r n   t y p e   = =   j t O B J ;  
  
             / /   b e g i n n i n g   o f   ' t r u e '   o r   ' f a l s e '  
             c a s e   ' t ' :  
             c a s e   ' T ' :  
             c a s e   ' f ' :  
             c a s e   ' F ' :  
               {  
                 i f ( t y p e   ! =   j t U N D E F )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;     / /   t y p e   e r r o r  
                     r e t u r n   f a l s e ;  
                   }  
                 t y p e   =   j t B O O L ;     / /   s e t   t h e   v a l u e   t y p e  
                 i f ( i   +   3   <   l e n )  
                   {  
                     i f ( S t r i n g C o m p a r e ( G e t S t r ( j s o n ,   i ,   4 ) ,   " t r u e " ,   f a l s e )   = =   0 )  
                       {  
                         b o o l _ v   =   t r u e ;  
                         i   + =   3 ;  
                         r e t u r n   t r u e ;  
                       }  
                   }  
                 i f ( i   +   4   <   l e n )  
                   {  
                     i f ( S t r i n g C o m p a r e ( G e t S t r ( j s o n ,   i ,   5 ) ,   " f a l s e " ,   f a l s e )   = =   0 )  
                       {  
                         b o o l _ v   =   f a l s e ;  
                         i   + =   4 ;  
                         r e t u r n   t r u e ;  
                       }  
                   }  
                 D E B U G _ P R I N T _ K E Y ;  
                 r e t u r n   f a l s e ;     / /   w r o n g   t y p e   o r   e n d   o f   l i n e  
                 b r e a k ;  
               }  
  
             / /   b e g i n n i n g   o f   n u l l  
             c a s e   ' n ' :  
             c a s e   ' N ' :  
               {  
                 i f ( t y p e   ! =   j t U N D E F )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;     / /   t y p e   e r r o r  
                     r e t u r n   f a l s e ;  
                   }  
                 t y p e   =   j t N U L L ;     / /   s e t   t h e   v a l u e   t y p e  
                 i f ( i   +   3   <   l e n )  
                     i f ( S t r i n g C o m p a r e ( G e t S t r ( j s o n ,   i ,   4 ) ,   " n u l l " ,   f a l s e )   = =   0 )  
                       {  
                         i   + =   3 ;  
                         r e t u r n   t r u e ;  
                       }  
                 D E B U G _ P R I N T _ K E Y ;  
                 r e t u r n   f a l s e ;     / /   n o t   N U L L   o r   e n d   o f   l i n e  
                 b r e a k ;  
               }  
  
             / /   b e g i n n i n g   o f   n u m b e r  
             c a s e   ' 0 ' :  
             c a s e   ' 1 ' :  
             c a s e   ' 2 ' :  
             c a s e   ' 3 ' :  
             c a s e   ' 4 ' :  
             c a s e   ' 5 ' :  
             c a s e   ' 6 ' :  
             c a s e   ' 7 ' :  
             c a s e   ' 8 ' :  
             c a s e   ' 9 ' :  
             c a s e   ' - ' :  
             c a s e   ' + ' :  
             c a s e   ' . ' :  
               {  
                 i f ( t y p e   ! =   j t U N D E F )  
                   {  
                     D E B U G _ P R I N T _ K E Y ;     / /   t y p e   e r r o r  
                     r e t u r n   f a l s e ;  
                   }  
  
                 b o o l   d b l   =   f a l s e ;     / /   s e t   t h e   v a l u e   t y p e  
                 i n t   i s   =   i ;  
                 w h i l e ( j s o n [ i ]   ! =   0   & &   i   <   l e n )  
                   {  
                     i + + ;  
                     i f ( S t r i n g F i n d ( n u m ,   G e t S t r ( j s o n ,   i ,   1 ) )   <   0 )  
                         b r e a k ;  
                     i f ( ! d b l )  
                         d b l   =   ( j s o n [ i ]   = =   ' . '   | |   j s o n [ i ]   = =   ' e '   | |   j s o n [ i ]   = =   ' E ' ) ;  
                   }  
                 s t r _ v   =   G e t S t r ( j s o n ,   i s ,   i   -   i s ) ;  
                 i f ( d b l )  
                   {  
                     t y p e   =   j t D B L ;  
                     d b l _ v   =   S t r i n g T o D o u b l e ( s t r _ v ) ;  
                     i n t _ v   =   ( l o n g ) d b l _ v ;  
                     b o o l _ v   =   i n t _ v   ! =   0 ;  
                   }  
                 e l s e  
                   {  
                     t y p e   =   j t I N T ;     / /   c l a r i f i e d   t h e   v a l u e   t y p e  
                     i n t _ v   =   S t r i n g T o I n t e g e r ( s t r _ v ) ;  
                     d b l _ v   =   ( d o u b l e ) i n t _ v ;  
                     b o o l _ v   =   i n t _ v   ! =   0 ;  
                   }  
  
                 i - - ;  
  
                 r e t u r n   t r u e ;     / /   m o v e d   1   c h a r a c t e r   b a c k   a n d   e x i t e d  
               }  
  
             / /   s t a r t   o r   e n d   o f   l i n e  
             c a s e   ' \ " ' :  
               {  
                 / /   i f   t h e   t y p e   h a s   n o t   y e t   b e e n   d e f i n e d   a n d   t h e   k e y   h a s   n o t   b e e n   s e t  
                 i f ( t y p e   = =   j t O B J )  
                   {  
                     i + + ;  
                     i n t   i s   =   i ;  
                     i f ( ! E x t r S t r ( j s o n ,   l e n ,   i ) )  
                       {  
                         D E B U G _ P R I N T _ K E Y ;     / /   t h i s   i s   t h e   k e y ,   g o   t o   t h e   e n d   o f   t h e   l i n e  
                         r e t u r n   f a l s e ;  
                       }  
  
                     l _ k e y   =   G e t S t r ( j s o n ,   i s ,   i   -   i s ) ;  
                   }  
                 e l s e  
                   {  
                     i f ( t y p e   ! =   j t U N D E F )  
                       {  
                         D E B U G _ P R I N T _ K E Y ;     / /   t y p e   e r r o r  
                         r e t u r n   f a l s e ;  
                       }  
  
                     t y p e   =   j t S T R ;     / /   s e t   t h e   v a l u e   t y p e  
                     i + + ;  
                     i n t   i s   =   i ;  
                     i f ( ! E x t r S t r ( j s o n ,   l e n ,   i ) )  
                       {  
                         D E B U G _ P R I N T _ K E Y ;  
                         r e t u r n   f a l s e ;  
                       }  
                     F r o m S t r ( j t S T R ,   G e t S t r ( j s o n ,   i s ,   i   -   i s ) ) ;  
                     r e t u r n   t r u e ;  
                   }  
  
                 b r e a k ;  
               }  
           }  
       }  
  
     r e t u r n   t r u e ;  
   }  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   E x t r S t r  
 b o o l   C J A V a l : : E x t r S t r ( c h a r &   j s o n [ ] ,   i n t   l e n ,   i n t   & i )  
   {  
     f o r ( ;   j s o n [ i ]   ! =   0   & &   i   <   l e n ;   i + + )  
       {  
         c h a r   c   =   j s o n [ i ] ;  
  
         i f ( c   = =   ' \ " ' )  
             b r e a k ;     / /   e n d   o f   l i n e  
  
         i f ( c   = =   ' \ \ '   & &   i   +   1   <   l e n )  
           {  
             i + + ;  
             c   =   j s o n [ i ] ;  
             s w i t c h ( c )  
               {  
                 / /   i t   i s   a l l o w e d  
                 c a s e   ' / ' :  
                 c a s e   ' \ \ ' :  
                 c a s e   ' \ " ' :  
                 c a s e   ' b ' :  
                 c a s e   ' f ' :  
                 c a s e   ' r ' :  
                 c a s e   ' n ' :  
                 c a s e   ' t ' :  
                     b r e a k ;  
  
                 / /   \ u X X X X  
                 c a s e   ' u ' :  
                   {  
                     i + + ;  
                     f o r ( i n t   j   =   0 ;   j   <   4   & &   i   <   l e n   & &   j s o n [ i ]   ! =   0 ;   j + + ,   i + + )  
                       {  
                         / /   n o t   h e x  
                         i f ( ! ( ( j s o n [ i ]   > =   ' 0 '   & &   j s o n [ i ]   < =   ' 9 ' )   | |   ( j s o n [ i ]   > =   ' A '   & &   j s o n [ i ]   < =   ' F ' )   | |   ( j s o n [ i ]   > =   ' a '   & &   j s o n [ i ]   < =   ' f ' ) ) )  
                           {  
                             P r i n t ( k e y   +   "   "   +   C h a r T o S t r i n g ( j s o n [ i ] )   +   "   "   +   s t r i n g ( _ _ L I N E _ _ ) ) ;  
                             r e t u r n   f a l s e ;  
                           }  
                       }  
                     i - - ;  
                     b r e a k ;  
                   }  
  
                 d e f a u l t :  
                     b r e a k ;   / * {   r e t u r n   f a l s e ;   }   / /   n o t   a l l o w e d   e s c a p e d   c h a r a c t e r   * /  
               }  
           }  
       }  
     r e t u r n   t r u e ;  
   }  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   E s c a p e  
 s t r i n g   C J A V a l : : E s c a p e ( s t r i n g   v )  
   {  
     u s h o r t   a s [ ] ,   s [ ] ;  
     i n t   n   =   S t r i n g T o S h o r t A r r a y ( v ,   a s ) ;  
  
     i f ( A r r a y R e s i z e ( s ,   2   *   n )   ! =   2   *   n )  
         r e t u r n   N U L L ;  
  
     i n t   j   =   0 ;  
     f o r ( i n t   i   =   0 ;   i   <   n ;   i + + )  
       {  
         s w i t c h ( a s [ i ] )  
           {  
             c a s e   ' \ \ ' :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   ' " ' :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' " ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   ' / ' :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' / ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   8 :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' b ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   1 2 :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' f ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   ' \ n ' :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' n ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   ' \ r ' :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' r ' ;  
                 j + + ;  
                 b r e a k ;  
             c a s e   ' \ t ' :  
                 s [ j ]   =   ' \ \ ' ;  
                 j + + ;  
                 s [ j ]   =   ' t ' ;  
                 j + + ;  
                 b r e a k ;  
             d e f a u l t :  
                 s [ j ]   =   a s [ i ] ;  
                 j + + ;  
                 b r e a k ;  
           }  
       }  
  
     r e t u r n   S h o r t A r r a y T o S t r i n g ( s ,   0 ,   j ) ;  
   }  
  
 / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   U n e s c a p e  
 s t r i n g   C J A V a l : : U n e s c a p e ( s t r i n g   v )  
   {  
     u s h o r t   a s [ ] ,   s [ ] ;  
     i n t   n   =   S t r i n g T o S h o r t A r r a y ( v ,   a s ) ;  
  
     i f ( A r r a y R e s i z e ( s ,   n )   ! =   n )  
         r e t u r n   N U L L ;  
  
     i n t   j   =   0 ,   i   =   0 ;  
     w h i l e ( i   <   n )  
       {  
         u s h o r t   c   =   a s [ i ] ;  
         i f ( c   = =   ' \ \ '   & &   i   <   n   -   1 )  
           {  
             s w i t c h ( a s [ i   +   1 ] )  
               {  
                 c a s e   ' \ \ ' :  
                     c   =   ' \ \ ' ;  
                     i + + ;  
                     b r e a k ;  
                 c a s e   ' " ' :  
                     c   =   ' " ' ;  
                     i + + ;  
                     b r e a k ;  
                 c a s e   ' / ' :  
                     c   =   ' / ' ;  
                     i + + ;  
                     b r e a k ;  
                 c a s e   ' b ' :  
                     c   =   8 ;   / * 0 8   =   ' \ b ' * / ;  
                     i + + ;  
                     b r e a k ;  
                 c a s e   ' f ' :  
                     c   =   1 2 ; / * 0 c   =   \ f * /   i + + ;  
                     b r e a k ;  
                 c a s e   ' n ' :  
                     c   =   ' \ n ' ;  
                     i + + ;  
                     b r e a k ;  
                 c a s e   ' r ' :  
                     c   =   ' \ r ' ;  
                     i + + ;  
                     b r e a k ;  
                 c a s e   ' t ' :  
                     c   =   ' \ t ' ;  
                     i + + ;  
                     b r e a k ;  
  
                 / /   \ u X X X X  
                 c a s e   ' u ' :  
                   {  
                     i   + =   2 ;  
                     u s h o r t   k   =   0 ;  
                     f o r ( i n t   j j   =   0 ;   j j   <   4   & &   i   <   n ;   j j + + ,   i + + )  
                       {  
                         c   =   a s [ i ] ;  
                         u s h o r t   h   =   0 ;  
  
                         i f ( c   > =   ' 0 '   & &   c   < =   ' 9 ' )  
                             h   =   c   -   ' 0 ' ;  
                         e l s e  
                             i f ( c   > =   ' A '   & &   c   < =   ' F ' )  
                                 h   =   c   -   ' A '   +   1 0 ;  
                             e l s e  
                                 i f ( c   > =   ' a '   & &   c   < =   ' f ' )  
                                     h   =   c   -   ' a '   +   1 0 ;  
                                 e l s e  
                                     b r e a k ;   / /   n o t   h e x  
  
                         k   + =   h   *   ( u s h o r t ) p o w ( 1 6 ,   ( 3   -   j j ) ) ;  
                       }  
                     i - - ;  
                     c   =   k ;  
                     b r e a k ;  
                   }  
               }  
           }  
         s [ j ]   =   c ;  
         j + + ;  
         i + + ;  
       }  
  
     r e t u r n   S h o r t A r r a y T o S t r i n g ( s ,   0 ,   j ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

/********************************************************************
 * MQLMySQL interface library "CLASSic Style"                       *
 ********************************************************************
 * This library uses MQLMySQL.DLL was developed as interface to con-*
 * nect to the MySQL database server.                               *
 * Note: Check expert advisor "Common" parameters to be sure that   *
 *       DLL imports are allowed.                                   *
 ********************************************************************/

#define MQLMYSQL_TRACER "TRACE: " // Prefix for tracer messages
#define MQLMYSQL_Node_ID (int)3269587

#import "MySQL.dll"
// returns version of MySqlCursor.dll library
string cMySqlVersion();

// number of last error of connection
int    cGetMySqlErrorNumber(int pConnection);

// number of last error of cursor
int    cGetCursorErrorNumber(int pCursorID);

// description of last error for connection
string cGetMySqlErrorDescription(int pConnection);

// description of last error for cursor
string cGetCursorErrorDescription(int pCursorID);

// establish connection to MySql database server
// and return connection identifier
int    cMySqlConnect(string pHost,              // Host name
                     string pUser,       // User
                     string pPassword,   // Password
                     string pDatabase,   // Database name
                     int    pPort,       // Port
                     string pSocket,     // Socket for Unix
                     int    pClientFlag, // Client flag
                     int    pNode); // Hash
// closes connection to database
void   cMySqlDisconnect(int pConnection);       // pConnection - database identifier (pointer to structure)
// executes non-SELECT statements
bool   cMySqlExecute(int    pConnection,        // pConnection - database identifier (pointer to structure)
                     string pQuery);     // pQuery      - SQL query for execution
// creates an cursor based on SELECT statement
// return valuse - cursor identifier
int    cMySqlCursorOpen(int    pConnection,     // pConnection - database identifier (pointer to structure)
                        string pQuery,          // pQuery      - SELECT statement for execution
                        int    pNode);   // Hash
// closes opened cursor
void   cMySqlCursorClose(int pCursorID);        // pCursorID  - internal identifier of cursor
// return number of rows was selected by cursor
int    cMySqlCursorRows(int pCursorID);         // pCursorID  - internal identifier of cursor
// fetch next row from cursor into current row buffer
// return true - if succeeded, otherwise - false
bool   cMySqlCursorFetchRow(int pCursorID);     // pCursorID  - internal identifier of cursor
// retrieves the value from current row was fetched by cursor
string cMySqlGetRowField(int    pCursorID,      // pCursorID  - internal identifier of cursor
                         int    pField);     // pField     - number of field in SELECT clause (started from 0,1,2... e.t.c.)

// return the number of rows affected by last DML operation (INSERT/UPDATE/DELETE)
int cMySqlRowsAffected(int pConnection);

// Reads and returns the key value from standard INI-file
string ReadIni(string pFileName,                // INI-filename
               string pSection,    // name of section
               string pKey);       // name of key
#import


//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CMySQL
 {
private:
  bool               SQLTrace;
  datetime           MySqlLastConnect;
  int                MySqlErrorNumber;       // recent MySQL error number
  string             MySqlErrorDescription;  // recent MySQL error description
  int                ConnectID;              // ID of database connection
  // database internal credentials can be set by SetCredentials or loaded from INI file by LoadCredentials
  bool               vCredentialsSet;
  string             vHost;
  string             vUser;
  string             vPassword;
  string             vDatabase;
  int                vPort;
  string             vSocket;
  int                vClientFlag;
  int                vNode;

  // just to clear error buffer before any function started its functionality
  void               ClearErrors()
   {
    MySqlErrorNumber = 0;
    MySqlErrorDescription = "No errors.";
   }
public:
                     CMySQL(void)
   {
    // constructor
    SQLTrace = false; // Trace is disabled by default
    MySqlLastConnect = 0;
    vCredentialsSet = false; // database credentials are not set by default
    ConnectID = -1; // database is not connected by default
    ClearErrors();
   }

                    ~CMySQL(void)
   {
    // destructor
    SQLTrace = false; // Trace is disabled by default
    MySqlLastConnect = 0;
    vCredentialsSet = false; // database credentials are not set by default
    if(ConnectID >= 0)
      Disconnect();
    ClearErrors();
   }

  bool               IsConnect(void)
   {
    return ConnectID >= 0 ? true : false;
   }

  // Set tracing state
  // pState = true for debug
  //           false for release
  void               SetTrace(bool pState)
   {
    SQLTrace = pState;
   }

  // Return the version of MQLMySQL library
  string             DllVersion()
   {
    return(cMySqlVersion());
   }

  // Interface function Connect - make connection to MySQL database using parameter:
  // pHost       - DNS name or IP-address
  // pUser       - database user (f.e. root)
  // pPassword   - password of user (f.e. Zok1LmVdx)
  // pDatabase   - database name (f.e. metatrader)
  // pPort       - TCP/IP port of database listener (f.e. 3306)
  // pSocket     - unix socket (for sockets or named pipes using)
  // pClientFlag - combination of the flags for features (usual 0)
  // ------------------------------------------------------------------------------------
  // RETURN      - database connection identifier
  //               if return value = 0, check MySqlErrorNumber and MySqlErrorDescription
  bool               Connect(string pHost, string pUser, string pPassword, string pDatabase, int pPort, string pSocket, int pClientFlag)
   {
    SetCredentials(pHost, pUser, pPassword, pDatabase, pPort, pSocket, pClientFlag);
    return (Connect());
   } // Connect

  // Interface function Connect - make connection to MySQL database using internal credentials (loaded or set)
  bool               Connect(void)
   {
    int connection;
    ClearErrors();

    if(!vCredentialsSet)
     {
      MySqlErrorNumber = -8;
      MySqlErrorDescription = "No database credentials.";
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "Connection error #", MySqlErrorNumber, " ", MySqlErrorDescription);
      return (false);
     }

    if(ConnectID >= 0)
     {
      // Connection is already exists
      MySqlErrorNumber = -7;
      MySqlErrorDescription = "Connection already exists.";
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "Connection error #", MySqlErrorNumber, " ", MySqlErrorDescription);
      return (false);
     }

    connection = cMySqlConnect(vHost, vUser, vPassword, vDatabase, vPort, vSocket, vClientFlag, MQLMYSQL_Node_ID);

    if(SQLTrace)
      Print(MQLMYSQL_TRACER, "Connecting to Host=", vHost, ", User=", vUser, ", Database=", vDatabase, " DBID#", connection);

    if(connection == -1)
     {
      MySqlErrorNumber = cGetMySqlErrorNumber(-1);
      MySqlErrorDescription = cGetMySqlErrorDescription(-1);
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "Connection error #", MySqlErrorNumber, " ", MySqlErrorDescription);
      return (false);
     }

    MySqlLastConnect = TimeCurrent();
    if(SQLTrace)
      Print(MQLMYSQL_TRACER, "Connected! DBID#", connection);

    ConnectID = connection;

    // SET UTF8 CHARSET FOR CONNECTION
    if(!Execute("SET NAMES UTF8"))
     {
      MySqlErrorNumber = cGetMySqlErrorNumber(-1);
      MySqlErrorDescription = cGetMySqlErrorDescription(-1);
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "'SET NAMES UTF8' error #", MySqlErrorNumber, " ", MySqlErrorDescription);
     }

    return (true);
   } // Connect

  // Set database credentials for further connection
  void               SetCredentials(string pHost, string pUser, string pPassword, string pDatabase, int pPort, string pSocket, int pClientFlag)
   {
    vHost = pHost;
    vUser = pUser;
    vPassword = pPassword;
    vDatabase = pDatabase;
    vPort = pPort;
    vSocket = pSocket;
    vClientFlag = pClientFlag;
    vCredentialsSet = true;
   } // SetCredentials

  // Load database credentials for further connection from standard INI file
  // INI file must have section MYSQL and keys Host, User, Password, Database, Port, Socket, ClientFlag
  void               LoadCredentials(string p_ini_file)
   {
    // reading database credentials from INI file
    vHost = ReadIni(p_ini_file, "MYSQL", "Host");
    vUser = ReadIni(p_ini_file, "MYSQL", "User");
    vPassword = ReadIni(p_ini_file, "MYSQL", "Password");
    vDatabase = ReadIni(p_ini_file, "MYSQL", "Database");
    vPort     = (int)StringToInteger(ReadIni(p_ini_file, "MYSQL", "Port"));
    vSocket   = ReadIni(p_ini_file, "MYSQL", "Socket");
    vClientFlag = (int)StringToInteger(ReadIni(p_ini_file, "MYSQL", "ClientFlag"));

    if(SQLTrace)
      Print(MQLMYSQL_TRACER, "Loaded '", p_ini_file, "'> Host: ", vHost, ", User: ", vUser, ", Database: ", vDatabase);
    vCredentialsSet = true;
   } // LoadCredentials

  // Interface function Disconnect - closes connection to database
  // When no connection was established - nothing happends
  void               Disconnect(void)
   {
    ClearErrors();
    if(ConnectID != -1)
     {
      cMySqlDisconnect(ConnectID);
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "DBID#", ConnectID, " disconnected");
      ConnectID = -1;
     }
   } // Disconnect

  // Interface function Execute - executes SQL query (DML/DDL/DCL operations, MySQL commands)
  // pQuery      - SQL query
  // ------------------------------------------------------
  // RETURN      - true : when execution succeded
  //             - false: when any error was raised (see MySqlErrorNumber, MySqlErrorDescription)
  bool               Execute(string pQuery)
   {
    ClearErrors();
    if(SQLTrace)
      Print(MQLMYSQL_TRACER, "DBID#", ConnectID, ", CMD:", pQuery);
    if(ConnectID == -1)
     {
      // no connection
      MySqlErrorNumber = -2;
      MySqlErrorDescription = "No connection to the database.";
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "CMD>", MySqlErrorNumber, ": ", MySqlErrorDescription);
      return (false);
     }

    if(!cMySqlExecute(ConnectID, pQuery))
     {
      MySqlErrorNumber = cGetMySqlErrorNumber(ConnectID);
      MySqlErrorDescription = cGetMySqlErrorDescription(ConnectID);
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "CMD>", MySqlErrorNumber, ": ", MySqlErrorDescription);
      return (false);
     }
    return (true);
   } // Execute

  enum ENUM_MYSQL_TRANCE_LEVEL
   {
    MYSQL_TRANCE_LEVEL_DEFULT = 0,
    MYSQL_TRANCE_LEVEL_READ_UNCOMMITTED = 1,
    MYSQL_TRANCE_LEVEL_READ_COMMITTED = 2,
    MYSQL_TRANCE_LEVEL_REPEATABLE_READ = 3,
    MYSQL_TRANCE_LEVEL_SERIALIZABLE = 4
   };
  bool               TransactionBegin(ENUM_MYSQL_TRANCE_LEVEL _isolation_level = MYSQL_TRANCE_LEVEL_DEFULT)
   {
    string query = NULL;
    switch(_isolation_level)
     {
      case MYSQL_TRANCE_LEVEL_READ_UNCOMMITTED:
        query = "SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;";
        break;
      case MYSQL_TRANCE_LEVEL_READ_COMMITTED:
        query = "SET TRANSACTION ISOLATION LEVEL READ COMMITTED;";
        break;
      case MYSQL_TRANCE_LEVEL_REPEATABLE_READ:
        query = "SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;";
        break;
      case MYSQL_TRANCE_LEVEL_SERIALIZABLE:
        query = "SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;";
        break;
      default:
        break;
     }
    query += "START TRANSACTION;";
    return(Execute(query));
   }
  bool               TransactionCommit(void)
   {
    return(Execute("COMMIT;"));
   }
  bool               TransactionAddSavePoint(const string _name)
   {
    return(Execute("SAVEPOINT " + _name + ";"));
   }
  bool               TransactionRollback(void)
   {
    return(Execute("ROLLBACK;"));
   };
  bool               TransactionRollbackToSavePoint(const string _name)
   {
    return(Execute("ROLLBACK TO " + _name + ";"));
   };
  // return number of rows affected by last DML operation
  int                RowsAffected(void)
   {
    return (cMySqlRowsAffected(ConnectID));
   } // RowsAffected

  // return internal connection identifier
  int                GetConnectID(void)
   {
    return ConnectID;
   } // GetConnectID

  bool               GetTrace(void)
   {
    return SQLTrace;
   } // GetTrace

  int                LastError(void)
   {
    return MySqlErrorNumber;
   } // LastError

  string             LastErrorMessage(void)
   {
    return MySqlErrorDescription;
   } // LastErrorMessage

 }; // class CMySQL

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CMySQLCursor
 {
private:
  int                CursorID;
  int                ConnectID;
  int                CursorErrorNumber;
  string             CursorErrorDescription;
  bool               SQLTrace;

  // just to clear error buffer before any function started its functionality
  void               ClearErrors()
   {
    CursorErrorNumber = 0;
    CursorErrorDescription = "No errors.";
   } // ClearErrors
public:
                     CMySQLCursor(void)
   {
    // constructor
    ConnectID = -1;
    CursorID = -1;
    ClearErrors();
    SQLTrace = false;
   }

                    ~CMySQLCursor(void)
   {
    // destructor
    if(CursorID >= 0)
      Close();
    ClearErrors();
   }

  // creates an cursor based on SELECT statement
  // return valuse - true on success
  //                 false on fail, to get the error - call LastError() and/or LastErrorMessage()
  bool               Open(CMySQL *pConnection, string pQuery)
   {
    SQLTrace = pConnection.GetTrace();
    ConnectID =  pConnection.GetConnectID();
    if(SQLTrace)
      Print(MQLMYSQL_TRACER, "DBID#", ConnectID, ", QRY:", pQuery);
    ClearErrors();

    CursorID = cMySqlCursorOpen(ConnectID, pQuery, MQLMYSQL_Node_ID);
    if(CursorID == -1)
     {
      CursorErrorNumber = cGetMySqlErrorNumber(ConnectID);
      CursorErrorDescription = cGetMySqlErrorDescription(ConnectID);
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "QRY>", CursorErrorNumber, ": ", CursorErrorDescription);
      return (false);
     }
    return (true);
   } // Open

  // closes opened cursor
  void               Close(void)
   {
    ClearErrors();
    // if (CursorID == -1) return; // no active cursor

    cMySqlCursorClose(CursorID);
    CursorErrorNumber = cGetCursorErrorNumber(CursorID);
    CursorErrorDescription = cGetCursorErrorDescription(CursorID);
    if(CursorErrorNumber != 0)
     {
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "Cursor #", CursorID, " closing error: ", CursorErrorNumber, ": ", CursorErrorDescription);
     }
    else
     {
      if(SQLTrace)
        Print(MQLMYSQL_TRACER, "Cursor #", CursorID, " closed");
      CursorID = -1;
     } // if (CursorErrorNumber != 0)
   } // Close

  // return number of rows was selected by cursor
  int                Rows(void)
   {
    int result;
    result = cMySqlCursorRows(CursorID);
    CursorErrorNumber = cGetCursorErrorNumber(CursorID);
    CursorErrorDescription = cGetCursorErrorDescription(CursorID);
    if(SQLTrace)
      Print(MQLMYSQL_TRACER, "Cursor #", CursorID, ", rows: ", result);
    return (result);
   } // Rows

  // fetch next row from cursor into current row buffer
  // return true - if succeeded, otherwise - false
  bool               Fetch(void)
   {
    bool result;
    result = cMySqlCursorFetchRow(CursorID);
    CursorErrorNumber = cGetCursorErrorNumber(CursorID);
    CursorErrorDescription = cGetCursorErrorDescription(CursorID);
    if(SQLTrace && CursorErrorNumber != 0)
     {
      Print(MQLMYSQL_TRACER, "Cursor #", CursorID, " fetching error: ", CursorErrorNumber, ": ", CursorErrorDescription);
     }
    return (result);
   } // Fetch

  // retrieves the value from current row was fetched by cursor
  // fields start from 0
  string             FieldAsString(int pField)
   {
    string result;
    result = cMySqlGetRowField(CursorID, pField);
    CursorErrorNumber = cGetCursorErrorNumber(CursorID);
    CursorErrorDescription = cGetCursorErrorDescription(CursorID);
    return (result);
   } // FieldAsString

  int                FieldAsInt(int pField)
   {
    return ((int)StringToInteger(FieldAsString(pField)));
   } // FieldAsInt

  double             FieldAsDouble(int pField)
   {
    return (StringToDouble(FieldAsString(pField)));
   } // FieldAsDouble

  datetime           FieldAsDatetime(int pField)
   {
    string x = FieldAsString(pField);
    StringReplace(x, "-", ".");
    return (StringToTime(x));
   } // FieldAsDatetime

  int                LastError(void)
   {
    return CursorErrorNumber;
   } // LastError

  string             LastErrorMessage(void)
   {
    return CursorErrorDescription;
   } // LastErrorMessage
 }; // class CMQLCursor


/********************************************************************
 * MySQL standard definitions                                       *
 ********************************************************************/
#define CLIENT_LONG_PASSWORD               1 /* new more secure passwords */
#define CLIENT_FOUND_ROWS                  2 /* Found instead of affected rows */
#define CLIENT_LONG_FLAG                   4 /* Get all column flags */
#define CLIENT_CONNECT_WITH_DB             8 /* One can specify db on connect */
#define CLIENT_NO_SCHEMA                  16 /* Don't allow database.table.column */
#define CLIENT_COMPRESS                   32 /* Can use compression protocol */
#define CLIENT_ODBC                       64 /* Odbc client */
#define CLIENT_LOCAL_FILES               128 /* Can use LOAD DATA LOCAL */
#define CLIENT_IGNORE_SPACE              256 /* Ignore spaces before '(' */
#define CLIENT_PROTOCOL_41               512 /* New 4.1 protocol */
#define CLIENT_INTERACTIVE              1024 /* This is an interactive client */
#define CLIENT_SSL                      2048 /* Switch to SSL after handshake */
#define CLIENT_IGNORE_SIGPIPE           4096 /* IGNORE sigpipes */
#define CLIENT_TRANSACTIONS             8192 /* Client knows about transactions */
#define CLIENT_RESERVED                16384 /* Old flag for 4.1 protocol  */
#define CLIENT_SECURE_CONNECTION       32768 /* New 4.1 authentication */
#define CLIENT_MULTI_STATEMENTS        65536 /* Enable/disable multi-stmt support */
#define CLIENT_MULTI_RESULTS          131072 /* Enable/disable multi-results */
#define CLIENT_PS_MULTI_RESULTS       262144 /* Multi-results in PS-protocol */
-e 

//+------------------------------------------------------------------+
//|                                                      CSqlite.mqh |
//|                                           Copyright 2022, denkir |
//|                             https://www.mql5.com/ru/users/denkir |
//+------------------------------------------------------------------+
#property copyright "Copyright 2023, denkir"
#property link      "https://www.mql5.com/ru/users/denkir"
//--- include
#include <Generic\HashSet.mqh>
#include <Arrays\ArrayString.mqh>
//+------------------------------------------------------------------+
//| Class CSqlite.                                                   |
//| Appointment: Class database operations.                          |
//|              Derives from class CObject.                         |
//+------------------------------------------------------------------+
class CSqlite : public CObject
  {
   //--- === Data members === ---
private:
   string            m_name;
   int               m_handle;
   uint              m_flags;
   CHashSet<string>  m_table_names;
   string            m_curr_table_name;
   int               m_sql_request_ha;
   string            m_sql_request;
   //--- === Methods === ---
public:
   //--- constructor/destructor
   void              CSqlite(void);
   void             ~CSqlite(void);
   //--- API MQL5 functions
   bool              Open(const string _file_name, const uint _flags);  // DatabaseOpen
   void              Close(void);                                       // DatabaseClose
   bool              TransactionBegin(void);                            // DatabaseTransactionBegin
   bool              TransactionCommit(void);                           // DatabaseTransactionCommit
   bool              TransactionRollback(void);                         // DatabaseTransactionRollback
   bool              Select(const string _sql_request);

   //--- get
   string            Name(void) const;
   int               Handle(void) const;
   uint              Flags(void) const;
   CHashSet<string>  *TableNames(void);
   int               SqlRequestHandle(void) const;
   string            SqlRequest(void) const;

   //--- service
   bool              Structure(const string  _name,
                               const bool    _is_temp = false);

   //--- tables
   bool              SelectTable(const string _table_name,
                                 const bool   _is_temp = false);
   bool              CreateTable(const string _table_name,
                                 const string &_col_names[],
                                 const bool   _not_exists = true,
                                 const bool   _is_temp = false);
   bool              CreateTableAs(const string _table_name,
                                   const string _sql_request,
                                   const bool   _not_exists = true,
                                   const bool   _is_temp = false);
   bool              DropTable(const string _table_name);
   bool              DropCurrentTable(void);
   bool              TableExists(const string _table_name);             // DatabaseTableExists
   long              ExportTable(const string _file_name,
                                 const uint   _flags,
                                 const string _separator);              // DatabaseImport
   long              ImportTable(const string _table_name,
                                 const string _file_name,
                                 const uint   _flags,
                                 const string _separator = ";",
                                 const ulong  _rows_to_skip = 0,
                                 const string _skip_comments = NULL);   // DatabaseExport
   bool              RenameTable(const string _new_name);
   bool              InsertSingleRow(const string &_col_names[],
                                     const string &_col_vals[]);
   bool              InsertMultipleRows(const string       &_col_names[],
                                        const CArrayString &_rows_arr);
   bool              Update(const string &_col_names[],
                            const string &_col_vals[],
                            const string _where_cond);
   bool              EmptyTable(void);
   bool              Delete(const string _where_cond);
   bool              Replace(const string &_col_names[],
                             const string &_col_vals[]);
   bool              AddColumn(const string &_col_definition);
   bool              RenameColumn(const string _curr_name,
                                  const string _new_name);
   long              PrintTable(const uint _flags = 0) const;           // DatabasePrint
   bool              SelectFrom(const string &_col_names[]);
   bool              SelectFromGroupBy(const string &_col_names[],
                                       const string &_group_names[]);
   bool              SelectFromOrderedBy(const string &_col_names[],
                                         const string &_ord_names[]);
   bool              SelectDistinctFrom(const string &_col_names[]);
   bool              SelectDistinctFromOrderedBy
   (
      const string &_col_names[],
      const string &_ord_names[]
   );
   bool              SelectFromWhere(const string &_col_names[],
                                     const string _where_cond);
   bool              SelectFromWhereOrderedBy
   (
      const string &_col_names[],
      const string _where_cond,
      const string &_ord_names[]
   );
   bool              InnerJoin(const string &_col_names[],
                               const string _other_table,
                               const string _join_cond);
   bool              LeftJoin(const string &_col_names[],
                              const string _other_table,
                              const string _join_cond);
   bool              CrossJoin(const string &_col_names[],
                               const string _other_table);
   bool              SelfJoin(const string &_col_names[],
                              const string _from,
                              const string _where_cond);
   bool              FullOuterJoin(const string &_col_names[],
                                   const string _other_table,
                                   const string _join_cond);
   bool              Union(const string &_col_names[],
                           const string _where_cond1,
                           const string _other_table,
                           const string &_other_col_names[],
                           const string _where_cond2,
                           const bool   _all = false);
   bool              Except(const string &_col_names[],
                            const string _other_table,
                            const string &_other_col_names[]);
   bool              Intersect(const string &_col_names[],
                               const string _other_table,
                               const string &_other_col_names[]);
   bool              ListTables(CArrayString &_tables_list,
                                const bool   _to_print = false);
   //--- sql request
   bool              CreateSqlRequest(const string _sql_request);       // DatabasePrepare
   bool              ExecuteSqlRequest(void);                           // DatabaseExecute
   template<typename T>
   bool              SqlRequestBind(const int _index,
                                    const T   _val);                    // DatabaseBind
   template<typename T>
   bool              SqlRequestBindArray(const int _index,
                                         const T   &_vals[]);           // DatabaseBindArray
   bool              ResetSqlRequest(void) const;
   long              ExportSqlRequest(const string _file_name,
                                      const uint   _flags,
                                      const string _separator);         // DatabaseReset
   bool              SqlRequestRead(void);                              // DatabaseRead
   template<typename ST>
   bool              SqlRequestReadBind(ST &_s_object);                 // DatabaseReadBind
   void              FinalizeSqlRequest(void);                          // DatabaseFinalize
   long              PrintSqlRequest(const uint _flags = 0) const;
   int               ColumnsCount(void) const;                          // DatabaseColumnsCount
   string            ColumnName(const int _col) const;                  // DatabaseColumnName
   ENUM_DATABASE_FIELD_TYPE ColumnType(const int _col) const;           // DatabaseColumnType
   int               ColumnSize(const int _col) const;                  // DatabaseColumnSize
   string            ColumnText(const int _col) const;                  // DatabaseColumnText
   int               ColumnInteger(const int _col) const;               // DatabaseColumnInteger
   long              ColumnLong(const int _col) const;                  // DatabaseColumnLong
   double            ColumnDouble(const int _col) const;                // DatabaseColumnDouble
   template<typename T>
   bool              ColumnBlob(const int _col, T &_vals[]) const;      // DatabaseColumnBlob
   //--- views
   bool              CreateView(const string _view_name,
                                const string &_col_names[],
                                const bool   _not_exists = true,
                                const bool   _is_temp = false);
   bool              CreateViewWhere(const string _view_name,
                                     const string &_col_names[],
                                     const string _where_cond,
                                     const bool   _not_exists = true,
                                     const bool   _is_temp = false);
   bool              DropView(const string _view_name,
                              const bool   _if_exists = true);
   bool              ListViews(CArrayString &_views_list,
                               const bool   _to_print = false);
  };
//+------------------------------------------------------------------+
//| Constructor                                                      |
//+------------------------------------------------------------------+
void CSqlite::CSqlite(void) :
   m_name(NULL),
   m_handle(INVALID_HANDLE),
   m_flags(0),
   m_curr_table_name(NULL),
   m_sql_request_ha(INVALID_HANDLE),
   m_sql_request(NULL)
  {
  }
//+------------------------------------------------------------------+
//| Destructor                                                       |
//+------------------------------------------------------------------+
void CSqlite::~CSqlite(void)
  {
   this.Close();
  }
//+------------------------------------------------------------------+
//| Open                                                             |
//+------------------------------------------------------------------+
bool CSqlite::Open(const string _file_name, const uint _flags)
  {
   ::ResetLastError();
   m_handle = ::DatabaseOpen(_file_name, _flags);
   if(m_handle == INVALID_HANDLE)
     {
      ::PrintFormat(__FUNCTION__ + ": failed with code %d", ::GetLastError());
      return false;
     }
   m_name = _file_name;
   return true;
  }
//+------------------------------------------------------------------+
//| Close                                                            |
//+------------------------------------------------------------------+
void CSqlite::Close(void)
  {
   ::DatabaseClose(m_handle);
   m_handle = INVALID_HANDLE;
  };
//+-------------------------------------------------------------------+
//| Start transaction execution                                       |
//+-------------------------------------------------------------------+
bool CSqlite::TransactionBegin(void)
  {
   return ::DatabaseTransactionBegin(m_handle);
  }
//+-------------------------------------------------------------------+
//| Complete transaction execution                                    |
//+-------------------------------------------------------------------+
bool CSqlite::TransactionCommit(void)
  {
   return ::DatabaseTransactionCommit(m_handle);
  }
//+-------------------------------------------------------------------+
//| Roll back transactions                                            |
//+-------------------------------------------------------------------+
bool CSqlite::TransactionRollback(void)
  {
   return ::DatabaseTransactionRollback(m_handle);
  }
//+------------------------------------------------------------------+
//| Query data                                                       |
//+------------------------------------------------------------------+
bool CSqlite::Select(const string _sql_request)
  {
   ::ResetLastError();
   if(!CreateSqlRequest(_sql_request))
     {
      ::PrintFormat(__FUNCTION__ + ": failed with code %d", ::GetLastError());
      return false;
     }
   if(!ExecuteSqlRequest())
     {
      ::PrintFormat(__FUNCTION__ + ": failed with code %d", ::GetLastError());
      return false;
     }
   return true;
  }
//+------------------------------------------------------------------+
//| Get a name                                                       |
//+------------------------------------------------------------------+
string CSqlite::Name(void) const
  {
   return m_name;
  }
//+------------------------------------------------------------------+
//| Get a handle                                                     |
//+------------------------------------------------------------------+
int CSqlite::Handle(void) const
  {
   return m_handle;
  }
//+------------------------------------------------------------------+
//| Get flags                                                        |
//+------------------------------------------------------------------+
uint CSqlite::Flags(void) const
  {
   return m_flags;
  }
//+------------------------------------------------------------------+
//| Get table names                                                  |
//+------------------------------------------------------------------+
CHashSet<string> *CSqlite::TableNames(void)
  {
   return ::GetPointer(m_table_names);
  }
//+------------------------------------------------------------------+
//| Get an SQL-request handle                                        |
//+------------------------------------------------------------------+
int CSqlite::SqlRequestHandle(void) const
  {
   return m_sql_request_ha;
  };
//+------------------------------------------------------------------+
//| Get an SQL-request                                               |
//+------------------------------------------------------------------+
string CSqlite::SqlRequest(void) const
  {
   return m_sql_request;
  };
//+------------------------------------------------------------------+
//| Find the structure                                               |
//+------------------------------------------------------------------+
bool CSqlite::Structure(const string _name, const bool _is_temp = false)
  {
   string sql_request =::StringFormat("SELECT sql FROM sqlite_schema WHERE name = '%s';", _name);
   if(_is_temp)
      sql_request =::StringFormat("SELECT sql FROM sqlite_temp_schema WHERE name = '%s';", _name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select a table                                                   |
//+------------------------------------------------------------------+
bool CSqlite::SelectTable(const string _table_name, const bool _is_temp = false)
  {
   m_curr_table_name = NULL;
//--- check a names array
   bool is_table_name, table_exists;
   is_table_name = m_table_names.Contains(_table_name);
   table_exists = true;
   if(_is_temp)
     {
      table_exists = is_table_name;
     }
   else
     {
      table_exists = TableExists(_table_name);
     }
   if(table_exists)
     {
      if(!is_table_name)
         m_table_names.Add(_table_name);
      m_curr_table_name = _table_name;
     }
   return m_curr_table_name != NULL;
  }
//+------------------------------------------------------------------+
//| Create a new table                                               |
//+------------------------------------------------------------------+
bool CSqlite::CreateTable(const string _table_name, const string &_col_names[],
                            const bool _not_exists = true, const bool _is_temp = false)
  {
   if(DropTable(_table_name))
     {
      string temp_str, no_exist_str;
      temp_str = no_exist_str = "";
      if(_is_temp)
         temp_str = " TEMP";
      if(_not_exists)
         no_exist_str = " IF NOT EXISTS";
      string sql_request =::StringFormat("CREATE%s TABLE%s %s(", temp_str,
                                         no_exist_str, _table_name);
      for(int idx = 0; idx <::ArraySize(_col_names); idx++)
         sql_request += "\n" + _col_names[idx];
      sql_request += ");";
      if(!Select(sql_request))
         return false;
      ::ResetLastError();
      if(!m_table_names.Add(_table_name))
        {
         ::PrintFormat(__FUNCTION__ + ": failed to add a table, code %d", ::GetLastError());
         return false;
        }
      if(!SelectTable(_table_name, _is_temp))
        {
         ::Print(__FUNCTION__ + ": failed to select the table name");
         return false;
        }
      return true;
     }
   return false;
  }
//+------------------------------------------------------------------+
//| Create a new table as                                            |
//+------------------------------------------------------------------+
bool CSqlite::CreateTableAs(const string _table_name, const string _sql_request,
                              const bool _not_exists = true, const bool _is_temp = false)
  {
   if(DropTable(_table_name))
     {
      string temp_str, no_exist_str;
      temp_str = no_exist_str = "";
      if(_is_temp)
         temp_str = " TEMP";
      if(_not_exists)
         no_exist_str = " IF NOT EXISTS";
      string sql_request =::StringFormat("CREATE%s TABLE%s %s AS \n%s", temp_str,
                                         no_exist_str, _table_name, _sql_request);
      if(!Select(sql_request))
         return false;
      ::ResetLastError();
      if(!m_table_names.Add(_table_name))
        {
         ::PrintFormat(__FUNCTION__ + ": failed to add a table, code %d", ::GetLastError());
         return false;
        }
      if(!SelectTable(_table_name, _is_temp))
        {
         ::Print(__FUNCTION__ + ": failed to select the table name");
         return false;
        }
      return true;
     }
   return false;
  }
//+------------------------------------------------------------------+
//| Drop the specified table                                         |
//+------------------------------------------------------------------+
bool CSqlite::DropTable(const string _table_name)
  {
//--- check if exists
   if(TableExists(_table_name))
     {
      string sql_request =::StringFormat("DROP TABLE %s", _table_name);
      if(!Select(sql_request))
         return false;
     }
//--- delete from a names array
   bool is_table_name = m_table_names.Contains(_table_name);
   if(is_table_name)
     {
      if(!m_table_names.Remove(_table_name))
         ::PrintFormat(__FUNCTION__ + ": failed to delete a table, code %d", ::GetLastError());
     }
   return true;
  }
//+------------------------------------------------------------------+
//| Drop the selected table                                          |
//+------------------------------------------------------------------+
bool CSqlite::DropCurrentTable(void)
  {
   return DropTable(m_curr_table_name);
  }
//+------------------------------------------------------------------+
//| Does a table exist?                                              |
//+------------------------------------------------------------------+
bool CSqlite::TableExists(const string _table_name)
  {
   return ::DatabaseTableExists(m_handle, _table_name);
  }
//+------------------------------------------------------------------+
//| Exports a table to a CSV file                                    |
//+------------------------------------------------------------------+
long CSqlite::ExportTable(const string _file_name, const uint _flags,
                            const string _separator)
  {
   return ::DatabaseExport(m_handle, m_curr_table_name, _file_name, _flags, _separator);
  }
//+------------------------------------------------------------------+
//| Import data from a file into a table                             |
//+------------------------------------------------------------------+
long CSqlite::ImportTable(const string _table_name, const string _file_name, const uint _flags,
                            const string _separator = ";", const ulong _rows_to_skip = 0,
                            const string  _skip_comments = NULL)
  {
   long imported =::DatabaseImport(m_handle, _table_name, _file_name, _flags, _separator,
                                   _rows_to_skip, _skip_comments);
   if(imported > 0)
      SelectTable(_table_name);
   return imported;
  }
//+------------------------------------------------------------------+
//| Rename a table                                                   |
//+------------------------------------------------------------------+
bool CSqlite::RenameTable(const string _new_name)
  {
   string sql_request =::StringFormat("ALTER TABLE %s ", m_curr_table_name);
   sql_request +=::StringFormat("RENAME TO %s", _new_name);
   if(!Select(sql_request))
      return false;
   return true;
  }
//+------------------------------------------------------------------+
//| Insert a single row into the table                               |
//| Schema table:                                                    |
//|    INSERT INTO table (column1,column2 ,..)                       |
//|    VALUES( value1, value2 ,...);                                 |
//+------------------------------------------------------------------+
bool CSqlite::InsertSingleRow(const string &_col_names[], const string &_col_vals[])
  {
   uint names_num, vals_num;
   names_num = _col_names.Size();
   vals_num = _col_vals.Size();
   if(vals_num == names_num)
     {
      string insert_str =::StringFormat("INSERT INTO %s(", m_curr_table_name);
      string vals_str = "\nVALUES(";
      for(uint c_idx = 0; c_idx < names_num; c_idx++)
        {
         string curr_name = _col_names[c_idx];
         insert_str += curr_name + ",";
         string curr_val = _col_vals[c_idx];
         vals_str += curr_val + ",";
        }
      insert_str =::StringSubstr(insert_str, 0, ::StringLen(insert_str) - 1); // delete the last comma
      insert_str += ")";
      vals_str =::StringSubstr(vals_str, 0, ::StringLen(vals_str) - 1); // delete the last comma
      vals_str += ");";
      string sql_request = insert_str + vals_str;
      if(Select(sql_request))
         return true;
     }
   return false;
  }
//+------------------------------------------------------------------+
//| Insert a multiple rows into the table                            |
//| Schema table:                                                    |
//| INSERT INTO table1 (column1,column2 ,..)                         |
//|    VALUES                                                        |
//|    (value1,value2 ,...),                                         |
//|    (value1,value2 ,...),                                         |
//|    ...                                                           |
//|    (value1,value2 ,...);                                         |
//+------------------------------------------------------------------+
bool CSqlite::InsertMultipleRows(const string &_col_names[], const CArrayString &_rows_arr)
  {
   uint names_num, rows_num;
   names_num = _col_names.Size();
   string insert_str =::StringFormat("INSERT INTO %s(", m_curr_table_name);
   for(uint c_idx = 0; c_idx < names_num; c_idx++)
     {
      string curr_name = _col_names[c_idx];
      insert_str += curr_name + ",";
     }
   insert_str =::StringSubstr(insert_str, 0, ::StringLen(insert_str) - 1); // delete the last comma
   insert_str += ")";
   string vals_str = "\nVALUES";
   ushort separator = ',';
   rows_num = _rows_arr.Total();
   for(uint r_idx = 0; r_idx < rows_num; r_idx++)
     {
      string curr_row_str = _rows_arr.At(r_idx);
      string split_result[];
      if(::StringSplit(curr_row_str, separator, split_result) != names_num)
         return false;
      if(::StringLen(curr_row_str) > 0)
         vals_str += "\n(" + curr_row_str + "),";
     }
   vals_str =::StringSubstr(vals_str, 0, ::StringLen(vals_str) - 1); // delete the last comma
   vals_str += ";";
   string sql_request = insert_str + vals_str;
   if(Select(sql_request))
      return true;
   return false;
  }
//+------------------------------------------------------------------+
//| Update existing data in a table                                  |
//| Schema table:                                                    |
//|    UPDATE table                                                  |
//|    SET column_1 = new_value_1,                                   |
//|        column_2 = new_value_2                                    |
//|    WHERE                                                         |
//|        search_condition;                                         |
//+------------------------------------------------------------------+
bool CSqlite::Update(const string &_col_names[], const string &_col_vals[],
                       const string _where_cond)
  {
   uint names_num, vals_num;
   names_num = _col_names.Size();
   vals_num = _col_vals.Size();
   if(vals_num == names_num)
     {
      string set_str = "\nSET ";
      for(uint c_idx = 0; c_idx < names_num; c_idx++)
        {
         string curr_name = _col_names[c_idx];
         string curr_val = _col_vals[c_idx];
         set_str += curr_name + " = " + curr_val;
         set_str += ",";
        }
      set_str =::StringSubstr(set_str, 0, ::StringLen(set_str) - 1); // delete the last comma
      //--- execute
      string sql_request =::StringFormat("UPDATE %s", m_curr_table_name) + set_str +
                          "\nWHERE " + "\n" + _where_cond;
      if(Select(sql_request))
         return true;
     }
   return false;
  }
//+------------------------------------------------------------------+
//| Empty a table                                                    |
//| Schema table:                                                    |
//|    DELETE FROM table;                                            |
//+------------------------------------------------------------------+
bool CSqlite::EmptyTable(void)
  {
   string sql_request =::StringFormat("DELETE FROM %s", m_curr_table_name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Delete existing data in a table                                  |
//| Schema table:                                                    |
//|    DELETE FROM table                                             |
//|    WHERE                                                         |
//|        search_condition;                                         |
//+------------------------------------------------------------------+
bool CSqlite::Delete(const string _where_cond)
  {
   string sql_request =::StringFormat("DELETE FROM %s", m_curr_table_name) +
                       "\nWHERE " + "\n" + _where_cond;
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Replace existing data in a table                                 |
//| Schema table:                                                    |
//|    REPLACE INTO table(column_list)                               |
//|    VALUES(value_list);                                           |
//+------------------------------------------------------------------+
bool CSqlite::Replace(const string &_col_names[], const string &_col_vals[])
  {
   uint names_num, vals_num;
   names_num = _col_names.Size();
   vals_num = _col_vals.Size();
   if(vals_num == names_num)
     {
      string replace_str =::StringFormat("REPLACE INTO %s(", m_curr_table_name);
      string vals_str = "\nVALUES(";
      for(uint c_idx = 0; c_idx < names_num; c_idx++)
        {
         string curr_name = _col_names[c_idx];
         replace_str += curr_name + ",";
         string curr_val = _col_vals[c_idx];
         vals_str += curr_val + ",";
        }
      replace_str =::StringSubstr(replace_str, 0, ::StringLen(replace_str) - 1); // delete the last comma
      replace_str += ")";
      vals_str =::StringSubstr(vals_str, 0, ::StringLen(vals_str) - 1); // delete the last comma
      vals_str += ");";
      string sql_request = replace_str + vals_str;
      if(Select(sql_request))
         return true;
     }
   return false;
  }
//+------------------------------------------------------------------+
//| Add a new column to a table                                      |
//+------------------------------------------------------------------+
bool CSqlite::AddColumn(const string &_col_definition)
  {
   string sql_request =::StringFormat("ALTER TABLE %s", m_curr_table_name);
   sql_request +=::StringFormat("\nADD COLUMN %s", _col_definition);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Rename a column of a table                                       |
//+------------------------------------------------------------------+
bool CSqlite::RenameColumn(const string _curr_name, const string _new_name)
  {
   string sql_request =::StringFormat("ALTER TABLE %s", m_curr_table_name);
   sql_request +=::StringFormat("\nRENAME COLUMN %s TO %s", _curr_name, _new_name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Print a table                                                    |
//+------------------------------------------------------------------+
long CSqlite::PrintTable(const uint _flags = 0) const
  {
   return ::DatabasePrint(m_handle, m_curr_table_name, _flags);
  }
//+------------------------------------------------------------------+
//| Select from a table                                              |
//+------------------------------------------------------------------+
bool CSqlite::SelectFrom(const string &_col_names[])
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", m_curr_table_name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select from a table grouped by                                   |
//+------------------------------------------------------------------+
bool CSqlite::SelectFromGroupBy(const string &_col_names[], const string &_group_names[])
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", m_curr_table_name);
   sql_request += " GROUP BY ";
   for(int o_idx = 0; o_idx <::ArraySize(_group_names); o_idx++)
      sql_request += _group_names[o_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select from a table ordered by                                   |
//+------------------------------------------------------------------+
bool CSqlite::SelectFromOrderedBy(const string &_col_names[], const string &_ord_names[])
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", m_curr_table_name);
   sql_request += " ORDER BY ";
   for(int o_idx = 0; o_idx <::ArraySize(_ord_names); o_idx++)
      sql_request += _ord_names[o_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select distinct rows from a table                                |
//+------------------------------------------------------------------+
bool CSqlite::SelectDistinctFrom(const string &_col_names[])
  {
   string sql_request = "SELECT DISTINCT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", m_curr_table_name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select distinct rows from a table ordered by                     |
//+------------------------------------------------------------------+
bool CSqlite::SelectDistinctFromOrderedBy(const string &_col_names[], const string &_ord_names[])
  {
   string sql_request = "SELECT DISTINCT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", m_curr_table_name);
   sql_request += " ORDER BY ";
   for(int o_idx = 0; o_idx <::ArraySize(_ord_names); o_idx++)
      sql_request += _ord_names[o_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select from a table on condition                                 |
//+------------------------------------------------------------------+
bool CSqlite::SelectFromWhere(const string &_col_names[], const string _where_cond)
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s WHERE %s", m_curr_table_name, _where_cond);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Select from a table on condition ordered by                      |
//+------------------------------------------------------------------+
bool CSqlite::SelectFromWhereOrderedBy(const string &_col_names[], const string _where_cond,
      const string &_ord_names[])
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s WHERE %s", m_curr_table_name, _where_cond);
   sql_request += " ORDER BY ";
   for(int o_idx = 0; o_idx <::ArraySize(_ord_names); o_idx++)
      sql_request += _ord_names[o_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Inner join                                                       |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|        (table1.column1, table2.column2,..)                       |
//|    FROM table1                                                   |
//|    INNER JOIN table2                                             |
//|    ON join_condition;                                            |
//+------------------------------------------------------------------+
bool CSqlite::InnerJoin(const string &_col_names[], const string _other_table,
                          const string _join_cond)
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", _other_table);
   sql_request +=::StringFormat(" INNER JOIN %s ", m_curr_table_name);
   sql_request +=::StringFormat(" ON %s ", _join_cond);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Left join                                                        |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|        (table1.column1, table2.column2,..)                       |
//|    FROM table1                                                   |
//|    LEFT OUTER JOIN table2                                        |
//|    ON join_condition;                                            |
//+------------------------------------------------------------------+
bool CSqlite::LeftJoin(const string &_col_names[], const string _other_table,
                         const string _join_cond)
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", _other_table);
   sql_request +=::StringFormat(" LEFT JOIN %s", m_curr_table_name);
   sql_request +=::StringFormat(" ON %s ", _join_cond);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Cross join                                                       |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|        (column1,column2 ,..)                                     |
//|    FROM table1                                                   |
//|    CROSS JOIN table2;                                            |
//+------------------------------------------------------------------+
bool CSqlite::CrossJoin(const string &_col_names[], const string _other_table)
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", _other_table);
   sql_request +=::StringFormat(" CROSS JOIN %s ", m_curr_table_name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Self join                                                        |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|        (x.column_name, y.column_name..)                          |
//|    FROM table1 x, table1 y                                       |
//|    WHERE x.column_name1 = y.column_name1;                        |
//+------------------------------------------------------------------+
bool CSqlite::SelfJoin(const string &_col_names[], const string _from,
                         const string _where_cond)
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", _from);
   sql_request +=::StringFormat(" WHERE %s ", _where_cond);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Left join                                                        |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|        (table1.column1, table2.column2,..)                       |
//|    FROM table1                                                   |
//|    FULL OUTER JOIN table2                                        |
//|    ON join_condition;                                            |
//+------------------------------------------------------------------+
bool CSqlite::FullOuterJoin(const string &_col_names[], const string _other_table,
                              const string _join_cond)
  {
   string sql_request = "SELECT ";
   for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat(" FROM %s", _other_table);
   sql_request +=::StringFormat(" FULL OUTER JOIN %s", m_curr_table_name);
   sql_request +=::StringFormat(" ON %s ", _join_cond);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Union                                                            |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|      (table1.column1, table1.column2,..)                         |
//|    FROM table1                                                   |
//|    WHERE search_condition1                                       |
//|    UNION [ALL]                                                   |
//|    SELECT                                                        |
//|      (table2.column1, table2.column2,..)                         |
//|    FROM table2                                                   |
//|    WHERE search_condition2;                                      |
//+------------------------------------------------------------------+
bool CSqlite::Union(const string &_col_names[], const string _where_cond1,
                      const string _other_table, const string &_other_col_names[],
                      const string _where_cond2, const bool _all = false)
  {
   uint col_size, other_col_size;
   col_size = _col_names.Size();
   other_col_size = _other_col_names.Size();
   if(col_size != other_col_size)
      return false;
   string sql_request = "SELECT ";
   for(uint n_idx = 0; n_idx < col_size; n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat("\nFROM %s", m_curr_table_name);
   if(::StringLen(_where_cond1) > 0)
      sql_request += "\nWHERE " + _where_cond1;
   string all_op_str = "";
   if(_all)
      all_op_str = "ALL";
   sql_request +=::StringFormat("\nUNION %s", all_op_str);
   sql_request += "\nSELECT ";
   for(uint n_idx = 0; n_idx < other_col_size; n_idx++)
      sql_request += _other_col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat("\nFROM %s", _other_table);
   if(::StringLen(_where_cond1) > 0)
      sql_request += "\nWHERE " + _where_cond2;
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Except                                                           |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|      (table1.column1, table1.column2,..)                         |
//|    FROM table1                                                   |
//|    EXCEPT                                                        |
//|    SELECT                                                        |
//|      (table2.column1, table2.column2,..)                         |
//|    FROM table2;                                                  |
//+------------------------------------------------------------------+
bool CSqlite::Except(const string &_col_names[], const string _other_table,
                       const string &_other_col_names[])
  {
   uint col_size, other_col_size;
   col_size = _col_names.Size();
   other_col_size = _other_col_names.Size();
   if(col_size != other_col_size)
      return false;
   string sql_request = "SELECT ";
   for(uint n_idx = 0; n_idx < col_size; n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat("\nFROM %s", m_curr_table_name);
   sql_request += "\nEXCEPT";
   sql_request += "\nSELECT ";
   for(uint n_idx = 0; n_idx < other_col_size; n_idx++)
      sql_request += _other_col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat("\nFROM %s", _other_table);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| Except                                                           |
//| Schema table:                                                    |
//|    SELECT                                                        |
//|      (table1.column1, table1.column2,..)                         |
//|    FROM table1                                                   |
//|    INTERSECT                                                     |
//|    SELECT                                                        |
//|      (table2.column1, table2.column2,..)                         |
//|    FROM table2;                                                  |
//+------------------------------------------------------------------+
bool CSqlite::Intersect(const string &_col_names[], const string _other_table,
                          const string &_other_col_names[])
  {
   uint col_size, other_col_size;
   col_size = _col_names.Size();
   other_col_size = _other_col_names.Size();
   if(col_size != other_col_size)
      return false;
   string sql_request = "SELECT ";
   for(uint n_idx = 0; n_idx < col_size; n_idx++)
      sql_request += _col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat("\nFROM %s", m_curr_table_name);
   sql_request += "\nINTERSECT";
   sql_request += "\nSELECT ";
   for(uint n_idx = 0; n_idx < other_col_size; n_idx++)
      sql_request += _other_col_names[n_idx] + ",";
   sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
   sql_request +=::StringFormat("\nFROM %s", _other_table);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| List all the tables                                              |
//+------------------------------------------------------------------+
bool CSqlite::ListTables(CArrayString &_tables_list, const bool _to_print = false)
  {
   if(!_tables_list.Shutdown())
      return false;
   string sql_request =
      "SELECT name FROM ( "
      "SELECT * FROM sqlite_schema "
      "UNION ALL "
      "SELECT * FROM sqlite_temp_schema) "
      "WHERE type ='table' AND name NOT LIKE 'sqlite_%'"
      "ORDER BY name;";
//--- real
   if(!Select(sql_request))
      return false;
   if(_to_print)
      ::PrintFormat("\nThe current DB \"%s\" includes such tables:", m_name);
   uint t_cnt = 0;
   while(SqlRequestRead())
     {
      string curr_table_name = ColumnText(0);
      if(curr_table_name != NULL)
        {
         _tables_list.Add(curr_table_name);
         if(_to_print)
           {
            ::PrintFormat("   Table #%d: %s", t_cnt + 1, curr_table_name);
            t_cnt++;
           }
        }
     }
   FinalizeSqlRequest();
   return true;
  }
//+------------------------------------------------------------------+
//| Create a request                                                 |
//+------------------------------------------------------------------+
bool CSqlite::CreateSqlRequest(const string _sql_request)
  {
   m_sql_request_ha =::DatabasePrepare(m_handle, _sql_request);
   m_sql_request = _sql_request;
   return m_sql_request_ha != INVALID_HANDLE;
  }
//+------------------------------------------------------------------+
//| Execute a request                                                |
//+------------------------------------------------------------------+
bool CSqlite::ExecuteSqlRequest(void)
  {
   return ::DatabaseExecute(m_handle, m_sql_request);
  }
//+------------------------------------------------------------------+
//| Set a parameter value                                            |
//+------------------------------------------------------------------+
template<typename T>
bool CSqlite::SqlRequestBind(const int _index, const T _val)
  {
   return ::DatabaseBind(m_sql_request_ha, _index, _val);
  }
//+------------------------------------------------------------------+
//| Set an array as a parameter value                                |
//+------------------------------------------------------------------+
template<typename T>
bool CSqlite::SqlRequestBindArray(const int _index, const T &_vals[])
  {
   return ::DatabaseBindArray(m_sql_request_ha, _index, _vals);
  }
//+------------------------------------------------------------------+
//| Reset a request                                                  |
//+------------------------------------------------------------------+
bool CSqlite::ResetSqlRequest(void) const
  {
   return ::DatabaseReset(m_sql_request_ha);
  }
//+------------------------------------------------------------------+
//| Exports an SQL request execution result to a CSV file            |
//+------------------------------------------------------------------+
long CSqlite::ExportSqlRequest(const string _file_name, const uint _flags,
                                 const string _separator)
  {
   return ::DatabaseExport(m_handle, m_sql_request, _file_name, _flags, _separator);
  }
//+------------------------------------------------------------------+
//| Move to the next entry                                           |
//+------------------------------------------------------------------+
bool CSqlite::SqlRequestRead(void)
  {
   return ::DatabaseRead(m_sql_request_ha);
  }
//+-------------------------------------------------------------------+
//| Moves to the next record and read data into the structure from it |
//+-------------------------------------------------------------------+
template<typename ST>
bool CSqlite::SqlRequestReadBind(ST &_s_object)
  {
   return ::DatabaseReadBind(m_sql_request_ha, _s_object);
  }
//+------------------------------------------------------------------+
//| Removes an sql request                                           |
//+------------------------------------------------------------------+
void CSqlite::FinalizeSqlRequest(void)
  {
   ::DatabaseFinalize(m_sql_request_ha);
   m_sql_request_ha = INVALID_HANDLE;
  }
//+------------------------------------------------------------------+
//| Print an SQL request                                             |
//+------------------------------------------------------------------+
long CSqlite::PrintSqlRequest(const uint _flags = 0) const
  {
   return ::DatabasePrint(m_handle, m_sql_request, _flags);
  }
//+-------------------------------------------------------------------+
//| Get the number of fields in a request                             |
//+-------------------------------------------------------------------+
int CSqlite::ColumnsCount(void) const
  {
   return ::DatabaseColumnsCount(m_sql_request_ha);
  }
//+-------------------------------------------------------------------+
//| Get a field name by index                                         |
//+-------------------------------------------------------------------+
string CSqlite::ColumnName(const int _col) const
  {
   string col_name = NULL, temp_name;
   if(::DatabaseColumnName(m_sql_request_ha, _col, temp_name))
      col_name = temp_name;
   return col_name;
  }
//+-------------------------------------------------------------------+
//| Get a field type by index                                         |
//+-------------------------------------------------------------------+
ENUM_DATABASE_FIELD_TYPE CSqlite::ColumnType(const int _col) const
  {
   return ::DatabaseColumnType(m_sql_request_ha, _col);
  }
//+-------------------------------------------------------------------+
//| Get a field size in bytes                                         |
//+-------------------------------------------------------------------+
int CSqlite::ColumnSize(const int _col) const
  {
   return ::DatabaseColumnSize(m_sql_request_ha, _col);
  }
//+-------------------------------------------------------------------+
//| Get a field value as a string                                     |
//+-------------------------------------------------------------------+
string CSqlite::ColumnText(const int _col) const
  {
   string col_txt = NULL, temp_txt;
   if(::DatabaseColumnText(m_sql_request_ha, _col, temp_txt))
      col_txt = temp_txt;
   return col_txt;
  }
//+------------------------------------------------------------------+
//| Get the int type value                                           |
//+------------------------------------------------------------------+
int CSqlite::ColumnInteger(const int _col) const
  {
   int col_val = WRONG_VALUE, temp_val;
   if(::DatabaseColumnInteger(m_sql_request_ha, _col, temp_val))
      col_val = temp_val;
   return col_val;
  }
//+------------------------------------------------------------------+
//| Get the long type value                                          |
//+------------------------------------------------------------------+
long CSqlite::ColumnLong(const int _col) const
  {
   long col_val = WRONG_VALUE, temp_val;
   if(::DatabaseColumnLong(m_sql_request_ha, _col, temp_val))
      col_val = temp_val;
   return col_val;
  }
//+------------------------------------------------------------------+
//| Get the double type value                                        |
//+------------------------------------------------------------------+
double CSqlite::ColumnDouble(const int _col) const
  {
   double col_val = WRONG_VALUE, temp_val;
   if(::DatabaseColumnDouble(m_sql_request_ha, _col, temp_val))
      col_val = temp_val;
   return col_val;
  }
//+------------------------------------------------------------------+
//| Get a field value as an array                                    |
//+------------------------------------------------------------------+
template<typename T>
bool CSqlite::ColumnBlob(const int _col, T &_vals[]) const
  {
   return ::DatabaseColumnBlob(m_sql_request_ha, _col, _vals);
  }
//+---------------------------------------------------------------------+
//| Create view                                                         |
//| Schema table:                                                       |
//|    CREATE [TEMP] VIEW [IF NOT EXISTS] view_name AS                  |
//|    SELECT column1, column2.....                                     |
//|    FROM table_name;                                                 |
//+---------------------------------------------------------------------+
bool CSqlite::CreateView(const string _view_name, const string &_col_names[],
                           const bool _not_exists = true, const bool _is_temp = false)
  {
   if(DropView(_view_name))
     {
      string temp_str, no_exist_str;
      temp_str = no_exist_str = "";
      if(_is_temp)
         temp_str = " TEMP";
      if(_not_exists)
         no_exist_str = " IF NOT EXISTS";
      string sql_request =::StringFormat("CREATE%s VIEW%s %s AS", temp_str,
                                         no_exist_str, _view_name);
      sql_request += "\nSELECT ";
      for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
         sql_request += "\n" + _col_names[n_idx] + ",";
      sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
      sql_request +=::StringFormat("\nFROM %s", m_curr_table_name);
      return Select(sql_request);
     }
   return false;
  }
//+---------------------------------------------------------------------+
//| Create view                                                         |
//| Schema table:                                                       |
//|    CREATE [TEMP] VIEW [IF NOT EXISTS] view_name AS                  |
//|    SELECT column1, column2.....                                     |
//|    FROM table_name                                                  |
//|    WHERE [condition];                                               |
//+---------------------------------------------------------------------+
bool CSqlite::CreateViewWhere(const string _view_name, const string &_col_names[],
                                const string _where_cond,
                                const bool _not_exists = true, const bool _is_temp = false)
  {
   if(DropView(_view_name))
     {
      string temp_str, no_exist_str;
      temp_str = no_exist_str = "";
      if(_is_temp)
         temp_str = " TEMP";
      if(_not_exists)
         no_exist_str = " IF NOT EXISTS";
      string sql_request =::StringFormat("CREATE%s VIEW%s %s AS", temp_str,
                                         no_exist_str, _view_name);
      sql_request += "\nSELECT ";
      for(int n_idx = 0; n_idx <::ArraySize(_col_names); n_idx++)
         sql_request += "\n" + _col_names[n_idx] + ",";
      sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1);
      sql_request +=::StringFormat("\nFROM %s", m_curr_table_name);
      sql_request += "\nWHERE " + _where_cond;
      return Select(sql_request);
     }
   return false;
  }
//+------------------------------------------------------------------+
//| Delete a view                                                    |
//+------------------------------------------------------------------+
bool CSqlite::DropView(const string _view_name, const bool _if_exists = true)
  {
   string exist_str = "";
   if(_if_exists)
      exist_str = " IF EXISTS";
   string sql_request =::StringFormat("DROP VIEW%s %s", exist_str, _view_name);
   return Select(sql_request);
  }
//+------------------------------------------------------------------+
//| List all the views                                               |
//+------------------------------------------------------------------+
bool CSqlite::ListViews(CArrayString &_views_list, const bool _to_print = false)
  {
   if(!_views_list.Shutdown())
      return false;
   string sql_request =
      "SELECT name FROM ( "
      "SELECT * FROM sqlite_schema "
      "UNION ALL "
      "SELECT * FROM sqlite_temp_schema) "
      "WHERE type ='view'"
      "ORDER BY name;";
//--- real
   if(!Select(sql_request))
      return false;
   if(_to_print)
      ::PrintFormat("\nThe current DB \"%s\" includes such views:", m_name);
   uint v_cnt = 0;
   while(SqlRequestRead())
     {
      string curr_view_name = ColumnText(0);
      if(curr_view_name != NULL)
        {
         _views_list.Add(curr_view_name);
         if(_to_print)
           {
            ::PrintFormat("   View #%d: %s", v_cnt + 1, curr_view_name);
            v_cnt++;
           }
        }
     }
   FinalizeSqlRequest();
   return true;
  }
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                     A p p . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   v e r s i o n       " 1 . 0 0 "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   < _ A t a \ W e b \ w s \ w s c l i e n t . m q h >  
 # i n c l u d e   < _ A t a \ G e n e r a l \ T r a d e s t a t i s t i c s . m q h >  
 # i n c l u d e   < _ A t a \ G e n e r a l \ P e r m i s s i o n s . m q h >  
 # i n c l u d e   < _ A t a \ G e n e r a l \ L o g i n . m q h >  
 # i n c l u d e   < _ A t a \ S y m b o l \ B a s e \ S y m b o l . m q h >  
 # i n c l u d e   < _ A t a \ L o g \ S e q L o g g e r . m q h >  
 # i n c l u d e   < _ A t a \ W e b \ R e q u e s t . m q h >  
 # i n c l u d e   " T a s k \ T a s k . m q h "  
 # i n c l u d e   " H i s t o r y \ H i s t o r y . m q h "  
 # i n c l u d e   " S e r i e s \ S e r i e s . m q h "  
 # i n c l u d e   " E q u i t y \ E q u i t y . m q h "  
 # i n c l u d e   " D a t a b a s e \ D a t a b a s e . m q h "  
 # i n c l u d e   < F i l e s \ F i l e T x t . m q h >  
 # i n c l u d e   < _ A t a \ G e n e r a l \ F u n c . m q h >  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C l a s s   C W e b S o c k e t A p p                                                                                             |  
 / / |                                                                                                                                     |  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C W e b S o c k e t A p p :   p u b l i c   W e b S o c k e t C l i e n t < H y b i >  
   {  
 p r i v a t e :  
     C T a s k                             * T a s k ;  
     C L o g i n                           L o g i n ;  
     C H i s t o r y                       * H i s t o r y ;  
     C S e r i e s                         * S e r i e s ;  
     C E q u i t y                         * E q u i t y ;  
     C T r a d e S t a t i s t i c s       * S t a t e m e n t ;  
  
     C D a t a b a s e                     D B ;  
     C P e r m i s s i o n s               P e r m i s s i o n s ;  
  
     C R e q u e s t                       R e s u l t A P I ;  
  
     d a t e t i m e                       m _ l a s t _ m s g _ t i m e ;  
     s t r i n g                           m _ n o d e _ i d ;  
     b o o l                               m _ i s _ p a s s e ;  
  
     b o o l                               C h e c k A c c o u n t ( v o i d )  
       {  
         b o o l   c h e c k   =   f a l s e ;  
         i f ( I S _ P O I N T E R _ D Y N A M I C ( T a s k ) )  
             i f ( : : A c c o u n t I n f o I n t e g e r ( A C C O U N T _ L O G I N )   = =   T a s k . L o g i n ( ) )  
                 r e t u r n   t r u e ;  
  
         i f ( ! c h e c k )  
             T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ L O G I N _ F A I L ) ;  
         / / - - -  
         r e t u r n   c h e c k ;  
       }  
  
     b o o l                               T r y L o g i n ( v o i d ) ;  
     b o o l                               T r y S e n d T e x t ( c o n s t   s t r i n g   _ m s g ) ;  
     b o o l                               T r y S e n d R e s u l t ( v o i d ) ;  
     v o i d                               S e n d S e q T a s k L o g ( c o n s t   s t r i n g   m e s s a g e ) ;  
     b o o l                               L o a d S y m b o l s D a t a ( c o n s t   b o o l   _ i s _ f u l l   =   f a l s e ) ;  
  
     v o i d                               D o T a s k ( v o i d ) ;  
     b o o l                               D o L o g i n ( v o i d ) ;  
     b o o l                               D o C h e c k D b C o n n e c t i o n ( v o i d ) ;  
     b o o l                               D o U p d a t e H i s t o r y ( v o i d ) ;  
     b o o l                               D o L o a d D a t a ( v o i d ) ;  
     b o o l                               D o C r e a t e S e r i e s ( v o i d ) ;  
     b o o l                               D o U p d a t e E q u i t y ( v o i d ) ;  
     b o o l                               D o U p d a t e S t a t e m e n t ( v o i d ) ;  
     b o o l                               D o S t o r e D a t a O n D b ( v o i d ) ;  
  
     v o i d                               D o T a s k R e s e t ( v o i d ) ;  
     v o i d                               D o T a s k U p d a t e ( v o i d ) ;  
  
     v o i d                               R e s e t ( v o i d )  
       {  
         F R E E ( H i s t o r y ) ;  
         F R E E ( S e r i e s ) ;  
         F R E E ( E q u i t y ) ;  
         F R E E ( S t a t e m e n t ) ;  
       }  
 p u b l i c :  
                                           C W e b S o c k e t A p p ( c o n s t   s t r i n g   _ a d d r e s s ,   c o n s t   b o o l   _ u s e C o m p r e s s i o n   =   f a l s e ) ;  
                                         ~ C W e b S o c k e t A p p ( ) ;  
  
     v o i d                               N o d e I d ( c o n s t   s t r i n g   _ k e y )           {   m _ n o d e _ i d   =   _ k e y ; }  
     s t r i n g                           N o d e I d ( v o i d )                         c o n s t   {   r e t u r n   m _ n o d e _ i d ; }  
  
     v o i d                               o n C o n n e c t e d ( )   o v e r r i d e ;  
     v o i d                               o n D i s c o n n e c t ( )   o v e r r i d e ;  
     v o i d                               o n M e s s a g e ( I W e b S o c k e t M e s s a g e   * m s g )   o v e r r i d e ;  
     v o i d                               o n F a i l e d ( v o i d ) ;  
     v o i d                               C h e c k T a s k ( s t r i n g   _ t a s k _ t x t ) ;  
     v o i d                               C h e c k S e r v e r L o s s ( v o i d )  
       {  
         i f ( m _ l a s t _ m s g _ t i m e   <   : : T i m e T r a d e S e r v e r ( )   -   D E F _ W E B S O C K E T _ L O S S _ S E C E N D )  
           {  
             c l o s e ( ) ;  
             m _ l a s t _ m s g _ t i m e   =   : : T i m e T r a d e S e r v e r ( ) ;  
           }  
       }  
     b o o l                               C h e c k S t o p A p p ( v o i d ) ;  
     b o o l                               C h e c k P a u s e A p p ( v o i d ) ;  
     v o i d                               D e s t r o y P o p u p s ( v o i d )     {   L o g i n . D e s t r o y P o p u p s ( ) ; }  
     v o i d                               O p e n L o g i n P o p u p ( v o i d )   {   L o g i n . O p e n L o g i n P o p u p ( ) ; }  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C W e b S o c k e t A p p : : C W e b S o c k e t A p p ( c o n s t   s t r i n g   _ a d d r e s s ,   c o n s t   b o o l   _ u s e C o m p r e s s i o n   =   f a l s e ) :  
     W e b S o c k e t C l i e n t ( _ a d d r e s s ,   _ u s e C o m p r e s s i o n ) ,  
     m _ n o d e _ i d ( N U L L ) ,  
     m _ l a s t _ m s g _ t i m e ( : : T i m e T r a d e S e r v e r ( ) ) ,  
     m _ i s _ p a s s e ( f a l s e )  
   {  
     R e s u l t A P I . I n i t ( D E F _ R E U L T _ A P I _ U R L ,   D E F _ R E U L T _ A P I _ H E A D E R ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C W e b S o c k e t A p p : : ~ C W e b S o c k e t A p p ( )  
   {  
     R e s e t ( ) ;  
     F R E E ( T a s k ) ;  
     c l o s e ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : o n C o n n e c t e d ( )   o v e r r i d e  
   {  
     W e b S o c k e t C l i e n t < H y b i > : : o n C o n n e c t e d ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : o n D i s c o n n e c t ( )   o v e r r i d e  
   {  
     W e b S o c k e t C l i e n t < H y b i > : : o n D i s c o n n e c t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : o n M e s s a g e ( I W e b S o c k e t M e s s a g e   * m s g )   o v e r r i d e  
   {  
     s t r i n g   r e s p o n s e   =   m s g . g e t S t r i n g ( ) ;  
     : : S t r i n g R e p l a c e ( r e s p o n s e ,   " \ n " ,   " " ) ;  
     F R E E ( m s g ) ;  
 / / - - -  
     C h e c k T a s k ( r e s p o n s e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : o n F a i l e d ( v o i d )  
   {  
     c l o s e ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : C h e c k T a s k ( s t r i n g   _ t a s k _ t x t )  
   {  
     T a s k   =   n e w   C T a s k ;  
     i f ( T a s k . P a r s T a s k J s o n ( _ t a s k _ t x t ,   m _ n o d e _ i d ) )  
       {  
         u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ;  
         i f ( T a s k . I s V a l i d T a s k ( ) )  
           {  
             i f ( D E F _ I S _ D E B U G )  
                 : : P r i n t ( " T a s k :   "   +   _ t a s k _ t x t   +   " . "   +   _ _ F U N C S I G _ _ ) ;  
  
             _ S e q L o g g e r . S e t A p p I d ( T a s k . N o d e I d ( ) ) ;  
             _ S e q L o g g e r . S e t T a s k ( T a s k . T a s k S t i n g ( ) ) ;  
             / / - - -  
             D o T a s k ( ) ;  
           }  
         / / - - -  
         u l o n g   t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         s t r i n g   m e s s a g e   =   N U L L ;  
         i f ( T a s k . R e s u l t . E r r o r C o d e ( )   = =   0 )  
             m e s s a g e   =   " D o n e   I n   "   +   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ;  
         e l s e  
             m e s s a g e   =   " F a i l e d   I n   "   +   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " )   +   "   |   "   +  
                                 " E r r o r :   "   +   T a s k . R e s u l t . E r r o r D e s c r i p t i o n ( ) ;  
  
         m e s s a g e   + =   "   |   "   +  
                               " I d :   "   +   ( s t r i n g ) T a s k . A c c o u n t I d ( )   +   "   |   "   +  
                               " T a s k :   "   +   ( s t r i n g ) T a s k . T a s k S t i n g ( )     +   "   |   "   +  
                               " L o g i n :   "   +   ( s t r i n g ) T a s k . L o g i n ( )   +   "   |   "   +  
                               " P a s s :   "   +   ( s t r i n g ) T a s k . P a s s w o r d ( ) ;  
         / / - - -  
         D e s t r o y P o p u p s ( ) ;  
         O p e n L o g i n P o p u p ( ) ;  
         S e n d S e q T a s k L o g ( m e s s a g e ) ;  
         T r y S e n d R e s u l t ( ) ;  
         / / - - -  
         : : P r i n t ( m e s s a g e   +   "   "   +   _ _ F U N C S I G _ _ ) ;  
         m _ l a s t _ m s g _ t i m e   =   : : T i m e T r a d e S e r v e r ( ) ;  
         / / - - -  
         R e s e t ( ) ;  
       }  
     F R E E ( T a s k ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : D o T a s k ( v o i d )  
   {  
     s w i t c h ( T a s k . T a s k ( ) )  
       {  
         c a s e   T A S K _ T Y P E _ R E S E T :                                 / /   1 -   A l g o :   N o r m a l     -   F r o m   0   t i m e   t o   c u r r e n t   t i m e     -   c a l c   a l l   d a t a  
             D o T a s k R e s e t ( ) ;  
             b r e a k ;  
         c a s e   T A S K _ T Y P E _ U P D A T E :                               / /   2 -   A l g o :   N o r m a l     -   F r o m   l a s t   c h e c k   p o i n t   t i m e   t o   c u r r e n t   t i m e   -   c a l c   a l l   d a t a  
             D o T a s k U p d a t e ( ) ;  
             b r e a k ;  
         d e f a u l t :  
             b r e a k ;  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : T r y L o g i n ( v o i d )  
   {  
     l o n g       l o g i n             =   ( l o n g ) T a s k . L o g i n ( ) ;  
     s t r i n g   s e r v e r           =   T a s k . S e r v e r ( )   = =   " U N F X B - R E A L "   ?   " U N F X B - R e a l "   :   T a s k . S e r v e r ( ) ,  
                   p a s s w o r d       =   T a s k . P a s s w o r d ( ) ;  
     d o u b l e   i n t _ b a l a c e   =   T a s k . I n i t B a l a n c e ( ) ;  
  
     i n t   l o g i n _ r e s u l t   =   L o g i n . T r y L o g i n ( l o g i n ,   p a s s w o r d ,   s e r v e r ,   i n t _ b a l a c e ) ;  
  
     i f ( l o g i n _ r e s u l t   >   L O G I N _ S U C S E S )  
       {  
         i f ( L o g i n . I s I n v a l i d ( ) )  
           {  
             : : P r i n t ( " I n v a l i d   A c c o u n t ! ! ! " ) ;  
             i f ( D B . I s C o n n e c t ( ) )  
                 D B . S e t I n v a l i d A c c o u n t ( T a s k . A c c o u n t I d ( ) ) ;  
             T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ I N V A L I D _ A C C ) ;  
           }  
         e l s e  
             i f ( l o g i n _ r e s u l t   = =   L O G I N _ C O N N _ F A I L )  
                 T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ L O G I N _ C O N N _ F A I L ) ;  
             e l s e  
                 i f ( l o g i n _ r e s u l t   = =   L O G I N _ L O A D _ D E A L S _ F A I L )  
                     T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ L O G I N _ D E A L S _ F A I L ) ;  
                 e l s e  
                     i f ( l o g i n _ r e s u l t   = =   L O G I N _ I N I T _ B A L A N C E _ F A I L )  
                         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ L O G I N _ I N I T _ B A L A N C E _ F A I L ) ;  
                     e l s e  
                         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ L O G I N _ F A I L ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : T r y S e n d T e x t ( c o n s t   s t r i n g   _ m s g )  
   {  
     i n t   u t r y   =   0 ;  
     w h i l e ( u t r y   <   D E F _ A P P _ T R Y _ S E N D _ M A X )  
       {  
         i f ( s e n d ( _ m s g ) )  
             r e t u r n   t r u e ;  
  
         u t r y + + ;  
         : : S l e e p ( D E F _ A P P _ T R Y _ S E N D _ S L E E P _ M S C ) ;  
       }  
 / / - - -  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : T r y S e n d R e s u l t ( v o i d )  
   {  
     b o o l   c h e c k   =   f a l s e ;  
     s t r i n g   r e s u l t   =   " { \ " e v e n t \ " : \ " r e s u l t \ " , \ " d a t a \ " : "   +   T a s k . R e s u l t J s o n ( )   +   " } " ;  
     i f ( D E F _ S E N D _ R E U L T _ T O _ S O C K E T )  
         c h e c k   =   T r y S e n d T e x t ( r e s u l t ) ;  
 / / - - -  
     s t r i n g   r e s p   =   N U L L ;  
     i f ( D E F _ S E N D _ R E U L T _ T O _ A P I   & &   R e s u l t A P I . P o s t ( r e s p ,   r e s u l t ) )  
         c h e c k   =   t r u e ;  
 / / - - -  
     r e t u r n   c h e c k ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : S e n d S e q T a s k L o g ( c o n s t   s t r i n g   m e s s a g e )  
   {  
     _ S e q L o g g e r . S e t E r r o r C o d e ( ( s t r i n g ) T a s k . R e s u l t . E r r o r C o d e ( ) ) ;  
     _ S e q L o g g e r . S e t D e s c r i p t i o n ( T a s k . R e s u l t . E r r o r D e s c r i p t i o n ( ) ) ;  
     _ S e q L o g g e r . S e t S t a t u s ( T a s k . R e s u l t . S t a t u s ( ) ) ;  
     i n t   c o d e   =   T a s k . R e s u l t . E r r o r C o d e ( ) ;  
     i f ( c o d e   = =   D E F _ A P P _ E R R _ L O G I N _ F A I L )  
       {  
         S E Q _ L O G _ E R R O R ( m e s s a g e ) ;  
       }  
     e l s e  
         i f ( c o d e   >   0 )  
           {  
             S E Q _ L O G _ W A R N I N G ( m e s s a g e ) ;  
           }  
         e l s e  
           {  
             S E Q _ L O G _ I N F O ( m e s s a g e ) ;  
           }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : L o a d S y m b o l s D a t a ( c o n s t   b o o l   _ i s _ f u l l   =   f a l s e )  
   {  
     i n t   t o t a l   =   H i s t o r y . S y m b o l L i s t . T o t a l ( ) ;  
 / / - - -  
     i f ( t o t a l   >   0 )  
       {  
         C S y m b o l   s y m b o l ;  
         f o r ( i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
           {  
             C S y m b o l D a t a   * s y m b o l _ d a t a   =   H i s t o r y . S y m b o l L i s t . A t ( i ) ;  
             s t r i n g             n a m e                   =   s y m b o l _ d a t a . N a m e ( ) ;  
             d a t e t i m e         s t a r t _ t i m e       =   s y m b o l _ d a t a . T i m e ( ) ;  
             / / - - -  
             i n t   l t r y   =   0 ;  
             b o o l   i s _ s y m b o l _ i n i t   =   f a l s e ;  
             d o  
               {  
                 i s _ s y m b o l _ i n i t   =   s y m b o l . I n i t ( n a m e ,   P E R I O D _ M 1 ,   s t a r t _ t i m e ) ;  
                 i f ( i s _ s y m b o l _ i n i t )  
                     b r e a k ;  
                 : : S l e e p ( D E F _ A P P _ T R Y _ L O A D _ S Y M B O L _ S L E E P _ M S C ) ;  
                 l t r y + + ;  
               }  
             w h i l e ( ! i s _ s y m b o l _ i n i t   & &   l t r y   < =   D E F _ A P P _ T R Y _ L O A D _ S Y M B O L ) ;  
             / / - - -  
             i f ( ! i s _ s y m b o l _ i n i t )  
               {  
                 i f ( D E F _ I S _ D E B U G )  
                     : : P r i n t ( " s y m b o l I n I t   f a i l : : " ,   n a m e ) ;  
  
                 r e t u r n   f a l s e ;  
               }  
  
             i f ( s y m b o l . C h e c k L o a d H i s t o r y ( )   <   0 )  
               {  
                 i f ( D E F _ I S _ D E B U G )  
                     : : P r i n t ( " C h e c k L o a d H i s t o r y   f a i l : : " ,   n a m e ) ;  
  
                 r e t u r n   f a l s e ;  
               }  
  
             i f ( _ i s _ f u l l )  
               {  
                 u i n t   f l a g s   =   C O P Y _ T I C K S _ I N F O   |   C O P Y _ T I C K S _ T I M E _ M S   |   C O P Y _ T I C K S _ B I D   |  
                                           C O P Y _ T I C K S _ A S K ;  
                 s y m b o l . L o a d T i c k s ( T i m e C u r r e n t ( ) ,   f l a g s ) ;  
               }  
           }  
       }  
 / / - - -   s u c c e e d  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o L o g i n ( v o i d )  
   {  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   l o g i n   t o   a c c o u n t  
     i f ( ! T r y L o g i n ( ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . L o g i n T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " T r y   L o g i n   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . L o g i n T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " L o g i n   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   C h e c k A c c o u n t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o C h e c k D b C o n n e c t i o n ( v o i d )  
   {  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   c h e c k   D B   c o n n e c t i o n  
     i f ( ! D B . I s C o n n e c t ( ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ D B _ C O N N _ F A I L ) ;  
         T a s k . R e s u l t . D b C o n n e c t i o n T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " D B   c o n n e c t i o n   f a i l d : :   "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . D b C o n n e c t i o n T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " D B   c o n n e c t i o n   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o U p d a t e H i s t o r y ( v o i d )  
   {  
     i f ( ! C h e c k A c c o u n t ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   u p d a t e   h i s t o r y  
     H i s t o r y   =   n e w   C H i s t o r y ;  
     i f ( ! I S _ P O I N T E R _ D Y N A M I C ( H i s t o r y )   | |   ! H i s t o r y . U p d a t e ( T a s k ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ H I S T O R Y _ U P D A T E _ F A I L ) ;  
         T a s k . R e s u l t . U p d a t e H i s t o r y T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " H i s t o r y   U p d a t e   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   c h e c k   h a s   d e a l   &   p o s   e l s e   u p d a t e   n o t   n e e d  
     i f ( H i s t o r y . D e a l s L i s t . T o t a l ( )   <   0 )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ N O _ D E A L _ T O U P D A T E ) ;  
         T a s k . R e s u l t . U p d a t e H i s t o r y T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " H i s t o r y   U p d a t e   f a i l "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . U p d a t e H i s t o r y T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " H i s t o r y   U p d a t e   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   C h e c k A c c o u n t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o L o a d D a t a ( v o i d )  
   {  
     i f ( ! C h e c k A c c o u n t ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   l o a d   d a t a  
     i f ( ! L o a d S y m b o l s D a t a ( f a l s e ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ D A T A _ L O A D _ F A I L ) ;  
         T a s k . R e s u l t . L o a d D a t a T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " L o a d   S y m b o l s   D a t a   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . L o a d D a t a T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " L o a d   S y m b o l s   D a t a   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   C h e c k A c c o u n t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o C r e a t e S e r i e s ( v o i d )  
   {  
     i f ( ! C h e c k A c c o u n t ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   c r e a t e   s e r i e s  
     S e r i e s   =   n e w   C S e r i e s ;  
     i f ( ! I S _ P O I N T E R _ D Y N A M I C ( S e r i e s )   | |   ! S e r i e s . C r e a t e ( H i s t o r y ,   T a s k ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ S E R I E S _ C R E A T E _ F A I L ) ;  
         T a s k . R e s u l t . C r e a t e S e r i e s T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " S e r i e s   C r e a t e   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . C r e a t e S e r i e s T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " S e r i e s   C r e a t e   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   C h e c k A c c o u n t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o U p d a t e E q u i t y ( v o i d )  
   {  
     i f ( ! C h e c k A c c o u n t ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   u p d a t e   e q u i t y  
     E q u i t y   =   n e w   C E q u i t y ;  
     i f ( ! I S _ P O I N T E R _ D Y N A M I C ( E q u i t y )   | |   ! E q u i t y . U p d a t e ( H i s t o r y ,   S e r i e s ,   T a s k ,   U P D A T E _ T Y P E _ N O R M A L ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ E Q U I T Y _ U P D A T E _ F A I L ) ;  
         T a s k . R e s u l t . U p d a t e E q u i t y T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " E q u i t y   U p d a t e   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . U p d a t e E q u i t y T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " E q u i t y   U p d a t e   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   C h e c k A c c o u n t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o U p d a t e S t a t e m e n t ( v o i d )  
   {  
     i f ( ! C h e c k A c c o u n t ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   u p d a t e   s t a t e m e n t  
     S t a t e m e n t   =   n e w   C T r a d e S t a t i s t i c s ;  
 / / - - -  
     i f ( ! D E F _ S E T T I N G _ S T O R _ S T A T E M E N T )  
         r e t u r n   t r u e ;  
 / / - - -  
     i f ( ! S t a t e m e n t . C a l c u l a t e ( 0 ,   0 ,   H i s t o r y . I n i t i a l B l a n c e ( ) ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ S E R I E S _ C R E A T E _ F A I L ) ;  
         T a s k . R e s u l t . U p d a t e S t a t e m e n t T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " S t a t e m e n t   U p d a t e   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
     T a s k . R e s u l t . U p d a t e S t a t e m e n t T e r m M s c ( t i m e _ e l a p s e d _ m s ) ;  
     i f ( D E F _ I S _ D E B U G )  
         : : P r i n t ( " S t a t e m e n t   U p d a t e   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
 / / - - -  
     r e t u r n   C h e c k A c c o u n t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : D o S t o r e D a t a O n D b ( v o i d )  
   {  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ,  
                 t i m e _ e l a p s e d _ m s ;  
 / / - - -   s t o r e   d a t a   o n   d b  
     i f ( ! D B . U p d a t e ( T a s k ,   H i s t o r y ,   S e r i e s ,   E q u i t y ,   S t a t e m e n t ) )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         T a s k . R e s u l t . E r r o r C o d e ( D E F _ A P P _ E R R _ D B _ S T O R E _ F A I L ) ;  
         i f ( D E F _ I S _ D E B U G )  
             : : P r i n t ( " D B   U p d a t e   f a i l d "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
         D B . S t o r H i s t o r y ( T a s k ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   s u c c e e d  
     i f ( D E F _ I S _ D E B U G )  
       {  
         t i m e _ e l a p s e d _ m s   = : : G e t T i c k C o u n t 6 4 ( )   -   s t a r t _ c n t ;  
         : : P r i n t ( " D B   U p d a t e   s u c c e s s "   +   "   : :   " ,   C F u n c : : F o r m a t N u m b e r ( t i m e _ e l a p s e d _ m s ,   0 ,   " m s c " ) ) ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : C h e c k S t o p A p p ( v o i d )  
   {  
     s t r i n g   s t r   =   N U L L ;  
 / / - - -  
     s t r i n g   f i l e n a m e   =   " P a n n e l S e r v i c e \ \ S T O P E R . t x t " ;  
     C F i l e T x t   F i l e ;  
     F i l e . S e t C o m m o n ( t r u e ) ;  
  
     i f ( F i l e . O p e n ( f i l e n a m e ,   F I L E _ R E A D   |   F I L E _ W R I T E )   ! =   I N V A L I D _ H A N D L E )  
       {  
         s t r   =   F i l e . R e a d S t r i n g ( ) ;  
         F i l e . C l o s e ( ) ;  
         i f ( s t r   = =   " " )  
             s t r   =   N U L L ;  
  
       }  
 / / - - -  
     r e t u r n   s t r   ! =   N U L L ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C W e b S o c k e t A p p : : C h e c k P a u s e A p p ( v o i d )  
   {  
     s t r i n g   s t r   =   N U L L ;  
 / / - - -  
     s t r i n g   f i l e n a m e   =   " P a n n e l S e r v i c e \ \ P U S S E R . t x t " ;  
     C F i l e T x t   F i l e ;  
     F i l e . S e t C o m m o n ( t r u e ) ;  
  
     i f ( F i l e . O p e n ( f i l e n a m e ,   F I L E _ R E A D   |   F I L E _ W R I T E )   ! =   I N V A L I D _ H A N D L E )  
       {  
         s t r   =   F i l e . R e a d S t r i n g ( ) ;  
         F i l e . C l o s e ( ) ;  
         i f ( s t r   ! =   " "   & &   s t r   ! =   N U L L )  
           {  
             i f ( ! m _ i s _ p a s s e )  
                 : : P r i n t ( " S e r v i s e   P a s s e d . . . " ) ;  
             m _ i s _ p a s s e   =   t r u e ;  
           }  
         e l s e  
           {  
             i f ( m _ i s _ p a s s e )  
                 : : P r i n t ( " S e r v i s e   R e s t a r t . . . " ) ;  
             m _ i s _ p a s s e   =   f a l s e ;  
           }  
         r e t u r n   m _ i s _ p a s s e ;  
       }  
 / / - - -  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : D o T a s k R e s e t ( v o i d )  
   {  
     R e s e t ( ) ;  
 / / - - -  
     i f ( ! D o L o g i n ( ) )  
         r e t u r n ;  
     i f ( ! D o C h e c k D b C o n n e c t i o n ( ) )  
         r e t u r n ;  
     i f ( ! D o U p d a t e H i s t o r y ( ) )  
         r e t u r n ;  
     i f ( ! D o L o a d D a t a ( ) )  
         r e t u r n ;  
     i f ( ! D o C r e a t e S e r i e s ( ) )  
         r e t u r n ;  
     i f ( ! D o U p d a t e E q u i t y ( ) )  
         r e t u r n ;  
     i f ( ! D o U p d a t e S t a t e m e n t ( ) )  
         r e t u r n ;  
     i f ( ! D o S t o r e D a t a O n D b ( ) )  
         r e t u r n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C W e b S o c k e t A p p : : D o T a s k U p d a t e ( v o i d )  
   {  
 / / - - -   l o g i n   t o   a c c o u n t  
     i f ( ! D o L o g i n ( ) )  
         r e t u r n ;  
 / / - - -   c h e c k   D B   c o n n e c t i o n  
     i f ( ! D o C h e c k D b C o n n e c t i o n ( ) )  
         r e t u r n ;  
 / / - - -   u p d a t e   h i s t o r y   b y   e q u i t y   c h e c k   p o i n t  
     i f ( ! D o U p d a t e H i s t o r y ( ) )  
         r e t u r n ;  
 / / - - -   l o a d   d a t a  
     i f ( ! D o L o a d D a t a ( ) )  
         r e t u r n ;  
 / / - - -   c r e a t e   s e r i s e  
     i f ( ! D o C r e a t e S e r i e s ( ) )  
         r e t u r n ;  
 / / - - -   u p d a t e   e q u i t y  
     i f ( ! D o U p d a t e E q u i t y ( ) )  
         r e t u r n ;  
 / / - - -   u p d a t e   s t a t e m e n t  
     i f ( ! D o U p d a t e S t a t e m e n t ( ) )  
         r e t u r n ;  
 / / - - -   s t o r e   d a t a   o n   d b   ( a l l   t a b l e )  
     i f ( ! D o S t o r e D a t a O n D b ( ) )  
         r e t u r n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                               GeneralConfigs.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property strict
//+------------------------------------------------------------------+
//| Genelral Setting                                                 |
//+------------------------------------------------------------------+
#define DEF_APP_NAME                      "PannelService"
#define DEF_PLATFORM                      "mt5"
#define DEF_DAY_SEC                       86400
#define DEF_SLEEP_INTERVAL                100
#define DEF_LICENCE_SLEEP_INTERVAL        1000
#define DEF_PAUSE_SLEEP_INTERVAL          10000
//+------------------------------------------------------------------+
//| WebSocket Setting                                                |
//+------------------------------------------------------------------+
#define DEF_WEBSOCKET_PROTOCOL            Hybi
#define DEF_WEBSOCKET_OPEN_HEADER         NULL
#define DEF_WEBSOCKET_LOSS_SECEND         30
//+------------------------------------------------------------------+
//| MySql database Setting                                           |
//+------------------------------------------------------------------+
#define DEF_DB_SOCKET                     "0"
#define DEF_DB_CLIENT_FALG                65536
//---
#define DEF_DB_TBL_USER                   "user"
#define DEF_DB_TBL_SERVER                 "server"
#define DEF_DB_TBL_ACCOUNT                "account"
#define DEF_DB_TBL_DEAL                   "deal"
#define DEF_DB_TBL_TRANSACTION            "transaction"
#define DEF_DB_TBL_POSITION               "position"
#define DEF_DB_TBL_BALANCE                "balance"
#define DEF_DB_TBL_EQUITY                 "equity"
#define DEF_DB_TBL_DRAWDOWN               "drawdown"
#define DEF_DB_TBL_OBJECTIVE              "objective"
#define DEF_DB_TBL_STATEMENT              "statement"
#define DEF_DB_TBL_NODE_HISTORY           "node_history"
#define DEF_DB_TBL_INVALID_ACCOUNT        "invalid_account"
//---
#define DEF_DB_UNREADBLE(T)               CCrypt::DbEnCrypt(T)
#define DEF_DB_READBLE(T)                 CCrypt::DbDeCrypt(T)
#define DEF_DB_HASH_ID(T)                 CCrypt::HashID(T)
//+------------------------------------------------------------------+
//| Crypto Setting                                                   |
//+------------------------------------------------------------------+
#define DEF_DEFULT_CRYPT_KEY              "Jf}dfPeQ%k4x&Z1OO$gsTnMvr8h6B@Yi]QgP%hW^y$S8CjN^RX["     // ASE256 - Hex --> Hidarifar
//---
#define DEF_APP_ENCRYPT(T)                CCrypt::AES128_BASE64(T, DEF_APP_CRYPT_KEY)
#define DEF_APP_DECRYPT(T)                CCrypt::DeAES128_BASE64(T, DEF_APP_CRYPT_KEY)
#define DEF_MY_ENCRYPT(T)                 CCrypt::MyEnCrypt(T, DEF_DEFULT_CRYPT_KEY)
#define DEF_MY_DECRYPT(T)                 CCrypt::MyDeCrypt(T, DEF_DEFULT_CRYPT_KEY)
//+------------------------------------------------------------------+
//| Json keys                                                        |
//+------------------------------------------------------------------+
#define DEF_JSON_KEY_NODE_ID              "nodeId"
#define DEF_JSON_KEY_TASK                 "task"
#define DEF_JSON_KEY_ACC_ID               "accountId"
#define DEF_JSON_KEY_LOGIN                "login"
#define DEF_JSON_KEY_PASS                 "investorPassword"
#define DEF_JSON_KEY_SERVER               "server"
#define DEF_JSON_KEY_POINT_DEAL           "hashPointA"
#define DEF_JSON_KEY_POINT_EQ             "hashPointB"
#define DEF_JSON_KEY_INIT_BALANCE         "initBalance"
#define DEF_JSON_KEY_TARGET_PERCENT       "targetPercent"
#define DEF_JSON_KEY_DAILY_RISK_PERCENT   "dailyPercent"
#define DEF_JSON_KEY_TOTAL_RISK_PERCENT   "totalPercent"
#define DEF_JSON_KEY_USE_TICK_SCALP       "tickScalp"
#define DEF_JSON_KEY_TICK_SCALP_TERM_MSC  "tickScalpTerm"
#define DEF_JSON_KEY_USE_GAMBELING        "gambeling"
#define DEF_JSON_KEY_GAMBELING_PERCENT    "gambelingPercent"
#define DEF_JSON_KEY_USE_NEWS             "news"
#define DEF_JSON_KEY_USE_WEEKEND          "weekend"
#define DEF_JSON_KEY_USE_TRAIL_TOTAL      "trailTotal"
#define DEF_JSON_KEY_TRAIL_TOTAL_TYPE     "trailTotalType"
#define DEF_JSON_KEY_IS_SECURE            "secure"
#define DEF_JSON_KEY_STATUS               "status"
#define DEF_JSON_KEY_ERR_CODE             "errorCode"
#define DEF_JSON_KEY_ERR_DES              "description"
//+------------------------------------------------------------------+
#define DEF_JSON_KEY_EQCHECK_TIME         "time"
#define DEF_JSON_KEY_EQCHECK_BALACE       "balnce"
#define DEF_JSON_KEY_EQCHECK_DAY_LIMIT    "dayLimit"
#define DEF_JSON_KEY_EQCHECK_TOTAL_LIMIT "totalLimit"
//+------------------------------------------------------------------+
#define DEF_JSON_KEY_DLCHECK_TIMEMSC      "timeMsc"
//+------------------------------------------------------------------+
//| News Param                                                       |
//+------------------------------------------------------------------+
const string rule_one_currency[] =
 {
  "AUD",
  "CAD",
  "CHF",
  "GBP",
  "NZD",
  "USD",
  "USD",
  "USD",
  "USD",
  "USD"
 };
const string rule_one_events[] =
 {
  "CPI q/q",
  "CPI m/m",
  "CPI m/m",
  "CPI m/m",
  "CPI q/q",
  "CPI m/m",
  "Nonfarm Payrolls",
  "PPI m/m",
  "FOMC Statement",
  "FOMC Press Conference"

 };
const ulong rule_one_event_ids[] =
 {
  36010014,
  124010003,
  756020001,
  826010011,
  554010005,
  840030005,
  840030016,
  840030001,
  840050002,
  840050018
 };
//---
const string rule_two_currency[] =
 {
  "AUD", "AUD", "AUD", "CAD", "CAD", "CHF", "EUR",
  "GBP", "GBP", "GBP", "NZD", "NZD", "NZD", "USD",
  "USD", "USD", "USD", "USD", "USD"
 };
const string rule_two_events[] =
 {
  "RBA Interest Rate Decision",
  "Employment Change",
  "GDP q/q",
  "employment-change",
  "GDP m/m",
  "SNB Interest Rate Decision",
  "ECB Interest Rate Decision",
  "S&P Global/CIPS Manufacturing PMI",
  "GDP m/m",
  "BoE Interest Rate Decision",
  "Employment Change q/q",
  "GDP q/q",
  "RBNZ Interest Rate Decision",
  "CB Consumer Confidence Index",
  "Core PCE Price Index m/m",
  "GDP q/q",
  "ISM Manufacturing PMI",
  "JOLTS Job Openings",
  "Retail Sales m/m"
 };
const ulong rule_two_event_ids[] =
 {
  36030008,  36010003,  36010019,  124010011, 124010021, 756010001, 999010007,
  826500001, 826010039, 826020009, 554010016, 554010024, 554020009, 840180002,
  840010001, 840010007, 840040001, 840030021, 840020010
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                          SGB.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property strict
//+------------------------------------------------------------------+
//| General Setting                                                  |
//+------------------------------------------------------------------+
#define DEF_IS_DEBUG                      true
#define DEF_IS_SWAOP_IN_MID_NIGHT         false
#define DEF_APP_TRY_SEND_MAX              3
#define DEF_APP_TRY_SEND_SLEEP_MSC        100
#define DEF_APP_TRY_LOGIN_MAX             3
#define DEF_APP_TRY_LOGIN_SLEEP_MSC       1000
#define DEF_APP_TRY_TERM_CON_MAX          100
#define DEF_APP_TRY_TERM_CON_SLEEP_MSC    100
#define DEF_APP_TRY_LOAD_SYMBOL           100
#define DEF_APP_TRY_LOAD_SYMBOL_SLEEP_MSC 100
//+------------------------------------------------------------------+
//| App Report Setting                                               |
//+------------------------------------------------------------------+
enum ENUM_STOR_EQUITY_TIPE
 {
  STOR_EQUITY_FULL = 1,
  STOR_EQUITY_LIMIT = 2
 };
#define DEF_SETTING_STOR_DEAL             true
#define DEF_SETTING_STOR_POSITION         true
#define DEF_SETTING_STOR_BALANCE          true
#define DEF_SETTING_STOR_EQUITY           STOR_EQUITY_FULL
#define DEF_SETTING_STOR_OBJECTIVE        true
#define DEF_SETTING_STOR_STATEMENT        true
#define DEF_SETTING_STOR_TRANSACTION      true
//+------------------------------------------------------------------+
//| WebSocket Setting                                                |
//+------------------------------------------------------------------+
#define DEF_WEBSOCKET_SERVER              "wss://node.sgbdev.com:443"
//#define DEF_WEBSOCKET_SERVER              "wss://free.blr2.piesocket.com/v3/1?api_key=slpnzeEp97tmelOkd0vpGQndM9RhpuULsuNjtJfl&notify_self=1"

#define DEF_SEND_REULT_TO_SOCKET          true
#define DEF_SEND_REULT_TO_API             true
#define DEF_REULT_API_URL                 "https://node.sgbdev.com/api/v1/Accounts/Result"
#define DEF_REULT_API_HEADER              "Content-Type: application/json\r\n"
//+------------------------------------------------------------------+
//| MySql database Setting                                           |
//+------------------------------------------------------------------+
#define DEF_DB_TRACE                      false
#define DEF_DB_INVALID_ACC_CODE           15
//---new
#define DEF_DB_SERVER                    "63.250.32.216"
#define DEF_DB_PORT                       3306
#define DEF_DB_User                       "node"
#define DEF_DB_Password                   "JrtIlo=4d-1=xrvB{,]3&&Q8"
#define DEF_DB_DB_Name                    "sgb_node"
//#define DEF_DB_DB_Name                    "ATA_TEST"
//+------------------------------------------------------------------+
//| SeqLog Server                                                    |
//+------------------------------------------------------------------+
//#define DEF_SEQ_LOG_URL                   "https://log.sgbdev.com/ingest/clef"
#define DEF_SEQ_LOG_URL                   "http://185.110.191.118:5341/ingest/clef"
#define DEF_SEQ_LOG_HEADER                "Content-Type: application/json\r\n"
//+------------------------------------------------------------------+
//| Crypto Setting                                                   |
//+------------------------------------------------------------------+
#define DEF_APP_CRYPT_KEY                 "})zrWY%IopJ&df9h" // ASE256 - Base64
//+------------------------------------------------------------------+
//| Licecce Setting                                                  |
//+------------------------------------------------------------------+
#define DEF_LIC_URL_IR                    "https://sgbconf.s3.ir-thr-at1.arvanstorage.ir/sgb.cnf"
#define DEF_LIC_URL_COM                   "https://sgbconf.s3.ir-thr-at1.arvanstorage.com/sgb.cnf"
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                             EquityCheckPoint.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
//+------------------------------------------------------------------+
#include <Object.mqh>
#include <_Ata\Web\JAson.mqh>
#include <_Ata\General\Crypt.mqh>
#include "..\Defines.mqh"
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CEquityCheckPoint : public CObject
 {
private:
  long               m_time_msc;
  double             m_balance,
                     m_day_limit,
                     m_total_limit;
  string             m_check_point;
  bool               m_is_set;

  void               TimeMsc(const long _value)       { m_time_msc = _value;}
  void               Balance(const double _value)     { m_balance = _value;}
  void               DayLimit(const double _value)    { m_day_limit = _value;}
  void               TotalLimit(const double _value)  { m_total_limit = _value;}

public:
                     CEquityCheckPoint();
                    ~CEquityCheckPoint();
                    
  bool               IsSet(void) const { return m_is_set;}
  
  void               Reset(void)
   {
    m_time_msc = 0;
    m_balance = 0;
    m_is_set = false;
   };

  long               TimeMsc(void)              const { return m_time_msc;}
  double             Balance(void)              const { return m_balance;}
  double             DayLimit(void)             const { return m_day_limit;}
  double             TotalLimit(void)           const { return m_total_limit;}

  void               SetChekPoint(const long   _time_msc,
                                  const double _balance,
                                  const double _day_limit,
                                  const double _total_limit);
  void               SetChekPoint(const string _hash);
  string             GetChekPoint(void);
  
  
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CEquityCheckPoint::CEquityCheckPoint()
 {
  Reset();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CEquityCheckPoint::~CEquityCheckPoint()
 {
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CEquityCheckPoint::SetChekPoint(const long   _time_msc,
                                     const double _balance,
                                     const double _day_limit,
                                     const double _total_limit)
 {
  m_time_msc = _time_msc;
  m_balance = _balance;
  m_day_limit = _day_limit;
  m_total_limit = _total_limit;
  
  m_is_set = true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CEquityCheckPoint::SetChekPoint(const string _hash)
 {
  Reset();

  string json_text = DEF_DB_READBLE(_hash);

  CJAVal json;

  if(json.Deserialize(json_text) &&
     json.HasKey(DEF_JSON_KEY_EQCHECK_TIME) != NULL &&
     json.HasKey(DEF_JSON_KEY_EQCHECK_BALACE) != NULL &&
     json.HasKey(DEF_JSON_KEY_EQCHECK_DAY_LIMIT) != NULL &&
     json.HasKey(DEF_JSON_KEY_EQCHECK_TOTAL_LIMIT) != NULL)
   {
    m_time_msc = json[DEF_JSON_KEY_EQCHECK_TIME].ToInt();
    m_balance  = json[DEF_JSON_KEY_EQCHECK_BALACE].ToDbl();
    m_day_limit = json[DEF_JSON_KEY_EQCHECK_DAY_LIMIT].ToDbl();
    m_total_limit = json[DEF_JSON_KEY_EQCHECK_TOTAL_LIMIT].ToDbl();
   }
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CEquityCheckPoint::GetChekPoint(void)
 {
  CJAVal json;

  json[DEF_JSON_KEY_EQCHECK_TIME]   = m_time_msc;
  json[DEF_JSON_KEY_EQCHECK_BALACE] = m_balance;
  json[DEF_JSON_KEY_EQCHECK_DAY_LIMIT] = m_day_limit;
  json[DEF_JSON_KEY_EQCHECK_TOTAL_LIMIT] = m_total_limit;

  string json_text = json.Serialize();

  m_check_point = DEF_DB_UNREADBLE(json_text);

  return m_check_point;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                         Task.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
//+------------------------------------------------------------------+
#include <Object.mqh>
#include "..\Error\Erorr.mqh"
#include "EquityCheckPoint.mqh"
#include "DealCheckPoint.mqh"
//+------------------------------------------------------------------+
#define DEF_APP_STATUS_SUCCESS            "success"
#define DEF_APP_STATUS_FAIL               "fail"
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CResultData : public CObject
 {
  string             m_status;
  long               m_login_term_msc;
  long               m_db_connection_term_msc;
  long               m_update_history_term_msc;
  long               m_load_data_term_msc;
  long               m_create_series_term_msc;
  long               m_update_equity_term_msc;
  long               m_update_report_term_msc;
  long               m_update_statement_term_msc;
  long               m_store_data_term_msc;
  long               m_full_term_msc;
  int                m_error_code;

  CEquityCheckPoint  EquityPoint;
  CDealCheckPoint    DealPoint;
public:
  void               Reset(void)
   {
    m_status = DEF_APP_STATUS_SUCCESS;
    m_login_term_msc = 0;
    m_db_connection_term_msc = 0;
    m_update_history_term_msc = 0;
    m_load_data_term_msc = 0;
    m_create_series_term_msc = 0;
    m_update_equity_term_msc = 0;
    m_update_report_term_msc = 0;
    m_update_statement_term_msc = 0;
    m_store_data_term_msc = 0;
    m_full_term_msc = 0;
    m_error_code = 0;

    EquityPoint.Reset();
    DealPoint.Reset();
   }
  //---
  string             Status(void)                           const { return m_status;}
  void               Status(const string _value)                  { m_status = _value;}
  long               LoginTermMsc(void)                     const { return m_login_term_msc;}
  void               LoginTermMsc(const long _value)              { m_login_term_msc = _value;}
  long               DbConnectionTermMsc(void)              const { return m_db_connection_term_msc;}
  void               DbConnectionTermMsc(const long _value)       { m_db_connection_term_msc = _value;}
  long               UpdateHistoryTermMsc(void)             const { return m_update_history_term_msc;}
  void               UpdateHistoryTermMsc(const long _value)      { m_update_history_term_msc = _value;}
  long               LoadDataTermMsc(void)                  const { return m_load_data_term_msc;}
  void               LoadDataTermMsc(const long _value)           { m_load_data_term_msc = _value;}
  long               CreateSeriesTermMsc(void)              const { return m_create_series_term_msc;}
  void               CreateSeriesTermMsc(const long _value)       { m_create_series_term_msc = _value;}
  long               UpdateEquityTermMsc(void)              const { return m_update_equity_term_msc;}
  void               UpdateEquityTermMsc(const long _value)       { m_update_equity_term_msc = _value;}
  long               UpdateReportTermMsc(void)              const { return m_update_report_term_msc;}
  void               UpdateReportTermMsc(const long _value)       { m_update_report_term_msc = _value;}
  long               UpdateStatementTermMsc(void)           const { return m_update_statement_term_msc;}
  void               UpdateStatementTermMsc(const long _value)    { m_update_statement_term_msc = _value;}
  long               StoreDataTermMsc(void)                 const { return m_store_data_term_msc;}
  void               StoreDataTermMsc(const long _value)          { m_store_data_term_msc = _value;}
  long               FullTermMsc(void)                      const
   {
    return(m_login_term_msc +
           m_db_connection_term_msc +
           m_update_history_term_msc +
           m_load_data_term_msc +
           m_create_series_term_msc +
           m_update_equity_term_msc +
           m_update_report_term_msc +
           m_update_statement_term_msc +
           m_store_data_term_msc);
   }
  int                ErrorCode(void)                        const { return m_error_code;}
  void               ErrorCode(const int _value)
   {
    m_error_code = _value;
    m_status = m_error_code == 0 ? DEF_APP_STATUS_SUCCESS : DEF_APP_STATUS_FAIL;
   }
  string             ErrorDescription(void)                 const { return AppErrorDescription(m_error_code);}
  string             HashPointA(void)                             { return EquityPoint.GetChekPoint();}
  string             HashPointB(void)                             { return DealPoint.GetChekPoint();}

  bool               IsSetEquityChekPoint(void)             const { return EquityPoint.IsSet();}
  string             EquityChekPoint(void)                        { return EquityPoint.GetChekPoint();}
  void               EquityChekPoint(const long   _time_msc,
                                     const double _balance,
                                     const double _day_limit,
                                     const double _total_limit)
   {
    EquityPoint.SetChekPoint(_time_msc, _balance, _day_limit, _total_limit);
   }
  string             DealChekPoint(void)     { return DealPoint.GetChekPoint();}
  void               DealChekPoint(const long _time_msc)
   {
    DealPoint.SetChekPoint(_time_msc);
   }
  //---
                     CResultData() { Reset();}
                    ~CResultData() {}
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                       Result.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
//+------------------------------------------------------------------+
#include <Object.mqh>
#include <_Ata\General\Macros.mqh>
#include "TaskData.mqh"
#include "ResultData.mqh"
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CTask : public CTaskData
 {
  void               Reset(void) override
   {
    CTaskData::Reset();
    Result.Reset();
   }
public:
  CResultData        Result;

  datetime           ServerTime(void)                       const { return ::TimeTradeServer();}
  string             AppName(void)                          const { return DEF_APP_NAME;}
  string             Identification(void)                   const { return NodeId();}
  string             HashID(void)
   {
    string id_parms[] =
     {
      AppName(),
      Identification(),
      ::IntegerToString(AccountId()),
      ::IntegerToString((int)ServerTime())
     };
    string hash_id = DEF_DB_HASH_ID(id_parms);
    if(hash_id.Length() > 256)
      hash_id = ::StringSubstr(hash_id, 0, 256);
    return hash_id;
   }
  //---
                     CTask(void) { this.Reset();};
                    ~CTask(void) {};
  //---
  bool               ParsTaskJson(const string _json_text, const string _node_id);
  bool               IsValidTask(void);
  string             ResultJson(void);

  string             NewEquityChekPoint(void)
   {
    if(Result.IsSetEquityChekPoint())
      return Result.EquityChekPoint();//EquityPoint.GetChekPoint();

    if(IsResetTask())
      return NULL;
    //---
    return CheckEquity();
   }
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
/*
{
  "nodeId": "string",
  "task": 1,
  "accountId": 1,
  "login": 1111,
  "investorPassword": "string",
  "server": "string",
  "hashPointA": "string",
  "hashPointB": "string",
  "initBalance": 10000.0,
  "targetPercent": 10.0,
  "dailyPercent": 8.0,
  "totalPercent": 12.0,
  "tickScalp": true,
  "tickScalpTerm": 30000, //milliseconds
  "gambeling": true,
  "gambelingPercent": 3.0,
  "news": false,
  "Weekend": true,
  "trailTotal": false,
  "trailTotalType": 1,
  "secure": false
}
*/
bool CTask::ParsTaskJson(const string _json_text, const string _node_id)
 {
  Reset();
  m_task_string = _json_text;
//::StringReplace(json_text, "'", "\"");
//--- Check json
  CJAVal json;
  /*
    string tex = NULL;

    if(!json.Deserialize(m_task_string))
      return false;
    if(json.HasKey(DEF_JSON_KEY_NODE_ID)             == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_TASK)                == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_ACC_ID)              == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_LOGIN)               == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_IS_SECURE)           == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_PASS)                == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_SERVER)              == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_POINT_DEAL)          == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_POINT_EQ)            == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_INIT_BALANCE)        == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_TARGET_PERCENT)      == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_DAILY_RISK_PERCENT)  == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_TOTAL_RISK_PERCENT)  == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_USE_TICK_SCALP)      == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_TICK_SCALP_TERM_MSC) == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_USE_GAMBELING)       == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_GAMBELING_PERCENT)   == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_USE_NEWS)            == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_USE_WEEKEND)         == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_USE_TRAIL_TOTAL)     == NULL)
      return false;
    if(json.HasKey(DEF_JSON_KEY_TRAIL_TOTAL_TYPE)    == NULL)
      return false;
  */
  if(!json.Deserialize(m_task_string)                      ||
     json.HasKey(DEF_JSON_KEY_NODE_ID)             == NULL ||
     json.HasKey(DEF_JSON_KEY_TASK)                == NULL ||
     json.HasKey(DEF_JSON_KEY_ACC_ID)              == NULL ||
     json.HasKey(DEF_JSON_KEY_LOGIN)               == NULL ||
     json.HasKey(DEF_JSON_KEY_IS_SECURE)           == NULL ||
     json.HasKey(DEF_JSON_KEY_PASS)                == NULL ||
     json.HasKey(DEF_JSON_KEY_SERVER)              == NULL ||
     json.HasKey(DEF_JSON_KEY_POINT_DEAL)          == NULL ||
     json.HasKey(DEF_JSON_KEY_POINT_EQ)            == NULL ||
     json.HasKey(DEF_JSON_KEY_INIT_BALANCE)        == NULL ||
     json.HasKey(DEF_JSON_KEY_TARGET_PERCENT)      == NULL ||
     json.HasKey(DEF_JSON_KEY_DAILY_RISK_PERCENT)  == NULL ||
     json.HasKey(DEF_JSON_KEY_TOTAL_RISK_PERCENT)  == NULL ||
     json.HasKey(DEF_JSON_KEY_USE_TICK_SCALP)      == NULL ||
     json.HasKey(DEF_JSON_KEY_TICK_SCALP_TERM_MSC) == NULL ||
     json.HasKey(DEF_JSON_KEY_USE_GAMBELING)       == NULL ||
     json.HasKey(DEF_JSON_KEY_GAMBELING_PERCENT)   == NULL ||
     json.HasKey(DEF_JSON_KEY_USE_NEWS)            == NULL ||
     json.HasKey(DEF_JSON_KEY_USE_WEEKEND)         == NULL ||
     json.HasKey(DEF_JSON_KEY_USE_TRAIL_TOTAL)     == NULL ||
     json.HasKey(DEF_JSON_KEY_TRAIL_TOTAL_TYPE)    == NULL)
   {
    Result.ErrorCode(DEF_APP_ERR_INVALID_JSON);
    return false;
   }
//--- Get Dataes
  IsSecure(json[DEF_JSON_KEY_IS_SECURE].ToBool());
  NodeId(json[DEF_JSON_KEY_NODE_ID].ToStr());
  Task((int)json[DEF_JSON_KEY_TASK].ToInt());
  AccountId((long)json[DEF_JSON_KEY_ACC_ID].ToInt());
  Login((long)json[DEF_JSON_KEY_LOGIN].ToInt());
  Password(json[DEF_JSON_KEY_PASS].ToStr());
  Server(json[DEF_JSON_KEY_SERVER].ToStr());
  CheckDeals(json[DEF_JSON_KEY_POINT_DEAL].ToStr());
  CheckEquity(json[DEF_JSON_KEY_POINT_EQ].ToStr());
  InitBalance(json[DEF_JSON_KEY_INIT_BALANCE].ToDbl());
  TargetPercent(json[DEF_JSON_KEY_TARGET_PERCENT].ToDbl());
  DailyRiskPercent(json[DEF_JSON_KEY_DAILY_RISK_PERCENT].ToDbl());
  TotalRiskPercent(json[DEF_JSON_KEY_TOTAL_RISK_PERCENT].ToDbl());
  UseTickScalp(json[DEF_JSON_KEY_USE_TICK_SCALP].ToBool());
  TickScalpTermMsc((uint)json[DEF_JSON_KEY_TICK_SCALP_TERM_MSC].ToInt());
  UseGambeling(json[DEF_JSON_KEY_USE_GAMBELING].ToBool());
  GambelingPercent(json[DEF_JSON_KEY_GAMBELING_PERCENT].ToDbl());
  UseNews(json[DEF_JSON_KEY_USE_NEWS].ToBool());
  UseWeekend(json[DEF_JSON_KEY_USE_WEEKEND].ToBool());
  UseTrailTotal(json[DEF_JSON_KEY_USE_TRAIL_TOTAL].ToBool());
  TrailTotal((int)json[DEF_JSON_KEY_TRAIL_TOTAL_TYPE].ToInt());
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CTask::IsValidTask(void)
 {
  if(Task() < DEF_TASK_MIN_ID || Task() > DEF_TASK_MAX_ID)
   {
    Result.ErrorCode(DEF_APP_ERR_INVALID_TASK);
    return false;
   }
  if(AccountId() <= 0)
   {
    Result.ErrorCode(DEF_APP_ERR_INVALID_ACC_ID);
    return false;
   }
  if(Login() <= 0)
   {
    Result.ErrorCode(DEF_APP_ERR_INVALID_LOGIN);
    return false;
   }
  if(IS_EMPTY_STRING(Password()))
   {
    Result.ErrorCode(DEF_APP_ERR_INVALID_PASS);
    return false;
   }
  if(IS_EMPTY_STRING(Server()))
   {
    Result.ErrorCode(DEF_APP_ERR_INVALID_SERVER);
    return false;
   }
  if(InitBalance() < 0)
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_INIT_BALANCE);
    return false;
   }
  if(TargetPercent() < 0 || TargetPercent() > 100)
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_TARGET_PERCENT);
    return false;
   }
  if(DailyRiskPercent() < 0 || DailyRiskPercent() > 100)
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_DAILY_PERCENT);
    return false;
   }
  if(TotalRiskPercent() < 0 || TotalRiskPercent() > 100)
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_TOYAL_PERCENT);
    return false;
   }
  if(UseTickScalp() && TickScalpTermMsc() < 0)
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_TICKSCALP_TERM);
    return false;
   }
  if(UseGambeling() && (GambelingPercent() < 0 || GambelingPercent() > 100))
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_GAMBEL_PERCENT);
    return false;
   }
  if(UseTrailTotal() && (TrailTotal() < DEF_TASK_TRAIL_MIN_ID || TrailTotal() > DEF_TASK_TRAIL_MAX_ID))
   {
    Result.ErrorCode(DEF_APP_ERR_BAD_TOTAL_TRAIL_TYPE);
    return false;
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
/*
{
   "nodeId"          : "String",    // 64
   "task"            : Int,         // TASK_UPDATE  = 1, TASK_RESET   = 2
   "accountId"       : UBigInt,     // DB.TblAcc
   "status"          : "String",    // success || fail
   "errorCode"       : Int,
   "description"     : "String",
}
*/
string CTask::ResultJson(void)
 {
  CJAVal json;

  json[DEF_JSON_KEY_NODE_ID]        = NodeId();
  json[DEF_JSON_KEY_TASK]           = Task();
  json[DEF_JSON_KEY_ACC_ID]         = AccountId();
  json[DEF_JSON_KEY_STATUS]         = Result.Status();
  json[DEF_JSON_KEY_ERR_CODE]       = Result.ErrorCode();
  json[DEF_JSON_KEY_ERR_DES]        = Result.ErrorDescription();

//string str = json.Serialize();
  return json.Serialize();
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                               DealCheckPoint.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
//+------------------------------------------------------------------+
#include <Object.mqh>
#include <_Ata\Web\JAson.mqh>
#include <_Ata\General\Crypt.mqh>
#include "..\Defines.mqh"
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CDealCheckPoint : public CObject
 {
private:
  long               m_time_msc;
  string             m_check_point;

  void               TimeMsc(const long _value)                { m_time_msc = _value;}
public:
                     CDealCheckPoint();
                    ~CDealCheckPoint();

  void               Reset(void)                               { m_time_msc = 0;};
  ulong              TimeMsc(void)                       const { return m_time_msc;}
  void               SetChekPoint(const long _time_msc)        { m_time_msc = _time_msc;}
  void               SetChekPoint(const string _hash);
  string             GetChekPoint(void);
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CDealCheckPoint::CDealCheckPoint()
 {
  Reset();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CDealCheckPoint::~CDealCheckPoint()
 {
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CDealCheckPoint::SetChekPoint(const string _hash)
 {
  Reset();
  string json_text = DEF_DB_READBLE(_hash);

  CJAVal json;

  if(json.Deserialize(json_text) &&
     json.HasKey(DEF_JSON_KEY_DLCHECK_TIMEMSC) != NULL)
   {
    m_time_msc = (long)json[DEF_JSON_KEY_DLCHECK_TIMEMSC].ToInt();
   }
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CDealCheckPoint::GetChekPoint(void)
 {
  CJAVal json;

  json[DEF_JSON_KEY_DLCHECK_TIMEMSC] = m_time_msc;


  string json_text = json.Serialize();
  m_check_point = DEF_DB_UNREADBLE(json_text);

  return m_check_point;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                         Task.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
//+------------------------------------------------------------------+
#include <Object.mqh>
#include "EquityCheckPoint.mqh"
#include "DealCheckPoint.mqh"
//+------------------------------------------------------------------+
//| TASK Setting                                                     |
//+------------------------------------------------------------------+
enum ENUM_TASK_TYPE
 {
  TASK_TYPE_RESET = 1,              // Algo: Normal  - From 0 time to current time  - calc all data
  TASK_TYPE_UPDATE = 2,             // Algo: Normal  - From last check point time to current time - calc all data
 };
#define DEF_TASK_MIN_ID TASK_TYPE_RESET
#define DEF_TASK_MAX_ID TASK_TYPE_UPDATE
enum ENUM_TRAIL_TYPE
 {
  TRAIL_BALANCE = 1,
  TRAIL_EQUITY  = 2
 };
#define DEF_TASK_TRAIL_MIN_ID TRAIL_BALANCE
#define DEF_TASK_TRAIL_MAX_ID TRAIL_EQUITY
enum ENUM_ALGORITHM_TYPE
 {
  ALGORITHM_NORMAL = 1, // Normal
  ALGORITHM_TICK  = 2,  // Tick
  ALGORITHM_NANO_TICK = 3  // NanoTick
 };

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CTaskData : public CObject
 {
protected:
  string             m_task_string;
  string             m_node_id;
  int                m_task;
  long               m_acc_id,
                     m_login;
  string             m_password,
                     m_raw_password,
                     m_server,
                     m_check_deals,
                     m_check_eq;
  bool               m_is_secure;
  double             m_init_balance,
                     m_target_percent,
                     m_daily_risk_percent,
                     m_total_risk_percent;
  bool               m_use_tick_scalp;
  int                m_tick_scalp_term_msc;
  bool               m_use_gambeling;
  double             m_gambeling_percent;
  bool               m_use_news;
  bool               m_use_weekend;
  bool               m_use_trail_total;
  int                m_trail_total;

  CEquityCheckPoint  EquityPoint;
  CDealCheckPoint    DealPoint;
public:
  virtual void       Reset(void)
   {
    m_task_string = NULL;
    m_node_id = NULL;
    m_task = 0;
    m_acc_id = 0;
    m_login = 0;
    m_password = NULL;
    m_raw_password = NULL;
    m_server = NULL;
    m_check_deals = NULL;
    m_check_eq = NULL;
    m_is_secure = false;
    m_init_balance = 0;
    m_target_percent = 10;
    m_daily_risk_percent = 5;
    m_total_risk_percent = 12;
    m_use_tick_scalp = true;
    m_tick_scalp_term_msc = 30000;
    m_use_gambeling = true;
    m_gambeling_percent = 3;
    m_use_news = false;
    m_use_weekend = true;
    m_use_trail_total = false;
    m_trail_total = TRAIL_BALANCE;

    EquityPoint.Reset();
    DealPoint.Reset();
   }
  //---
  void               NodeId(const string _value)            { m_node_id = _value;}
  string             NodeId(void)                     const { return m_node_id;}
  void               Task(const int _value)                 { m_task = _value;}
  int                Task(void)                       const { return m_task;}
  string             TaskSting(void)                  const { return ::EnumToString((ENUM_TASK_TYPE)m_task);}
  void               AccountId(const long _value)           { m_acc_id = _value;}
  long               AccountId(void)                  const { return m_acc_id;}
  void               Login(const long _value)               { m_login = _value;}
  long               Login(void)                      const { return m_login;}
  void               Password(const string _value)
   {
    if(m_is_secure)
      m_password = DEF_APP_DECRYPT(_value);
    else
      m_password = _value;
    m_raw_password = _value;
   }
  string             Password(void)                   const { return m_password;}
  string             RawPassword(void)                const { return m_raw_password;}
  void               Server(const string _value)            { m_server = _value;}
  string             Server(void)                     const { return m_server;}
  void               CheckDeals(const string _hash)
   {
    if(IsResetTask())
      return;
    DealPoint.SetChekPoint(_hash);
    m_check_deals = _hash;
   }
  string             CheckDeals(void)                 const { return m_check_deals;}
  void               CheckEquity(const string _hash)
   {
    if(IsResetTask())
      return;
    EquityPoint.SetChekPoint(_hash);
    m_check_eq = _hash;
   }
  string             CheckEquity(void)                const { return m_check_eq;}
  void               IsSecure(const bool _value)            { m_is_secure = _value;}
  bool               IsSecure(void)                   const { return m_is_secure;}
  void               InitBalance(const double _value)       { m_init_balance = _value;}
  double             InitBalance(void)                const { return m_init_balance;}
  void               TargetPercent(const double _value)     { m_target_percent = _value;}
  double             TargetPercent(void)              const { return m_target_percent;}
  void               DailyRiskPercent(const double _value)  { m_daily_risk_percent = _value;}
  double             DailyRiskPercent(void)           const { return m_daily_risk_percent;}
  void               TotalRiskPercent(const double _value)  { m_total_risk_percent = _value;}
  double             TotalRiskPercent(void)           const { return m_total_risk_percent;}
  void               UseTickScalp(const bool _value)        { m_use_tick_scalp = _value;}
  bool               UseTickScalp(void)               const { return m_use_tick_scalp;}
  void               TickScalpTermMsc(const int _value)     { m_tick_scalp_term_msc = _value;}
  int                TickScalpTermMsc(void)           const { return m_tick_scalp_term_msc;}
  void               UseGambeling(const bool _value)        { m_use_gambeling = _value;}
  bool               UseGambeling(void)               const { return m_use_gambeling;}
  void               GambelingPercent(const double _value)  { m_gambeling_percent = _value;}
  double             GambelingPercent(void)           const { return m_gambeling_percent;}
  void               UseNews(const bool _value)             { m_use_news = _value;}
  bool               UseNews(void)                    const { return m_use_news;}
  void               UseWeekend(const bool _value)          { m_use_weekend = _value;}
  bool               UseWeekend(void)                 const { return m_use_weekend;}
  void               UseTrailTotal(const bool _value)       { m_use_trail_total = _value;}
  bool               UseTrailTotal(void)              const { return m_use_trail_total;}
  void               TrailTotal(const int _value)           { m_trail_total = _value;}
  int                TrailTotal(void)                 const { return m_trail_total;}
  string             TrailTotalString(void)           const { return ::EnumToString((ENUM_TRAIL_TYPE)m_trail_total);}
  double             DailyLimitRatio(void)            const { return((100 - m_daily_risk_percent) / 100);}
  double             TotalLimitRatio(void)            const { return((100 - m_total_risk_percent) / 100);}
  //---
  long               EquityCheckPointTimeMsc(void)    const { return EquityPoint.TimeMsc();}
  double             EquityCheckPointBalance(void)    const { return EquityPoint.Balance();}
  double             EquityCheckPointDayLimit(void)   const { return EquityPoint.DayLimit();}
  double             EquityCheckPointTotalLimit(void) const { return EquityPoint.TotalLimit();}
  string             HashPointA(void)                       { return EquityPoint.GetChekPoint();}
  string             HashPointB(void)                       { return DealPoint.GetChekPoint();}
  //---
                     CTaskData() { Reset();}
                    ~CTaskData() {}

  bool               IsResetTask(void)
   {
    switch(m_task)
     {
      case  TASK_TYPE_RESET:
        return true;
      case  TASK_TYPE_UPDATE:
        return false;
     }
    return false;
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      Licence.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property strict
//+------------------------------------------------------------------+
#include <_Ata\General\Crypt.mqh>
#include <_Ata\Web\Http.mqh>
#include "Defines.mqh"
//+------------------------------------------------------------------+
datetime Expiry = 0;
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool IsLicenced(void)
 {
  if(Expiry > ::TimeTradeServer() +::PeriodSeconds(PERIOD_H1) * 4)
    return true;
//---
  datetime exp_date_ir = ::StringToTime(DEF_MY_DECRYPT(httpGET(DEF_LIC_URL_IR)));
  if(exp_date_ir > ::TimeTradeServer())
   {
    Expiry = ::TimeTradeServer() + (::PeriodSeconds(PERIOD_H1) * 100);
    return true;
   }
//---
  datetime exp_date_com = ::StringToTime(DEF_MY_DECRYPT(httpGET(DEF_LIC_URL_COM)));
  if(exp_date_com > ::TimeTradeServer())
   {
    Expiry = ::TimeTradeServer() + (::PeriodSeconds(PERIOD_H1) * 100);
    return true;
   }
//---
  ::Print("Contact: " + "Ata Atalou.");
  return false;
 }
//+------------------------------------------------------------------+
string CreateLicence(datetime _time)
 {
  string hash = DEF_MY_ENCRYPT(::TimeToString(_time));
  ::Print(hash);
  return hash;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                     Database.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
#property strict
//+------------------------------------------------------------------+
#include <_Ata\Databases\MySQL\MySQLClass.mqh>
#include <_Ata\General\Tradestatistics.mqh>
#include "..\History\History.mqh"
#include "..\Series\Series.mqh"
#include "..\Equity\Equity.mqh"

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CDatabase
 {
private:
  CMySQL             DB;
  CHistory           *History;
  CSeries            *Series;
  CEquity            *Equity;
  CTask              *Task;
  CTradeStatistics   *Statement;

  string             m_hash_id;

  bool               Connect(void);
  void               Disconnect(void);
  bool               Execute(const string _query);
  bool               TransactionBegin(void);
  bool               TransactionExecute(const string _query);
  bool               TransactionCommit(void);
  bool               TransactionRollback(void);

  string             StringFild(const string _text);
  string             IntegerFild(const long _value);
  string             DoubleFild(const double _value, const int _digits = 8);
  string             DateTimeFild(const datetime _time);
  string             Timestamp3Fild(const ulong _value);

  bool               CreateDatabase(void);
  bool               DropTables(void);
  bool               CreateTables(void);
  bool               CreateTableUser(void);
  bool               CreateTableServer(void);
  bool               CreateTableAccount(void);
  bool               CreateTableDeal(void);
  bool               CreateTableTransaction(void);
  bool               CreateTablePosition(void);
  bool               CreateTableBalance(void);
  bool               CreateTableEquity(void);
  bool               CreateTableObjective(void);
  bool               CreateTableStatement(void);
  bool               FillTempData(void);

  bool               StoreAccountData(void);
  bool               StoreDeals(void);
  bool               StorePositions(void);
  bool               StoreBalance(void);
  bool               StoreEquity(void);
  bool               StoreStatement(void);
  bool               StoreDrawdown(void);
  bool               StoreObjective(void);
  bool               StoreCheckPoints(void);
  bool               StoreNodeLastUpdate(const string _hash_id, const bool _is_trans = false);
public:
                     CDatabase();
                    ~CDatabase();
  bool               IsConnect(void);
  bool               Update(CTask              *_Task,
                            CHistory           *_History,
                            CSeries            *_Series,
                            CEquity            *_Equity,
                            CTradeStatistics   *_Statement);
  void               SetInvalidAccount(const ulong _account_id);
  bool               StorHistory(CTask *_Task, const bool _is_trans = false);
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CDatabase::CDatabase()
 {
  IsConnect();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CDatabase::~CDatabase()
 {
  Disconnect();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::Connect(void)
 {
  DB.SetTrace(DEF_DB_TRACE);
  return DB.Connect(DEF_DB_SERVER, DEF_DB_User, DEF_DB_Password, DEF_DB_DB_Name, DEF_DB_PORT, DEF_DB_SOCKET, DEF_DB_CLIENT_FALG);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CDatabase::Disconnect(void)
 {
  DB.Disconnect();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::IsConnect(void)
 {
  if(DB.IsConnect())
    return true;

  return Connect();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::Execute(const string _query)
 {
  if(!DB.Execute(_query))
   {
    Disconnect();
    if(!Connect())
      return false;

    return DB.Execute(_query);
   }
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::TransactionBegin(void)
 {
  Disconnect();
  if(!Connect())
    return false;
  return DB.TransactionBegin();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::TransactionExecute(const string _query)
 {
  if(!DB.Execute(_query))
   {
    TransactionRollback();
    return false;
   }
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::TransactionCommit(void)
 {
  return DB.TransactionCommit();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::TransactionRollback(void)
 {
  return DB.TransactionRollback();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CDatabase::StringFild(const string _text)
 {
  return "'" + _text + "'";
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CDatabase::IntegerFild(const long _value)
 {
  if(!::MathIsValidNumber(_value))
    return "null";
  return ::IntegerToString(_value);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CDatabase::DoubleFild(const double _value, const int _digits = 8)
 {
  if(!::MathIsValidNumber(_value))
    return "null";
  double value = ::NormalizeDouble(_value, _digits);
  return ::DoubleToString(value, _digits);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CDatabase::DateTimeFild(const datetime _time)
 {
//-- fix mysql bug 1292 error
  datetime time = _time > (2 * 60 * 60) ? _time : (2 * 60 * 60);

  return StringFild(::TimeToString(time, TIME_DATE | TIME_MINUTES | TIME_SECONDS));
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
string CDatabase::Timestamp3Fild(const ulong _value)
 {
  return "FROM_UNIXTIME(" + (string)_value + "/1000)";
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::Update(CTask              *_Task,
                       CHistory           *_History,
                       CSeries            *_Series,
                       CEquity            *_Equity,
                       CTradeStatistics   *_Statement)
 {
  ulong start_cnt =::GetTickCount64(),
        time_elapsed_ms;
//---
  Task = _Task;
  History = _History;
  Series = _Series;
  Equity = _Equity;
  Statement = _Statement;

  if(!IS_POINTER_DYNAMIC(Task) || !IS_POINTER_DYNAMIC(History) || !IS_POINTER_DYNAMIC(Series) || !IS_POINTER_DYNAMIC(Equity) || !IS_POINTER_DYNAMIC(Statement))
    return false;

  bool is_store = false;
  for(int i = 0; i < 3; i++)
   {
    if(!TransactionBegin())
      continue;
    if(!StoreAccountData())
      continue;
    if(!StoreDeals())
      continue;
    if(!StorePositions())
      continue;
    if(!StoreBalance())
      continue;
    if(!StoreEquity())
      continue;
    if(!StoreDrawdown())
      continue;
    if(!StoreStatement())
      continue;
    if(!StoreObjective())
      continue;
    //if(!StoreCheckPoints())
    //  continue;
    if(!StorHistory(Task, true))
      continue;
    if(!TransactionCommit())
      continue;

    is_store = true;
    break;
   }
//---
  time_elapsed_ms =::GetTickCount64() - start_cnt;
  Task.Result.StoreDataTermMsc(time_elapsed_ms);
//---
  return is_store;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CDatabase::SetInvalidAccount(const ulong _account_id)
 {
  string query = NULL;
  query  = "INSERT INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_INVALID_ACCOUNT + "` (";
  query += "`account_id`";      //INT UNSIGNED      NOT NULL,";
  query += ") VALUES (";
  query += IntegerFild(_account_id);
  query += ");";
//---
  DB.Execute(query);
 }

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateDatabase(void)
 {
  if(!DropTables())
    return false;
  if(!CreateTables())
    return false;
  if(!FillTempData())
    return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::DropTables(void)
 {
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTables(void)
 {
  if(!CreateTableUser())
    return false;
  if(!CreateTableServer())
    return false;
  if(!CreateTableAccount())
    return false;
  if(!CreateTableDeal())
    return false;
  if(!CreateTableTransaction())
    return false;
  if(!CreateTablePosition())
    return false;
  if(!CreateTableBalance())
    return false;
  if(!CreateTableEquity())
    return false;
  if(!CreateTableObjective())
    return false;
  if(!CreateTableStatement())
    return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableUser(void)
 {
  string table_name = DEF_DB_TBL_USER;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`           INT UNSIGNED      NOT NULL AUTO_INCREMENT,";
  query += "`first_name`   VARCHAR ( 255 )   NULL,";
  query += "`last_name`    VARCHAR ( 255 )   NULL,";
  query += "`email`        VARCHAR ( 255 )   NOT NULL,";
  query += "`password`     VARCHAR ( 255 )   NOT NULL,";

  query += "`created_at`   TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`   TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`   TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "UNIQUE INDEX `user_idx_email` ( `email` ) USING BTREE,";
  query += "CONSTRAINT `user_ck_email_lower_case` CHECK (`email` = LOWER( `email` ))";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableServer(void)
 {
  string table_name = DEF_DB_TBL_SERVER;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`           INT UNSIGNED      NOT NULL AUTO_INCREMENT,";
  query += "`broker_name`  VARCHAR ( 255 )   NOT NULL,";
  query += "`server`       VARCHAR ( 255 )   NOT NULL,";
  query += "`domain`       VARCHAR ( 255 )   NOT NULL,";
  query += "`platform`     VARCHAR ( 32 )    NOT NULL DEFAULT 'mt5',";
  query += "`type`         VARCHAR ( 32 )    NOT NULL DEFAULT 'demo',";

  query += "`created_at`   TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`   TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`   TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "UNIQUE INDEX `broker_idx_server` ( `server` ) USING BTREE,";
  query += "UNIQUE INDEX `broker_idx_domain` ( `domain` ) USING BTREE,";
  query += "CONSTRAINT `user_ck_domain_lower_case` CHECK (`domain` = LOWER( `domain` ))";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableAccount(void)
 {
  string table_name = DEF_DB_TBL_ACCOUNT;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`                 INT UNSIGNED      NOT NULL AUTO_INCREMENT,";
  query += "`user_id`            INT UNSIGNED      NOT NULL,";
  query += "`server_id`          INT UNSIGNED      NOT NULL,";
  query += "`login`              INT UNSIGNED      NOT NULL,";
  query += "`pasword`            VARCHAR ( 255 )   NOT NULL,";
  query += "`investor_password`  VARCHAR ( 255 )   NOT NULL,";
  query += "`hash_point_a`       VARCHAR ( 255 )   NULL,";
  query += "`hash_point_b`       VARCHAR ( 255 )   NULL,";

  query += "`created_at`         TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`         TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`         TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "INDEX `account_idx_fk_user_id` ( `user_id` ) USING BTREE,";
  query += "INDEX `account_idx_fk_server_id` ( `server_id` ) USING BTREE,";
  query += "CONSTRAINT `account_user_id_fkey` FOREIGN KEY ( `user_id` ) REFERENCES `sgb`.`user` ( `id` ) ON DELETE RESTRICT ON UPDATE CASCADE,";
  query += "CONSTRAINT `account_server_id_fkey` FOREIGN KEY ( `server_id` ) REFERENCES `sgb`.`server` ( `id` ) ON DELETE RESTRICT ON UPDATE CASCADE ";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableDeal(void)
 {
  string table_name = DEF_DB_TBL_DEAL;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`              VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`      INT UNSIGNED      NOT NULL,";
  query += "`deal_ticket`     BIGINT UNSIGNED   NOT NULL,";
  query += "`order_ticket`    BIGINT UNSIGNED   NOT NULL,";
  query += "`time`            TIMESTAMP         NOT NULL,";
  query += "`time_rate`       TIMESTAMP         NOT NULL,";
  query += "`time_msc`        BIGINT UNSIGNED   NOT NULL,";
  query += "`type`            TINYINT UNSIGNED  NOT NULL,";
  query += "`entry`           TINYINT UNSIGNED  NOT NULL,";
  query += "`magic`           BIGINT            ZEROFILL NOT NULL,";
  query += "`reason`          TINYINT UNSIGNED  NOT NULL,";
  query += "`position_ticket` BIGINT UNSIGNED   NOT NULL,";
  query += "`volume`          DOUBLE            NOT NULL,";
  query += "`price`           DOUBLE            NOT NULL,";
  query += "`commission`      DOUBLE            NOT NULL,";
  query += "`swap`            DOUBLE            NOT NULL,";
  query += "`profit`          DOUBLE            NOT NULL,";
  query += "`fee`             DOUBLE            NOT NULL,";
  query += "`stop_loss`       DOUBLE            NOT NULL,";
  query += "`take_profit`     DOUBLE            NOT NULL,";
  query += "`symbol`          VARCHAR ( 255 )   NOT NULL,";
  query += "`comment`         VARCHAR ( 255 )   NULL,";
  query += "`external_id`     VARCHAR ( 255 )   NULL,";

  query += "`created_at`      TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`      TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`      TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "INDEX `deal_idx_fk_account_id` ( `account_id` ) USING BTREE,";
  query += "INDEX `deal_idx_fk_deal_ticket` ( `deal_ticket` ) USING BTREE,";
  query += "CONSTRAINT `deal_account_id_fkey` FOREIGN KEY ( `account_id` ) REFERENCES `sgb`.`account` ( `id` ) ON DELETE RESTRICT ON UPDATE CASCADE ";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableTransaction(void)
 {
  string table_name = DEF_DB_TBL_TRANSACTION;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`                 VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`         INT UNSIGNED      NOT NULL,";

  query += "`created_at`         TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`         TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`         TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "INDEX `transaction_idx_fk_account_id` ( `account_id` ) USING BTREE,";
  query += "CONSTRAINT `transaction_account_id_fkey` FOREIGN KEY (`account_id`) REFERENCES `sgb`.`account` ( `id` ) ON DELETE RESTRICT ON UPDATE CASCADE";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTablePosition(void)
 {
  string table_name = DEF_DB_TBL_POSITION;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`                 VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`         INT UNSIGNED      NOT NULL,";
  query += "`open_deal_ticket`   BIGINT UNSIGNED   NOT NULL,";
  query += "`open_time`          TIMESTAMP         NOT NULL,";
  query += "`open_time_rate`     TIMESTAMP         NOT NULL,";
  query += "`open_time_msc`      BIGINT            NOT NULL,";
  query += "`open_price`         DOUBLE            NOT NULL,";
  query += "`open_commission`    DOUBLE            NOT NULL,";
  query += "`open_swap`          DOUBLE            NOT NULL,";
  query += "`open_fee`           DOUBLE            NOT NULL,";
  query += "`close_deal_ticket`  BIGINT UNSIGNED   NOT NULL,";
  query += "`close_time`         TIMESTAMP         NOT NULL,";
  query += "`close_time_rate`    TIMESTAMP         NOT NULL,";
  query += "`close_time_msc`     BIGINT            NOT NULL,";
  query += "`close_price`        DOUBLE            NOT NULL,";
  query += "`close_commission`   DOUBLE            NOT NULL,";
  query += "`close_swap`         DOUBLE            NOT NULL,";
  query += "`close_fee`          DOUBLE            NOT NULL,";
  query += "`cost`               DOUBLE            NOT NULL,";
  query += "`profit`             DOUBLE            NOT NULL,";
  query += "`net_profit`         DOUBLE            NOT NULL,";
  query += "`duratian_msc`       BIGINT UNSIGNED   NOT NULL,";
  query += "`is_weekend`         TINYINT           NOT NULL,";
  query += "`type`               TINYINT           NOT NULL,";
  query += "`volume`             DOUBLE            NOT NULL,";
  query += "`symbol`             VARCHAR ( 255 )   NOT NULL,";
  query += "`position_ticket`    BIGINT UNSIGNED   NOT NULL,";
  query += "`is_tick_scalp`      TINYINT ( 1 )     NOT NULL DEFAULT 0,";
  query += "`is_weekend`         TINYINT ( 1 )     NOT NULL DEFAULT 0,";
  query += "`is_news_trading`    TINYINT ( 1 )     NOT NULL DEFAULT 0,";
  query += "`news`               VARCHAR ( 255 )   NULL,";
  query += "`status`             TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "`created_at`         TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`         TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`         TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "INDEX `position_idx_fk_account_id` ( `account_id` ) USING BTREE,";
  query += "INDEX `position_idx_fk_position_ticket` ( `position_ticket` ) USING BTREE,";
  query += "CONSTRAINT `position_account_id_fkey` FOREIGN KEY ( `account_id` ) REFERENCES `sgb`.`account` ( `id` ) ON DELETE RESTRICT ON UPDATE CASCADE";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableBalance(void)
 {
  string table_name = DEF_DB_TBL_BALANCE;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`                 VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`         INT UNSIGNED      NOT NULL,";
  query += "`time_msc`           BIGINT            NOT NULL,";
  query += "`balance`            DOUBLE            NULL,";
  query += "`last_day_balance`   DOUBLE            NULL,";
  query += "`daily_limit`        DOUBLE            NULL,";
  query += "`total_limit`        DOUBLE            NULL,";

  query += "`created_at`      TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`      TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`      TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY (`id`),";
  query += "INDEX `balance_equity_idx_fk_account_id`(`account_id`) USING BTREE,";
  query += "CONSTRAINT `balance_equity_account_id_fkey` FOREIGN KEY (`account_id`) REFERENCES `sgb`.`account` (`id`) ON DELETE RESTRICT ON UPDATE CASCADE";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableEquity(void)
 {
  string table_name = DEF_DB_TBL_EQUITY;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`                    VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`            INT UNSIGNED      NOT NULL,";

  query += "`time`                  TIMESTAMP         NOT NULL,";
  query += "`time_msc`              BIGINT            NOT NULL,";
  query += "`balance`               DOUBLE NULL,";
  query += "`open_equity`           DOUBLE            NULL,";
  query += "`high_equity`           DOUBLE            NULL,";
  query += "`low_equity`            DOUBLE            NULL,";
  query += "`close_equity`          DOUBLE            NULL,";
  query += "`daily_limit`           DOUBLE            NULL,";
  query += "`total_limit`           DOUBLE            NULL,";
  query += "`is_balance_gambeling`  TINYINT ( 1 )     NOT NULL DEFAULT 0,";
  query += "`is_equity_gambeling`   TINYINT ( 1 )     NOT NULL DEFAULT 0,";
  query += "`created_at`            TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`            TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`            TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY (`id`),";
  query += "INDEX `balance_equity_idx_fk_account_id`(`account_id`) USING BTREE,";
  query += "CONSTRAINT `balance_equity_account_id_fkey` FOREIGN KEY (`account_id`) REFERENCES `sgb`.`account` (`id`) ON DELETE RESTRICT ON UPDATE CASCADE";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableObjective(void)
 {
  string table_name = DEF_DB_TBL_OBJECTIVE;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";

  query += "`id`                             VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`                     INT UNSIGNED      NOT NULL,";

  query += "`init_balance`                   DOUBLE            NULL,";
  query += "`balance_min_value`              DOUBLE            NULL,";
  query += "`balance_min_time`               TIMESTAMP         NULL,";
  query += "`balance_min_time_msc`           BIGINT            NULL,";
  query += "`balance_max_value`              DOUBLE            NULL,";
  query += "`balance_max_time`               TIMESTAMP         NULL,";
  query += "`balance_max_time_msc`           BIGINT            NULL,";
  query += "`balance_is_daily_touch`         TINYINT ( 1 )     NULL,";
  query += "`balance_daily_touch_value`      DOUBLE            NULL,";
  query += "`balance_daily_touch_Time`       TIMESTAMP         NULL,";
  query += "`balance_daily_touch_Time_Msc`   BIGINT            NULL,";
  query += "`balance_daily_touch_Limit`      DOUBLE            NULL,";
  query += "`balance_is_total_touch`         TINYINT ( 1 )     NULL,";
  query += "`balance_total_touch_value`      DOUBLE            NULL,";
  query += "`balance_total_touch_time`       TIMESTAMP         NULL,";
  query += "`balance_total_touch_time_Msc`   BIGINT            NULL,";
  query += "`balance_total_touch_limit`      DOUBLE            NULL,";
  query += "`equity_min_value`               DOUBLE            NULL,";
  query += "`equity_min_time`                TIMESTAMP         NULL,";
  query += "`equity_min_time_msc`            BIGINT            NULL,";
  query += "`equity_max_value`               DOUBLE            NULL,";
  query += "`equity_max_time`                TIMESTAMP         NULL,";
  query += "`equity_max_time_msc`            BIGINT            NULL,";
  query += "`equity_is_daily_touch`          TINYINT ( 1 )     NULL,";
  query += "`equity_daily_touch_value`       DOUBLE            NULL,";
  query += "`equity_daily_touch_Time`        TIMESTAMP         NULL,";
  query += "`equity_daily_touch_Time_Msc`    BIGINT            NULL,";
  query += "`equity_daily_touch_Limit`       DOUBLE            NULL,";
  query += "`equity_is_total_touch`          TINYINT ( 1 )     NULL,";
  query += "`equity_total_touch_value`       DOUBLE            NULL,";
  query += "`equity_total_touch_time`        TIMESTAMP         NULL,";
  query += "`equity_total_touch_time_Msc`    BIGINT            NULL,";
  query += "`equity_total_touch_limit`       DOUBLE            NULL,";

  query += "`created_at`                     TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`                     TIMESTAMP         NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`                     TINYINT ( 1 )     NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "INDEX `objective_idx_fk_account_id`(`account_id`) USING BTREE,";
  query += "CONSTRAINT `objective_account_id_fkey` FOREIGN KEY (`account_id`) REFERENCES `sgb`.`account` (`id`) ON DELETE RESTRICT ON UPDATE CASCADE";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::CreateTableStatement(void)
 {
  string table_name = DEF_DB_TBL_STATEMENT;
  string query = "CREATE TABLE IF NOT EXISTS `" + DEF_DB_DB_Name + "`.`" + table_name + "` (";


  query += "`id`                             VARCHAR ( 255 )   NOT NULL,";
  query += "`account_id`                     INT UNSIGNED      NOT NULL,";

  query += "`total_net_profit`               DOUBLE         NULL,";
  query += "`gross_profit`                   DOUBLE         NULL,";
  query += "`gross_loss`                     DOUBLE         NULL,";
  query += "`profit_factor`                  DOUBLE         NULL,";
  query += "`recovery_factor`                DOUBLE         NULL,";
  query += "`expected_payoff`                DOUBLE         NULL,";
  query += "`sharpe_ratio`                   DOUBLE         NULL,";
  query += "`ahpr`                           DOUBLE         NULL,";
  query += "`ahpr_percent`                   DOUBLE         NULL,";
  query += "`ghpr`                           DOUBLE         NULL,";
  query += "`ghpr_percent`                   DOUBLE         NULL,";
  query += "`z_score`                        DOUBLE         NULL,";
  query += "`z_score_percent`                DOUBLE         NULL,";
  query += "`lr_correlation`                 DOUBLE         NULL,";
  query += "`lr_standard_error`              DOUBLE         NULL,";
  query += "`total_deals`                    INT            NULL,";
  query += "`total_trades`                   INT            NULL,";
  query += "`total_profit_trades`            INT            NULL,";
  query += "`total_loss_trades`              INT            NULL,";
  query += "`total_win_rate`                 DOUBLE         NULL,";
  query += "`total_loss_rate`                DOUBLE         NULL,";
  query += "`total_average_profit_trade`     DOUBLE         NULL,";
  query += "`total_average_loss_trade`       DOUBLE         NULL,";
  query += "`long_trades`                    INT            NULL,";
  query += "`long_profit_trades`             INT            NULL,";
  query += "`long_loss_trades`               INT            NULL,";
  query += "`long_win_rate`                  DOUBLE         NULL,";
  query += "`long_loss_rate`                 DOUBLE         NULL,";
  query += "`short_trades`                   INT            NULL,";
  query += "`short_profit_trades`            INT            NULL,";
  query += "`short_loss_trades`              INT            NULL,";
  query += "`short_win_rate`                 DOUBLE         NULL,";
  query += "`short_loss_rate`                DOUBLE         NULL,";
  query += "`largest_profit_trade`           DOUBLE         NULL,";
  query += "`largest_loss_trade`             DOUBLE         NULL,";
  query += "`ave_profit_trade`               DOUBLE         NULL,";
  query += "`ave_loss_trade`                 DOUBLE         NULL,";
  query += "`max_consecutive_wins`           DOUBLE         NULL,";
  query += "`max_consecutive_losses`         DOUBLE         NULL,";
  query += "`ave_consecutive_wins_trades`    INT            NULL,";
  query += "`ave_consecutive_losses_trades`  INT            NULL,";

  query += "`created_at`                     TIMESTAMP      NOT NULL DEFAULT CURRENT_TIMESTAMP,";
  query += "`updated_at`                     TIMESTAMP      NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,";
  query += "`is_deleted`                     TINYINT ( 1 )  NOT NULL DEFAULT 0,";

  query += "PRIMARY KEY ( `id` ),";
  query += "INDEX `statement_idx_fk_account_id`(`account_id`) USING BTREE,";
  query += "CONSTRAINT `statement_account_id_fkey` FOREIGN KEY (`account_id`) REFERENCES `sgb`.`account` (`id`) ON DELETE RESTRICT ON UPDATE CASCADE";

  query += ") ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci ROW_FORMAT = DYNAMIC;";
//---
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::FillTempData(void)
 {
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StoreAccountData(void)
 {
  string query = NULL;
  m_hash_id = Task.HashID();

  query  = "INSERT INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_ACCOUNT + "` (";

  query += "`id`,";                       // int unsigned NOT NULL,
  query += "`server`,";                   // varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  query += "`login`,";                    // int unsigned NOT NULL,
  query += "`investor_password`,";        // varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  if(Task.Result.ErrorCode() == 0)
   {
    query += "`hash_point_a`,";           // varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
    query += "`hash_point_b`,";           // varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
    query += "`last_update`,";            // timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
    query += "`last_history_id`,";        // varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
   }
  query += "`task`,";                     // int NOT NULL,
  query += "`algorithm`,";                // int NOT NULL,
  query += "`initial_balance`,";          // decimal(15, 2) NOT NULL,
  query += "`daily_drawdown_percent`,";   // decimal(5, 2) NOT NULL,
  query += "`total_drawdown_percent`,";   // decimal(5, 2) NOT NULL,
  query += "`tick_scalp_enable`,";        // tinyint(1) NOT NULL,
  query += "`tick_scalp_term`,";          // int NOT NULL,
  query += "`gambling_enable`,";          // tinyint(1) NOT NULL,
  query += "`gambling_percent`,";         // decimal(5, 2) NOT NULL,
  query += "`news_enable`,";              // tinyint(1) NOT NULL,
  query += "`weekend_enable`,";           // tinyint(1) NOT NULL,
  query += "`trail_total`,";              // tinyint(1) NOT NULL,
  query += "`trail_total_type`,";         // int NOT NULL,
  query += "`is_secure`";                 // tinyint(1) NOT NULL,

  query += ") VALUES(";

  query += IntegerFild(Task.AccountId())              + ",";    //"`id`,";                      // int unsigned NOT NULL,
  query += StringFild(Task.Server())                  + ",";    //"`server`,";                  // varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  query += IntegerFild(Task.Login())                  + ",";    //"`login`,";                   // int unsigned NOT NULL,
  query += StringFild(Task.Password())                + ",";    //"`investor_password`,";       // varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  if(Task.Result.ErrorCode() == 0)
   {
    query += StringFild(Task.Result.DealChekPoint())  + ",";    //"`hash_point_a`,";            // varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
    query += StringFild(Task.NewEquityChekPoint())    + ",";    //"`hash_point_b`,";            // varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
    query += DateTimeFild(History.EndTime())          + ",";    //"`last_update`,";             // timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
    query += StringFild(m_hash_id)                    + ",";    //"`history_id`,";              // varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
   }
  query += IntegerFild(Task.Task())                   + ",";    //"`task`,";                    // int NOT NULL,
  query += IntegerFild(ALGORITHM_NORMAL)              + ",";    //"`algorithm`,";               // int NOT NULL,
  query += DoubleFild(Task.InitBalance(), 2)          + ",";    //"`initial_balance`,";         // decimal(15, 2) NOT NULL,
  query += DoubleFild(Task.DailyRiskPercent(), 2)     + ",";    //"`daily_drawdown_percent`,";  // decimal(5, 2) NOT NULL,
  query += DoubleFild(Task.TotalRiskPercent(), 2)     + ",";    //"`total_drawdown_percent`,";  // decimal(5, 2) NOT NULL,
  query += IntegerFild(Task.UseTickScalp())           + ",";    //"`tick_scalp_enable`,";       // tinyint(1) NOT NULL,
  query += IntegerFild(Task.TickScalpTermMsc())       + ",";    //"`tick_scalp_term`,";         // int NOT NULL,
  query += IntegerFild(Task.UseGambeling())           + ",";    //"`gambeling_enable`,";        // tinyint(1) NOT NULL,
  query += DoubleFild(Task.GambelingPercent(), 2)     + ",";    //"`gambeling_percent`,";       // decimal(5, 2) NOT NULL,
  query += IntegerFild(Task.UseNews())                + ",";    //"`news_enable`,";             // tinyint(1) NOT NULL,
  query += IntegerFild(Task.UseWeekend())             + ",";    //"`weekend_enable`,";          // tinyint(1) NOT NULL,
  query += IntegerFild(Task.UseTrailTotal())          + ",";    //"`trail_total`,";             // tinyint(1) NOT NULL,
  query += IntegerFild(Task.TrailTotal())             + ",";    //"`trail_total_type`,";        // int NOT NULL,
  query += IntegerFild(Task.IsSecure())               ;         //"`is_secure`";                // tinyint(1) NOT NULL,

  query += ")";

  query += "ON DUPLICATE KEY UPDATE ";

  query += "`server`=VALUES(`server`),";
  query += "`login`=VALUES(`login`),";
  query += "`investor_password`=VALUES(`investor_password`),";
  if(Task.Result.ErrorCode() == 0)
   {
    query += " `hash_point_a`=VALUES(`hash_point_a`),";
    query += "`hash_point_b`=VALUES(`hash_point_b`),";
    query += "`last_update`=VALUES(`last_update`),";
    query += "`last_history_id` = VALUES(`last_history_id`),";
   }
  query += "`task` = VALUES(`task`),";
  query += "`algorithm` = VALUES(`algorithm`),";
  query += "`initial_balance` = VALUES(`initial_balance`),";
  query += "`daily_drawdown_percent` = VALUES(`daily_drawdown_percent`),";
  query += "`total_drawdown_percent` = VALUES(`total_drawdown_percent`),";
  query += "`tick_scalp_enable` = VALUES(`tick_scalp_enable`),";
  query += "`tick_scalp_term` = VALUES(`tick_scalp_term`),";
  query += "`gambling_enable` = VALUES(`gambling_enable`),";
  query += "`gambling_percent` = VALUES(`gambling_percent`),";
  query += "`news_enable` = VALUES(`news_enable`),";
  query += "`weekend_enable` = VALUES(`weekend_enable`),";
  query += "`trail_total` = VALUES(`trail_total`),";
  query += "`trail_total_type` = VALUES(`trail_total_type`),";
  query += "`is_secure` = VALUES(`is_secure`);";

  return TransactionExecute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StoreDeals(void)
 {
  if(!DEF_SETTING_STOR_DEAL)
    return true;
//---
  bool is_start = true;
  string query = "DELETE FROM `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_DEAL + "` WHERE account_id=" + IntegerFild(Task.AccountId()) + " AND time>" + Timestamp3Fild(Task.EquityCheckPointTimeMsc()) + ";";

  uint total = History.DealsList.Total();
  for(uint i = 0; i < total; i++)
   {
    CDeal *Deal = History.DealsList.At(i);

    if(IS_POINTER_DYNAMIC(Deal) && Deal.Ticket() > 0)
     {
      int digits = (int)::SymbolInfoInteger(Deal.Symbol(), SYMBOL_DIGITS);

      if(is_start || query == NULL)
       {
        query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_DEAL + "` (";

        query += "`account_id`,";      //INT UNSIGNED      NOT NULL,";
        query += "`deal_ticket`,";     //BIGINT UNSIGNED   NOT NULL,";
        query += "`order_ticket`,";    //BIGINT UNSIGNED   NOT NULL,";
        query += "`time`,";            //TIMESTAMP(3)      NOT NULL,";
        query += "`type`,";            //TINYINT UNSIGNED  NOT NULL,";
        query += "`entry`,";           //TINYINT UNSIGNED  NOT NULL,";
        query += "`magic`,";           //BIGINT            ZEROFILL NOT NULL,";
        query += "`reason`,";          //TINYINT UNSIGNED  NOT NULL,";
        query += "`position_ticket`,"; //BIGINT UNSIGNED   NOT NULL,";
        query += "`volume`,";          //DOUBLE            NOT NULL,";
        query += "`price`,";           //DOUBLE            NOT NULL,";
        query += "`commission`,";      //DOUBLE            NOT NULL,";
        query += "`swap`,";            //DOUBLE            NOT NULL,";
        query += "`profit`,";          //DOUBLE            NOT NULL,";
        query += "`fee`,";             //DOUBLE            NOT NULL,";
        query += "`stop_loss`,";       //DOUBLE            NOT NULL,";
        query += "`take_profit`,";     //DOUBLE            NOT NULL,";
        query += "`symbol`,";          //VARCHAR ( 255 )   NOT NULL,";
        query += "`comment`,";         //VARCHAR ( 255 )   NULL,";
        query += "`balance`,";         //DOUBLE            NULL,";
        query += "`external_id`";      //VARCHAR ( 255 )   NULL,";

        query += ") VALUES";

        is_start = false;
       }
      else
        query += ",";

      query += " (";

      query += IntegerFild(Task.AccountId())          + ",";   //"`account_id`,";      //INT UNSIGNED      NOT NULL,";
      query += IntegerFild(Deal.Ticket())             + ",";   //"`deal_ticket`,";     //BIGINT UNSIGNED   NOT NULL,";
      query += IntegerFild(Deal.OrderTicket())        + ",";   //"`order_ticket`,";    //BIGINT UNSIGNED   NOT NULL,";
      query += Timestamp3Fild(Deal.TimeMsc())         + ",";   //"`time`,";            //TIMESTAMP(3)      NOT NULL,";
      query += IntegerFild(Deal.MysqlEnumDealType())  + ",";   //"`type`,";            //TINYINT UNSIGNED  NOT NULL,";
      query += IntegerFild(Deal.MysqlEnumEntry())     + ",";   //"`entry`,";           //TINYINT UNSIGNED  NOT NULL,";
      query += IntegerFild(Deal.Magic())              + ",";   //"`magic`,";           //BIGINT            ZEROFILL NOT NULL,";
      query += IntegerFild(Deal.MysqlEnumReason())    + ",";   //"`reason`,";          //TINYINT UNSIGNED  NOT NULL,";
      query += IntegerFild(Deal.PositionId())         + ",";   //"`position_ticket`,"; //BIGINT UNSIGNED   NOT NULL,";
      query += DoubleFild(Deal.Volume(), 2)           + ",";   //"`volume`,";          //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Price(), digits)       + ",";   //"`price`,";           //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Commission(), digits)  + ",";   //"`commission`,";      //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Swap(), 2)             + ",";   //"`swap`,";            //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Profit(), 2)           + ",";   //"`profit`,";          //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Fee(), 2)              + ",";   //"`fee`,";             //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Sl(), digits)          + ",";   //"`stop_loss`,";       //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.Tp(), digits)          + ",";   //"`take_profit`,";     //DOUBLE            NOT NULL,";
      query += StringFild(Deal.Symbol())              + ",";   //"`symbol`,";          //VARCHAR ( 255 )   NOT NULL,";
      query += StringFild(Deal.Comment())             + ",";   //"`comment`,";         //VARCHAR ( 255 )   NULL,";
      query += DoubleFild(Deal.Balance(), 2)          + ",";   //"`balance`,";         //DOUBLE            NULL,";
      query += StringFild(Deal.ExtId())               + "";    //"`external_id`,";     //VARCHAR ( 255 )   NULL,";

      query += ") ";
     }
    if(i != 0 && i % 200 == 0)
     {
      if(query != NULL)
       {
        query += ";";
        if(!TransactionExecute(query))
          return false;
       }
      query = NULL;
     }
   }
//---
  if(query != NULL)
   {
    query += ";";
    return TransactionExecute(query);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StorePositions(void)
 {
  if(!DEF_SETTING_STOR_POSITION)
    return true;
//---
  bool is_start = true;
  string query = "DELETE FROM `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_POSITION + "` WHERE account_id=" + IntegerFild(Task.AccountId()) + " AND open_time>" + Timestamp3Fild(Task.EquityCheckPointTimeMsc()) + ";";

  uint total = History.PositionList.Total();
  for(uint i = 0; i < total; i++)
   {
    CPosition *Position = History.PositionList.At(i);

    if(IS_POINTER_DYNAMIC(Position) && Position.PositionId() > 0 && Position.OpenTicket() > 0 && (Position.CloseTicket() > 0 || Position.IsOpenPosition()))
     {
      int digits = Position.Digits();

      if(is_start || query == NULL)
       {
        if(i == 0)
          query += "DELETE FROM `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_POSITION + "` WHERE `status`=1 AND `account_id`=" + IntegerFild(Task.AccountId()) + ";";

        query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_POSITION + "` (";

        query += "`account_id`,";         //INT UNSIGNED      NOT NULL,";
        query += "`open_deal_ticket`,";   //BIGINT UNSIGNED   NOT NULL,";
        query += "`open_time`,";          //TIMESTAMP(3)      NOT NULL,";
        query += "`open_price`,";         //DOUBLE            NOT NULL,";
        query += "`open_stop_loss`,";     //DOUBLE            NULL,";
        query += "`open_take_profit`,";   //DOUBLE            NULL,";
        query += "`open_commission`,";    //DOUBLE            NOT NULL,";
        query += "`open_swap`,";          //DOUBLE            NOT NULL,";
        query += "`open_fee`,";           //DOUBLE            NOT NULL,";
        query += "`close_deal_ticket`,";  //BIGINT UNSIGNED   NOT NULL,";
        query += "`close_time`,";         //TIMESTAMP(3)         NOT NULL,";
        query += "`close_price`,";        //DOUBLE            NOT NULL,";
        query += "`close_stop_loss`,";    //DOUBLE            NULL,";
        query += "`close_take_profit`,";  //DOUBLE            NULL,";
        query += "`close_commission`,";   //DOUBLE            NOT NULL,";
        query += "`close_swap`,";         //DOUBLE            NOT NULL,";
        query += "`close_fee`,";          //DOUBLE            NOT NULL,";
        query += "`cost`,";               //DOUBLE            NOT NULL,";
        query += "`profit`,";             //DOUBLE            NOT NULL,";
        query += "`net_profit`,";         //DOUBLE            NOT NULL,";
        query += "`duratian_msc`,";       //BIGINT UNSIGNED   NOT NULL,";
        query += "`type`,";               //TINYINT           NOT NULL,";
        query += "`volume`,";             //DOUBLE            NOT NULL,";
        query += "`symbol`,";             //VARCHAR ( 255 )   NOT NULL,";
        query += "`position_ticket`,";    //BIGINT UNSIGNED   NOT NULL,";
        query += "`is_tick_scalp`,";      // TINYINT(1)       NOT NULL DEFAULT 0,
        query += "`is_weekend`,";         // TINYINT(1)       NOT NULL DEFAULT 0,
        query += "`is_news_trading`,";    // TINYINT(1)       NOT NULL DEFAULT 0,
        query += "`news`,";               // VARCHAR(255)     NULL,
        query += "`status`";              //TINYINT ( 1 )     NOT NULL DEFAULT 0,";

        query += ") VALUES";
        is_start = false;
       }
      else
        query += ",";

      query += " (";

      query += IntegerFild(Task.AccountId()) + ",";             //"`account_id`,";         //INT UNSIGNED      NOT NULL,";
      query += IntegerFild(Position.OpenTicket()) + ",";        //"`open_deal_ticket`,";   //BIGINT UNSIGNED   NOT NULL,";
      query += Timestamp3Fild(Position.OpenTimeMsc()) + ",";    //"`open_time`,";          //TIMESTAMP(3)      NOT NULL,";
      query += DoubleFild(Position.OpenPrice(), digits) + ",";  //"`open_price`,";         //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.OpenSl(), digits) + ",";     //query += "`open_stop_loss`,";     //DOUBLE            NULL,";
      query += DoubleFild(Position.OpenTp(), digits) + ",";     //query += "`open_take_profit`,";   //DOUBLE            NULL,";
      query += DoubleFild(Position.OpenCommission(), 2) + ",";  //"`open_commission`,";    //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.OpenSwap(), 2) + ",";        //"`open_swap`,";          //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.OpenFee(), 2) + ",";         //"`open_fee`,";           //DOUBLE            NOT NULL,";
      query += IntegerFild(Position.CloseTicket()) + ",";       //"`close_deal_ticket`,";  //BIGINT UNSIGNED   NOT NULL,";
      query += Timestamp3Fild(Position.CloseTimeMsc()) + ",";   //"`close_time`,";         //TIMESTAMP(3)      NOT NULL,";
      query += DoubleFild(Position.ClosePrice(), digits) + ","; //"`close_price`,";        //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.CloseSl(), digits) + ",";    //query += "`open_stop_loss`,";     //DOUBLE            NULL,";
      query += DoubleFild(Position.CloseTp(), digits) + ",";    //query += "`open_take_profit`,";   //DOUBLE            NULL,";
      query += DoubleFild(Position.CloseCommission(), 2) + ","; //"`close_commission`,";   //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.CloseSwap(), 2) + ",";       //"`close_swap`,";         //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.CloseFee(), 2) + ",";        //"`close_fee`,";          //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.TotalCost(), 2) + ",";       //"`cost`,";               //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.Profit(), 2) + ",";          //"`profit`,";             //DOUBLE            NOT NULL,";
      query += DoubleFild(Position.NetProfit(), 2) + ",";       //"`net_profit`,";         //DOUBLE            NOT NULL,";
      query += IntegerFild(Position.TradeDuratianMsc()) + ",";  //"`duratian_msc`,";       //BIGINT UNSIGNED   NOT NULL,";
      query += IntegerFild(Position.MysqlEnumPositionType()) + ","; //"`type`,";               //TINYINT           NOT NULL,";
      query += DoubleFild(Position.Volume(), 2) + ",";          //"`volume`,";             //DOUBLE            NOT NULL,";
      query += StringFild(Position.Symbol()) + ",";             //"`symbol`,";             //VARCHAR ( 255 )   NOT NULL,";
      query += IntegerFild(Position.PositionId()) + ",";        //"`position_ticket`,";    //BIGINT UNSIGNED   NOT NULL,";
      query += IntegerFild(Position.IsTickScalp()) + ",";       //"`is_tick_scalp`,";      // TINYINT(1)        NOT NULL DEFAULT 0,
      query += IntegerFild(Position.IsWeekend()) + ",";         //`is_weekend`,";          // TINYINT(1)        NOT NULL DEFAULT 0,
      query += IntegerFild(Position.IsNewsTrading()) + ",";     //"`is_news_trading`,";    // TINYINT(1)        NOT NULL DEFAULT 0,
      query += StringFild(Position.News()) + ",";               //"`news`,";               // VARCHAR(255)      NULL,
      query += IntegerFild(Position.IsOpenPosition()) + "";     //"`status`";              //TINYINT ( 1 )     NOT NULL DEFAULT 0,";

      query += ")";
     }
    if(i != 0 && i % 200 == 0)
     {
      if(query != NULL)
       {
        query += ";";
        if(!TransactionExecute(query))
          return false;
       }
      query = NULL;
     }
   }
//---
  if(query != NULL)
   {
    query += ";";
    return TransactionExecute(query);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StoreBalance(void)
 {
  if(!DEF_SETTING_STOR_BALANCE)
    return true;
//---
  bool is_start = true;
  string query = "DELETE FROM `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_BALANCE + "` WHERE account_id=" + IntegerFild(Task.AccountId()) + " AND time>" + Timestamp3Fild(Task.EquityCheckPointTimeMsc()) + ";";

  uint total = History.DealsList.Total();
  for(uint i = 0; i < total; i++)
   {
    CDeal *Deal = History.DealsList.At(i);

    if(IS_POINTER_DYNAMIC(Deal) && Deal.Ticket() > 0)
     {
      if(is_start || query == NULL)
       {
        query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_BALANCE + "` (";

        query += "`deal_ticket`,";       //BIGINT UNSIGNED   NOT NULL,";
        query += "`account_id`,";        //INT UNSIGNED      NOT NULL,";
        query += "`time_msc`,";          //BIGINT UNSIGNED   NOT NULL,";
        query += "`time`,";
        query += "`balance`,";           //DOUBLE            NOT NULL,";
        query += "`last_day_balance`,";  //DOUBLE            NOT NULL,";
        query += "`daily_limit`,";       //DOUBLE            NOT NULL,";
        query += "`total_limit`";        //DOUBLE            NOT NULL,";

        query += ") VALUES";
        is_start = false;
       }
      else
        query += ",";

      query += " (";

      query += IntegerFild(Deal.Ticket())             + ",";   //"`deal_ticket`,";     //BIGINT UNSIGNED   NOT NULL,";
      query += IntegerFild(Task.AccountId())          + ",";   //"`account_id`,";        //INT UNSIGNED      NOT NULL,";
      query += IntegerFild(Deal.TimeMsc())            + ",";   //BIGINT UNSIGNED   NOT NULL,";
      query += Timestamp3Fild(Deal.TimeMsc())         + ",";
      query += DoubleFild(Deal.Balance(), 2)          + ",";   //"`balance`";            //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.LastDayBalance(), 2)   + ",";   //"`last_day_balance`,";  //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.DailyLimit(), 2)       + ",";   //"`daily_limit`,";       //DOUBLE            NOT NULL,";
      query += DoubleFild(Deal.TotalLimit(), 2)       + "";    //"`total_limit`,";       //DOUBLE            NOT NULL,";

      query += ")";
     }
    if(i != 0 && i % 500 == 0)
     {
      if(query != NULL)
       {
        query += ";";
        if(!TransactionExecute(query))
          return false;
       }
      query = NULL;
     }
   }
//---
  if(query != NULL)
   {
    query += ";";
    return TransactionExecute(query);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StoreEquity(void)
 {
  bool is_start = true;
  string query = "DELETE FROM `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_EQUITY + "` WHERE account_id=" + IntegerFild(Task.AccountId()) + " AND time>" + Timestamp3Fild(Task.EquityCheckPointTimeMsc()) + ";";

  uint total = Series.Total();
  for(uint i = 0; i < total; i++)
   {
    if(is_start || query == NULL)
     {
      query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_EQUITY + "` (";

      query += "`account_id`,";              //INT UNSIGNED      NOT NULL,";
      query += "`time_msc`,";                //BIGINT            NOT NULL,
      query += "`time`,";                    //TIMESTAMP(3)      NOT NULL,";
      query += "`balance`,";                 // DOUBLE           NULL,
      query += "`high_equity`,";             //DOUBLE            NULL,";
      query += "`low_equity`,";              //DOUBLE            NULL,";
      if(DEF_SETTING_STOR_EQUITY == STOR_EQUITY_FULL)
       {
        query += "`open_equity`,";           //DOUBLE            NULL,";
        query += "`close_equity`,";          //DOUBLE            NULL,";
       }
      query += "`daily_limit`,";             //DOUBLE            NULL,";
      query += "`total_limit`,";             //DOUBLE            NULL,";
      query += "`is_balance_gambeling`,";    // TINYINT ( 1 ) NOT NULL DEFAULT 0,
      query += "`is_equity_gambeling`";      // TINYINT ( 1 ) NOT NULL DEFAULT 0,

      query += ") VALUES";
      is_start = false;
     }
    else
      query += ",";

    query += " (";

    query += IntegerFild(Task.AccountId())               + ",";   //"`account_id`,";    //INT UNSIGNED      NOT NULL,";
    query += IntegerFild(Series.m_time_msc[i])           + ",";   //"`time_msc`,";      //BIGINT            NOT NULL,
    query += Timestamp3Fild(Series.m_time_msc[i])        + ",";   //"`time`,";          //TIMESTAMP(3)      NOT NULL,";
    query += DoubleFild(Series.m_balance[i], 2)          + ",";   //"`balance`,";       //DOUBLE            NULL,";
    query += DoubleFild(Series.m_equity_high[i], 2)      + ",";   //"`high_equity`,";   //DOUBLE            NULL,";
    query += DoubleFild(Series.m_equity_low[i], 2)       + ",";   //"`low_equity`,";    //DOUBLE            NULL,";
    if(DEF_SETTING_STOR_EQUITY == STOR_EQUITY_FULL)
     {
      query += DoubleFild(Series.m_equity_open[i], 2)    + ",";   //"`open_equity`,";   //DOUBLE            NULL,";
      query += DoubleFild(Series.m_equity_close[i], 2)   + ",";   //"`close_equity`";   //DOUBLE            NULL,";
     }
    query += DoubleFild(Series.m_day_limit[i], 2)        + ",";   //"`daily_limit`,";   //DOUBLE            NULL,";
    query += DoubleFild(Series.m_total_limit[i], 2)      + ",";   //"`total_limit`";    //DOUBLE            NULL,";
    query += IntegerFild(Series.m_balance_gambeling[i])  + ",";   //"`is_balance_gambeling`,";    // TINYINT ( 1 ) NOT NULL DEFAULT 0,
    query += IntegerFild(Series.m_equity_gambeling[i])   + "";    //"`is_equity_gambeling`";      // TINYINT ( 1 ) NOT NULL DEFAULT 0,

    query += ")";


    if(i != 0 && i % 300 == 0)
     {
      if(query != NULL)
       {
        query += ";";
        if(!TransactionExecute(query))
          return false;
       }
      query = NULL;
     }
   }
//---
  if(query != NULL)
   {
    query += ";";
    return TransactionExecute(query);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StoreStatement(void)
 {
  if(!DEF_SETTING_STOR_STATEMENT)
    return true;
//---
  string query = NULL;

  query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_STATEMENT + "` (";

  query += "`id`,";                             //VARCHAR ( 255 )   NOT NULL,
  query += "`total_net_profit`,";               //DOUBLE         NULL,";
  query += "`gross_profit`,";                   //DOUBLE         NULL,";
  query += "`gross_loss`,";                     //DOUBLE         NULL,";
  query += "`profit_factor`,";                  //DOUBLE         NULL,";
  query += "`recovery_factor`,";                //DOUBLE         NULL,";
  query += "`expected_payoff`,";                //DOUBLE         NULL,";
  query += "`sharpe_ratio`,";                   //DOUBLE         NULL,";
  query += "`ahpr`,";                           //DOUBLE         NULL,";
  query += "`ahpr_percent`,";                   //DOUBLE         NULL,";
  query += "`ghpr`,";                           //DOUBLE         NULL,";
  query += "`ghpr_percent`,";                   //DOUBLE         NULL,";
  query += "`z_score`,";                        //DOUBLE         NULL,";
  query += "`z_score_percent`,";                //DOUBLE         NULL,";
  query += "`lr_correlation`,";                 //DOUBLE         NULL,";
  query += "`lr_standard_error`,";              //DOUBLE         NULL,";
  query += "`total_deals`,";                    //INT            NULL,";
  query += "`total_trades`,";                   //INT            NULL,";
  query += "`total_profit_trades`,";            //INT            NULL,";
  query += "`total_loss_trades`,";              //INT            NULL,";
  query += "`total_win_rate`,";                 //DOUBLE         NULL,";
  query += "`total_loss_rate`,";                //DOUBLE         NULL,";
  query += "`total_average_profit_trade`,";     //DOUBLE         NULL,";
  query += "`total_average_loss_trade`,";       //DOUBLE         NULL,";
  query += "`long_trades`,";                    //INT            NULL,";
  query += "`long_profit_trades`,";             //INT            NULL,";
  query += "`long_loss_trades`,";               //INT            NULL,";
  query += "`long_win_rate`,";                  //DOUBLE         NULL,";
  query += "`long_loss_rate`,";                 //DOUBLE         NULL,";
  query += "`short_trades`,";                   //INT            NULL,";
  query += "`short_profit_trades`,";            //INT            NULL,";
  query += "`short_loss_trades`,";              //INT            NULL,";
  query += "`short_win_rate`,";                 //DOUBLE         NULL,";
  query += "`short_loss_rate`,";                //DOUBLE         NULL,";
  query += "`largest_profit_trade`,";           //DOUBLE         NULL,";
  query += "`largest_loss_trade`,";             //DOUBLE         NULL,";
  query += "`ave_profit_trade`,";               //DOUBLE         NULL,";
  query += "`ave_loss_trade`,";                 //DOUBLE         NULL,";
  query += "`max_consecutive_wins`,";           //DOUBLE         NULL,";
  query += "`max_consecutive_losses`,";         //DOUBLE         NULL,";
  query += "`ave_consecutive_wins_trades`,";    //INT            NULL,";
  query += "`ave_consecutive_losses_trades`";   //INT            NULL,";

  query += ") VALUES (";

  query += IntegerFild(Task.AccountId()) + ",";
  query += DoubleFild(Statement.Profit()) + ",";
  query += DoubleFild(Statement.GrossProfit()) + ",";
  query += DoubleFild(Statement.GrossLoss()) + ",";
  query += DoubleFild(Statement.ProfitFactor()) + ",";
  query += DoubleFild(Statement.RecoveryFactor()) + ",";
  query += DoubleFild(Statement.ExpectedPayoff()) + ",";
  query += DoubleFild(Statement.SharpeRatio()) + ",";
  query += DoubleFild(Statement.AHPR()) + ",";
  query += DoubleFild(Statement.AHPRPercent()) + ",";
  query += DoubleFild(Statement.GHPR()) + ",";
  query += DoubleFild(Statement.GHPRPercent()) + ",";
  query += DoubleFild(Statement.ZScore()) + ",";
  query += DoubleFild(Statement.ZScorePercent()) + ",";
  query += DoubleFild(Statement.LRCorrelation()) + ",";
  query += DoubleFild(Statement.LRStandardError()) + ",";
  query += IntegerFild(Statement.Deals()) + ",";
  query += IntegerFild(Statement.Trades()) + ",";
  query += IntegerFild(Statement.ProfitTrades()) + ",";
  query += IntegerFild(Statement.LossTrades()) + ",";
  query += DoubleFild(Statement.Percent(Statement.ProfitTrades(), Statement.Trades())) + ",";
  query += DoubleFild(Statement.Percent(Statement.LossTrades(), Statement.Trades())) + ",";
  query += DoubleFild(Statement.Divide(Statement.GrossProfit(), Statement.ProfitTrades())) + ",";
  query += DoubleFild(Statement.Divide(Statement.GrossLoss(), Statement.LossTrades())) + ",";
  query += IntegerFild(Statement.LongTrades()) + ",";
  query += IntegerFild(Statement.ProfitLongTrades()) + ",";
  query += IntegerFild(Statement.LongTrades() - Statement.ProfitLongTrades()) + ",";
  query += DoubleFild(Statement.Percent(Statement.ProfitLongTrades(), Statement.LongTrades())) + ",";
  query += DoubleFild(Statement.Percent(Statement.LongTrades() - Statement.ProfitLongTrades(), Statement.LongTrades())) + ",";
  query += IntegerFild(Statement.ShortTrades()) + ",";
  query += IntegerFild(Statement.ProfitShortTrades()) + ",";
  query += IntegerFild(Statement.ShortTrades() - Statement.ProfitShortTrades()) + ",";
  query += DoubleFild(Statement.Percent(Statement.ProfitShortTrades(), Statement.ShortTrades())) + ",";
  query += DoubleFild(Statement.Percent(Statement.ShortTrades() - Statement.ProfitShortTrades(), Statement.ShortTrades())) + ",";
  query += DoubleFild(Statement.LargestProfitTrade()) + ",";
  query += DoubleFild(Statement.LargestLossTrade()) + ",";
  query += DoubleFild(Statement.Divide(Statement.GrossProfit(), Statement.ProfitTrades())) + ",";
  query += DoubleFild(Statement.Divide(Statement.GrossLoss(), Statement.LossTrades())) + ",";
  query += DoubleFild(Statement.MaxConWins()) + ",";
  query += DoubleFild(Statement.MaxConLosses()) + ",";
  query += IntegerFild(Statement.ProfitTradesAvgCon()) + ",";
  query += IntegerFild(Statement.LossTradesAvgCon()) + "";

  query += "); ";
//---
  return  TransactionExecute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool  CDatabase::StoreDrawdown(void)
 {
  bool is_start = true;
  string query = "DELETE FROM `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_DRAWDOWN + "` WHERE account_id=" + IntegerFild(Task.AccountId()) + " AND `time`>" + Timestamp3Fild(Task.EquityCheckPointTimeMsc()) + ";";

  uint total = Equity.DrawDownList.Total();
  for(uint i = 0; i < total; i++)
   {
    CDrawDown *DD = Equity.DrawDownList.At(i);

    if(!IS_POINTER_DYNAMIC(DD))
      continue;

    if(is_start || query == NULL)
     {
      query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_DRAWDOWN + "` (";

      query += "`account_id`,";    //INT UNSIGNED      NOT NULL,";
      query += "`source`,";
      query += "`type`,";
      query += "`time`,";
      query += "`time_msc`,";
      query += "`limit`,";
      query += "`value`";

      query += ") VALUES";
      is_start = false;
     }
    else
      query += ",";

    query += " (";

    query += IntegerFild(Task.AccountId())               + ",";
    query += IntegerFild((int)DD.source)                 + ",";
    query += IntegerFild((int)DD.type)                   + ",";
    query += Timestamp3Fild(DD.time_msc)                 + ",";
    query += IntegerFild(DD.time_msc)                    + ",";
    query += DoubleFild(DD.limit)                        + ",";
    query += DoubleFild(DD.value)                        + "";

    query += ")";

    if(i != 0 && i % 300 == 0)
     {
      if(query != NULL)
       {
        query += ";";
        if(!TransactionExecute(query))
          return false;
       }
      query = NULL;
     }
   }
//---
  if(query != NULL)
   {
    query += ";";
    return TransactionExecute(query);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool  CDatabase::StoreObjective(void)
 {
  if(!DEF_SETTING_STOR_OBJECTIVE)
    return true;
//---
  string query = NULL;
  query += "CALL UpdateObjective(" + IntegerFild(Task.AccountId()) + ");";

  query += "UPDATE `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_OBJECTIVE        + "` ";
  query += "SET ";
  query += "open_position_count=" + IntegerFild(History.TotalOpenPositons()) + ", ";
  query += "open_order_count="    + IntegerFild(History.TotalOpenOrders())   + " ";
  query += "WHERE id="            + IntegerFild(Task.AccountId())            + ";";
//---
  return  TransactionExecute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool  CDatabase::StoreCheckPoints(void)
 {
  string query = NULL;
  query += "UPDATE `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_ACCOUNT + "` SET ";
  query += "`hash_point_a` = " + StringFild(Task.Result.DealChekPoint()) + ", ";
  query += "`hash_point_b` = " + StringFild(Task.NewEquityChekPoint()) + " ";
  query += "WHERE `id` = " + IntegerFild(Task.AccountId()) + ";";
//---
  return  TransactionExecute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StoreNodeLastUpdate(const string _hash_id, const bool _is_trans = false)
 {
  string query = NULL;
  query += "UPDATE `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_ACCOUNT + "` SET ";
  query += "`node_last_update`= " + DateTimeFild(History.EndTime()) + ", ";
  query += "`node_history_id`=" + StringFild(_hash_id) + " ";
  query += "WHERE `id` = " + (string)Task.AccountId() + ";";
//---
  if(_is_trans)
    return TransactionExecute(query);
  return Execute(query);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDatabase::StorHistory(CTask *_Task, const bool _is_trans = false)
 {
  if(!IS_POINTER_DYNAMIC(_Task))
    return false;
//---
  string query = NULL;
  if(!_is_trans)
    m_hash_id = _Task.HashID();


  query += "REPLACE INTO `" + DEF_DB_DB_Name + "`.`" + DEF_DB_TBL_NODE_HISTORY + "` (";

  query += "`id`,";                             //varchar 255
  query += "`server_time`,";                    //timestamp
  query += "`app_name`,";                       //varchar 255
  query += "`identification`,";                 //varchar 255
  query += "`task`,";                           //varchar 50
  query += "`accountId`,";                      //int
  query += "`login`,";                          //int
  query += "`investor_password`,";              //varchar 255
  query += "`server`,";                         //varchar 255
  query += "`hash_point_a`,";                   //varchar 255
  query += "`hash_point_b`,";                   //varchar 255
  query += "`initial_balance`,";                //double
  query += "`target_percent`,";                 //double
  query += "`daily_risk_percent`,";             //double
  query += "`total_risk_percent`,";             //double
  query += "`is_check_tick_scalp`,";            //tinyint 1
  query += "`tick_scalp_term_msc`,";            //bigint
  query += "`is_check_gambeling`,";             //tinyint 1
  query += "`gambeling_percent`,";              //double
  query += "`is_check_news`,";                  //tinyint 1
  query += "`is_check_Weekend`,";               //tinyint 1
  query += "`is_trail_total`,";                 //tinyint 1
  query += "`trail_total_type`,";               //tinyint 1
  query += "`is_secure`,";                      //tinyint 1
  query += "`result_status`,";                  //varchar 255
  query += "`login_term_msc`,";                 //bigint
  query += "`db_connection_term_msc`,";         //bigint
  query += "`update_history_term_msc`,";        //bigint
  query += "`load_data_term_msc`,";             //bigint
  query += "`create_series_term_msc`,";         //bigint
  query += "`update_equity_term_msc`,";         //bigint
  query += "`update_report_term_msc`,";         //bigint
  query += "`update_statement_term_msc`,";      //bigint
  query += "`store_data_term_msc`,";            //bigint
  query += "`full_term_msc`,";                  //bigint
  query += "`error_code`,";                     //int
  query += "`error_description`,";              //varchar 255
  query += "`new_hash_point_a`,";               //varchar 255
  query += "`new_hash_point_b`";                //varchar 255

  query += ") VALUES (";

  query += StringFild(m_hash_id) + ",";                                //varchar 255
  query += DateTimeFild(_Task.ServerTime()) + ",";                    //timestamp
  query += StringFild(_Task.AppName()) + ",";                         //varchar 255
  query += StringFild(_Task.Identification()) + ",";                  //varchar 255
  query += StringFild(_Task.TaskSting()) + ",";                       //varchar 50
  query += IntegerFild(_Task.AccountId()) + ",";                      //int
  query += IntegerFild(_Task.Login()) + ",";                          //int
  query += StringFild(_Task.RawPassword()) + ",";                     //varchar 255
  query += StringFild(_Task.Server()) + ",";                          //varchar 255
  query += StringFild(_Task.HashPointA()) + ",";                      //varchar 255
  query += StringFild(_Task.HashPointB()) + ",";                      //varchar 255
  query += DoubleFild(_Task.InitBalance(), 2) + ",";                  //double
  query += DoubleFild(_Task.TargetPercent()) + ",";                   //double
  query += DoubleFild(_Task.DailyRiskPercent()) + ",";                //double
  query += DoubleFild(_Task.TotalRiskPercent()) + ",";                //double
  query += IntegerFild((int)_Task.UseTickScalp()) + ",";              //tinyint 1
  query += IntegerFild(_Task.TickScalpTermMsc()) + ",";               //bigint
  query += IntegerFild((int)_Task.UseGambeling()) + ",";              //tinyint 1
  query += DoubleFild(_Task.GambelingPercent()) + ",";                //double
  query += IntegerFild((int)_Task.UseNews()) + ",";                   //tinyint 1
  query += IntegerFild((int)_Task.UseWeekend()) + ",";                //tinyint 1
  query += IntegerFild((int)_Task.UseTrailTotal()) + ",";             //tinyint 1
  query += IntegerFild(_Task.TrailTotal()) + ",";                     //tinyint 1
  query += IntegerFild((int)_Task.IsSecure()) + ",";                  //tinyint 1
  query += StringFild(_Task.Result.Status()) + ",";                   //varchar 255
  query += IntegerFild(_Task.Result.LoadDataTermMsc()) + ",";         //bigint
  query += IntegerFild(_Task.Result.DbConnectionTermMsc()) + ",";     //bigint
  query += IntegerFild(_Task.Result.UpdateHistoryTermMsc()) + ",";    //bigint
  query += IntegerFild(_Task.Result.LoadDataTermMsc()) + ",";         //bigint
  query += IntegerFild(_Task.Result.CreateSeriesTermMsc()) + ",";     //bigint
  query += IntegerFild(_Task.Result.UpdateEquityTermMsc()) + ",";     //bigint
  query += IntegerFild(_Task.Result.UpdateReportTermMsc()) + ",";     //bigint
  query += IntegerFild(_Task.Result.UpdateStatementTermMsc()) + ",";  //bigint
  query += IntegerFild(_Task.Result.StoreDataTermMsc()) + ",";        //bigint
  query += IntegerFild(_Task.Result.FullTermMsc()) + ",";             //bigint
  query += IntegerFild(_Task.Result.ErrorCode()) + ",";               //int
  query += StringFild(_Task.Result.ErrorDescription()) + ",";         //varchar 255
  query += StringFild(_Task.Result.HashPointA()) + ",";               //varchar 255
  query += StringFild(_Task.NewEquityChekPoint()) + "";                //varchar 255

  query += ");";

  if(_is_trans)
   {
    if(!TransactionExecute(query))
      return false;
   }
  else
    if(!Execute(query))
      return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                        Erorr.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
//+------------------------------------------------------------------+
//| App Erros                                                        |
//+------------------------------------------------------------------+
#define DEF_APP_ERR_NO_ERROR              0
#define DEF_APP_ERR_INVALID_JSON          5001
#define DEF_APP_ERR_INVALID_NODE_ID       5002
#define DEF_APP_ERR_INVALID_TASK          5003
#define DEF_APP_ERR_INVALID_USER_ID       5004
#define DEF_APP_ERR_INVALID_ACC_ID        5005
#define DEF_APP_ERR_INVALID_LOGIN         5006
#define DEF_APP_ERR_INVALID_PASS          5007
#define DEF_APP_ERR_INVALID_SERVER        5008
#define DEF_APP_ERR_LOGIN_FAIL            5009
#define DEF_APP_ERR_HISTORY_UPDATE_FAIL   5010
#define DEF_APP_ERR_DATA_LOAD_FAIL        5011
#define DEF_APP_ERR_SERIES_CREATE_FAIL    5012
#define DEF_APP_ERR_DB_CONN_FAIL          5013
#define DEF_APP_ERR_DB_STORE_FAIL         5014
#define DEF_APP_ERR_STATEMENT_FAIL        5015
#define DEF_APP_ERR_EQUITY_UPDATE_FAIL    5016
#define DEF_APP_ERR_REPORT_UPDATE_FAIL    5017
#define DEF_APP_ERR_INVALID_ACC           5018
#define DEF_APP_ERR_SERVICE_STOP          5019
#define DEF_APP_ERR_BAD_INIT_BALANCE      5020
#define DEF_APP_ERR_BAD_TARGET_PERCENT    5021
#define DEF_APP_ERR_BAD_DAILY_PERCENT     5022
#define DEF_APP_ERR_BAD_TOYAL_PERCENT     5023
#define DEF_APP_ERR_BAD_TICKSCALP_TERM    5024
#define DEF_APP_ERR_BAD_GAMBEL_PERCENT    5025
#define DEF_APP_ERR_BAD_TOTAL_TRAIL_TYPE  5026
#define DEF_APP_ERR_NO_DEAL_TOUPDATE      5027
#define DEF_APP_ERR_HISTORY_INITIAL_FAIL  5028
#define DEF_APP_ERR_INT_CONN_FAIL         5029
#define DEF_APP_ERR_LOGIN_CONN_FAIL       5030
#define DEF_APP_ERR_LOGIN_DEALS_FAIL      5031
#define DEF_APP_ERR_LOGIN_INIT_BALANCE_FAIL 5032


//+------------------------------------------------------------------+
//| defines                                                          |
//+------------------------------------------------------------------+
string AppErrorDescription(const int _code)
 {
  switch(_code)
   {
    case DEF_APP_ERR_NO_ERROR:
      return "no error";
    case DEF_APP_ERR_INVALID_JSON:
      return "invalid json format";
    case DEF_APP_ERR_INVALID_NODE_ID:
      return "invalid node id";
    case DEF_APP_ERR_INVALID_TASK:
      return "invalid task";
    case DEF_APP_ERR_INVALID_USER_ID:
      return "invalid user id";
    case DEF_APP_ERR_INVALID_ACC_ID:
      return "invalid account id";
    case DEF_APP_ERR_INVALID_LOGIN:
      return "invalid login no.";
    case DEF_APP_ERR_INVALID_PASS:
      return "invalid password";
    case DEF_APP_ERR_INVALID_SERVER:
      return "invalid server";
    case DEF_APP_ERR_LOGIN_FAIL:
      return "login fali";
    case DEF_APP_ERR_HISTORY_UPDATE_FAIL:
      return "history update fail";
    case DEF_APP_ERR_DATA_LOAD_FAIL:
      return "load data fail";
    case DEF_APP_ERR_SERIES_CREATE_FAIL:
      return "create serises fail";
    case DEF_APP_ERR_DB_CONN_FAIL:
      return "db connection fail";
    case DEF_APP_ERR_DB_STORE_FAIL:
      return "db storing fail";
    case DEF_APP_ERR_STATEMENT_FAIL:
      return "statement update fail";
    case DEF_APP_ERR_EQUITY_UPDATE_FAIL:
      return "equity update fail";
    case DEF_APP_ERR_REPORT_UPDATE_FAIL:
      return "report update fail";
    case DEF_APP_ERR_INVALID_ACC:
      return "invalid account";
    case DEF_APP_ERR_SERVICE_STOP:
      return "service stoped";
    case DEF_APP_ERR_BAD_INIT_BALANCE:
      return "invalid initial balance";
    case DEF_APP_ERR_BAD_TARGET_PERCENT:
      return "invalid target percent";
    case DEF_APP_ERR_BAD_DAILY_PERCENT:
      return "invalid daily percent";
    case DEF_APP_ERR_BAD_TOYAL_PERCENT:
      return "invalid total percent";
    case DEF_APP_ERR_BAD_TICKSCALP_TERM:
      return "invalid tick scalp term";
    case DEF_APP_ERR_BAD_GAMBEL_PERCENT:
      return "invalid gambelling percent";
    case DEF_APP_ERR_BAD_TOTAL_TRAIL_TYPE:
      return "invalid total trail type";
    case DEF_APP_ERR_NO_DEAL_TOUPDATE:
      return "no update required(no deal or position)";
    case DEF_APP_ERR_HISTORY_INITIAL_FAIL:
      return "initial calculation balance fail";
    case DEF_APP_ERR_INT_CONN_FAIL:
      return "internet connection fail";
    case DEF_APP_ERR_LOGIN_CONN_FAIL:
      return "login connection fail";
    case DEF_APP_ERR_LOGIN_DEALS_FAIL:
      return "login broker deals fail";
    case DEF_APP_ERR_LOGIN_INIT_BALANCE_FAIL:
      return "login initial balance fail";
    default:
      break;
   }
  return "unkown error";
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                 SqliteSeries.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
#include <Object.mqh>
#include <Arrays\ArrayString.mqh>
#include <_Ata\Databases\SqliteDatabase.mqh>
#include <_Ata\General\Macros.mqh>
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CSqliteSeries : public CObject
 {
private:
  CSqlite            m_db;
  string             m_db_name,
                     m_db_path,
                     m_file_name,
                     m_table_name;
  uint               m_flags;
public:
                     CSqliteSeries();
                    ~CSqliteSeries();
  bool               Init(void);
  bool               AddArray(const ulong &_series[]);
  bool               AddString(const string _values);
  bool               Add(const ulong _time_msc);
  bool               GetSeries(ulong &_series[]);
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CSqliteSeries::CSqliteSeries()
 {
  m_db_name = "SeriesCash.sqlite";
  m_db_path = "SeriesCash\\";
  m_file_name = m_db_path + m_db_name;
  m_flags = DATABASE_OPEN_READWRITE | DATABASE_OPEN_CREATE;
  m_table_name = "TblSeries";
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CSqliteSeries::~CSqliteSeries()
 {
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSqliteSeries::Init(void)
 {
  if(!m_db.Open(m_file_name, m_flags))
    return false;

//--- create a table
  string params[] = {"series UNSIGNED BIG INT NOT NULL"};

  if(!m_db.CreateTable(m_table_name, params))
    return false;

  if(!m_db.SelectTable(m_table_name))
    return false;

  if(!m_db.EmptyTable())
    return false;

  m_db.FinalizeSqlRequest();
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSqliteSeries::AddArray(const ulong &_series[])
 {
  if(!m_db.TransactionBegin())
    return false;
//---
  CArrayString rows_str_arr;
  for(uint i = 0; i < _series.Size(); i++)
   {
    if(!rows_str_arr.Add(::StringFormat("%I64u", _series[i])))
      return false;
   }
//---
  string col_names[] = {"series"};
  if(!m_db.InsertMultipleRows(col_names, rows_str_arr))
   {
    m_db.TransactionRollback();
    return false;
   }
  m_db.FinalizeSqlRequest();
//---
  if(!m_db.TransactionCommit())
    return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSqliteSeries::AddString(const string _values)
 {
  if(!m_db.TransactionBegin())
    return false;
//---
  string sql_request =::StringFormat("INSERT INTO %s( series ) VALUES %s", m_table_name, _values);

  sql_request =::StringSubstr(sql_request, 0, ::StringLen(sql_request) - 1); // delete the last comma
  sql_request += ";";

  if(!m_db.Select(sql_request))
   {
    m_db.TransactionRollback();
    return false;
   }
  m_db.FinalizeSqlRequest();
//---
  if(!m_db.TransactionCommit())
    return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSqliteSeries::Add(const ulong _time_msc)
 {
  if(!m_db.TransactionBegin())
    return false;
//---
  string col_names[] = {"series"};
  string col_value[1];
  col_value[0] = ::StringFormat("%I64u", _time_msc);

  if(!m_db.InsertSingleRow(col_names, col_value))
    return false;
  m_db.FinalizeSqlRequest();
//---
  if(!m_db.TransactionCommit())
    return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSqliteSeries::GetSeries(ulong &_series[])
 {
  string col_names[] = {"series"};

  if(!m_db.SelectDistinctFromOrderedBy(col_names, col_names))
    return false;

  for(int i = 0; m_db.SqlRequestRead(); i++)
    if(!CFunc::AddToArray(m_db.ColumnLong(0), _series))
      return false;
//---
  return true;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                       Series.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"

#include <Object.mqh>
#include "..\Task\Task.mqh"
#include "..\History\History.mqh"
#include "SqliteSeries.mqh"
#define DEF_SERILAIZE_METHOD 3
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CSeries : public CObject
 {
public:
  CTask              *Task;
  CHistory           *History;
  datetime           m_time[];
  ulong              m_time_msc[];
  double             m_balance[],
                     m_day_limit[],
                     m_total_limit[],
                     m_equity_open[],
                     m_equity_high[],
                     m_equity_low[],
                     m_equity_close[];
  bool               m_balance_gambeling[],
                     m_equity_gambeling[];

  void               Reset(void);

                     CSeries();
                    ~CSeries();
  bool               Create(CHistory *_History, CTask *_Task);
  bool               CreateMethodOne(void);
  bool               CreateMethodTwo(void);
  bool               CreateMethodThree(void);

  uint               Total(void) const { return(m_time_msc.Size());}

  bool               RemoveLastRate(const double _end_balance, const double _end_equity)
   {
    uint new_size = Total() - 1;

    if(new_size >= 0)
     {
      if(::ArrayResize(m_time, new_size) != new_size)
        return false;
      if(::ArrayResize(m_time_msc, new_size) != new_size)
        return false;
      if(::ArrayResize(m_balance, new_size) != new_size)
        return false;
      if(::ArrayResize(m_day_limit, new_size) != new_size)
        return false;
      if(::ArrayResize(m_total_limit, new_size) != new_size)
        return false;
      if(::ArrayResize(m_equity_open, new_size) != new_size)
        return false;
      if(::ArrayResize(m_equity_high, new_size) != new_size)
        return false;
      if(::ArrayResize(m_equity_low, new_size) != new_size)
        return false;
      if(::ArrayResize(m_equity_close, new_size) != new_size)
        return false;
      if(::ArrayResize(m_balance_gambeling, new_size) != new_size)
        return false;
      if(::ArrayResize(m_equity_gambeling, new_size) != new_size)
        return false;
     }
    //--
    return true;
   }

  int                GetIndex(const ulong _time_msc)
   {
    if(m_time_msc.Size() > 0)
     {
      int index = ::ArrayBsearch(m_time_msc, _time_msc);
      if(m_time_msc[index] == _time_msc)
        return index;
     }
    return(WRONG_VALUE);
   }

  ulong              TimeMsc(const int _index) const
   {
    if(_index < 0 || (int)m_time_msc.Size() <= _index)
      return 0;
    else
      return m_time_msc[_index];
   }

  int                BarDurationMsc(const int _bar_shift)
   {
    if(m_time_msc.Size() == 0)
      return WRONG_VALUE;

    if(_bar_shift < 0)
      return WRONG_VALUE;

    if(_bar_shift >= (int)m_time_msc.Size())
      return WRONG_VALUE;

    if(_bar_shift == m_time_msc.Size() - 1)
      return 60000;

    return int(m_time_msc[_bar_shift + 1] - m_time_msc[_bar_shift]);
   }

  bool               IsM1Rate(const uint _bar_shift)
   {
    if(BarDurationMsc(_bar_shift) != 60000)
      return false;
    if(m_time_msc[_bar_shift] % 60000 != 0)
      return false;
    //---
    return true;
   }
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CSeries::CSeries()
 {
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CSeries::~CSeries()
 {
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CSeries::Reset(void)
 {
  ::ArrayFree(m_time);
  ::ArrayFree(m_time_msc);
  ::ArrayFree(m_balance);
  ::ArrayFree(m_day_limit);
  ::ArrayFree(m_total_limit);
  ::ArrayFree(m_equity_open);
  ::ArrayFree(m_equity_high);
  ::ArrayFree(m_equity_low);
  ::ArrayFree(m_equity_close);
  ::ArrayFree(m_balance_gambeling);
  ::ArrayFree(m_equity_gambeling);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSeries::Create(CHistory *_History, CTask *_Task)
 {
  History = _History;
  Task = _Task;
  if(!IS_POINTER_DYNAMIC(History) || !IS_POINTER_DYNAMIC(Task))
    return false;

  if(DEF_SERILAIZE_METHOD == 1)
    return CreateMethodOne(); // defult

  if(DEF_SERILAIZE_METHOD == 2)
    return CreateMethodTwo(); // string

  if(DEF_SERILAIZE_METHOD == 3)
    return CreateMethodThree(); // push

  ulong start_cnt =::GetTickCount64();
  CreateMethodOne();
  ulong time1 = ::GetTickCount64() - start_cnt;
  ulong time_msc_1[];
  ::ArrayCopy(time_msc_1, m_time_msc);


  start_cnt =::GetTickCount64();
  CreateMethodTwo();
  ulong time2 = ::GetTickCount64() - start_cnt;
  ulong time_msc_2[];
  ::ArrayCopy(time_msc_2, m_time_msc);


  start_cnt =::GetTickCount64();
  CreateMethodThree();
  ulong time3 = ::GetTickCount64() - start_cnt;
  ulong time_msc_3[];
  ::ArrayCopy(time_msc_3, m_time_msc);


  int i1 = ::ArrayCompare(time_msc_1, time_msc_2);
  int i2 = ::ArrayCompare(time_msc_1, time_msc_3);
  int i3 = ::ArrayCompare(time_msc_2, time_msc_3);

  Print("MethodOne :: "    + (string)time1   + "\n" +
        "MethodTwo :: "    + (string)time2   + "\n" +
        "MethodThree :: "  + (string)time3   + "\n" +
        "Compare 1~2 :: "  + (string)i1      + "\n" +
        "Compare 1~3 :: "  + (string)i2      + "\n" +
        "Compare 2~3 :: "  + (string)i3
       );
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSeries::CreateMethodOne(void)
 {
  Reset();
  ulong time_msc[];
//---
  int total = History.DealsList.Total();
  for(int i = 0; i < total; i++)
   {
    int size = (int)time_msc.Size();

    CDeal *Deal = History.DealsList.At(i);
    if(!IS_POINTER_DYNAMIC(Deal))
      return false;

    ulong temp_time =  Deal.TimeMsc();

    ::ArraySort(time_msc);
    if(size == 0 || time_msc[::ArrayBsearch(time_msc, temp_time)] !=  temp_time)
     {
      if(::ArrayResize(time_msc, size + 1) == size + 1)
       {
        time_msc[size] = temp_time;
        size++;
       }
      else
        return false;
     }
   }
//---
  total =  History.PositionList.Total();
  for(int i = 0; i < total; i++)
   {
    CPosition *Position = History.PositionList.At(i);
    ulong start = ulong(::MathMax(Position.OpenRateTime() - 60, 0)) * 1000,
          end   = ulong(Position.CloseRateTime() + 60) * 1000;
    if(start > end)
      return false;

    int step = int((end - start) / 60000) + 1;
    int size = (int)time_msc.Size();

    for(int j = 0; j < step; j++)
     {
      ulong temp_time = start + j * 60000;
      if(temp_time > 0)
       {
        ::ArraySort(time_msc);
        if(size == 0 || time_msc[::ArrayBsearch(time_msc, temp_time)] !=  temp_time)
         {
          if(::ArrayResize(time_msc, size + 1) == size + 1)
           {
            time_msc[size] = temp_time;
            size++;
           }
          else
            return false;
         }
       }
     }
   }
  int size = (int)time_msc.Size();
//---
  if(::ArrayCopy(m_time_msc, time_msc) != size)
    return false;
//---

  if(::ArrayResize(m_time, size) != size ||
     ::ArrayResize(m_balance, size) != size ||
     ::ArrayResize(m_day_limit, size) != size ||
     ::ArrayResize(m_total_limit, size) != size ||
     ::ArrayResize(m_equity_open, size) != size ||
     ::ArrayResize(m_equity_high, size) != size ||
     ::ArrayResize(m_equity_low, size) != size ||
     ::ArrayResize(m_equity_close, size) != size ||
     ::ArrayResize(m_balance_gambeling, size) != size ||
     ::ArrayResize(m_equity_gambeling, size) != size)
    return false;

//---
  if(::ArrayInitialize(m_time, 0) != size ||
     ::ArrayInitialize(m_balance, 0.0) != size ||
     ::ArrayInitialize(m_day_limit, 0.0) != size ||
     ::ArrayInitialize(m_total_limit, 0.0) != size ||
     ::ArrayInitialize(m_equity_open, 0.0) != size ||
     ::ArrayInitialize(m_equity_high, 0.0) != size ||
     ::ArrayInitialize(m_equity_low, 0.0) != size ||
     ::ArrayInitialize(m_equity_close, 0.0) != size ||
     ::ArrayInitialize(m_balance_gambeling, false) != size ||
     ::ArrayInitialize(m_equity_gambeling, false) != size)
    return false;
//---
  for(int i = 0; i < size; i++)
   {
    m_time[i] = int(m_time_msc[i] / 1000);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSeries::CreateMethodTwo(void)
 {
  Reset();
  ulong time_msc[];
  ulong temp_time_msc[];
  string values;
//---
  int total = History.DealsList.Total();
  for(int i = 0; i < total; i++)
   {
    CDeal *Deal = History.DealsList.At(i);
    if(!IS_POINTER_DYNAMIC(Deal))
      return false;

    values += ::StringFormat("(%s),", ::StringFormat("%I64u", Deal.TimeMsc()));
   }
//---
  total =  History.PositionList.Total();
  for(int i = 0; i < total; i++)
   {
    CPosition *Position = History.PositionList.At(i);
    ulong start = ulong(::MathMax(Position.OpenRateTime() - 60, 0)) * 1000,
          end   = ulong(Position.CloseRateTime() + 60) * 1000;
    if(start > end)
      return false;
    int step = int((end - start) / 60000) + 1;

    for(int j = 0; j < step; j++)
     {
      values += ::StringFormat("(%s),", ::StringFormat("%I64u", start + j * 60000));
     }
   }
//---
  CSqliteSeries db;
  if(!db.Init())
    return false;

  if(!db.AddString(values))
    return false;

  if(!db.GetSeries(time_msc))
    return false;
  ::ArraySort(time_msc);
//---
  int size = (int)time_msc.Size();
//---
  if(::ArrayCopy(m_time_msc, time_msc) != size)
    return false;
//---

  if(::ArrayResize(m_time, size) != size ||
     ::ArrayResize(m_balance, size) != size ||
     ::ArrayResize(m_day_limit, size) != size ||
     ::ArrayResize(m_total_limit, size) != size ||
     ::ArrayResize(m_equity_open, size) != size ||
     ::ArrayResize(m_equity_high, size) != size ||
     ::ArrayResize(m_equity_low, size) != size ||
     ::ArrayResize(m_equity_close, size) != size ||
     ::ArrayResize(m_balance_gambeling, size) != size ||
     ::ArrayResize(m_equity_gambeling, size) != size)
    return false;

//---
  if(::ArrayInitialize(m_time, 0) != size ||
     ::ArrayInitialize(m_balance, 0.0) != size ||
     ::ArrayInitialize(m_day_limit, 0.0) != size ||
     ::ArrayInitialize(m_total_limit, 0.0) != size ||
     ::ArrayInitialize(m_equity_open, 0.0) != size ||
     ::ArrayInitialize(m_equity_high, 0.0) != size ||
     ::ArrayInitialize(m_equity_low, 0.0) != size ||
     ::ArrayInitialize(m_equity_close, 0.0) != size ||
     ::ArrayInitialize(m_balance_gambeling, false) != size ||
     ::ArrayInitialize(m_equity_gambeling, false) != size)
    return false;
//---
  for(int i = 0; i < size; i++)
   {
    m_time[i] = int(m_time_msc[i] / 1000);
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CSeries::CreateMethodThree(void)
 {
  Reset();
  ulong time_msc[];
  ulong temp_time_msc[];
  string values;
//--- Add Start Time
  if(History.StartTimeMsc() > 0)
    if(!CFunc::AddToArray(History.StartTimeMsc(), temp_time_msc))
      return false;
//--- Add Deal Time
  int total = History.DealsList.Total();
  for(int i = 0; i < total; i++)
   {
    CDeal *Deal = History.DealsList.At(i);
    if(!IS_POINTER_DYNAMIC(Deal))
      return false;

    if(!CFunc::AddToArray(Deal.TimeMsc(), temp_time_msc))
      return false;
   }
//--- Add Position OpenTime Until CloseTime
  total =  History.PositionList.Total();
  for(int i = 0; i < total; i++)
   {
    CPosition *Position = History.PositionList.At(i);
    ulong start = ulong(::MathMax(Position.OpenRateTime() - 60, 0)) * 1000,
          end   = ::MathMin(ulong(Position.CloseRateTime() + 60) * 1000, History.EndTimeMsc());
    if(start > end)
      return false;
    int step = int((end - start) / 60000) + 1;

    for(int j = 0; j < step; j++)
     {
      if(!CFunc::AddToArray(start + j * 60000, temp_time_msc))
        return false;
     }
   }
//--- Add End time
  if(!CFunc::AddToArray(History.EndTimeRateMsc(), temp_time_msc))
    return false;
  if(!CFunc::AddToArray(History.EndTimeMsc(), temp_time_msc))
    return false;

//---
  CSqliteSeries db;
  if(!db.Init())
    return false;

  if(!db.AddArray(temp_time_msc))
    return false;

  if(!db.GetSeries(time_msc))
    return false;
  ::ArraySort(time_msc);
//---
  int size = (int)time_msc.Size();
//---
  if(::ArrayCopy(m_time_msc, time_msc) != size)
    return false;
//---
  if(::ArrayResize(m_time, size) != size ||
     ::ArrayResize(m_balance, size) != size ||
     ::ArrayResize(m_day_limit, size) != size ||
     ::ArrayResize(m_total_limit, size) != size ||
     ::ArrayResize(m_equity_open, size) != size ||
     ::ArrayResize(m_equity_high, size) != size ||
     ::ArrayResize(m_equity_low, size) != size ||
     ::ArrayResize(m_equity_close, size) != size ||
     ::ArrayResize(m_balance_gambeling, size) != size ||
     ::ArrayResize(m_equity_gambeling, size) != size)
    return false;
//---
  double start_balance = Task.EquityCheckPointBalance(),
         day_limit     = Task.EquityCheckPointDayLimit(),
         total_limit   = Task.InitBalance() * Task.TotalLimitRatio();

  if(Task.EquityCheckPointTotalLimit() > 0)
    total_limit = Task.EquityCheckPointTotalLimit();

  if(::ArrayInitialize(m_time, 0) != size ||
     ::ArrayInitialize(m_balance, start_balance) != size ||
     ::ArrayInitialize(m_day_limit, day_limit) != size ||
     ::ArrayInitialize(m_total_limit, total_limit) != size ||
     ::ArrayInitialize(m_equity_open, start_balance) != size ||
     ::ArrayInitialize(m_equity_high, start_balance) != size ||
     ::ArrayInitialize(m_equity_low, start_balance) != size ||
     ::ArrayInitialize(m_equity_close, start_balance) != size ||
     ::ArrayInitialize(m_balance_gambeling, false) != size ||
     ::ArrayInitialize(m_equity_gambeling, false) != size)
    return false;
//---
  for(int i = 0; i < size; i++)
    m_time[i] = int(m_time_msc[i] / 1000);
//---
  return true;
 }
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      History.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
#property strict
//+------------------------------------------------------------------+
#include <Arrays\ArrayObj.mqh>
#include <Arrays\ArrayString.mqh>
#include <_Ata\Info\PositionInfo.mqh>
#include <_Ata\General\Func.mqh>
#include "..\Task\Task.mqh"
#include "Deal.mqh"
#include "Position.mqh"
#include "SymbolData.mqh"
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CHistory
 {
private:
  CTask              *Task;
  //CArrayObj          SwapDealList;
  CArrayString       SymbolArr;
  CArrayString       TradeDays;
  datetime           m_frist_deal_time,
                     m_first_trade_time;
  long               m_start_time_msc;
  datetime           m_start_time,
                     m_end_time,
                     m_end_time_rate;
  ulong              m_end_time_msc;
  double             //m_start_balnce,
  m_init_balance,
  m_end_equity,
  m_end_balance;
  uint               m_total_open_position,
                     m_total_open_order;

  void               Reset(void)
   {
    DealsList.Clear();
    PositionList.Clear();
    SymbolList.Clear();
    SymbolArr.Clear();
    TradeDays.Clear();

    m_frist_deal_time = 0;
    m_first_trade_time = 0;

    m_start_time_msc = 0;
    m_start_time = 0;
    m_end_time = 0;
    m_end_time_rate = 0;
    m_end_time_msc = 0;

    //m_start_balnce = 0;
    m_init_balance = 0;
    m_end_equity = 0;
    m_end_balance = 0;

    m_total_open_position = 0;
    m_total_open_order = 0;
   }

  bool               AddToDealsList(CDeal *Deal);
  bool               AddToPositionList(CDeal *Deal);
  bool               DealsListCompletion(void);
  bool               PositionListCompletion(void);
  bool               AddLiveToPositionList(CPositionInfo &PositionInfo);
  void               AddToSymbolList(const string _symbol, const datetime _time);
  void               AddToDaysList(const datetime _time);
  void               CheckFirstTimes(CDeal *Deal);

  bool               UpdateData(void);
public:
  CArrayObj          DealsList,
                     PositionList,
                     SymbolList;

                     CHistory();
                    ~CHistory();

  bool               Update(CTask *_Task);
  long               StartTimeMsc(void)            const { return m_start_time_msc;}
  datetime           EndTime(void)                 const { return m_end_time;}
  ulong              EndTimeMsc(void)              const { return m_end_time_msc;}
  ulong              EndTimeRateMsc(void)          const { return m_end_time_rate * 1000;}
  double             EndEquity(void)               const { return m_end_equity;}
  double             EndBalance(void)              const { return m_end_balance;}
  datetime           FirstDealTime(void)           const { return m_frist_deal_time;}
  datetime           FirstTradeTime(void)          const { return m_first_trade_time;}
  double             InitialBlance(void)           const { return m_init_balance;}
  //double             StartBlance(void)             const { return m_start_balnce;}

  int                TotalOpenPositons(void)       const { return (int)m_total_open_position;}
  int                TotalOpenOrders(void)         const { return (int)m_total_open_order;}

  bool               IsPositionOpenAtTimeMsc(const ulong _time_msc)
   {
    int total = PositionList.Total();
    for(int i = 0; i < total; i++)
     {
      CPosition *Position = PositionList.At(i);
      ulong open_time_msc = Position.OpenTimeMsc();
      ulong close_time_msc = Position.CloseTimeMsc();

      if(_time_msc >= open_time_msc && _time_msc <= close_time_msc)
        return true;
     }
    return false;
   }
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CHistory::CHistory()
 {
  Reset();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CHistory::~CHistory()
 {
  Reset();
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::Update(CTask *_Task)
 {
  Reset();
  Task = _Task;
  if(!IS_POINTER_DYNAMIC(Task))
    return false;

  m_init_balance = Task.InitBalance();
  m_start_time_msc = Task.EquityCheckPointTimeMsc();
  m_start_time = datetime(m_start_time_msc / 1000);
  m_end_time = ::TimeTradeServer();
  m_end_equity = ::AccountInfoDouble(ACCOUNT_EQUITY);
  m_end_balance = ::AccountInfoDouble(ACCOUNT_BALANCE);
  m_end_time_rate = (int)(m_end_time / 60) * 60;
  m_end_time_msc = (ulong)(m_end_time * 1000);
//--- History
  if(!::HistorySelect(m_start_time, ::TimeTradeServer() + ::PeriodSeconds(PERIOD_MN1)))
    return false;

  uint total = ::HistoryDealsTotal();

  for(uint i = 0; i < total; i++)
   {
    CDealInfo DealInfo;
    if(!DealInfo.SelectByIndex(i))
      return false;

    CDeal *Deal = new CDeal;
    Deal.Set(DealInfo);
    //---
    if(!AddToDealsList(Deal))
     {
      FREE(Deal);
      return false;
     }

    if(!AddToPositionList(Deal))
      return false;
    CheckFirstTimes(Deal);
   }
  DealsListCompletion();
  PositionListCompletion();
//---- Live
  m_total_open_order = OrdersTotal();
  m_total_open_position  = PositionsTotal();
  for(uint i = 0; i < m_total_open_position; i++)
   {
    CPositionInfo PositionInfo;
    if(!PositionInfo.SelectByIndex(i))
      continue;
    AddLiveToPositionList(PositionInfo);
   }
//--- succeed
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::AddToDealsList(CDeal *Deal)
 {
  return DealsList.Add(Deal);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::AddToPositionList(CDeal *Deal)
 {
  if(!CFunc::IsSymbol(Deal.Symbol()))
    return true;

  ENUM_DEAL_TYPE type = Deal.DealType();

  if(Deal.Entry() != DEAL_ENTRY_OUT)
   {
    if(Deal.Entry() == DEAL_ENTRY_IN || Deal.Entry() == DEAL_ENTRY_INOUT)
      if(type == DEAL_TYPE_BUY && type == DEAL_TYPE_SELL)
        AddToDaysList(Deal.Time());

    return true;
   }

  if(type != DEAL_TYPE_BUY && type != DEAL_TYPE_SELL)
    return true;

  if(Deal.Volume() <= 0)
    return true;

  if(Deal.Price() <= 0)
    return true;

  CPosition *Position = new CPosition;
  Position.SetDealOut(Deal);

  return PositionList.Add(Position);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::DealsListCompletion(void)
 {
//----
  uint total = DealsList.Total();
  if(total > 0)
   {
    if(DEF_IS_SWAOP_IN_MID_NIGHT)
     {
      CArrayObj SwapDealList;
      for(uint i = 0; i < total; i++)
       {
        CDeal *Deal = DealsList.At(i);
        //--- Add SwapDeals
        if(Deal.Swap() != 0 && Deal.Comment() != "Swap Deal")
         {
          if(::HistorySelectByPosition(Deal.PositionId()))
           {
            uint deal_total = ::HistoryDealsTotal();
            for(uint j = 0; j < deal_total; j++)
             {
              CDealInfo DealInfo;
              if(!DealInfo.SelectByIndex(j))
                return false;

              if(DealInfo.Entry() != DEAL_ENTRY_IN)
                continue;

              if(DealInfo.DealType() != DEAL_TYPE_BUY && DealInfo.DealType() != DEAL_TYPE_SELL)
                continue;

              if(DealInfo.Volume() <= 0)
                continue;

              if(DealInfo.Price() <= 0)
                continue;

              if(DealInfo.Symbol() != Deal.Symbol())
                continue;

              if(DealInfo.DealType() == Deal.DealType())
                continue;

              datetime open_day = int(DealInfo.Time() / (DEF_DAY_SEC)) * DEF_DAY_SEC;
              datetime close_day = int(Deal.Time() / (DEF_DAY_SEC)) * DEF_DAY_SEC;

              uint step = (uint)::MathCeil((close_day - open_day) / DEF_DAY_SEC);
              if(step <= 0)
               {
                Deal.Comment("Swap Deal");
                break;
               }

              double swap_per_day = Deal.Swap() / step;

              for(uint i = 1; i <= step; i++)
               {
                datetime time = open_day + i * DEF_DAY_SEC;
                ulong ticket = (ulong)::StringToInteger((string)Deal.Ticket() + (string)i);

                if(i == step)
                  swap_per_day = Deal.Swap() - (step - 1) * swap_per_day;

                CDeal * SwapDeal = new CDeal;
                SwapDeal.Set(Deal);
                SwapDeal.Ticket(ticket);
                SwapDeal.Time(time);
                SwapDeal.TimeMsc(time * 1000);
                SwapDeal.Commission(0);
                SwapDeal.Swap(swap_per_day);
                SwapDeal.Profit(0);
                SwapDeal.Fee(0);
                SwapDeal.Comment("Swap Deal");
                SwapDeal.ExtId((string)Deal.Ticket());

                if(!SwapDealList.Add(SwapDeal))
                 {
                  FREE(SwapDeal);
                  return false;
                 }
               }
              break;
             }
           }
         }
       }
      uint swap_total = SwapDealList.Total();
      for(uint i = 0; i < swap_total; i++)
       {
        CDeal *SwapDeal = SwapDealList.At(i);
        total = DealsList.Total();
        for(uint pos = 0; pos < total; pos++)
         {
          CDeal *Deal = DealsList.At(pos);
          if(Deal.TimeMsc() > SwapDeal.TimeMsc())
           {
            DealsList.Insert(SwapDeal, pos);
            break;
           }
         }
       }
      if(swap_total > 0)
        SwapDealList.FreeMode(false);
     }

    //--- calc each deal balance prams
    double balance = Task.EquityCheckPointBalance();
    double last_day_balance = m_init_balance;
    MqlDateTime prev_deal_time_str;
    ::TimeToStruct(Task.EquityCheckPointTimeMsc() / 1000, prev_deal_time_str);
    //---
    for(uint i = 0; i < total; i++)
     {
      CDeal *Deal = DealsList.At(i);

      MqlDateTime deal_time_str;
      ::TimeToStruct(Deal.Time(), deal_time_str);

      if(Deal.Time() >= m_first_trade_time && m_first_trade_time != 0)
       {
        if(prev_deal_time_str.day_of_year != deal_time_str.day_of_year)
          last_day_balance = balance;
       }

      prev_deal_time_str = deal_time_str;
      double swap = !DEF_IS_SWAOP_IN_MID_NIGHT ? Deal.Swap() :
                    (Deal.Comment() == "Swap Deal" ? Deal.Swap() : 0);
      balance += Deal.Profit() + Deal.Commission() + swap;

      Deal.Balance(balance);
      Deal.LastDayBalance(last_day_balance);
      Deal.DailyLimit(last_day_balance * Task.DailyLimitRatio());
      Deal.TotalLimit(m_init_balance * Task.TotalLimitRatio());
     }
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::PositionListCompletion(void)
 {
  uint total = PositionList.Total();
  for(uint i = 0; i < total; i++)
   {
    CPosition *Position = PositionList.At(i);
    if(!::HistorySelectByPosition(Position.PositionId()))
      return false;

    uint deal_total = ::HistoryDealsTotal();
    for(uint j = 0; j < deal_total; j++)
     {
      CDealInfo DealInfo;
      if(!DealInfo.SelectByIndex(j))
        return false;

      if(DealInfo.Entry() != DEAL_ENTRY_IN)
        continue;

      if(DealInfo.DealType() != DEAL_TYPE_BUY && DealInfo.DealType() != DEAL_TYPE_SELL)
        continue;

      if(DealInfo.Volume() <= 0)
        continue;

      if(DealInfo.Price() <= 0)
        continue;

      if(DealInfo.Symbol() != Position.Symbol())
        continue;

      if(DealInfo.DealType() != Position.PositionType())
        continue;

      CDeal Deal;
      Deal.Set(DealInfo);
      Position.SetDealIn(Deal, true, Task.UseWeekend(), Task.UseNews(), Task.UseTickScalp(), Task.TickScalpTermMsc());

      AddToSymbolList(Position.Symbol(), Position.OpenRateTime());
      break;
     }
   }
//---
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::AddLiveToPositionList(CPositionInfo & PositionInfo)
 {
  long pos_id = PositionInfo.Identifier();

  if(!::HistorySelectByPosition(pos_id))
    return false;

  CDeal *DealIn  = new CDeal;
  bool is_deal_in_set = false;
  uint deal_total = ::HistoryDealsTotal();
  for(uint j = 0; j < deal_total; j++)
   {
    CDealInfo DealInfo;
    if(!DealInfo.SelectByIndex(j))
     {
      FREE(DealIn);
      return false;
     }

    if(DealInfo.Entry() != DEAL_ENTRY_IN)
      continue;

    if(DealInfo.DealType() != DEAL_TYPE_BUY && DealInfo.DealType() != DEAL_TYPE_SELL)
      continue;

    if(DealInfo.Volume() <= 0)
      continue;

    if(DealInfo.Price() <= 0)
      continue;

    if(DealInfo.Symbol() != PositionInfo.Symbol())
      continue;

    ENUM_DEAL_TYPE pos_deal_type = PositionInfo.PositionType() == POSITION_TYPE_BUY ? DEAL_TYPE_BUY : DEAL_TYPE_SELL;

    if(DealInfo.DealType() != pos_deal_type)
      continue;

    is_deal_in_set = DealIn.Set(DealInfo);
    break;
   }

  if(!is_deal_in_set)
   {
    FREE(DealIn);
    return false;
   }

  CDeal *Dealout = new CDeal;
  bool is_deal_out_set = Dealout.Set(0,
                                     0,
                                     m_end_time,
                                     m_end_time_msc,
                                     DealIn.DealType() == DEAL_TYPE_BUY ? DEAL_TYPE_SELL : DEAL_TYPE_BUY,
                                     DEAL_ENTRY_OUT,
                                     0,
                                     DEAL_REASON_CLIENT,
                                     DealIn.PositionId(),
                                     PositionInfo.Volume(),
                                     PositionInfo.PriceCurrent(),//DealIn.DealType() == DEAL_TYPE_BUY ? ::SymbolInfoDouble(PositionInfo.Symbol(), SYMBOL_BID) : ::SymbolInfoDouble(PositionInfo.Symbol(), SYMBOL_ASK),
                                     0,
                                     0,
                                     PositionInfo.Profit(),
                                     0.0,
                                     PositionInfo.StopLoss(),
                                     PositionInfo.TakeProfit(),
                                     PositionInfo.Symbol(),
                                     "",
                                     DealIn.ExtId());

  if(!is_deal_out_set)
   {
    FREE(DealIn);
    FREE(Dealout);
    return false;
   }

  CPosition *Position = new CPosition;
  Position.IsOpenPosition(true);
  Position.SetDeals(DealIn, Dealout, true, Task.UseWeekend(), Task.UseNews(), Task.UseTickScalp(), Task.TickScalpTermMsc());

  AddToSymbolList(Position.Symbol(), Position.OpenRateTime());

  if(PositionList.Add(Position))
    return true;
  FREE(Position);
//---
  return false;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CHistory::AddToSymbolList(const string _symbol, const datetime _time)
 {
  SymbolArr.Sort();
  if(SymbolArr.Search(_symbol) < 0)
   {
    if(SymbolArr.Add(_symbol))
     {
      CSymbolData *data = new CSymbolData;
      data.Name(_symbol);
      data.Time(datetime(int((_time / 60) * 60)));
      if(!SymbolList.Add(data))
        delete data;
     }
   }
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CHistory::AddToDaysList(const datetime _time)
 {
  TradeDays.Sort();
  datetime day = (_time / DEF_DAY_SEC) * DEF_DAY_SEC;
  string date = ::TimeToString(day, TIME_DATE | TIME_SECONDS);
  if(TradeDays.Search(date) < 0)
    TradeDays.Add(date);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
void CHistory::CheckFirstTimes(CDeal * Deal)
 {
  if(m_frist_deal_time != 0 && m_first_trade_time != 0)
    return;
//---
  if(m_frist_deal_time == 0 && Deal.Time() > 0)
    m_frist_deal_time = Deal.Time();
//---
  if(m_first_trade_time == 0 && Deal.Time() > 0)
   {
    ENUM_DEAL_TYPE type = Deal.DealType();
    if(type == DEAL_TYPE_BUY || type == DEAL_TYPE_SELL)
      m_first_trade_time = Deal.Time();
   }
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CHistory::UpdateData(void)
 {
//---
  return true;
 }
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                   D e a l . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   v e r s i o n       " 1 . 0 0 "  
 # p r o p e r t y   s t r i c t  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   < O b j e c t . m q h >  
 # i n c l u d e   < _ A t a \ C a l e n d a r \ C a l e n d a r I n f o . m q h >  
 # i n c l u d e   < _ A t a \ G e n e r a l \ F u n c . m q h >  
 # i n c l u d e   " . . \ D e f i n e s . m q h "  
 # i n c l u d e   " D e a l . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C P o s i t i o n   :   p u b l i c   C O b j e c t  
   {  
 p r i v a t e :  
     C D e a l                             m _ d e a l _ i n ,  
                                           m _ d e a l _ o u t ;  
     b o o l                               m _ i s _ o p e n _ p o s ;  
     d o u b l e                           m _ p o i n t _ v a l u e ,  
                                           m _ p o i n t ;  
     l o n g                               m _ d i g i t s ;  
  
     b o o l                               m _ i s _ t i c k _ s c a l p ,  
                                           m _ i s _ w e e k e n d ,  
                                           m _ i s _ n e w s _ t r a d i n g ;  
     s t r i n g                           m _ n e w s ;  
  
     u l o n g                             D u r a t i o n M s c ( v o i d )   {   r e t u r n   u l o n g ( : : M a t h M a x ( m _ d e a l _ o u t . T i m e M s c ( )   -   m _ d e a l _ i n . T i m e M s c ( ) ,   0 ) ) ; }  
     b o o l                               I s N e w s R u l e O n e ( c o n s t   M q l C a l e n d a r V a l u e   &   _ e v e n t ,   u i n t   &   _ i n d e x ) ;  
     b o o l                               I s N e w s R u l e T w o ( c o n s t   M q l C a l e n d a r V a l u e   &   _ e v e n t ,   u i n t   &   _ i n d e x ) ;  
     b o o l                               S e t E x t r a D a t a ( c o n s t   b o o l   _ u s e _ w e e k e n d ,  
                                                                     c o n s t   b o o l   _ u s e _ n e w s ,  
                                                                     c o n s t   b o o l   _ u s e _ t i c k _ s c a l p ,  
                                                                     c o n s t   u i n t   _ t i c k _ s c a l p _ d u r a t i o n _ m s c ) ;  
     v o i d                               C h e c k T i c k S c a l p ( c o n s t   u i n t   _ t i c k _ s c a l p _ d u r a t i o n _ m s c ) ;  
     v o i d                               C h e c k W e e k e n d ( v o i d ) ;  
     v o i d                               C h e c k N e w s T r a d i n g ( v o i d ) ;  
  
  
 p u b l i c :  
                                           C P o s i t i o n ( ) ;  
                                         ~ C P o s i t i o n ( ) ;  
     v o i d                               S e t D e a l I n ( C D e a l   & D e a l ,  
                                                               c o n s t   b o o l   _ s e t _ e x t r a _ d a t a ,  
                                                               c o n s t   b o o l   _ u s e _ w e e k e n d ,  
                                                               c o n s t   b o o l   _ u s e _ n e w s ,  
                                                               c o n s t   b o o l   _ u s e _ t i c k _ s c a l p ,  
                                                               c o n s t   u i n t   _ t i c k _ s c a l p _ d u r a t i o n _ m s c )  
       {  
         m _ d e a l _ i n   =   & D e a l ;  
         i f ( _ s e t _ e x t r a _ d a t a )  
             S e t E x t r a D a t a ( _ u s e _ w e e k e n d ,   _ u s e _ n e w s ,   _ u s e _ t i c k _ s c a l p ,   _ t i c k _ s c a l p _ d u r a t i o n _ m s c ) ;  
       }  
     v o i d                               S e t D e a l O u t ( C D e a l   & D e a l )   {   m _ d e a l _ o u t   =   & D e a l ; }  
     v o i d                               S e t D e a l s ( C D e a l   & D e a l I n ,  
                                                             C D e a l   & D e a l O u t ,  
                                                             c o n s t   b o o l   _ s e t _ e x t r a _ d a t a ,  
                                                             c o n s t   b o o l   _ u s e _ w e e k e n d ,  
                                                             c o n s t   b o o l   _ u s e _ n e w s ,  
                                                             c o n s t   b o o l   _ u s e _ t i c k _ s c a l p ,  
                                                             c o n s t   u i n t   _ t i c k _ s c a l p _ d u r a t i o n _ m s c )  
       {  
         S e t D e a l O u t ( D e a l O u t ) ;  
         S e t D e a l I n ( D e a l I n ,   _ s e t _ e x t r a _ d a t a ,   _ u s e _ w e e k e n d ,   _ u s e _ n e w s ,   _ u s e _ t i c k _ s c a l p ,   _ t i c k _ s c a l p _ d u r a t i o n _ m s c ) ;  
       }  
     / / - - -  
     v o i d                               P o i n t V a l u e ( c o n s t   d o u b l e   _ v a l u e )                       {   m _ p o i n t _ v a l u e   =   _ v a l u e ; }  
     d o u b l e                           P o i n t V a l u e ( v o i d )                                         c o n s t   {   r e t u r n   m _ p o i n t _ v a l u e ; }  
     v o i d                               P o i n t ( c o n s t   d o u b l e   _ v a l u e )                                 {   m _ p o i n t   =   _ v a l u e ; }  
     d o u b l e                           P o i n t ( v o i d )                                                   c o n s t   {   r e t u r n   m _ p o i n t ; }  
     v o i d                               D i g i t s ( c o n s t   i n t   _ v a l u e )                                     {   m _ d i g i t s   =   _ v a l u e ; }  
     i n t                                 D i g i t s ( v o i d )                                                 c o n s t   {   r e t u r n   ( i n t ) m _ d i g i t s ; }  
     / / - - -  
     v o i d                               I s O p e n P o s i t i o n ( c o n s t   b o o l   _ v a l u e )                   {   m _ i s _ o p e n _ p o s   =   _ v a l u e ; }  
     b o o l                               I s O p e n P o s i t i o n ( v o i d )                                 c o n s t   {   r e t u r n   m _ i s _ o p e n _ p o s ; }  
     / / - - -  
     l o n g                               P o s i t i o n I d ( v o i d )                                         c o n s t   {   r e t u r n   m _ d e a l _ o u t . P o s i t i o n I d ( ) ; }  
     s t r i n g                           S y m b o l ( v o i d )                                                 c o n s t   {   r e t u r n   m _ d e a l _ o u t . S y m b o l ( ) ; }  
     E N U M _ D E A L _ T Y P E           P o s i t i o n T y p e ( v o i d )                                     c o n s t   {   r e t u r n   m _ d e a l _ o u t . D e a l T y p e ( )   = =   D E A L _ T Y P E _ B U Y   ?   D E A L _ T Y P E _ S E L L   :   D E A L _ T Y P E _ B U Y ; }  
     i n t                                 M y s q l E n u m P o s i t i o n T y p e ( v o i d )  
       {  
       / /   ' B u y ' ,   ' S e l l ' ,   ' U n k n o w n '  
         s w i t c h ( P o s i t i o n T y p e ( ) )  
           {  
             c a s e     D E A L _ T Y P E _ B U Y :       / /   B u y  
                 r e t u r n   1 ;  
             c a s e     D E A L _ T Y P E _ S E L L :       / / S e l l  
                 r e t u r n   2 ;  
             d e f a u l t :  
                 b r e a k ;  
           }  
         r e t u r n   3 ; / /   ' U n k n o w n '  
       }  
  
     d o u b l e                           V o l u m e ( v o i d )                                                 c o n s t   {   r e t u r n   m _ d e a l _ o u t . V o l u m e ( ) ; }  
     / / - - -  
     u l o n g                             O p e n T i c k e t ( v o i d )                                         c o n s t   {   r e t u r n   m _ d e a l _ i n . T i c k e t ( ) ; }  
     d a t e t i m e                       O p e n T i m e ( v o i d )                                             c o n s t   {   r e t u r n   m _ d e a l _ i n . T i m e ( ) ; }  
     d a t e t i m e                       O p e n R a t e T i m e ( v o i d )                                     c o n s t   {   r e t u r n   m _ d e a l _ i n . R a t e T i m e ( ) ; }  
     u l o n g                             O p e n T i m e M s c ( v o i d )                                       c o n s t   {   r e t u r n   m _ d e a l _ i n . T i m e M s c ( ) ; }  
     d o u b l e                           O p e n P r i c e ( v o i d )                                           c o n s t   {   r e t u r n   m _ d e a l _ i n . P r i c e ( ) ; }  
     d o u b l e                           O p e n S l ( v o i d )                                                 c o n s t   {   r e t u r n   m _ d e a l _ i n . S l ( ) ; }  
     d o u b l e                           O p e n T p ( v o i d )                                                 c o n s t   {   r e t u r n   m _ d e a l _ i n . T p ( ) ; }  
     d o u b l e                           O p e n C o m m i s s i o n ( v o i d )                                 c o n s t   {   r e t u r n   m _ d e a l _ i n . C o m m i s s i o n ( ) ; }  
     d o u b l e                           O p e n S w a p ( v o i d )                                             c o n s t   {   r e t u r n   m _ d e a l _ i n . S w a p ( ) ; }  
     d o u b l e                           O p e n F e e ( v o i d )                                               c o n s t   {   r e t u r n   m _ d e a l _ i n . F e e ( ) ; }  
     / / - - -  
     u l o n g                             C l o s e T i c k e t ( v o i d )                                       c o n s t   {   r e t u r n   m _ d e a l _ o u t . T i c k e t ( ) ; }  
     d a t e t i m e                       C l o s e T i m e ( v o i d )                                           c o n s t   {   r e t u r n   m _ d e a l _ o u t . T i m e ( ) ; }  
     d a t e t i m e                       C l o s e R a t e T i m e ( v o i d )                                   c o n s t   {   r e t u r n   m _ d e a l _ o u t . R a t e T i m e ( ) ; }  
     u l o n g                             C l o s e T i m e M s c ( v o i d )                                     c o n s t   {   r e t u r n   m _ d e a l _ o u t . T i m e M s c ( ) ; }  
     d o u b l e                           C l o s e P r i c e ( v o i d )                                         c o n s t   {   r e t u r n   m _ d e a l _ o u t . P r i c e ( ) ; }  
     d o u b l e                           C l o s e S l ( v o i d )                                               c o n s t   {   r e t u r n   m _ d e a l _ o u t . S l ( ) ; }  
     d o u b l e                           C l o s e T p ( v o i d )                                               c o n s t   {   r e t u r n   m _ d e a l _ o u t . T p ( ) ; }  
     d o u b l e                           C l o s e P r o f i t ( v o i d )                                       c o n s t   {   r e t u r n   m _ d e a l _ o u t . P r o f i t ( ) ; }  
     d o u b l e                           C l o s e C o m m i s s i o n ( v o i d )                               c o n s t   {   r e t u r n   m _ d e a l _ o u t . C o m m i s s i o n ( ) ; }  
     d o u b l e                           C l o s e S w a p ( v o i d )                                           c o n s t   {   r e t u r n   m _ d e a l _ o u t . S w a p ( ) ; }  
     d o u b l e                           C l o s e F e e ( v o i d )                                             c o n s t   {   r e t u r n   m _ d e a l _ o u t . F e e ( ) ; }  
     / / - - -  
     d o u b l e                           O p e n C o s t ( v o i d )                                             c o n s t   {   r e t u r n ( m _ d e a l _ i n . C o m m i s s i o n ( )   +   m _ d e a l _ i n . S w a p ( ) ) ; }  
     d o u b l e                           C l o s e C o s t ( v o i d )                                           c o n s t   {   r e t u r n ( m _ d e a l _ o u t . C o m m i s s i o n ( )   +   m _ d e a l _ o u t . S w a p ( ) ) ; }  
     d o u b l e                           T o t a l C o s t ( v o i d )                                           c o n s t   {   r e t u r n ( O p e n C o s t ( )   +   C l o s e C o s t ( ) ) ; }  
  
     d o u b l e                           P r o f i t ( v o i d )                                                 c o n s t   {   r e t u r n ( m _ d e a l _ o u t . P r o f i t ( ) ) ; }  
     d o u b l e                           N e t P r o f i t ( v o i d )                                           c o n s t   {   r e t u r n ( m _ d e a l _ o u t . P r o f i t ( )   +   T o t a l C o s t ( ) ) ; }  
     u i n t                               T r a d e D u r a t i a n M s c ( v o i d )                             c o n s t   {   r e t u r n   i n t ( m _ d e a l _ o u t . T i m e M s c ( )   -   m _ d e a l _ i n . T i m e M s c ( ) ) ; }  
     d o u b l e                           G e t P r o f i t ( c o n s t   d o u b l e   _ l a s t _ p r i c e )   c o n s t ;  
     b o o l                               I s T i c k S c a l p ( v o i d )                                       c o n s t   {   r e t u r n   m _ i s _ t i c k _ s c a l p ; }  
     b o o l                               I s W e e k e n d ( v o i d )                                           c o n s t   {   r e t u r n   m _ i s _ w e e k e n d ; }  
     b o o l                               I s N e w s T r a d i n g ( v o i d )                                   c o n s t   {   r e t u r n   m _ i s _ n e w s _ t r a d i n g ; }  
     s t r i n g                           N e w s ( v o i d )                                                     c o n s t   {   r e t u r n   m _ n e w s ; }  
  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C P o s i t i o n : : C P o s i t i o n ( )   :  
     m _ i s _ o p e n _ p o s ( f a l s e ) ,  
     m _ p o i n t _ v a l u e ( 0 ) ,  
     m _ p o i n t ( 0 ) ,  
     m _ d i g i t s ( 0 ) ,  
     m _ i s _ t i c k _ s c a l p ( f a l s e ) ,  
     m _ i s _ w e e k e n d ( f a l s e ) ,  
     m _ i s _ n e w s _ t r a d i n g ( f a l s e ) ,  
     m _ n e w s ( " " )  
   {  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C P o s i t i o n : : ~ C P o s i t i o n ( )  
   {  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   C P o s i t i o n : : G e t P r o f i t ( c o n s t   d o u b l e   _ l a s t _ p r i c e )   c o n s t  
   {  
     d o u b l e   l a s t _ p r i c e   =   : : N o r m a l i z e D o u b l e ( _ l a s t _ p r i c e ,   t h i s . D i g i t s ( ) ) ,  
                   o p e n _ p r i c e   =   : : N o r m a l i z e D o u b l e ( t h i s . O p e n P r i c e ( ) ,   t h i s . D i g i t s ( ) ) ,  
                   d i f                 =   l a s t _ p r i c e   -   o p e n _ p r i c e ;  
  
     d i f   =   ( t h i s . P o s i t i o n T y p e ( )   = =   D E A L _ T Y P E _ B U Y )   ?   d i f   :   - d i f ;  
 / / - - -  
     d o u b l e   m o v e _ p o i n t s   =   d i f   /   t h i s . P o i n t ( ) ;  
     r e t u r n   : : N o r m a l i z e D o u b l e ( m o v e _ p o i n t s   *   t h i s . P o i n t V a l u e ( ) ,   2 ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C P o s i t i o n : : C h e c k T i c k S c a l p ( c o n s t   u i n t   _ t i c k _ s c a l p _ d u r a t i o n _ m s c )  
   {  
     i f ( ! I s O p e n P o s i t i o n ( )   & &   D u r a t i o n M s c ( )   <   _ t i c k _ s c a l p _ d u r a t i o n _ m s c )  
         m _ i s _ t i c k _ s c a l p   =   t r u e ;  
     e l s e  
         m _ i s _ t i c k _ s c a l p   =   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C P o s i t i o n : : C h e c k W e e k e n d ( v o i d )  
   {  
     m _ i s _ w e e k e n d   =   t r u e ;  
 / / - - -  
     M q l D a t e T i m e   m d t s t r u c t o p e n ,   m d t s t r u c t c l o s e ;  
     : : T i m e T o S t r u c t ( t h i s . O p e n T i m e ( ) ,   m d t s t r u c t o p e n ) ;  
     : : T i m e T o S t r u c t ( t h i s . C l o s e T i m e ( ) ,   m d t s t r u c t c l o s e ) ;  
 / / - - -  
     i f ( m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   S U N D A Y   | |   m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   F R I D A Y   | |   m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   S A T U R D A Y )  
       {  
         i f ( m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   S A T U R D A Y )   / /   4F(G 
             r e t u r n ;  
  
         s t r i n g   b r o k e r   =   : : A c c o u n t I n f o S t r i n g ( A C C O U N T _ C O M P A N Y ) ;  
         : : S t r i n g T o L o w e r ( b r o k e r ) ;  
  
         i f ( : : S t r i n g F i n d ( b r o k e r ,   " u n f x b " )   > =   0 )  
           {  
             i f ( m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   F R I D A Y   & &   m d t s t r u c t o p e n . h o u r   >   2 1 )  
                 r e t u r n ;  
  
             i f ( m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   S U N D A Y   & &   m d t s t r u c t o p e n . h o u r   <   2 1 )  
                 r e t u r n ;  
           }  
         e l s e  
           {  
             i f ( m d t s t r u c t o p e n . d a y _ o f _ w e e k   = =   S U N D A Y )  
                 r e t u r n ;  
           }  
       }  
 / / - - -  
     i f ( ! I s O p e n P o s i t i o n ( )   & &  
           ( m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   S U N D A Y   | |   m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   F R I D A Y   | |   m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   S A T U R D A Y ) )  
       {  
         i f ( m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   S A T U R D A Y )   / /   4F(G 
             r e t u r n ;  
  
         s t r i n g   b r o k e r   =   : : A c c o u n t I n f o S t r i n g ( A C C O U N T _ C O M P A N Y ) ;  
         : : S t r i n g T o L o w e r ( b r o k e r ) ;  
  
         i f ( : : S t r i n g F i n d ( b r o k e r ,   " u n f x b " )   > =   0 )  
           {  
             i f ( m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   F R I D A Y   & &   m d t s t r u c t c l o s e . h o u r   >   2 1 )  
                 r e t u r n ;  
             i f ( m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   S U N D A Y   & &   m d t s t r u c t c l o s e . h o u r   <   2 1 )  
                 r e t u r n ;  
           }  
         e l s e  
           {  
             i f ( m d t s t r u c t c l o s e . d a y _ o f _ w e e k   = =   S U N D A Y )  
                 r e t u r n ;  
           }  
       }  
 / / - - -  
     m _ i s _ w e e k e n d   =   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C P o s i t i o n : : I s N e w s R u l e O n e ( c o n s t   M q l C a l e n d a r V a l u e   &   _ e v e n t ,   u i n t   &   _ i n d e x )  
   {  
     s t r i n g   s y m b o l   =   t h i s . S y m b o l ( ) ,  
                   b a s e       =   : : S y m b o l I n f o S t r i n g ( s y m b o l ,   S Y M B O L _ C U R R E N C Y _ B A S E ) ,  
                   q u o t e     =   : : S y m b o l I n f o S t r i n g ( s y m b o l ,   S Y M B O L _ C U R R E N C Y _ P R O F I T ) ;  
     : : S t r i n g T o L o w e r ( s y m b o l ) ;  
     : : S t r i n g T o L o w e r ( b a s e ) ;  
     : : S t r i n g T o L o w e r ( q u o t e ) ;  
  
     f o r ( u i n t   i   =   0 ;   i   <   r u l e _ o n e _ e v e n t _ i d s . S i z e ( ) ;   i + + )  
       {  
         i f ( r u l e _ o n e _ e v e n t _ i d s [ i ]   = =   _ e v e n t . e v e n t _ i d )  
           {  
             i f ( O p e n T i m e ( )     < =   _ e v e n t . t i m e   +   3   *   P e r i o d S e c o n d s ( P E R I O D _ M 1 )   & &  
                   C l o s e T i m e ( )   > =   _ e v e n t . t i m e   -   2   *   P e r i o d S e c o n d s ( P E R I O D _ M 1 ) )  
               {  
                 s t r i n g   e v e n t _ c u r r e n c y   =   r u l e _ o n e _ c u r r e n c y [ i ] ;  
                 : : S t r i n g T o L o w e r ( e v e n t _ c u r r e n c y ) ;  
                 i f ( : : S t r i n g F i n d ( s y m b o l ,   e v e n t _ c u r r e n c y )   > =   0   | |  
                       b a s e   = =   e v e n t _ c u r r e n c y   | |  
                       q u o t e   = =   e v e n t _ c u r r e n c y )  
                   {  
                     _ i n d e x   =   i ;  
                     r e t u r n   t r u e ;  
                   }  
               }  
           }  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C P o s i t i o n : : I s N e w s R u l e T w o ( c o n s t   M q l C a l e n d a r V a l u e   &   _ e v e n t ,   u i n t   &   _ i n d e x )  
   {  
     s t r i n g   s y m b o l   =   t h i s . S y m b o l ( ) ,  
                   b a s e       =   : : S y m b o l I n f o S t r i n g ( s y m b o l ,   S Y M B O L _ C U R R E N C Y _ B A S E ) ,  
                   q u o t e     =   : : S y m b o l I n f o S t r i n g ( s y m b o l ,   S Y M B O L _ C U R R E N C Y _ P R O F I T ) ;  
     : : S t r i n g T o L o w e r ( s y m b o l ) ;  
     : : S t r i n g T o L o w e r ( b a s e ) ;  
     : : S t r i n g T o L o w e r ( q u o t e ) ;  
  
     f o r ( u i n t   i   =   0 ;   i   <   r u l e _ t w o _ e v e n t _ i d s . S i z e ( ) ;   i + + )  
       {  
         i f ( r u l e _ t w o _ e v e n t _ i d s [ i ]   = =   _ e v e n t . e v e n t _ i d )  
           {  
             i f ( O p e n T i m e ( )   > =   _ e v e n t . t i m e   -   5   *   : : P e r i o d S e c o n d s ( P E R I O D _ M 1 )   & &  
                   C l o s e T i m e ( )   < =   _ e v e n t . t i m e   +   2   *   : : P e r i o d S e c o n d s ( P E R I O D _ M 1 ) )  
               {  
                 s t r i n g   e v e n t _ c u r r e n c y   =   r u l e _ t w o _ c u r r e n c y [ i ] ;  
                 : : S t r i n g T o L o w e r ( e v e n t _ c u r r e n c y ) ;  
                 i f ( : : S t r i n g F i n d ( s y m b o l ,   e v e n t _ c u r r e n c y )   > =   0   | |  
                       b a s e   = =   e v e n t _ c u r r e n c y   | |  
                       q u o t e   = =   e v e n t _ c u r r e n c y )  
                   {  
                     _ i n d e x   =   i ;  
                     r e t u r n   t r u e ;  
                   }  
               }  
           }  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C P o s i t i o n : : C h e c k N e w s T r a d i n g ( v o i d )  
   {  
     m _ i s _ n e w s _ t r a d i n g   =   f a l s e ;  
     m _ n e w s   =   " " ;  
     i f ( I s O p e n P o s i t i o n ( ) )  
         r e t u r n ;  
     i f ( C l o s e P r o f i t ( )   < =   0 )  
         r e t u r n ;  
 / / - - - -  
     m _ i s _ n e w s _ t r a d i n g   =   t r u e ;  
  
     C C a l e n d a r I n f o             C a l e n d a r ;  
     M q l C a l e n d a r V a l u e       e v e n t _ v a l u e [ ] ;  
  
     i f ( C a l e n d a r . V a l u e H i s t o r y S e l e c t A l l ( e v e n t _ v a l u e ,   O p e n R a t e T i m e ( )   -   5   *   P e r i o d S e c o n d s ( P E R I O D _ M 1 ) ,   C l o s e T i m e ( )   +   3   *   P e r i o d S e c o n d s ( P E R I O D _ M 1 ) ) )  
       {  
         f o r ( u i n t   i   =   0 ;   i   <   e v e n t _ v a l u e . S i z e ( ) ;   i + + )  
           {  
             u i n t   i n d e x   =   W R O N G _ V A L U E ;  
             i f ( I s N e w s R u l e O n e ( e v e n t _ v a l u e [ i ] ,   i n d e x ) )  
               {  
                 m _ n e w s   =   " R u l e   1 :   "   +   r u l e _ o n e _ c u r r e n c y [ i n d e x ]   +   "   "   +   r u l e _ o n e _ e v e n t s [ i n d e x ] ;  
                 r e t u r n ;  
               }  
  
             i f ( I s N e w s R u l e T w o ( e v e n t _ v a l u e [ i ] ,   i n d e x ) )  
               {  
                 m _ n e w s   =   " R u l e   2 : "   +   t h i s . S y m b o l ( )   +   "   "   +   r u l e _ t w o _ e v e n t s [ i n d e x ] ;  
                 r e t u r n ;  
               }  
           }  
       }  
 / / - - -  
     m _ i s _ n e w s _ t r a d i n g   =   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C P o s i t i o n : : S e t E x t r a D a t a ( c o n s t   b o o l   _ u s e _ w e e k e n d ,  
                                                           c o n s t   b o o l   _ u s e _ n e w s ,  
                                                           c o n s t   b o o l   _ u s e _ t i c k _ s c a l p ,  
                                                           c o n s t   u i n t   _ t i c k _ s c a l p _ d u r a t i o n _ m s c )  
   {  
     i f ( _ u s e _ w e e k e n d )  
         C h e c k W e e k e n d ( ) ;  
     i f ( _ u s e _ n e w s )  
         C h e c k N e w s T r a d i n g ( ) ;  
     i f ( _ u s e _ t i c k _ s c a l p )  
         C h e c k T i c k S c a l p ( _ t i c k _ s c a l p _ d u r a t i o n _ m s c ) ;  
 / / - - -  
     i f ( O p e n P r i c e ( )   < =   0   | |   C l o s e P r i c e ( )   < =   0   | |   V o l u m e ( )   < =   0 )  
         r e t u r n   f a l s e ;  
  
     i f ( ! C F u n c : : I s S y m b o l ( t h i s . S y m b o l ( ) ) )  
         r e t u r n   f a l s e ;  
  
     i f ( ! : : S y m b o l I n f o D o u b l e ( t h i s . S y m b o l ( ) ,   S Y M B O L _ P O I N T ,   m _ p o i n t ) )  
         r e t u r n   f a l s e ;  
  
     i f ( ! : : S y m b o l I n f o I n t e g e r ( t h i s . S y m b o l ( ) ,   S Y M B O L _ D I G I T S ,   m _ d i g i t s ) )  
         r e t u r n   f a l s e ;  
  
     i f ( m _ p o i n t   < =   0   | |   m _ d i g i t s   <   0 )  
         r e t u r n   f a l s e ;  
  
     u l o n g     d i f _ p o i n t   =   ( u l o n g ) : : r o u n d ( : : M a t h A b s ( t h i s . C l o s e P r i c e ( )   -   t h i s . O p e n P r i c e ( ) )   /   m _ p o i n t ) ;  
     d o u b l e   v a l u e ;  
     i f ( d i f _ p o i n t   >   0   & &   C l o s e P r o f i t ( )   /   V o l u m e ( )   ! =   0 )  
       {  
         v a l u e   =   M a t h A b s ( C l o s e P r o f i t ( )   /   d i f _ p o i n t ) ;  
         i f ( v a l u e   >   0 )  
           {  
             P o i n t V a l u e ( v a l u e ) ;  
             r e t u r n   t r u e ;  
           }  
       }  
 / / - - -  
     E N U M _ O R D E R _ T Y P E   t y p e   =   ( P o s i t i o n T y p e ( )   = =   D E A L _ T Y P E _ B U Y )   ?   O R D E R _ T Y P E _ B U Y   :   O R D E R _ T Y P E _ S E L L ;  
     i f ( t y p e   = =   O R D E R _ T Y P E _ B U Y )  
       {  
         d o u b l e   a s k   =   : : S y m b o l I n f o D o u b l e ( t h i s . S y m b o l ( ) ,   S Y M B O L _ A S K ) ;  
         i f ( a s k   -   5   *   m _ p o i n t   >   O p e n P r i c e ( ) )  
             t y p e   =   O R D E R _ T Y P E _ B U Y _ L I M I T ;  
         i f ( a s k   +   5   *   m _ p o i n t   <   O p e n P r i c e ( ) )  
             t y p e   =   O R D E R _ T Y P E _ B U Y _ S T O P ;  
       }  
     e l s e  
       {  
         d o u b l e   b i d   =   : : S y m b o l I n f o D o u b l e ( t h i s . S y m b o l ( ) ,   S Y M B O L _ B I D ) ;  
         i f ( b i d   -   5   *   m _ p o i n t   >   O p e n P r i c e ( ) )  
             t y p e   =   O R D E R _ T Y P E _ S E L L _ S T O P ;  
         i f ( b i d   +   5   *   m _ p o i n t   <   O p e n P r i c e ( ) )  
             t y p e   =   O R D E R _ T Y P E _ S E L L _ L I M I T ;  
       }  
  
     d o u b l e   p r i c e _ c l o s e   =   t y p e   = =   O R D E R _ T Y P E _ B U Y   ?   O p e n P r i c e ( )   +   m _ p o i n t   :   O p e n P r i c e ( )   -   m _ p o i n t ;  
     v a l u e   =   0 ;  
     i f ( O r d e r C a l c P r o f i t ( t y p e ,   t h i s . S y m b o l ( ) ,   V o l u m e ( ) ,   O p e n P r i c e ( ) ,   C l o s e P r i c e ( ) ,   v a l u e ) )  
         i f ( v a l u e   >   0 )  
           {  
             P o i n t V a l u e ( v a l u e ) ;  
             r e t u r n   t r u e ;  
           }  
 / / - - - -  
     d o u b l e   t i c k _ s i z e     =   S y m b o l I n f o D o u b l e ( t h i s . S y m b o l ( ) ,   S Y M B O L _ T R A D E _ T I C K _ S I Z E ) ;  
     d o u b l e   t i c k _ v a l u e   =   S y m b o l I n f o D o u b l e ( t h i s . S y m b o l ( ) ,   S Y M B O L _ T R A D E _ T I C K _ V A L U E ) ;  
     v a l u e   =   0 ;  
     i f ( t i c k _ s i z e   >   0   & &   t i c k _ v a l u e   >   0 )  
       {  
         v a l u e   =   t i c k _ v a l u e   *   m _ p o i n t   /   t i c k _ s i z e ;  
         i f ( v a l u e   *   V o l u m e ( )   >   0 )  
           {  
             P o i n t V a l u e ( v a l u e   *   V o l u m e ( ) ) ;  
             r e t u r n   t r u e ;  
           }  
  
       }  
     P o i n t V a l u e ( 1   *   V o l u m e ( ) ) ;  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                                   SymbolData.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
#property strict
#include <Object.mqh>
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CSymbolData : public CObject
 {
private:
  string             name;
  datetime           time;
public:
  string             Name(void)            const { return(name); }
  void               Name(const string _name)    { name = _name; }
  datetime           Time(void)            const { return(time); }
  void               Time(const datetime _time)  { time = _time; }
  void               Set(const string _name, const datetime _time)
   {
    name = _name;
    time = _time;
   }
 };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                         Deal.mqh |
//|                                    Copyright 2024, Akbar Atalou. |
//|                                       https://t.me/ProTraderSoft |
//+------------------------------------------------------------------+
#property copyright "Copyright 2024, Akbar Atalou."
#property link      "https://t.me/ProTraderSoft"
#property version   "1.00"
#property strict
//+------------------------------------------------------------------+
#include <Object.mqh>
#include <_Ata\Info\DealInfo.mqh>
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
class CDeal : public CObject
 {
private:
  ulong              deal_ticket;
  long               order_ticket;
  datetime           time;
  datetime           time_rate;
  ulong              time_msc;
  ENUM_DEAL_TYPE     type;
  ENUM_DEAL_ENTRY    entry;
  long               magic;
  ENUM_DEAL_REASON   reason;
  long               position_id;
  double             volume;
  double             price;
  double             commission;
  double             swap;
  double             profit;
  double             fee;
  double             sl;
  double             tp;
  string             symbol;
  string             comment;
  string             external_id;

  double             balance;
  double             last_day_balance;
  double             daily_limit;
  double             total_limit;

public:
                     CDeal();
                     CDeal(CDealInfo *DealInfo) { Set(DealInfo);}
                    ~CDeal();
  //---
  void               Ticket(const long _value)              { deal_ticket = _value;}
  void               OrderTicket(const long _value)         { order_ticket = _value;}
  void               Time(const datetime _value)
   {
    time = _value;
    time_rate = int(time / 60) * 60;
   }
  void               RateTime(const datetime _value)        { time_rate = _value;}
  void               TimeMsc(const long _value)             { time_msc = _value;}
  void               DealType(const ENUM_DEAL_TYPE _value)  { type = _value;}
  void               Entry(const ENUM_DEAL_ENTRY _value)    { entry = _value;}
  void               Magic(const long _value)               { magic = _value;}
  void               Reason(const ENUM_DEAL_REASON _value)  { reason = _value;}
  void               PositionId(const long _value)          { position_id = _value;}
  void               Volume(const double _value)            { volume = _value;}
  void               Price(const double _value)             { price = _value;}
  void               Commission(const double _value)        { commission = _value;}
  void               Swap(const double _value)              { swap = _value;}
  void               Profit(const double _value)            { profit = _value;}
  void               Fee(const double _value)               { fee = _value;}
  void               Sl(const double _value)                { sl = _value;}
  void               Tp(const double _value)                { tp = _value;}
  void               Symbol(const string _value)            { symbol = _value;}
  void               Comment(const string _value)           { comment = _value;}
  void               ExtId(const string _value)             { external_id = _value;}
  void               Balance(const double _value)           { balance = _value;}
  void               LastDayBalance(const double _value)    { last_day_balance = _value;}
  void               DailyLimit(const double _value)        { daily_limit = _value;}
  void               TotalLimit(const double _value)        { total_limit = _value;}
  //---
  ulong              Ticket(void)         const { return deal_ticket;}
  long               OrderTicket(void)    const { return order_ticket;}
  datetime           Time(void)           const { return time;}
  datetime           RateTime(void)       const { return time_rate;}
  ulong              TimeMsc(void)        const { return time_msc;}
  ENUM_DEAL_TYPE     DealType(void)       const { return type;}
  int                MysqlEnumDealType(void)
   {
    // 'Buy', 'Sell', 'Balance', 'Credit', 'Charge', 'Correction', 'Bonus', 'Commission', 'Daily Commission', 'Monthly Commission', 'Daily Agent Commission', 'Monthly Agent Commission', 'Interest Rate', 'Canceled Buy', 'Canceled Sell', 'Dividend', 'Franked', 'Tax', 'Unknown'
    switch(type)
     {
      case DEAL_TYPE_BUY:                       // 'Buy'
        return 1;
      case DEAL_TYPE_SELL:                      // 'Sell'
        return 2;
      case DEAL_TYPE_BALANCE:                   // 'Balance'
        return 3;
      case DEAL_TYPE_CREDIT:                    // 'Credit'
        return 4;
      case DEAL_TYPE_CHARGE:                    // 'Charge'
        return 5;
      case DEAL_TYPE_CORRECTION:                // 'Correction'
        return 6;
      case DEAL_TYPE_BONUS:                     // 'Bonus'
        return 7;
      case DEAL_TYPE_COMMISSION:                // 'Commission'
        return 8;
      case DEAL_TYPE_COMMISSION_DAILY:          // 'Daily Commission'
        return 9;
      case DEAL_TYPE_COMMISSION_MONTHLY:        // 'Monthly Commission'
        return 10;
      case DEAL_TYPE_COMMISSION_AGENT_DAILY:    // 'Daily Agent Commission'
        return 11;
      case DEAL_TYPE_COMMISSION_AGENT_MONTHLY:  // 'Monthly Agent Commission'
        return 12;
      case DEAL_TYPE_INTEREST:                  // 'Interest Rate'
        return 13;
      case DEAL_TYPE_BUY_CANCELED:              // 'Canceled Buy'
        return 14;
      case DEAL_TYPE_SELL_CANCELED:             // 'Canceled Sell'
        return 15;
      case DEAL_DIVIDEND:                       // 'Dividend'
        return 16;
      case DEAL_DIVIDEND_FRANKED:               // 'Franked'
        return 17;
      case DEAL_TAX:                            // 'Tax'
        return 18;
      default:
        break;
     }
    return 19;// 'Unknown'
   }
  ENUM_DEAL_ENTRY    Entry(void)          const { return entry;}
  int                MysqlEnumEntry(void)
   {
    //'In', 'Out', 'Reverse', 'Close By Opposite', 'Unknown'
    switch(entry)
     {
      case DEAL_ENTRY_IN:        //'In'
        return 1;
      case DEAL_ENTRY_OUT:       //'Out'
        return 2;
      case DEAL_ENTRY_INOUT:     //'Reverse'
        return 3;
      case DEAL_ENTRY_OUT_BY:    //'Close By Opposite'
        return 4;
      default:
        break;
     }
    return 5;//'Unknown'
   }
  long               Magic(void)          const { return magic;}
  ENUM_DEAL_REASON   Reason(void)         const { return reason;}
  int                MysqlEnumReason(void)
   {
    //'Desktop Terminal', 'Mobile Application', 'Web Platform', 'MQL5 Program', 'Stop Loss Activation', 'Take Profit Activation', 'Stop Out', 'Rollover', 'Variation Margin', 'SPLIT', 'Corporate Action', 'Unknown'
    switch(reason)
     {
      case DEAL_REASON_CLIENT:            // Desktop Terminal
        return 1;
      case DEAL_REASON_MOBILE:            // Mobile Application
        return 2;
      case DEAL_REASON_WEB:               // Web Platform
        return 3;
      case DEAL_REASON_EXPERT:            // MQL5 Program
        return 4;
      case DEAL_REASON_SL:                // Stop Loss Activation
        return 5;
      case DEAL_REASON_TP:                // Take Profit Activation
        return 6;
      case DEAL_REASON_SO:                // Stop Out
        return 7;
      case DEAL_REASON_ROLLOVER:          // Rollover
        return 8;
      case DEAL_REASON_VMARGIN:           // Variation Margin
        return 9;
      case DEAL_REASON_SPLIT:             // SPLIT
        return 10;
      case DEAL_REASON_CORPORATE_ACTION:  // Corporate Action
        return 11;
      default:
        break;
     }
    return 12;//'Unknown'
   }
  long               PositionId(void)     const { return position_id;}
  double             Volume(void)         const { return volume;}
  double             Price(void)          const { return price;}
  double             Commission(void)     const { return commission;}
  double             Swap(void)           const { return swap;}
  double             Profit(void)         const { return profit;}
  double             Fee(void)            const { return fee;}
  double             Sl(void)             const { return sl;}
  double             Tp(void)             const { return tp;}
  string             Symbol(void)         const { return symbol;}
  string             Comment(void)        const { return comment;}
  string             ExtId(void)          const { return external_id;}
  double             Balance(void)        const { return balance;}
  double             LastDayBalance(void) const { return last_day_balance;}
  double             DailyLimit(void)     const { return daily_limit;}
  double             TotalLimit(void)     const { return total_limit;}

  //---
  bool               Set(CDealInfo &DealInfo);
  bool               Set(CDeal *Deal);
  bool               Set(const ulong _deal_ticket);
  bool               Set(const ulong            _deal_ticket,
                         const long             _order_ticket,
                         const datetime         _time,
                         const ulong            _time_msc,
                         const ENUM_DEAL_TYPE   _type,
                         const ENUM_DEAL_ENTRY  _entry,
                         const long             _magic,
                         const ENUM_DEAL_REASON _reason,
                         const long              _position_id,
                         const double            _volume,
                         const double            _price,
                         const double            _commission,
                         const double            _swap,
                         const double            _profit,
                         const double            _fee,
                         const double            _sl,
                         const double            _tp,
                         const string            _symbol,
                         const string            _comment,
                         const string            _external_id);
 };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CDeal::CDeal() :
  deal_ticket(0),
  order_ticket(0),
  time(0),
  time_rate(0),
  time_msc(0),
  type(0),
  entry(0),
  magic(0),
  reason(0),
  position_id(0),
  volume(0.0),
  price(0.0),
  commission(0.0),
  swap(0.0),
  profit(0.0),
  fee(0.0),
  sl(0.0),
  tp(0.0),
  symbol(NULL),
  comment(NULL),
  external_id(NULL)
 {
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
CDeal::~CDeal()
 {
 }
//+------------------------------------------------------------------+
bool CDeal::Set(CDealInfo &DealInfo)
 {
  deal_ticket  = DealInfo.Ticket();
  order_ticket = DealInfo.Order();
  time         = DealInfo.Time();
  time_rate    = (int)(time / 60) * 60;
  time_msc     = DealInfo.TimeMsc();
  type         = DealInfo.DealType();
  entry        = DealInfo.Entry();
  magic        = DealInfo.Magic();
  reason       = DealInfo.Reason();
  position_id  = DealInfo.PositionId();
  volume       = DealInfo.Volume();
  price        = DealInfo.Price();
  commission   = DealInfo.Commission();
  swap         = DealInfo.Swap();
  profit       = DealInfo.Profit();
  fee          = DealInfo.Fee();
  sl           = DealInfo.StopLoss();
  tp           = DealInfo.TackProfit();
  symbol       = DealInfo.Symbol();
  comment      = DealInfo.Comment();
  external_id  = DealInfo.ExternalId();
  return true;
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDeal::Set(CDeal *Deal)
 {
  return Set(Deal.Ticket(),
             Deal.OrderTicket(),
             Deal.Time(),
             Deal.TimeMsc(),
             Deal.DealType(),
             Deal.Entry(),
             Deal.Magic(),
             Deal.Reason(),
             Deal.PositionId(),
             Deal.Volume(),
             Deal.Price(),
             Deal.Commission(),
             Deal.Swap(),
             Deal.Profit(),
             Deal.Fee(),
             Deal.Sl(),
             Deal.Tp(),
             Deal.Symbol(),
             Deal.Comment(),
             Deal.ExtId());
 }
//+------------------------------------------------------------------+
bool CDeal::Set(const ulong _deal_ticket)
 {
  CDealInfo DealInfo;
  DealInfo.Ticket(_deal_ticket);
  return Set(DealInfo);
 }
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
bool CDeal::Set(const ulong            _deal_ticket,
                const long             _order_ticket,
                const datetime         _time,
                const ulong            _time_msc,
                const ENUM_DEAL_TYPE   _type,
                const ENUM_DEAL_ENTRY  _entry,
                const long             _magic,
                const ENUM_DEAL_REASON _reason,
                const long             _position_id,
                const double           _volume,
                const double           _price,
                const double           _commission,
                const double           _swap,
                const double           _profit,
                const double           _fee,
                const double           _sl,
                const double           _tp,
                const string           _symbol,
                const string           _comment,
                const string           _external_id)
 {
  deal_ticket  = _deal_ticket;
  order_ticket = _order_ticket;
  time         = _time;
  time_rate    = (int)(time / 60) * 60;
  time_msc     = _time_msc;
  type         = _type;
  entry        = _entry;
  magic        = _magic;
  reason       = _reason;
  position_id  = _position_id;
  volume       = _volume;
  price        = _price;
  commission   = _commission;
  swap         = _swap;
  profit       = _profit;
  fee          = _fee;
  sl           = _sl;
  tp           = _tp;
  symbol       = _symbol;
  comment      = _comment;
  external_id  = _external_id;
  return true;
 }
//+------------------------------------------------------------------+
-e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                             D e f i n e s . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   s t r i c t  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   " C o n f i g s \ G e n e r a l C o n f i g s . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   " C o n f i g s \ S g b C o n f i g s . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                               E q u i t y . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   v e r s i o n       " 1 . 0 0 "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # i n c l u d e   < O b j e c t . m q h >  
 # i n c l u d e   " . . \ H i s t o r y \ H i s t o r y . m q h "  
 # i n c l u d e   " . . \ S e r i e s \ S e r i e s . m q h "  
 # i n c l u d e   < A r r a y s \ A r r a y O b j . m q h >  
 / / # i n c l u d e   " . . \ R e p o r t \ V a l u e s \ R u l e S e r i e s . m q h "  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 e n u m   E N U M _ B E _ U P D A T E _ T Y P E  
   {  
     U P D A T E _ T Y P E _ F A S T ,  
     U P D A T E _ T Y P E _ N O R M A L ,  
     U P D A T E _ T Y P E _ F U L L  
   } ;  
 e n u m   E N U M _ D D _ S O U R C E  
   {  
     D D _ S O U R C E _ B A L A N C E   =   1 ,  
     D D _ S O U R C E _ E Q U I T Y     =   2 ,  
     D D _ S O U R C E _ U N K N O W N   =   3  
   } ;  
 e n u m   E N U M _ D D _ T Y P E  
   {  
     D D _ T Y P E _ D A I L Y   =   1 ,  
     D D _ T Y P E _ T O T A L   =   2 ,  
     D D _ T Y P E _ U N K N O W N   =   3  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C D r a w D o w n   :   p u b l i c   C O b j e c t  
   {  
 p u b l i c :  
     E N U M _ D D _ S O U R C E           s o u r c e ;  
     E N U M _ D D _ T Y P E               t y p e ;  
     d a t e t i m e                       t i m e ;  
     u l o n g                             t i m e _ m s c ;  
     d o u b l e                           l i m i t ;  
     d o u b l e                           v a l u e ;  
                                           C D r a w D o w n ( )   :   s o u r c e ( D D _ S O U R C E _ U N K N O W N ) ,   t y p e ( D D _ T Y P E _ U N K N O W N ) ,   t i m e ( 0 ) ,   t i m e _ m s c ( 0 ) ,   l i m i t ( 0 ) ,   v a l u e ( 0 )   { }  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C E q u i t y   :   p u b l i c   C O b j e c t  
   {  
 p r i v a t e :  
     C T a s k                             * T a s k ;  
     C H i s t o r y                       * H i s t o r y ;  
     C S e r i e s                         * S e r i e s ;  
     M q l R a t e s                       m _ p r e v _ p r o f i t _ r a t e ;  
  
     b o o l                               U p d a t e B a l a n c e ( v o i d ) ;  
     b o o l                               U p d a t e E q u i t y ( c o n s t   E N U M _ B E _ U P D A T E _ T Y P E   _ t y p e ) ;  
     b o o l                               C h e c k T o t a l L i m i T r a i l ( v o i d ) ;  
     b o o l                               F i n d C h e c k P o i n t ( v o i d ) ;  
  
     v o i d                               F i l l O n e B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t ) ;  
     v o i d                               F i l l O p e n B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t ) ;  
     v o i d                               F i l l O n W a y B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t ,   c o n s t   E N U M _ B E _ U P D A T E _ T Y P E   _ t y p e ) ;  
     v o i d                               F i l l C l o s e B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t ) ;  
  
     v o i d                               C r e a t e O n e B a r R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                                             c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                                             M q l R a t e s                 & _ r e s _ r a t e ) ;  
     v o i d                               C r e a t e O p e n R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                                         c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                                         M q l R a t e s                 & _ v i r t u a l _ r a t e ) ;  
     b o o l                               C r e a t e O n W a y R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                                           c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                                           M q l R a t e s                 & _ r e s _ r a t e ) ;  
     v o i d                               C r e a t e C l o s e R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                                           c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                                           M q l R a t e s                 & _ r e s _ r a t e ) ;  
  
     b o o l                               C r e a t e P r o f i t R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                                             c o n s t   M q l R a t e s     & _ v i r t u a l _ r a t e ,  
                                                                             M q l R a t e s                 & _ p r o f i t _ r a t e ,  
                                                                             c o n s t   b o o l             _ i s _ o p e n         =   f a l s e ,  
                                                                             c o n s t   b o o l             _ i s _ c l o s e       =   f a l s e ) ;  
  
     b o o l                               A d d P r o f i t s ( M q l R a t e s   & _ p r o f i t _ r a t e ,  
                                                                 c o n s t   u i n t           _ b a r _ s h i f t ) ;  
     d o u b l e                           G e t T i c k P r i c e B y T y p e ( M q l T i c k   & _ t i c k ,   E N U M _ D E A L _ T Y P E   _ t y p e ) ;  
     v o i d                               R e s t T r a d e P r e v P r o f i t ( v o i d ) ;  
     v o i d                               S e t T r a d e P r e v P r o f i t ( c o n s t   M q l R a t e s   & _ p r o f i t _ r a t e ) ;  
     v o i d                               C h e c k E q u i t y H i g h L o w ( v o i d ) ;  
  
     b o o l                               U p d a t e D a t a ( v o i d ) ;  
  
     v o i d                               R e s e t ( v o i d )  
       {  
         / / F R E E ( B a l a n c e D a t a ) ;  
         / / F R E E ( E q u i t y D a t a ) ;  
  
         D r a w D o w n L i s t . C l e a r ( ) ;  
       }  
  
  
  
 p u b l i c :  
     / / C R u l e S e r i e s                 * B a l a n c e D a t a ;  
     / / C R u l e S e r i e s                 * E q u i t y D a t a ;  
  
     C A r r a y O b j                     D r a w D o w n L i s t ;  
  
                                           C E q u i t y ( ) ;  
                                         ~ C E q u i t y ( ) ;  
     b o o l                               U p d a t e ( C H i s t o r y                                     *   _ H i s t o r y ,  
                                                         C S e r i e s                                       *   _ S e r i e s ,  
                                                         C T a s k                                           *   _ T a s k ,  
                                                         c o n s t   E N U M _ B E _ U P D A T E _ T Y P E   _ t y p e   =   U P D A T E _ T Y P E _ F U L L ) ;  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C E q u i t y : : C E q u i t y ( )  
   {  
     R e s e t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C E q u i t y : : ~ C E q u i t y ( )  
   {  
     R e s e t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : U p d a t e ( C H i s t o r y                                     * _ H i s t o r y ,  
                                           C S e r i e s                                       * _ S e r i e s ,  
                                           C T a s k                                           * _ T a s k ,  
                                           c o n s t   E N U M _ B E _ U P D A T E _ T Y P E   _ t y p e   =   U P D A T E _ T Y P E _ F U L L )  
   {  
     u l o n g   s t a r t _ c n t   = : : G e t T i c k C o u n t 6 4 ( ) ;  
     R e s e t ( ) ;  
 / / - - -  
     H i s t o r y   =   _ H i s t o r y ;  
     S e r i e s   =   _ S e r i e s ;  
     T a s k   =   _ T a s k ;  
     i f ( ! I S _ P O I N T E R _ D Y N A M I C ( H i s t o r y )   | |   ! I S _ P O I N T E R _ D Y N A M I C ( S e r i e s )   | |   ! I S _ P O I N T E R _ D Y N A M I C ( T a s k ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     i f ( ! U p d a t e B a l a n c e ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     i f ( ! U p d a t e E q u i t y ( _ t y p e ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     i f ( ! C h e c k T o t a l L i m i T r a i l ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     i f ( ! U p d a t e D a t a ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     i f ( ! F i n d C h e c k P o i n t ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -   s u c c e e d  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : U p d a t e B a l a n c e ( v o i d )  
   {  
 / / - - - -  
     u i n t   t o t a l   =   H i s t o r y . D e a l s L i s t . T o t a l ( ) ;  
  
     f o r ( u i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         C D e a l   * D e a l   =   H i s t o r y . D e a l s L i s t . A t ( i ) ;  
  
         i f ( ! I S _ P O I N T E R _ D Y N A M I C ( D e a l )   & &   D e a l . T i c k e t ( )   < =   0 )  
             r e t u r n   f a l s e ;  
  
         i n t   i n d e x   =   S e r i e s . G e t I n d e x ( D e a l . T i m e M s c ( ) ) ;  
         i f ( i n d e x   = =   W R O N G _ V A L U E )  
             r e t u r n   f a l s e ;  
  
         d o u b l e   b a l a n c e   =   D e a l . B a l a n c e ( ) ;  
         d o u b l e   d a y _ l i m i t   =   D e a l . D a i l y L i m i t ( ) ;  
         i n t   c o u n t   =   ( i n t ) S e r i e s . m _ b a l a n c e . S i z e ( )   -   i n d e x ;  
  
         : : A r r a y F i l l ( S e r i e s . m _ b a l a n c e ,   i n d e x ,   c o u n t ,   b a l a n c e ) ;  
         : : A r r a y F i l l ( S e r i e s . m _ d a y _ l i m i t ,   i n d e x ,   c o u n t ,   d a y _ l i m i t ) ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : U p d a t e E q u i t y ( c o n s t   E N U M _ B E _ U P D A T E _ T Y P E   _ t y p e )  
   {  
     i n t   s i z e   =   ( i n t ) S e r i e s . m _ b a l a n c e . S i z e ( ) ;  
     i f ( : : A r r a y C o p y ( S e r i e s . m _ e q u i t y _ o p e n ,   S e r i e s . m _ b a l a n c e )   ! =   s i z e   | |  
           : : A r r a y C o p y ( S e r i e s . m _ e q u i t y _ h i g h ,   S e r i e s . m _ b a l a n c e )   ! =   s i z e   | |  
           : : A r r a y C o p y ( S e r i e s . m _ e q u i t y _ l o w ,   S e r i e s . m _ b a l a n c e )   ! =   s i z e   | |  
           : : A r r a y C o p y ( S e r i e s . m _ e q u i t y _ c l o s e ,   S e r i e s . m _ b a l a n c e )   ! =   s i z e )  
         r e t u r n   f a l s e ;  
 / / - - - -  
     u i n t   t o t a l   =   H i s t o r y . P o s i t i o n L i s t . T o t a l ( ) ;  
  
     f o r ( u i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         C P o s i t i o n   * P o s i t i o n   =   H i s t o r y . P o s i t i o n L i s t . A t ( i ) ;  
  
         i f ( ! I S _ P O I N T E R _ D Y N A M I C ( P o s i t i o n ) )  
             r e t u r n   f a l s e ;  
  
         i n t   s t a r t _ s e r   =   S e r i e s . G e t I n d e x ( P o s i t i o n . O p e n T i m e M s c ( ) ) ,  
                 e n d _ s e r       =   S e r i e s . G e t I n d e x ( P o s i t i o n . C l o s e T i m e M s c ( ) ) ;  
  
         i f ( s t a r t _ s e r   = =   W R O N G _ V A L U E   | |   e n d _ s e r   = =   W R O N G _ V A L U E )  
             r e t u r n   f a l s e ;  
  
         f o r ( i n t   b a r   =   s t a r t _ s e r ;   b a r   < =   e n d _ s e r ;   b a r + + )  
           {  
             i f ( b a r   = =   s t a r t _ s e r   & &   b a r   = =   e n d _ s e r )  
               {  
                 F i l l O n e B a r ( P o s i t i o n ,   b a r ) ;  
                 c o n t i n u e ;  
               }  
             i f ( b a r   = =   s t a r t _ s e r )  
               {  
                 F i l l O p e n B a r ( P o s i t i o n ,   b a r ) ;  
                 c o n t i n u e ;  
               }  
             i f ( b a r   = =   e n d _ s e r )  
               {  
                 F i l l C l o s e B a r ( P o s i t i o n ,   b a r ) ;  
                 c o n t i n u e ;  
               }  
             F i l l O n W a y B a r ( P o s i t i o n ,   b a r ,   _ t y p e ) ;  
           }  
       }  
     C h e c k E q u i t y H i g h L o w ( ) ;  
 / / - - -   R e m o v e   l a s t   R a t e  
     i f ( ! S e r i e s . R e m o v e L a s t R a t e ( H i s t o r y . E n d B a l a n c e ( ) ,   H i s t o r y . E n d E q u i t y ( ) ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : C h e c k T o t a l L i m i T r a i l ( v o i d )  
   {  
     i f ( ! T a s k . U s e T r a i l T o t a l ( ) )  
         r e t u r n   t r u e ;  
 / / - - - -  
     u i n t   t o t a l   =   S e r i e s . T o t a l ( ) ;  
     d o u b l e   m a x _ v a l u e   =   T a s k . E q u i t y C h e c k P o i n t T o t a l L i m i t ( ) ,  
                   r a t i o   =   T a s k . T o t a l L i m i t R a t i o ( ) ;  
  
     i f ( T a s k . T r a i l T o t a l ( )   = =   T R A I L _ E Q U I T Y )  
       {  
         f o r ( u i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
           {  
             m a x _ v a l u e   =   : : M a t h M a x ( m a x _ v a l u e ,   S e r i e s . m _ e q u i t y _ h i g h [ i ] ) ;  
             S e r i e s . m _ t o t a l _ l i m i t [ i ]   =   m a x _ v a l u e   *   r a t i o ;  
           }  
       }  
     e l s e  
       {  
         f o r ( u i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
           {  
             m a x _ v a l u e   =   : : M a t h M a x ( m a x _ v a l u e ,   S e r i e s . m _ b a l a n c e [ i ] ) ;  
             S e r i e s . m _ t o t a l _ l i m i t [ i ]   =   m a x _ v a l u e   *   r a t i o ;  
           }  
       }  
 / / - - - -  
     t o t a l   =   H i s t o r y . D e a l s L i s t . T o t a l ( ) ;  
     f o r ( u i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         C D e a l   * D e a l   =   H i s t o r y . D e a l s L i s t . A t ( i ) ;  
         i n t   i n d e x   =   S e r i e s . G e t I n d e x ( D e a l . T i m e M s c ( ) ) ;  
         i f ( i n d e x   > =   0 )  
             D e a l . T o t a l L i m i t ( S e r i e s . m _ t o t a l _ l i m i t [ i n d e x ] ) ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : F i n d C h e c k P o i n t ( v o i d )  
   {  
 / / - - -   '1  *9/'/  ~H24F  G'  -/'BD    EH1/  '3*    ~HF*  E9F  /'1/ 
     i f ( H i s t o r y . P o s i t i o n L i s t . T o t a l ( )   < =   0 )  
         r e t u r n   t r u e ;  
 / / - - -     ~HF*  E-'3('*  'H* 
     u i n t   t o t a l   =   S e r i e s . T o t a l ( ) ;  
     f o r ( u i n t   i   =   t o t a l   -   1 ;   i   > =   0 ;   i - - )  
       {  
         i f ( S e r i e s . m _ b a l a n c e [ i ]   = =   S e r i e s . m _ e q u i t y _ o p e n [ i ]   & &  
               S e r i e s . m _ b a l a n c e [ i ]   = =   S e r i e s . m _ e q u i t y _ h i g h [ i ]   & &  
               S e r i e s . m _ b a l a n c e [ i ]   = =   S e r i e s . m _ e q u i t y _ l o w [ i ]   & &  
               S e r i e s . m _ b a l a n c e [ i ]   = =   S e r i e s . m _ e q u i t y _ c l o s e [ i ] )  
           {  
             / / - - -   (113  4H/  /1  "F  FB7G  G  ~H24F  ('2  H,H/  F/'4*G  ('4/.  
             i f ( H i s t o r y . I s P o s i t i o n O p e n A t T i m e M s c ( S e r i e s . m _ t i m e _ m s c [ i ] ) )  
                 c o n t i n u e ;  
             T a s k . R e s u l t . E q u i t y C h e k P o i n t ( S e r i e s . m _ t i m e _ m s c [ i ] ,   S e r i e s . m _ b a l a n c e [ i ] ,  
                                                                     S e r i e s . m _ d a y _ l i m i t [ i ] ,   S e r i e s . m _ t o t a l _ l i m i t [ i ] ) ;  
             b r e a k ;  
           }  
       }  
 / / - - -     ~HF*  E-'3('*  /D2 
     i n t   i n d e x   =   H i s t o r y . D e a l s L i s t . T o t a l ( )   -   1 ;  
     i f ( i n d e x   > =   0 )  
       {  
         C D e a l   * D e a l   =   H i s t o r y . D e a l s L i s t . A t ( i n d e x ) ;  
  
         i f ( I S _ P O I N T E R _ D Y N A M I C ( D e a l )   & &   D e a l . T i m e M s c ( )   >   0 )  
             T a s k . R e s u l t . D e a l C h e k P o i n t ( D e a l . T i m e M s c ( ) ) ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : F i l l O n e B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t )  
   {  
     R e s t T r a d e P r e v P r o f i t ( ) ;  
 / / - - -   c r e a t e   v i r t u a l   r a t e  
     M q l R a t e s   v i r t u a l _ r a t e ;  
     C r e a t e O n e B a r R a t e ( _ P o s i t i o n ,   _ b a r _ s h i f t ,   v i r t u a l _ r a t e ) ;  
 / / - - -   c a l c   p r o f i t   r a t e  
     M q l R a t e s   p r o f i t _ r a t e ;  
     C r e a t e P r o f i t R a t e ( _ P o s i t i o n ,   v i r t u a l _ r a t e ,   p r o f i t _ r a t e ,   t r u e ,   t r u e ) ;  
 / / - - -   a d d   t o   i n d D a t a  
     A d d P r o f i t s ( p r o f i t _ r a t e ,   _ b a r _ s h i f t ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : F i l l O p e n B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t )  
   {  
     R e s t T r a d e P r e v P r o f i t ( ) ;  
 / / - - -   c r e a t e   v i r t u a l   r a t e  
     M q l R a t e s   v i r t u a l _ r a t e ;  
     C r e a t e O p e n R a t e ( _ P o s i t i o n ,   _ b a r _ s h i f t ,   v i r t u a l _ r a t e ) ;  
 / / - - -   c a l c   p r o f i t   r a t e  
     M q l R a t e s   p r o f i t _ r a t e ;  
     C r e a t e P r o f i t R a t e ( _ P o s i t i o n ,   v i r t u a l _ r a t e ,   p r o f i t _ r a t e ,   t r u e ,   f a l s e ) ;  
 / / - - -   a d d   t o   i n d D a t a  
     A d d P r o f i t s ( p r o f i t _ r a t e ,   _ b a r _ s h i f t ) ;  
 / / - - -  
     S e t T r a d e P r e v P r o f i t ( p r o f i t _ r a t e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : F i l l O n W a y B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t ,   c o n s t   E N U M _ B E _ U P D A T E _ T Y P E   _ t y p e )  
   {  
     E N U M _ D E A L _ T Y P E   t y p e     =   _ P o s i t i o n . P o s i t i o n T y p e ( ) ;  
     M q l R a t e s   p r o f i t _ r a t e ;  
     i f ( ! S e r i e s . I s M 1 R a t e ( _ b a r _ s h i f t )   | |  
           ( _ t y p e   = =   U P D A T E _ T Y P E _ F U L L   & &   t y p e   = =   D E A L _ T Y P E _ S E L L ) )  
       {  
         M q l R a t e s   v i r t u a l _ r a t e ;  
         i f ( C r e a t e O n W a y R a t e ( _ P o s i t i o n ,   _ b a r _ s h i f t ,   v i r t u a l _ r a t e ) )  
             C r e a t e P r o f i t R a t e ( _ P o s i t i o n ,   v i r t u a l _ r a t e ,   p r o f i t _ r a t e ,   f a l s e ,   f a l s e ) ;  
         e l s e  
           {  
             p r o f i t _ r a t e . o p e n   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
             p r o f i t _ r a t e . h i g h   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
             p r o f i t _ r a t e . l o w   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
             p r o f i t _ r a t e . c l o s e   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
           }  
       }  
     e l s e  
       {  
         / / - - -   c r e a t e   v i r t u a l   r a t e  
         s t r i n g     s y m b o l   =   _ P o s i t i o n . S y m b o l ( ) ;  
         d a t e t i m e   f r o m     =   S e r i e s . m _ t i m e [ _ b a r _ s h i f t ] ;  
         M q l R a t e s   s y m b o l _ r a t e s [ 1 ] ;  
         i n t   c o u n t _ r a t e s   =   : : C o p y R a t e s ( s y m b o l ,   P E R I O D _ M 1 ,   f r o m ,   1 ,   s y m b o l _ r a t e s ) ;  
         / / - - -   c a l c   p r o f i t   r a t e  
         i f ( c o u n t _ r a t e s   >   0 )  
           {  
             d o u b l e   p o i n t   =   ( d o u b l e ) : : S y m b o l I n f o D o u b l e ( s y m b o l ,   S Y M B O L _ P O I N T ) ;  
  
             i f ( t y p e   = =   D E A L _ T Y P E _ S E L L   & &   p o i n t   >   0 )  
               {  
                 s y m b o l _ r a t e s [ 0 ] . o p e n     =   s y m b o l _ r a t e s [ 0 ] . o p e n     +   ( d o u b l e ) s y m b o l _ r a t e s [ 0 ] . s p r e a d   *   p o i n t ;  
                 s y m b o l _ r a t e s [ 0 ] . h i g h     =   s y m b o l _ r a t e s [ 0 ] . h i g h     +   ( d o u b l e ) s y m b o l _ r a t e s [ 0 ] . s p r e a d   *   p o i n t ;  
                 s y m b o l _ r a t e s [ 0 ] . l o w       =   s y m b o l _ r a t e s [ 0 ] . l o w       +   ( d o u b l e ) s y m b o l _ r a t e s [ 0 ] . s p r e a d   *   p o i n t ;  
                 s y m b o l _ r a t e s [ 0 ] . c l o s e   =   s y m b o l _ r a t e s [ 0 ] . c l o s e   +   ( d o u b l e ) s y m b o l _ r a t e s [ 0 ] . s p r e a d   *   p o i n t ;  
               }  
  
             C r e a t e P r o f i t R a t e ( _ P o s i t i o n ,   s y m b o l _ r a t e s [ 0 ] ,   p r o f i t _ r a t e ,   f a l s e ,   f a l s e ) ;  
           }  
         e l s e  
           {  
             p r o f i t _ r a t e . o p e n   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
             p r o f i t _ r a t e . h i g h   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
             p r o f i t _ r a t e . l o w   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
             p r o f i t _ r a t e . c l o s e   =   m _ p r e v _ p r o f i t _ r a t e . c l o s e ;  
           }  
       }  
 / / - - -   a d d   t o   S e r i e s  
     A d d P r o f i t s ( p r o f i t _ r a t e ,   _ b a r _ s h i f t ) ;  
 / / - - -  
     S e t T r a d e P r e v P r o f i t ( p r o f i t _ r a t e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : F i l l C l o s e B a r ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,   c o n s t   u i n t   _ b a r _ s h i f t )  
   {  
 / / / / - - -   c r e a t e   v i r t u a l   r a t e  
 / /     M q l R a t e s   v i r t u a l _ r a t e ;  
 / /     C r e a t e C l o s e R a t e ( _ P o s i t i o n ,   _ b a r _ s h i f t ,   v i r t u a l _ r a t e ) ;  
 / / / / - - -   c a l c   p r o f i t   r a t e  
 / /     M q l R a t e s   p r o f i t _ r a t e ;  
 / /     C r e a t e P r o f i t R a t e ( _ P o s i t i o n ,   v i r t u a l _ r a t e ,   p r o f i t _ r a t e ,   f a l s e ,   t r u e ) ;  
 / / / / - - -   a d d   t o   S e r i e s  
 / /     A d d P r o f i t s ( p r o f i t _ r a t e ,   _ b a r _ s h i f t ) ;  
 / / - - -  
     R e s t T r a d e P r e v P r o f i t ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : C r e a t e O n e B a r R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                               c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                               M q l R a t e s                 & _ r e s _ r a t e )  
   {  
     _ r e s _ r a t e . o p e n       =   _ P o s i t i o n . O p e n P r i c e ( ) ;  
     _ r e s _ r a t e . c l o s e     =   _ P o s i t i o n . C l o s e P r i c e ( ) ;  
     _ r e s _ r a t e . h i g h       =   : : M a t h M a x ( _ r e s _ r a t e . o p e n ,   _ r e s _ r a t e . c l o s e ) ;  
     _ r e s _ r a t e . l o w         =   : : M a t h M i n ( _ r e s _ r a t e . o p e n ,   _ r e s _ r a t e . c l o s e ) ;  
     _ r e s _ r a t e . s p r e a d   =   0 ;  
 / / - - -  
     s t r i n g     s y m b o l   =   _ P o s i t i o n . S y m b o l ( ) ;  
     E N U M _ D E A L _ T Y P E   t y p e     =   _ P o s i t i o n . P o s i t i o n T y p e ( ) ;  
  
     l o n g   f r o m _ m s c   =   l o n g ( S e r i e s . T i m e M s c ( _ b a r _ s h i f t ) ) ,  
               t o _ m s c       =   f r o m _ m s c   +   6 0 0 0 0 ;  
  
     i f ( S e r i e s . T o t a l ( )   >   _ b a r _ s h i f t   +   2 )  
         t o _ m s c   =   l o n g ( S e r i e s . T i m e M s c ( _ b a r _ s h i f t   +   1 )   -   1 ) ;  
  
     m a t r i x   t i c k s ;  
     u i n t   f l a g s   =   t y p e   = =   D E A L _ T Y P E _ B U Y   ?   C O P Y _ T I C K S _ B I D   :   C O P Y _ T I C K S _ A S K ;  
  
     i f ( t i c k s . C o p y T i c k s R a n g e ( s y m b o l ,   f l a g s ,   f r o m _ m s c ,   t o _ m s c ) )  
       {  
         i f ( t i c k s . C o l s ( )   <   1   | |   t i c k s . R o w s ( )   <   1 )  
             r e t u r n ;  
         _ r e s _ r a t e . h i g h       =   t i c k s . M a x ( ) ;  
         _ r e s _ r a t e . l o w         =   t i c k s . M i n ( ) ;  
         _ r e s _ r a t e . c l o s e     =   t i c k s [ 0 ] [ t i c k s . C o l s ( )   -   1 ] ;  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : C r e a t e O p e n R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                           c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                           M q l R a t e s                 & _ r e s _ r a t e )  
   {  
     _ r e s _ r a t e . o p e n       =   _ P o s i t i o n . O p e n P r i c e ( ) ;  
     _ r e s _ r a t e . c l o s e     =   _ r e s _ r a t e . o p e n ;  
     _ r e s _ r a t e . h i g h       =   _ r e s _ r a t e . o p e n ;  
     _ r e s _ r a t e . l o w         =   _ r e s _ r a t e . o p e n ;  
     _ r e s _ r a t e . s p r e a d   =   0 ;  
 / / - - -  
     s t r i n g     s y m b o l   =   _ P o s i t i o n . S y m b o l ( ) ;  
     E N U M _ D E A L _ T Y P E   t y p e     =   _ P o s i t i o n . P o s i t i o n T y p e ( ) ;  
     l o n g   f r o m _ m s c   =   l o n g ( _ P o s i t i o n . O p e n T i m e M s c ( ) ) ,  
               t o _ m s c       =   f r o m _ m s c   +   6 0 0 0 0 ;  
  
     i f ( S e r i e s . T o t a l ( )   >   _ b a r _ s h i f t   +   2 )  
         t o _ m s c   =   l o n g ( S e r i e s . T i m e M s c ( _ b a r _ s h i f t   +   1 )   -   1 ) ;  
  
     m a t r i x   t i c k s ;  
     u i n t   f l a g s   =   t y p e   = =   D E A L _ T Y P E _ B U Y   ?   C O P Y _ T I C K S _ B I D   :   C O P Y _ T I C K S _ A S K ;  
  
     i f ( t i c k s . C o p y T i c k s R a n g e ( s y m b o l ,   f l a g s ,   f r o m _ m s c ,   t o _ m s c ) )  
       {  
         i f ( t i c k s . C o l s ( )   <   1   | |   t i c k s . R o w s ( )   <   1 )  
             r e t u r n ;  
         _ r e s _ r a t e . o p e n       =   t i c k s [ 0 ] [ 0 ] ;  
         _ r e s _ r a t e . h i g h       =   t i c k s . M a x ( ) ;  
         _ r e s _ r a t e . l o w         =   t i c k s . M i n ( ) ;  
         _ r e s _ r a t e . c l o s e     =   t i c k s [ 0 ] [ t i c k s . C o l s ( )   -   1 ] ;  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : C r e a t e O n W a y R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                             c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                             M q l R a t e s                 & _ r e s _ r a t e )  
   {  
 / / - - -  
     s t r i n g     s y m b o l   =   _ P o s i t i o n . S y m b o l ( ) ;  
     E N U M _ D E A L _ T Y P E   t y p e     =   _ P o s i t i o n . P o s i t i o n T y p e ( ) ;  
     l o n g   f r o m _ m s c   =   l o n g ( S e r i e s . T i m e M s c ( _ b a r _ s h i f t ) ) ,  
               t o _ m s c       =   f r o m _ m s c   +   6 0 0 0 0 ;  
  
     i f ( S e r i e s . T o t a l ( )   >   _ b a r _ s h i f t   +   2 )  
         t o _ m s c   =   l o n g ( S e r i e s . T i m e M s c ( _ b a r _ s h i f t   +   1 )   -   1 ) ;  
  
     m a t r i x   t i c k s ;  
     u i n t   f l a g s   =   t y p e   = =   D E A L _ T Y P E _ B U Y   ?   C O P Y _ T I C K S _ B I D   :   C O P Y _ T I C K S _ A S K ;  
  
     i f ( t i c k s . C o p y T i c k s R a n g e ( s y m b o l ,   f l a g s ,   f r o m _ m s c ,   t o _ m s c ) )  
       {  
         i f ( t i c k s . C o l s ( )   <   1   | |   t i c k s . R o w s ( )   <   1 )  
             r e t u r n   f a l s e ;  
         _ r e s _ r a t e . o p e n       =   t i c k s [ 0 ] [ 0 ] ;  
         _ r e s _ r a t e . h i g h       =   t i c k s . M a x ( ) ;  
         _ r e s _ r a t e . l o w         =   t i c k s . M i n ( ) ;  
         _ r e s _ r a t e . c l o s e     =   t i c k s [ 0 ] [ t i c k s . C o l s ( )   -   1 ] ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : C r e a t e C l o s e R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                             c o n s t   u i n t             _ b a r _ s h i f t ,  
                                                             M q l R a t e s                 & _ r e s _ r a t e )  
   {  
     _ r e s _ r a t e . o p e n       =   _ P o s i t i o n . C l o s e P r i c e ( ) ;  
     _ r e s _ r a t e . c l o s e     =   _ r e s _ r a t e . o p e n ;  
     _ r e s _ r a t e . h i g h       =   _ r e s _ r a t e . o p e n ;  
     _ r e s _ r a t e . l o w         =   _ r e s _ r a t e . o p e n ;  
     _ r e s _ r a t e . s p r e a d   =   0 ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : C r e a t e P r o f i t R a t e ( c o n s t   C P o s i t i o n   * _ P o s i t i o n ,  
                                                               c o n s t   M q l R a t e s     & _ v i r t u a l _ r a t e ,  
                                                               M q l R a t e s                 & _ p r o f i t _ r a t e ,  
                                                               c o n s t   b o o l             _ i s _ o p e n         =   f a l s e ,  
                                                               c o n s t   b o o l             _ i s _ c l o s e       =   f a l s e )  
   {  
     _ p r o f i t _ r a t e . o p e n     =   _ P o s i t i o n . G e t P r o f i t ( _ v i r t u a l _ r a t e . o p e n ) ;  
     _ p r o f i t _ r a t e . h i g h     =   _ P o s i t i o n . G e t P r o f i t ( _ v i r t u a l _ r a t e . h i g h ) ;  
     _ p r o f i t _ r a t e . l o w       =   _ P o s i t i o n . G e t P r o f i t ( _ v i r t u a l _ r a t e . l o w ) ;  
     _ p r o f i t _ r a t e . c l o s e   =   ( ! _ i s _ c l o s e   ?   _ P o s i t i o n . G e t P r o f i t ( _ v i r t u a l _ r a t e . c l o s e )   :   _ P o s i t i o n . P r o f i t ( ) ) ;  
 / / - - -   s u c c e e d  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : A d d P r o f i t s ( M q l R a t e s   & _ p r o f i t _ r a t e ,  
                                                   c o n s t   u i n t           _ b a r _ s h i f t )  
   {  
     u i n t   t o t a l   =   S e r i e s . T o t a l ( ) ;  
     i f ( _ b a r _ s h i f t   > =   t o t a l )  
         r e t u r n   f a l s e ;  
  
     d o u b l e   v a l u e 1   =   _ p r o f i t _ r a t e . h i g h ,  
                   v a l u e 2   =   _ p r o f i t _ r a t e . l o w ,  
                   v a l u e 3   =   _ p r o f i t _ r a t e . o p e n ,  
                   v a l u e 4   =   _ p r o f i t _ r a t e . c l o s e ;  
  
     S e r i e s . m _ e q u i t y _ o p e n [ _ b a r _ s h i f t ]     + =   _ p r o f i t _ r a t e . o p e n ;  
     S e r i e s . m _ e q u i t y _ h i g h [ _ b a r _ s h i f t ]     + =   _ p r o f i t _ r a t e . h i g h ;  
     S e r i e s . m _ e q u i t y _ l o w [ _ b a r _ s h i f t ]       + =   _ p r o f i t _ r a t e . l o w ;  
     S e r i e s . m _ e q u i t y _ c l o s e [ _ b a r _ s h i f t ]   + =   _ p r o f i t _ r a t e . c l o s e ;  
 / / - - -   s u c c e e d  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 d o u b l e   C E q u i t y : : G e t T i c k P r i c e B y T y p e ( M q l T i c k   & _ t i c k ,   E N U M _ D E A L _ T Y P E   _ t y p e )  
   {  
     i f ( _ t y p e   = =   D E A L _ T Y P E _ S E L L )  
         r e t u r n   _ t i c k . a s k ;  
     r e t u r n   _ t i c k . b i d ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : R e s t T r a d e P r e v P r o f i t ( v o i d )  
   {  
     M q l R a t e s   c l e a n ;  
     m _ p r e v _ p r o f i t _ r a t e   =   c l e a n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : S e t T r a d e P r e v P r o f i t ( c o n s t   M q l R a t e s   & _ p r o f i t _ r a t e )  
   {  
     m _ p r e v _ p r o f i t _ r a t e   =   _ p r o f i t _ r a t e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C E q u i t y : : C h e c k E q u i t y H i g h L o w ( v o i d )  
   {  
     u i n t   t o t a l   =   S e r i e s . T o t a l ( ) ;  
     f o r ( u i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         d o u b l e   v a l u e 1   =   S e r i e s . m _ e q u i t y _ o p e n [ i ] ,  
                       v a l u e 2   =   S e r i e s . m _ e q u i t y _ h i g h [ i ] ,  
                       v a l u e 3   =   S e r i e s . m _ e q u i t y _ l o w [ i ] ,  
                       v a l u e 4   =   S e r i e s . m _ e q u i t y _ c l o s e [ i ] ;  
  
         S e r i e s . m _ e q u i t y _ h i g h [ i ]   =   : : M a t h M a x ( : : M a t h M a x ( v a l u e 1 ,   v a l u e 2 ) ,   : : M a t h M a x ( v a l u e 3 ,   v a l u e 4 ) ) ;  
         S e r i e s . m _ e q u i t y _ l o w [ i ]     =   : : M a t h M i n ( : : M a t h M i n ( v a l u e 1 ,   v a l u e 2 ) ,   : : M a t h M i n ( v a l u e 3 ,   v a l u e 4 ) ) ;  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C E q u i t y : : U p d a t e D a t a ( v o i d )  
   {  
     b o o l       u s e _ _ g a m b l i n g   =   T a s k . U s e G a m b e l i n g ( ) ,  
                   i s _ b a l a n c e _ g a m b l i n g   =   f a l s e ,  
                   i s _ e q u i t y _ g a m b l i n g   =   f a l s e ;  
     d o u b l e   g a m b l _ p e r c   =   T a s k . G a m b e l i n g P e r c e n t ( ) ,  
                   p e r c e n t   =   W R O N G _ V A L U E ;  
  
     b o o l   i s _ b a l a n c e _ d a i l y _ t o u c h   =   f a l s e ,  
               i s _ b a l a n c e _ t o t a l _ t o u c h   =   f a l s e ,  
               i s _ e q u i t y _ d a i l y _ t o u c h   =   f a l s e ,  
               i s _ e q u i t y _ t o t a l _ t o u c h   =   f a l s e ;  
     D r a w D o w n L i s t . C l e a r ( ) ;  
 / / - - -   L o o p   S e r i e s   F o r   G a m b l i n g s   &   D r a w   d o w n  
     i n t   t o t a l   =   ( i n t ) S e r i e s . T o t a l ( ) ;  
     f o r ( i n t   i   =   0 ;   i   <   t o t a l ;   i + + )  
       {  
         i f ( u s e _ _ g a m b l i n g )  
           {  
             / / - - -   b a l a n c e   g a m b l i n g  
             i f ( ! i s _ b a l a n c e _ g a m b l i n g )  
               {  
                 p e r c e n t   =   ( ( S e r i e s . m _ b a l a n c e [ : : M a t h M a x ( i   -   1 ,   0 ) ]   -   S e r i e s . m _ b a l a n c e [ i ] )   /   S e r i e s . m _ b a l a n c e [ : : M a t h M a x ( i   -   1 ,   0 ) ] )   *   1 0 0 ;  
                 i f ( p e r c e n t   >   g a m b l _ p e r c )  
                   {  
                     i s _ b a l a n c e _ g a m b l i n g   =   t r u e ;  
                     S e r i e s . m _ b a l a n c e _ g a m b e l i n g [ i ]   =   t r u e ;  
                   }  
               }  
             / / - - -   e q u i t y   g a m b l i n g  
             i f ( ! i s _ e q u i t y _ g a m b l i n g )  
               {  
                 p e r c e n t   =   ( ( S e r i e s . m _ b a l a n c e [ i ]   -   S e r i e s . m _ e q u i t y _ l o w [ i ] )   /   S e r i e s . m _ b a l a n c e [ i ] )   *   1 0 0 ;  
                 i f ( p e r c e n t   >   g a m b l _ p e r c )  
                   {  
                     i s _ e q u i t y _ g a m b l i n g   =   t r u e ;  
                     S e r i e s . m _ e q u i t y _ g a m b e l i n g [ i ]   =   t r u e ;  
                   }  
               }  
             / / - - -   r e s t   g a m b l i n g  
             i f ( S e r i e s . m _ b a l a n c e [ i ]   = =   S e r i e s . m _ e q u i t y _ l o w [ i ] )  
               {  
                 i s _ b a l a n c e _ g a m b l i n g   =   f a l s e ;  
                 i s _ e q u i t y _ g a m b l i n g   =   f a l s e ;  
               }  
           }  
  
         / / - - -   b a l a n c e   d a i l y   t o u c h   l i s t  
         i f ( ! i s _ b a l a n c e _ d a i l y _ t o u c h   & &   S e r i e s . m _ b a l a n c e [ i ]   < =   S e r i e s . m _ d a y _ l i m i t [ i ] )  
           {  
             C D r a w D o w n   * D D   =   n e w   C D r a w D o w n ;  
             D D . s o u r c e   =   D D _ S O U R C E _ B A L A N C E ;  
             D D . t y p e   =   D D _ T Y P E _ D A I L Y ;  
             D D . t i m e   =   S e r i e s . m _ t i m e [ i ] ;  
             D D . t i m e _ m s c   =   S e r i e s . m _ t i m e _ m s c [ i ] ;  
             D D . l i m i t   =   S e r i e s . m _ d a y _ l i m i t [ i ] ;  
             D D . v a l u e   =   S e r i e s . m _ b a l a n c e [ i ] ;  
  
             i f ( ! D r a w D o w n L i s t . A d d ( D D ) )  
               {  
                 F R E E ( D D ) ;  
               }  
             e l s e  
                 i s _ b a l a n c e _ d a i l y _ t o u c h   =   t r u e ;  
           }  
         e l s e  
             i f ( i s _ b a l a n c e _ d a i l y _ t o u c h   & &   S e r i e s . m _ b a l a n c e [ i ]   >   S e r i e s . m _ d a y _ l i m i t [ i ] )  
                 i s _ b a l a n c e _ d a i l y _ t o u c h   =   f a l s e ;  
  
         / / - - -   b a l a n c e   t o t a l   t o u c h   l i s t  
         i f ( ! i s _ b a l a n c e _ t o t a l _ t o u c h   & &   S e r i e s . m _ b a l a n c e [ i ]   < =   S e r i e s . m _ t o t a l _ l i m i t [ i ] )  
           {  
             C D r a w D o w n   * D D   =   n e w   C D r a w D o w n ;  
             D D . s o u r c e   =   D D _ S O U R C E _ B A L A N C E ;  
             D D . t y p e   =   D D _ T Y P E _ T O T A L ;  
             D D . t i m e   =   S e r i e s . m _ t i m e [ i ] ;  
             D D . t i m e _ m s c   =   S e r i e s . m _ t i m e _ m s c [ i ] ;  
             D D . l i m i t   =   S e r i e s . m _ t o t a l _ l i m i t [ i ] ;  
             D D . v a l u e   =   S e r i e s . m _ b a l a n c e [ i ] ;  
  
             i f ( ! D r a w D o w n L i s t . A d d ( D D ) )  
               {  
                 F R E E ( D D ) ;  
               }  
             e l s e  
                 i s _ b a l a n c e _ t o t a l _ t o u c h   =   t r u e ;  
           }  
         e l s e  
             i f ( i s _ b a l a n c e _ t o t a l _ t o u c h   & &   S e r i e s . m _ b a l a n c e [ i ]   >   S e r i e s . m _ t o t a l _ l i m i t [ i ] )  
                 i s _ b a l a n c e _ t o t a l _ t o u c h   =   f a l s e ;  
  
         / / - - -   e q u i t y   d a i l y   t o u c h   l i s t  
         i f ( ! i s _ e q u i t y _ d a i l y _ t o u c h   & &   S e r i e s . m _ e q u i t y _ l o w [ i ]   < =   S e r i e s . m _ d a y _ l i m i t [ i ] )  
           {  
             C D r a w D o w n   * D D   =   n e w   C D r a w D o w n ;  
             D D . s o u r c e   =   D D _ S O U R C E _ E Q U I T Y ;  
             D D . t y p e   =   D D _ T Y P E _ D A I L Y ;  
             D D . t i m e   =   S e r i e s . m _ t i m e [ i ] ;  
             D D . t i m e _ m s c   =   S e r i e s . m _ t i m e _ m s c [ i ] ;  
             D D . l i m i t   =   S e r i e s . m _ d a y _ l i m i t [ i ] ;  
             D D . v a l u e   =   S e r i e s . m _ e q u i t y _ l o w [ i ] ;  
  
             i f ( ! D r a w D o w n L i s t . A d d ( D D ) )  
               {  
                 F R E E ( D D ) ;  
               }  
             e l s e  
                 i s _ e q u i t y _ d a i l y _ t o u c h   =   t r u e ;  
           }  
         e l s e  
             i f ( i s _ e q u i t y _ d a i l y _ t o u c h   & &   S e r i e s . m _ e q u i t y _ l o w [ i ]   >   S e r i e s . m _ d a y _ l i m i t [ i ] )  
                 i s _ e q u i t y _ d a i l y _ t o u c h   =   f a l s e ;  
  
         / / - - -   e q u i t y   t o t a l   t o u c h   l i s t  
         i f ( ! i s _ e q u i t y _ t o t a l _ t o u c h   & &   S e r i e s . m _ e q u i t y _ l o w [ i ]   < =   S e r i e s . m _ t o t a l _ l i m i t [ i ] )  
           {  
             C D r a w D o w n   * D D   =   n e w   C D r a w D o w n ;  
             D D . s o u r c e   =   D D _ S O U R C E _ E Q U I T Y ;  
             D D . t y p e   =   D D _ T Y P E _ T O T A L ;  
             D D . t i m e   =   S e r i e s . m _ t i m e [ i ] ;  
             D D . t i m e _ m s c   =   S e r i e s . m _ t i m e _ m s c [ i ] ;  
             D D . l i m i t   =   S e r i e s . m _ t o t a l _ l i m i t [ i ] ;  
             D D . v a l u e   =   S e r i e s . m _ e q u i t y _ l o w [ i ] ;  
  
             i f ( ! D r a w D o w n L i s t . A d d ( D D ) )  
               {  
                 F R E E ( D D ) ;  
               }  
             e l s e  
                 i s _ e q u i t y _ t o t a l _ t o u c h   =   t r u e ;  
           }  
         e l s e  
             i f ( i s _ e q u i t y _ t o t a l _ t o u c h   & &   S e r i e s . m _ e q u i t y _ l o w [ i ]   >   S e r i e s . m _ t o t a l _ l i m i t [ i ] )  
                 i s _ e q u i t y _ t o t a l _ t o u c h   =   f a l s e ;  
       }  
 / / - - -  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                   C a l e n d a r I n f o . m q h   |  
 / / |                                                                                       C o p y r i g h t   2 0 2 1 ,   d e n k i r   |  
 / / |                                                           h t t p s : / / w w w . m q l 5 . c o m / r u / u s e r s / d e n k i r   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 1 ,   d e n k i r "  
 # p r o p e r t y   l i n k             " h t t p s : / / w w w . m q l 5 . c o m / r u / u s e r s / d e n k i r "  
 / / - - -  
 # i n c l u d e   < O b j e c t . m q h >  
 # i n c l u d e   < G e n e r i c \ S o r t e d S e t . m q h >  
 # i n c l u d e   < A r r a y s \ A r r a y S t r i n g . m q h >  
 # i n c l u d e   < M a t h \ S t a t \ M a t h . m q h >  
 # i n c l u d e   " C o n t i n e n t s . m q h "  
 / / - - -   d e f i n e s   f o r   e v e n t s   f i l t e r i n g  
 / / - - -   1 )   t y p e   ( 3 )  
 # d e f i n e   F I L T E R _ B Y _ T Y P E _ E V E N T                       0 x 1                             / /   1   b y   t y p e   " e v e n t "  
 # d e f i n e   F I L T E R _ B Y _ T Y P E _ I N D I C A T O R               0 x 2                             / /   2   b y   t y p e   " i n d i c a t o r "  
 # d e f i n e   F I L T E R _ B Y _ T Y P E _ H O L I D A Y                   0 x 4                             / /   3   b y   t y p e   " h o l i d a y "  
 / / - - -   2 )   s e c t o r   ( 1 3 )  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ N O N E                     0 x 8                             / /   4   b y   s e c t o r   " n o n e "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ M A R K E T                 0 x 1 0                           / /   5   b y   s e c t o r   " m a r k e t "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ G D P                       0 x 2 0                           / /   6   b y   s e c t o r   " G D P "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ J O B S                     0 x 4 0                           / /   7   b y   s e c t o r   " j o b s "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ P R I C E S                 0 x 8 0                           / /   8   b y   s e c t o r   " p r i c e s "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ M O N E Y                   0 x 1 0 0                         / /   9   b y   s e c t o r   " m o n e y "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ T R A D E                   0 x 2 0 0                         / /   1 0   b y   s e c t o r   " t r a d e "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ G O V E R N M E N T         0 x 4 0 0                         / /   1 1   b y   s e c t o r   " g o v e r n m e n t "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ B U S I N E S S             0 x 8 0 0                         / /   1 2   b y   s e c t o r   " b u s i n e s s "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ C O N S U M E R             0 x 1 0 0 0                       / /   1 3   b y   s e c t o r   " c o n s u m e r "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ H O U S I N G               0 x 2 0 0 0                       / /   1 4   b y   s e c t o r   " h o u s i n g "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ T A X E S                   0 x 4 0 0 0                       / /   1 5   b y   s e c t o r   " t a x e s "  
 # d e f i n e   F I L T E R _ B Y _ S E C T O R _ H O L I D A Y S             0 x 8 0 0 0                       / /   1 6   b y   s e c t o r   " h o l i d a y s "  
 / / - - -   3 )   f r e q u e n c y   ( 6 )  
 # d e f i n e   F I L T E R _ B Y _ F R E Q U E N C Y _ N O N E               0 x 1 0 0 0 0                     / /   1 7   b y   f r e q u e n c y   " n o n e "  
 # d e f i n e   F I L T E R _ B Y _ F R E Q U E N C Y _ W E E K               0 x 2 0 0 0 0                     / /   1 8   b y   f r e q u e n c y   " w e e k "  
 # d e f i n e   F I L T E R _ B Y _ F R E Q U E N C Y _ M O N T H             0 x 4 0 0 0 0                     / /   1 9   b y   f r e q u e n c y   " m o n t h "  
 # d e f i n e   F I L T E R _ B Y _ F R E Q U E N C Y _ Q U A R T E R         0 x 8 0 0 0 0                     / /   2 0   b y   f r e q u e n c y   " q u a r t e r "  
 # d e f i n e   F I L T E R _ B Y _ F R E Q U E N C Y _ Y E A R               0 x 1 0 0 0 0 0                   / /   2 1   b y   f r e q u e n c y   " y e a r "  
 # d e f i n e   F I L T E R _ B Y _ F R E Q U E N C Y _ D A Y                 0 x 2 0 0 0 0 0                   / /   2 2   b y   f r e q u e n c y   " d a y "  
 / / - - -   4 )   i m p o r t a n c e   ( 4 )  
 # d e f i n e   F I L T E R _ B Y _ I M P O R T A N C E _ N O N E             0 x 4 0 0 0 0 0                   / /   2 3   b y   i m p o r t a n c e   " n o n e "  
 # d e f i n e   F I L T E R _ B Y _ I M P O R T A N C E _ L O W               0 x 8 0 0 0 0 0                   / /   2 4   b y   i m p o r t a n c e   " l o w "  
 # d e f i n e   F I L T E R _ B Y _ I M P O R T A N C E _ M O D E R A T E     0 x 1 0 0 0 0 0 0                 / /   2 5   b y   i m p o r t a n c e   " m e d i u m "  
 # d e f i n e   F I L T E R _ B Y _ I M P O R T A N C E _ H I G H             0 x 2 0 0 0 0 0 0                 / /   2 6   b y   i m p o r t a n c e   " h i g h "  
 / / - - -   5 )   u n i t   ( 1 4 )  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ N O N E                         0 x 4 0 0 0 0 0 0                 / /   2 7   b y   u n i t   " n o n e "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ P E R C E N T                   0 x 8 0 0 0 0 0 0                 / /   2 8   b y   u n i t   " p e r c e n t a g e "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ C U R R E N C Y                 0 x 1 0 0 0 0 0 0 0               / /   2 9   b y   u n i t   " c u r r e n c y "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ H O U R                         0 x 2 0 0 0 0 0 0 0               / /   3 0   b y   u n i t   " h o u r s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ J O B                           0 x 4 0 0 0 0 0 0 0               / /   3 1   b y   u n i t   " j o b s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ R I G                           0 x 8 0 0 0 0 0 0 0               / /   3 2   b y   u n i t   " d r i l l i n g   r i g s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ U S D                           0 x 1 0 0 0 0 0 0 0 0             / /   3 3   b y   u n i t   " U S D "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ P E O P L E                     0 x 2 0 0 0 0 0 0 0 0             / /   3 4   b y   u n i t   " p e o p l e "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ M O R T G A G E                 0 x 4 0 0 0 0 0 0 0 0             / /   3 5   b y   u n i t   " m o r t g a g e   l o a n s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ V O T E                         0 x 8 0 0 0 0 0 0 0 0             / /   3 6   b y   u n i t   " v o t e s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ B A R R E L                     0 x 1 0 0 0 0 0 0 0 0 0           / /   3 7   b y   u n i t   " b a r r e l s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ C U B I C F E E T               0 x 2 0 0 0 0 0 0 0 0 0           / /   3 8   b y   u n i t   " c u b i c   f e e t "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ P O S I T I O N                 0 x 4 0 0 0 0 0 0 0 0 0           / /   3 9   b y   u n i t   " n e t   p o s i t i o n s "  
 # d e f i n e   F I L T E R _ B Y _ U N I T _ B U I L D I N G                 0 x 8 0 0 0 0 0 0 0 0 0           / /   4 0   b y   u n i t   " b u i l d i n g s "  
 / / - - -   6 )   m u l t i p l i e r   ( 5 )  
 # d e f i n e   F I L T E R _ B Y _ M U L T I P L I E R _ N O N E             0 x 1 0 0 0 0 0 0 0 0 0 0         / /   4 1   b y   m u l t i p l i e r   " n o n e "  
 # d e f i n e   F I L T E R _ B Y _ M U L T I P L I E R _ T H O U S A N D S   0 x 2 0 0 0 0 0 0 0 0 0 0         / /   4 2   b y   m u l t i p l i e r   " t h o u s a n d s "  
 # d e f i n e   F I L T E R _ B Y _ M U L T I P L I E R _ M I L L I O N S     0 x 4 0 0 0 0 0 0 0 0 0 0         / /   4 3   b y   m u l t i p l i e r   " m i l l i o n s "  
 # d e f i n e   F I L T E R _ B Y _ M U L T I P L I E R _ B I L L I O N S     0 x 8 0 0 0 0 0 0 0 0 0 0         / /   4 4   b y   m u l t i p l i e r   " b i l l i o n s "  
 # d e f i n e   F I L T E R _ B Y _ M U L T I P L I E R _ T R I L L I O N S   0 x 1 0 0 0 0 0 0 0 0 0 0 0       / /   4 5   b y   m u l t i p l i e r   " t r i l l i o n s "  
 / / - - -   7 )   t i m e   m o d e   ( 4 )  
 # d e f i n e   F I L T E R _ B Y _ T I M E M O D E _ D A T E T I M E         0 x 2 0 0 0 0 0 0 0 0 0 0 0       / /   4 6   b y   t i m e   m o d e   " n a "  
 # d e f i n e   F I L T E R _ B Y _ T I M E M O D E _ D A T E                 0 x 4 0 0 0 0 0 0 0 0 0 0 0       / /   4 7   b y   t i m e   m o d e   " p o s i t i v e "  
 # d e f i n e   F I L T E R _ B Y _ T I M E M O D E _ N O T I M E             0 x 8 0 0 0 0 0 0 0 0 0 0 0       / /   4 8   b y   t i m e   m o d e   " n e g a t i v e "  
 # d e f i n e   F I L T E R _ B Y _ T I M E M O D E _ T E N T A T I V E       0 x 1 0 0 0 0 0 0 0 0 0 0 0 0     / /   4 9   b y   t i m e   m o d e   " t e n t a t i v e "  
 / / - - -   t y p e  
 # d e f i n e   I S _ T Y P E _ E V E N T ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T Y P E _ E V E N T ) ! = 0 )  
 # d e f i n e   I S _ T Y P E _ I N D I C A T O R ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T Y P E _ I N D I C A T O R ) ! = 0 )  
 # d e f i n e   I S _ T Y P E _ H O L I D A Y ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T Y P E _ H O L I D A Y ) ! = 0 )  
 / / - - -   s e c t o r  
 # d e f i n e   I S _ S E C T O R _ N O N E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ N O N E ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ M A R K E T ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ M A R K E T ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ G D P ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ G D P ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ J O B S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ J O B S ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ P R I C E S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ P R I C E S ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ M O N E Y ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ M O N E Y ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ T R A D E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ T R A D E ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ C O N S U M E R ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ C O N S U M E R ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ H O U S I N G ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ H O U S I N G ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ T A X E S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ T A X E S ) ! = 0 )  
 # d e f i n e   I S _ S E C T O R _ H O L I D A Y S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ S E C T O R _ H O L I D A Y S ) ! = 0 )  
 / / - - -   f r e q u e n c y  
 # d e f i n e   I S _ F R E Q U E N C Y _ N O N E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ F R E Q U E N C Y _ N O N E ) ! = 0 )  
 # d e f i n e   I S _ F R E Q U E N C Y _ W E E K ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ F R E Q U E N C Y _ W E E K ) ! = 0 )  
 # d e f i n e   I S _ F R E Q U E N C Y _ M O N T H ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ F R E Q U E N C Y _ M O N T H ) ! = 0 )  
 # d e f i n e   I S _ F R E Q U E N C Y _ Q U A R T E R ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ F R E Q U E N C Y _ Q U A R T E R ) ! = 0 )  
 # d e f i n e   I S _ F R E Q U E N C Y _ Y E A R ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ F R E Q U E N C Y _ Y E A R ) ! = 0 )  
 # d e f i n e   I S _ F R E Q U E N C Y _ D A Y ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ F R E Q U E N C Y _ D A Y ) ! = 0 )  
 / / - - -   i m p o r t a n c e  
 # d e f i n e   I S _ I M P O R T A N C E _ N O N E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ I M P O R T A N C E _ N O N E ) ! = 0 )  
 # d e f i n e   I S _ I M P O R T A N C E _ L O W ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ I M P O R T A N C E _ L O W ) ! = 0 )  
 # d e f i n e   I S _ I M P O R T A N C E _ M O D E R A T E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ I M P O R T A N C E _ M O D E R A T E ) ! = 0 )  
 # d e f i n e   I S _ I M P O R T A N C E _ H I G H ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ I M P O R T A N C E _ H I G H ) ! = 0 )  
 / / - - -   u n i t  
 # d e f i n e   I S _ U N I T _ N O N E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ N O N E ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ P E R C E N T ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ P E R C E N T ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ C U R R E N C Y ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ C U R R E N C Y ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ H O U R ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ H O U R ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ J O B ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ J O B ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ R I G ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ R I G ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ U S D ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ U S D ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ P E O P L E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ P E O P L E ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ M O R T G A G E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ M O R T G A G E ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ V O T E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ V O T E ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ B A R R E L ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ B A R R E L ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ C U B I C F E E T ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ C U B I C F E E T ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ P O S I T I O N ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ P O S I T I O N ) ! = 0 )  
 # d e f i n e   I S _ U N I T _ B U I L D I N G ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ U N I T _ B U I L D I N G ) ! = 0 )  
 / / - - -   m u l t i p l i e r  
 # d e f i n e   I S _ M U L T I P L I E R _ N O N E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ M U L T I P L I E R _ N O N E ) ! = 0 )  
 # d e f i n e   I S _ M U L T I P L I E R _ T H O U S A N D S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ M U L T I P L I E R _ T H O U S A N D S ) ! = 0 )  
 # d e f i n e   I S _ M U L T I P L I E R _ M I L L I O N S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ M U L T I P L I E R _ M I L L I O N S ) ! = 0 )  
 # d e f i n e   I S _ M U L T I P L I E R _ B I L L I O N S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ M U L T I P L I E R _ B I L L I O N S ) ! = 0 )  
 # d e f i n e   I S _ M U L T I P L I E R _ T R I L L I O N S ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ M U L T I P L I E R _ T R I L L I O N S ) ! = 0 )  
 / / - - -   t i m e   m o d e  
 # d e f i n e   I S _ T I M E M O D E _ D A T E T I M E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T I M E M O D E _ D A T E T I M E ) ! = 0 )  
 # d e f i n e   I S _ T I M E M O D E _ D A T E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T I M E M O D E _ D A T E ) ! = 0 )  
 # d e f i n e   I S _ T I M E M O D E _ N O T I M E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T I M E M O D E _ N O T I M E ) ! = 0 )  
 # d e f i n e   I S _ T I M E M O D E _ T E N T A T I V E ( f i l t e r )   ( ( f i l t e r & F I L T E R _ B Y _ T I M E M O D E _ T E N T A T I V E ) ! = 0 )  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C a l e n d a r   v a l u e   t y p e                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 e n u m   E N U M _ C A L E N D A R _ V A L U E _ T Y P E  
   {  
     C A L E N D A R _ V A L U E _ T Y P E _ A C T U A L   =   0 ,                       / /   a c t u a l  
     C A L E N D A R _ V A L U E _ T Y P E _ P R E V I O U S   =   1 ,                   / /   p r e v i o u s  
     C A L E N D A R _ V A L U E _ T Y P E _ R E V I S E D _ P R E V I O U S   =   2 ,   / /   r e v i s e d   p r e v i o u s  
     C A L E N D A R _ V A L U E _ T Y P E _ F O R E C A S T   =   3 ,                   / /   f o r e c a s t  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T i m e   s e r i e s   o b s e r v a t i o n   s t r u c t u r e                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r u c t   S i T s O b s e r v a t i o n  
   {  
     d a t e t i m e                       t i m e ;   / /   t i m e s t a m p  
     d o u b l e                           v a l ;     / /   v a l u e  
     / / - - -   c o n s t r u c t o r  
     v o i d                               S i T s O b s e r v a t i o n ( v o i d ) :   t i m e ( 0 ) ,   v a l ( E M P T Y _ V A L U E )   { }  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   T i m e   s e r i e s   s t r u c t u r e                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r u c t   S i T i m e S e r i e s  
   {  
 p r i v a t e :  
     b o o l                               i n i t ;                 / /   i s   i n i t i a l i z e d ?  
     u i n t                               s i z e ;  
     d a t e t i m e                       t i m e v a l s [ ] ;     / /   t i m e   v a l u e s  
     d o u b l e                           d a t a v a l s [ ] ;     / /   d a t a   v a l u e s  
     s t r i n g                           n a m e ;                 / /   t s   n a m e  
 p u b l i c :  
     / / - - -   c o n s t r u c t o r  
     v o i d                               S i T i m e S e r i e s ( v o i d ) ;  
     / / - - -   d e s t r u c t o r  
     v o i d                             ~ S i T i m e S e r i e s ( v o i d ) ;  
     / / - - -   c o p y   c o n s r u c t o r  
     v o i d                               S i T i m e S e r i e s ( c o n s t   S i T i m e S e r i e s   & s r c _ t s ) ;  
     / / - - -   a s s i g n m e n t   o p e r a t o r  
     v o i d                               o p e r a t o r = ( c o n s t   S i T i m e S e r i e s   & s r c _ t s ) ;  
     / / - - -   e q u a l i t y   o p e r a t o r  
     b o o l                               o p e r a t o r = = ( c o n s t   S i T i m e S e r i e s   & s r c _ t s ) ;  
     / / - - -   i n d e x i n g   o p e r a t o r  
     S i T s O b s e r v a t i o n         o p e r a t o r [ ] ( c o n s t   u i n t   i d x )   c o n s t ;  
     / / - - -   i n i t i a l i z a t i o n  
     b o o l                               I n i t ( d a t e t i m e   & t s _ t i m e s [ ] ,   c o n s t   d o u b l e   & t s _ v a l u e s [ ] ,  
                                                     c o n s t   s t r i n g   t s _ n a m e ) ;  
     / / - - -   g e t   s e r i e s   p r o p e r t i e s  
     b o o l                               G e t S e r i e s ( d a t e t i m e   & d s t _ t i m e s [ ] ,   d o u b l e   & d s t _ v a l u e s [ ] ,   s t r i n g   & d s t _ n a m e ) ;  
     b o o l                               G e t S e r i e s ( S i T s O b s e r v a t i o n   & d s t _ o b s e r v a t i o n s [ ] ,   s t r i n g   & d s t _ n a m e ) ;  
     / / - - -   s e r v i c e  
     b o o l                               I s I n i t ( v o i d )   c o n s t  
       {  
         r e t u r n   i n i t ;  
       } ;  
     u i n t                               S i z e ( v o i d )   c o n s t  
       {  
         r e t u r n   s i z e ;  
       } ;  
     v o i d                               P r i n t ( c o n s t   i n t   d i g s   =   2 ,   c o n s t   u i n t   s t e p   =   0 ) ;  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o n s t r u c t o r                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S i T i m e S e r i e s : : S i T i m e S e r i e s ( v o i d ) :  
     n a m e ( N U L L ) ,   i n i t ( f a l s e ) ,   s i z e ( W R O N G _ V A L U E )  
   {  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   D e s t r u c t o r                                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S i T i m e S e r i e s : : ~ S i T i m e S e r i e s ( v o i d )  
   {  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z a t i o n                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   S i T i m e S e r i e s : : I n i t ( d a t e t i m e   & t s _ t i m e s [ ] ,   c o n s t   d o u b l e   & t s _ v a l u e s [ ] ,  
                                                 c o n s t   s t r i n g   t s _ n a m e )  
   {  
     i n i t   =   f a l s e ;  
     i n t   v a l u e s _ s i z e   = : : A r r a y S i z e ( t s _ v a l u e s ) ;  
     i f ( v a l u e s _ s i z e   >   0 )  
         i f ( v a l u e s _ s i z e   = = : : A r r a y S i z e ( t s _ t i m e s ) )  
             i f ( : : A r r a y C o p y ( t i m e v a l s ,   t s _ t i m e s )   = =   v a l u e s _ s i z e )  
                 i f ( : : A r r a y C o p y ( d a t a v a l s ,   t s _ v a l u e s )   = =   v a l u e s _ s i z e )  
                   {  
                     n a m e   =   t s _ n a m e ;  
                     s i z e   =   v a l u e s _ s i z e ;  
                     i n i t   =   t r u e ;  
                   }  
     r e t u r n   i n i t ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o p y   c o n s r u c t o r                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S i T i m e S e r i e s : : S i T i m e S e r i e s ( c o n s t   S i T i m e S e r i e s   & s r c _ t s )  
   {  
     i n i t   =   f a l s e ;  
     i f ( s r c _ t s . I s I n i t ( ) )  
       {  
         u i n t   s r c _ t s _ s i z e   =   s r c _ t s . S i z e ( ) ;  
         i f ( : : A r r a y C o p y ( t i m e v a l s ,   s r c _ t s . t i m e v a l s )   = =   s r c _ t s _ s i z e )  
             i f ( : : A r r a y C o p y ( d a t a v a l s ,   s r c _ t s . d a t a v a l s )   = =   s r c _ t s _ s i z e )  
               {  
                 n a m e   =   s r c _ t s . n a m e ;  
                 s i z e   =   s r c _ t s _ s i z e ;  
                 i n i t   =   t r u e ;  
               }  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A s s i g n m e n t   o p e r a t o r                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S i T i m e S e r i e s : : o p e r a t o r = ( c o n s t   S i T i m e S e r i e s   & s r c _ t s )  
   {  
     i f ( ! ( t h i s   = =   s r c _ t s ) )  
       {  
         i n i t   =   f a l s e ;  
         i f ( s r c _ t s . I s I n i t ( ) )  
           {  
             u i n t   s r c _ t s _ s i z e   =   s r c _ t s . S i z e ( ) ;  
             i f ( s r c _ t s _ s i z e   <   s i z e )  
               {  
                 i f ( : : A r r a y R e s i z e ( t i m e v a l s ,   s r c _ t s _ s i z e )   ! =   s r c _ t s _ s i z e )  
                     r e t u r n ;  
                 i f ( : : A r r a y R e s i z e ( d a t a v a l s ,   s r c _ t s _ s i z e )   ! =   s r c _ t s _ s i z e )  
                     r e t u r n ;  
               }  
             i f ( : : A r r a y C o p y ( t i m e v a l s ,   s r c _ t s . t i m e v a l s )   = =   s r c _ t s _ s i z e )  
                 i f ( : : A r r a y C o p y ( d a t a v a l s ,   s r c _ t s . d a t a v a l s )   = =   s r c _ t s _ s i z e )  
                   {  
                     n a m e   =   s r c _ t s . n a m e ;  
                     s i z e   =   s r c _ t s _ s i z e ;  
                     i n i t   =   t r u e ;  
                   }  
           }  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E q u a l i t y   o p e r a t o r                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   S i T i m e S e r i e s : : o p e r a t o r = = ( c o n s t   S i T i m e S e r i e s   & s r c _ t s )  
   {  
     i f ( i n i t   ! =   s r c _ t s . i n i t )  
         r e t u r n   f a l s e ;  
     i f ( s r c _ t s . i n i t )  
       {  
         i f ( s i z e   ! =   s r c _ t s . s i z e )  
             r e t u r n   f a l s e ;  
         i f ( : : S t r i n g C o m p a r e ( n a m e ,   s r c _ t s . n a m e ) )  
             r e t u r n   f a l s e ;  
         f o r ( u i n t   t s _ i d x   =   0 ;   t s _ i d x   <   s i z e ;   t s _ i d x + + )  
           {  
             i f ( t i m e v a l s [ t s _ i d x ]   ! =   s r c _ t s . t i m e v a l s [ t s _ i d x ] )  
                 r e t u r n   f a l s e ;  
             i f ( d a t a v a l s [ t s _ i d x ]   ! =   s r c _ t s . d a t a v a l s [ t s _ i d x ] )  
                 r e t u r n   f a l s e ;  
           }  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n d e x i n g   o p e r a t o r                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 S i T s O b s e r v a t i o n   S i T i m e S e r i e s : : o p e r a t o r [ ] ( c o n s t   u i n t   i d x )   c o n s t  
   {  
     S i T s O b s e r v a t i o n   r e s ( ) ;  
     i f ( i n i t )  
         i f ( i d x   <   s i z e )  
           {  
             r e s . t i m e   =   t i m e v a l s [ i d x ] ;  
             r e s . v a l   =   d a t a v a l s [ i d x ] ;  
           }  
     r e t u r n   r e s ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   s e r i e s   p r o p e r t i e s                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   S i T i m e S e r i e s : : G e t S e r i e s ( d a t e t i m e   & d s t _ t i m e s [ ] ,   d o u b l e   & d s t _ v a l u e s [ ] ,   s t r i n g   & d s t _ n a m e )  
   {  
     i f ( i n i t )  
         i f ( : : A r r a y R e s i z e ( d s t _ t i m e s ,   s i z e )   = =   s i z e )  
             i f ( : : A r r a y R e s i z e ( d s t _ v a l u e s ,   s i z e )   = =   s i z e )  
               {  
                 f o r ( u i n t   t s _ i d x   =   0 ;   t s _ i d x   <   s i z e ;   t s _ i d x + + )  
                   {  
                     d s t _ t i m e s [ t s _ i d x ]   =   t i m e v a l s [ t s _ i d x ] ;  
                     d s t _ v a l u e s [ t s _ i d x ]   =   d a t a v a l s [ t s _ i d x ] ;  
                   }  
                 d s t _ n a m e   =   n a m e ;  
                 r e t u r n   t r u e ;  
               }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   s e r i e s   p r o p e r t i e s                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   S i T i m e S e r i e s : : G e t S e r i e s ( S i T s O b s e r v a t i o n   & d s t _ o b s e r v a t i o n s [ ] ,   s t r i n g   & d s t _ n a m e )  
   {  
     i f ( i n i t )  
         i f ( : : A r r a y R e s i z e ( d s t _ o b s e r v a t i o n s ,   s i z e )   = =   s i z e )  
           {  
             f o r ( u i n t   t s _ i d x   =   0 ;   t s _ i d x   <   s i z e ;   t s _ i d x + + )  
               {  
                 d s t _ o b s e r v a t i o n s [ t s _ i d x ] . t i m e   =   t i m e v a l s [ t s _ i d x ] ;  
                 d s t _ o b s e r v a t i o n s [ t s _ i d x ] . v a l   =   d a t a v a l s [ t s _ i d x ] ;  
               }  
             d s t _ n a m e   =   n a m e ;  
             r e t u r n   t r u e ;  
           }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   P r i n t   t i m e   s e r i e s                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S i T i m e S e r i e s : : P r i n t ( c o n s t   i n t   d i g s   =   2 ,   c o n s t   u i n t   s t e p   =   0 )  
   {  
     i f ( i n i t )  
       {  
         s t r i n g   t i t l e _ t o _ p r i n t   =   " \ n - - - = =   T i m e s   s e r i e s   = = - - - " ;  
         i f ( n a m e   ! =   N U L L )  
             t i t l e _ t o _ p r i n t   = : : S t r i n g F o r m a t ( " \ n - - - = =   T i m e s   s e r i e s   -   % s = = - - - " ,   n a m e ) ;  
         : : P r i n t ( t i t l e _ t o _ p r i n t ) ;  
         f o r ( u i n t   t s _ i d x   =   0 ;   t s _ i d x   <   s i z e ;   t s _ i d x   + =   s t e p   +   1 )  
           {  
             s t r i n g   t i m e _ s t r ,   d a t a _ s t r ;  
             t i m e _ s t r   =   : : T i m e T o S t r i n g ( t i m e v a l s [ t s _ i d x ] ) ;  
             i f ( d a t a v a l s [ t s _ i d x ]   = =   E M P T Y _ V A L U E )  
                 d a t a _ s t r   =   " E M P T Y _ V A L U E " ;  
             e l s e  
                 d a t a _ s t r   =   : : D o u b l e T o S t r i n g ( d a t a v a l s [ t s _ i d x ] ,   d i g s ) ;  
             : : P r i n t F o r m a t ( " [ % d ] :   t i m e   -   % s ,   v a l u e   -   % s " ,   t s _ i d x   +   1 ,   t i m e _ s t r ,   d a t a _ s t r ) ;  
           }  
       }  
     e l s e  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _ " :   f a i l e d   t o   p r i n t   T S .   I t   i s   n o t   i n i t i a l i z e d ! " ) ;  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C l a s s   C C a l e n d a r I n f o .                                                                                           |  
 / / |   A p p o i n t m e n t :   C l a s s   f o r   a c c e s s   t o   c a l e n d a r   i n f o .                                     |  
 / / |                             D e r i v e s   f r o m   c l a s s   C O b j e c t .                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C C a l e n d a r I n f o   :   p u b l i c   C O b j e c t  
   {  
     / / - - -   = = =   D a t a   m e m b e r s   = = =   - - -  
 p r o t e c t e d :  
     s t r i n g                           m _ c u r r e n c y ;  
     u l o n g                             m _ c o u n t r y _ i d ;  
     M q l C a l e n d a r C o u n t r y   m _ c o u n t r y _ d e s c r i p t i o n ;  
     u l o n g                             m _ e v e n t _ i d ;  
     M q l C a l e n d a r E v e n t       m _ e v e n t _ d e s c r i p t i o n ;  
     s t a t i c   M q l C a l e n d a r C o u n t r y   m _ c o u n t r i e s [ ] ;  
     b o o l                               m _ i s _ i n i t ;  
     / / - - -   = = =   M e t h o d s   = = =   - - -  
 p u b l i c :  
     / / - - -   c o n s t r u c t o r / d e s t r u c t o r  
     v o i d                               C C a l e n d a r I n f o ( v o i d ) ;  
     v o i d                             ~ C C a l e n d a r I n f o ( v o i d )   { } ;  
     / / - - -   i n i t i a l i z a t i o n  
     b o o l                       I n i t  
     (  
         c o n s t   s t r i n g   c u r r e n c y   =   N U L L ,                   / /   c o u n t r y   c u r r e n c y   c o d e   n a m e  
         c o n s t   u l o n g   c o u n t r y _ i d   =   W R O N G _ V A L U E ,   / /   c o u n t r y   I D  
         c o n s t   u l o n g   e v e n t _ i d   =   W R O N G _ V A L U E ,       / /   e v e n t   I D  
         c o n s t   b o o l   t o _ l o g   =   f a l s e                           / /   t o   l o g ?  
     ) ;  
     v o i d                               D e i n i t ( v o i d ) ;  
     / / - - -   !a l e n d a r   s t r u c t u r e s   d e s c r i p t i o n s  
     b o o l                               C o u n t r y D e s c r i p t i o n ( M q l C a l e n d a r C o u n t r y   & c o u n t r y ,   c o n s t   b o o l   t o _ l o g   =   f a l s e ) ;  
     b o o l                               E v e n t D e s c r i p t i o n ( M q l C a l e n d a r E v e n t   & e v e n t ,   c o n s t   b o o l   t o _ l o g   =   f a l s e ) ;  
     s t a t i c   b o o l                 V a l u e D e s c r i p t i o n ( u l o n g   v a l u e _ i d ,   M q l C a l e n d a r V a l u e   & v a l u e ,  
                                                                             c o n s t   b o o l   t o _ l o g   =   f a l s e ) ;  
     b o o l                               E v e n t s B y C o u n t r y D e s c r i p t i o n ( M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,   c o n s t   b o o l   t o _ l o g   =   f a l s e ) ;  
     b o o l                               E v e n t s B y C u r r e n c y D e s c r i p t i o n ( M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,   c o n s t   b o o l   t o _ l o g   =   f a l s e ) ;  
     b o o l                               E v e n t s B y S e c t o r ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   e v e n t _ s e c t o r ,  
                                                                         M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,   c o n s t   b o o l   t o _ l o g   =   f a l s e ) ;  
     / / - - -   !a l e n d a r   e n u m   d e s c r i p t i o n s  
     s t a t i c   s t r i n g             E v e n t T y p e D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ T Y P E   e v e n t _ t y p e ) ;  
     s t a t i c   s t r i n g             E v e n t S e c t o r D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   e v e n t _ s e c t o r ,   c o n s t   b o o l   i s _ l o n g _ f o r m   =   t r u e ) ;  
     s t a t i c   s t r i n g             E v e n t F r e q u e n c y D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ F R E Q U E N C Y   e v e n t _ f r e q u e n c y ) ;  
     s t a t i c   s t r i n g             E v e n t T i m e M o d e D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ T I M E M O D E   e v e n t _ t i m e _ m o d e ) ;  
     s t a t i c   s t r i n g             E v e n t U n i t D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ U N I T   e v e n t _ u n i t ) ;  
     s t a t i c   s t r i n g             E v e n t I m p o r t a n c e D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ I M P O R T A N C E   e v e n t _ i m p o r t a n c e ) ;  
     s t a t i c   s t r i n g             E v e n t M u l t i p l i e r D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ M U L T I P L I E R   e v e n t _ m u l t i p l i e r ) ;  
     s t a t i c   s t r i n g             V a l u e I m p a c t D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ I M P A C T   e v e n t _ i m p a c t ) ;  
     / / - - -   h i s t o r y  
     b o o l                       V a l u e H i s t o r y S e l e c t B y C o u n t r y  
     (  
         M q l C a l e n d a r V a l u e   & v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     )                                     c o n s t ;  
     b o o l                       V a l u e H i s t o r y S e l e c t B y E v e n t  
     (  
         M q l C a l e n d a r V a l u e   & v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     )                                     c o n s t ;  
     b o o l                       V a l u e H i s t o r y S e l e c t B y E v e n t  
     (  
         S i T i m e S e r i e s   & d s t _ t s ,               / /   t i m e s e r i e s   f o r   v a l u e   d e s c r i p t i o n s  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     ) ;  
     b o o l                       V a l u e H i s t o r y S e l e c t B y E v e n t  
     (  
         S i T i m e S e r i e s   & d s t _ t s ,               / /   t i m e s e r i e s   f o r   v a l u e   d e s c r i p t i o n s  
         c o n s t   E N U M _ C A L E N D A R _ V A L U E _ T Y P E   v a l _ t y p e ,  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     ) ;  
     b o o l                       V a l u e H i s t o r y S e l e c t  
     (  
         M q l C a l e n d a r V a l u e   & v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     )                                     c o n s t ;  
     b o o l                       V a l u e H i s t o r y S e l e c t  
     (  
         S i T i m e S e r i e s   & d s t _ t s [ ] ,           / /   a r r a y   o f   t i m e s e r i e s   f o r   v a l u e   d e s c r i p t i o n s  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     ) ;  
     s t a t i c   b o o l         V a l u e H i s t o r y S e l e c t A l l  
     (  
         M q l C a l e n d a r V a l u e   & v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
         d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
         d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
     ) ;  
     / / - - -   t h e   c a l e n d a r   d a t a b a s e   s t a t u s  
     i n t                         V a l u e L a s t S e l e c t B y E v e n t  
     (  
         u l o n g &                               c h a n g e _ i d ,           / /   C a l e n d a r   c h a n g e   I D  
         M q l C a l e n d a r V a l u e &         v a l u e s [ ]               / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
     )                                     c o n s t ;  
     i n t                         V a l u e L a s t S e l e c t  
     (  
         u l o n g &                               c h a n g e _ i d ,           / /   C a l e n d a r   c h a n g e   I D  
         M q l C a l e n d a r V a l u e &         v a l u e s [ ]               / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
     )                                     c o n s t ;  
     s t a t i c   i n t           V a l u e L a s t S e l e c t A l l  
     (  
         u l o n g &                               c h a n g e _ i d ,           / /   C a l e n d a r   c h a n g e   I D  
         M q l C a l e n d a r V a l u e &         v a l u e s [ ]               / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
     ) ;  
     / / - - -   c u r r e n c i e s  
     b o o l                               G e t U n i q u e C u r r e n c i e s ( s t r i n g   & c u r r e n c i e s [ ] ,   c o n s t   b o o l   i s _ u p p e r   =   t r u e ) ;  
  
     / / - - -   c o u n t r i e s   a n d   c o n t i n e n t s  
     b o o l                               G e t C o u n t r i e s ( C A r r a y S t r i n g   & c o u n t r i e s _ a r r ) ;  
     b o o l                               G e t C o u n t r i e s ( M q l C a l e n d a r C o u n t r y   & c o u n t r i e s [ ] ) ;  
     b o o l                               G e t U n i q u e C o n t i n e n t s ( s t r i n g   & c o n t i n e n t s [ ] ) ;  
     b o o l                               G e t C o u n t r i e s B y C o n t i n e n t ( c o n s t   E N U M _ C O N T I N E N T   s r c _ c o n t i n e n t ,  
             C A r r a y S t r i n g   & c o u n t r i e s _ a r r ,  
             c o n s t   b o o l   i s _ c o u n t r y _ f l a g   =   f a l s e ) ;  
  
     s t r i n g                           G e t C o u n t r y N a m e B y I d ( c o n s t   u l o n g   c o u n t r y _ i d ,   c o n s t   b o o l   i s _ c o u n t r y _ f l a g   =   f a l s e ) ;  
     s t r i n g                           G e t C o u n t r y C o d e B y I d ( c o n s t   u l o n g   c o u n t r y _ i d ) ;  
     / / - - -   e v e n t s  
     b o o l                               G e t E v e n t s B y N a m e ( C A r r a y S t r i n g   & e v e n t s _ a r r ,   c o n s t   s t r i n g   n a m e   =   N U L L ) ;  
     b o o l                               G e t E v e n t s B y N a m e ( M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,   c o n s t   s t r i n g   n a m e   =   N U L L ) ;  
     s t a t i c   b o o l                 F i l t e r E v e n t s B y A n y ( M q l C a l e n d a r E v e n t   & f i l t e r e d _ e v e n t s [ ] ,  
                                                                               M q l C a l e n d a r E v e n t   & s r c _ e v e n t s [ ] ,   c o n s t   u l o n g   f i l t e r ) ;  
     s t a t i c   b o o l                 F i l t e r E v e n t s B y A l l ( M q l C a l e n d a r E v e n t   & f i l t e r e d _ e v e n t s [ ] ,  
                                                                               M q l C a l e n d a r E v e n t   & s r c _ e v e n t s [ ] ,   c o n s t   u l o n g   f i l t e r ) ;  
     s t a t i c   b o o l                 G e t U n i q u e S e c t o r s ( s t r i n g   & s e c t o r s [ ] ,   c o n s t   M q l C a l e n d a r E v e n t   & s r c _ e v e n t s [ ] ) ;  
     b o o l                               G e t E v e n t s B y S e c t o r ( C A r r a y S t r i n g   & e v e n t s _ a r r ,  
                                                                               c o n s t   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   e v e n t _ s e c t o r ) ;  
     s t a t i c   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   G e t S e c t o r B y N a m e ( c o n s t   s t r i n g   s e c t o r _ n a m e ) ;  
     / / - - -   p r i n t  
     s t a t i c   v o i d                 P r i n t C o u n t r y D e s c r i p t i o n ( c o n s t   M q l C a l e n d a r C o u n t r y   & c o u n t r y ) ;  
     s t a t i c   v o i d                 P r i n t E v e n t D e s c r i p t i o n ( c o n s t   M q l C a l e n d a r E v e n t   & e v e n t ) ;  
     s t a t i c   v o i d                 P r i n t V a l u e D e s c r i p t i o n ( c o n s t   M q l C a l e n d a r V a l u e   & v a l u e ) ;  
     / / - - -  
 p r i v a t e :  
     b o o l                               V a l i d a t e P r o p e r t i e s ( v o i d ) ;  
     b o o l                               C o u n t r y B y I d ( c o n s t   u l o n g   c o u n t r y _ i d ) ;  
     b o o l                               E v e n t I d ( v o i d ) ;  
   } ;  
 M q l C a l e n d a r C o u n t r y   C C a l e n d a r I n f o : : m _ c o u n t r i e s [ ] ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o n s t r u c t o r                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C C a l e n d a r I n f o : : C C a l e n d a r I n f o ( v o i d )  
   {  
     m _ c u r r e n c y   =   N U L L ;  
     m _ c o u n t r y _ i d   =   m _ e v e n t _ i d   =   W R O N G _ V A L U E ;  
     : : Z e r o M e m o r y ( m _ c o u n t r y _ d e s c r i p t i o n ) ;  
     : : Z e r o M e m o r y ( m _ e v e n t _ d e s c r i p t i o n ) ;  
     m _ i s _ i n i t   =   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z a t i o n                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : I n i t ( c o n s t   s t r i n g   c u r r e n c y   =   N U L L ,                   / /   c o u n t r y   c u r r e n c y   c o d e   n a m e  
                                                   c o n s t   u l o n g   c o u n t r y _ i d   =   W R O N G _ V A L U E ,   / /   c o u n t r y   I D  
                                                   c o n s t   u l o n g   e v e n t _ i d   =   W R O N G _ V A L U E ,       / /   e v e n t   I D  
                                                   c o n s t   b o o l   t o _ l o g   =   f a l s e                           / /   t o   l o g ?  
                                                 )  
   {  
 / / - - -   c h e c k   r e i n i t i a l i z a t i o n  
     i f ( m _ i s _ i n i t )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C C a l e n d a r I n f o   o b j e c t   a l r e a d y   i n i t i a l i z e d ! " ) ;  
         r e t u r n   f a l s e ;  
       }  
 / / - - -   c h e c k   c o u n t r i e s  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     i f ( c o u n t r i e s _ c n t   <   1 )  
       {  
         : : R e s e t L a s t E r r o r ( ) ;  
         c o u n t r i e s _ c n t   =   : : C a l e n d a r C o u n t r i e s ( m _ c o u n t r i e s ) ;  
         i f ( c o u n t r i e s _ c n t   <   1 )  
           {  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r C o u n t r i e s ( )   r e t u r n e d   0 !   E r r o r   % d " ,  
                                         : : G e t L a s t E r r o r ( ) ) ;  
             r e t u r n   f a l s e ;  
           }  
       }  
     f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
       {  
         M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
         / / - - -   c h e c k   c u r r e n c y  
         i f ( ! : : S t r i n g C o m p a r e ( c u r r _ c o u n t r y . c u r r e n c y ,   c u r r e n c y ) )  
           {  
             m _ c u r r e n c y   =   c u r r e n c y ;  
           }  
         / / - - -   c h e c k   c o u n t r y  
         i f ( c o u n t r y _ i d   ! =   W R O N G _ V A L U E )  
             i f ( c u r r _ c o u n t r y . i d   = =   c o u n t r y _ i d )  
               {  
                 m _ c o u n t r y _ i d   =   c o u n t r y _ i d ;  
               }  
       }  
 / / - - -   c h e c k   e v e n t  
     i f ( e v e n t _ i d   ! =   W R O N G _ V A L U E )  
       {  
         m _ e v e n t _ i d   =   e v e n t _ i d ;  
       }  
 / / - - -   v a l i d a t e   p r o p e r t i e s  
     i f ( ! t h i s . V a l i d a t e P r o p e r t i e s ( ) )  
         r e t u r n   f a l s e ;  
 / / - - -  
     i f ( t o _ l o g )  
       {  
         : : P r i n t ( " \ n - - - = =   N e w   C a l e n d a r   I n f o   o b j e c t   = = - - - " ) ;  
         i f ( m _ c u r r e n c y   ! =   N U L L )  
             : : P r i n t F o r m a t ( "       C u r r e n c y :   % s " ,   m _ c u r r e n c y ) ;  
         i f ( m _ c o u n t r y _ i d   ! =   W R O N G _ V A L U E )  
             : : P r i n t F o r m a t ( "       C o u n t r y   i d :   % I 6 4 u " ,   m _ c o u n t r y _ i d ) ;  
         i f ( m _ e v e n t _ i d   ! =   W R O N G _ V A L U E )  
             : : P r i n t F o r m a t ( "       E v e n t   i d :   % I 6 4 u " ,   m _ e v e n t _ i d ) ;  
       }  
     m _ i s _ i n i t   =   t r u e ;  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   D e i n i t i a l i z a t i o n                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C C a l e n d a r I n f o : : D e i n i t ( v o i d )  
   {  
     m _ c u r r e n c y   =   N U L L ;  
     m _ c o u n t r y _ i d   =   m _ e v e n t _ i d   =   W R O N G _ V A L U E ;  
     : : Z e r o M e m o r y ( m _ c o u n t r y _ d e s c r i p t i o n ) ;  
     : : Z e r o M e m o r y ( m _ e v e n t _ d e s c r i p t i o n ) ;  
     m _ i s _ i n i t   =   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   a   c o u n t r y   d e s c r i p t i o n   b y   i t s   I D                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : C o u n t r y D e s c r i p t i o n ( M q l C a l e n d a r C o u n t r y   & c o u n t r y ,  
                                                                               c o n s t   b o o l   t o _ l o g   =   f a l s e )  
   {  
     i f ( m _ c o u n t r y _ d e s c r i p t i o n . i d   ! =   W R O N G _ V A L U E )  
       {  
         c o u n t r y   =   m _ c o u n t r y _ d e s c r i p t i o n ;  
         i f ( t o _ l o g )  
             t h i s . P r i n t C o u n t r y D e s c r i p t i o n ( c o u n t r y ) ;  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   a n   e v e n t   d e s c r i p t i o n   b y   i t s   I D                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : E v e n t D e s c r i p t i o n ( M q l C a l e n d a r E v e n t   & e v e n t ,   c o n s t   b o o l   t o _ l o g   =   f a l s e )  
   {  
     i f ( m _ e v e n t _ d e s c r i p t i o n . i d   ! =   W R O N G _ V A L U E )  
       {  
         e v e n t   =   m _ e v e n t _ d e s c r i p t i o n ;  
         i f ( t o _ l o g )  
             t h i s . P r i n t E v e n t D e s c r i p t i o n ( e v e n t ) ;  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   a   v a l u e   d e s c r i p t i o n   b y   i t s   I D                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   b o o l   C C a l e n d a r I n f o : : V a l u e D e s c r i p t i o n ( u l o n g   v a l u e _ i d ,   M q l C a l e n d a r V a l u e &   v a l u e ,  
         c o n s t   b o o l   t o _ l o g   =   f a l s e )  
   {  
     : : R e s e t L a s t E r r o r ( ) ;  
     i f ( ! : : C a l e n d a r V a l u e B y I d ( v a l u e _ i d ,   v a l u e ) )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e B y I d ( )   f a i l e d !   E r r o r   % d " ,  
                                     : : G e t L a s t E r r o r ( ) ) ;  
         r e t u r n   f a l s e ;  
       }  
     i f ( t o _ l o g )  
         C C a l e n d a r I n f o : : P r i n t V a l u e D e s c r i p t i o n ( v a l u e ) ;  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   t h e   a r r a y   o f   d e s c r i p t i o n s   o f   a l l   e v e n t s   b y   a   s p e c i f i e d   c o u n t r y     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : E v e n t s B y C o u n t r y D e s c r i p t i o n ( M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,  
         c o n s t   b o o l   t o _ l o g   =   f a l s e )  
   {  
     i f ( m _ c o u n t r y _ d e s c r i p t i o n . i d   ! =   W R O N G _ V A L U E )  
       {  
         s t r i n g   c o u n t r y _ c o d e   =   m _ c o u n t r y _ d e s c r i p t i o n . c o d e ;  
         : : R e s e t L a s t E r r o r ( ) ;  
         i f ( ! : : C a l e n d a r E v e n t B y C o u n t r y ( c o u n t r y _ c o d e ,   e v e n t s ) )  
           {  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r E v e n t B y C o u n t r y ( )   f a i l e d !   E r r o r   % d " ,  
                                         : : G e t L a s t E r r o r ( ) ) ;  
             r e t u r n   f a l s e ;  
           }  
         i f ( t o _ l o g )  
             f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   : : A r r a y S i z e ( e v e n t s ) ;   e v _ i d x + + )  
               {  
                 M q l C a l e n d a r E v e n t   c u r r _ e v e n t   =   e v e n t s [ e v _ i d x ] ;  
                 t h i s . P r i n t E v e n t D e s c r i p t i o n ( c u r r _ e v e n t ) ;  
               }  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   t h e   a r r a y   o f   d e s c r i p t i o n s   o f   a l l   e v e n t s   b y   a   s p e c i f i e d   c u r r e n c y   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : E v e n t s B y C u r r e n c y D e s c r i p t i o n ( M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,  
         c o n s t   b o o l   t o _ l o g   =   f a l s e )  
   {  
     i f ( m _ c u r r e n c y   ! =   N U L L )  
       {  
         / / s t r i n g   c o u n t r y _ c o d e   =   m _ c o u n t r y _ d e s c r i p t i o n . c o d e ;  
         : : R e s e t L a s t E r r o r ( ) ;  
         i f ( ! : : C a l e n d a r E v e n t B y C u r r e n c y ( m _ c u r r e n c y ,   e v e n t s ) )  
           {  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r E v e n t B y C u r r e n c y ( )   f a i l e d !   E r r o r   % d " ,  
                                         : : G e t L a s t E r r o r ( ) ) ;  
             r e t u r n   f a l s e ;  
           }  
         i f ( t o _ l o g )  
             f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   : : A r r a y S i z e ( e v e n t s ) ;   e v _ i d x + + )  
               {  
                 M q l C a l e n d a r E v e n t   c u r r _ e v e n t   =   e v e n t s [ e v _ i d x ] ;  
                 t h i s . P r i n t E v e n t D e s c r i p t i o n ( c u r r _ e v e n t ) ;  
               }  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   t h e   a r r a y   o f   d e s c r i p t i o n s   o f   a l l   e v e n t s   b y   a   s p e c i f i e d   s e c t o r   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : E v e n t s B y S e c t o r ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   e v e n t _ s e c t o r ,  
                                                                       M q l C a l e n d a r E v e n t   & e v e n t s [ ] ,   c o n s t   b o o l   t o _ l o g   =   f a l s e )  
   {  
     i f ( m _ c o u n t r y _ d e s c r i p t i o n . i d   >   0 )  
       {  
         s t r i n g   c o u n t r y _ c o d e   =   m _ c o u n t r y _ d e s c r i p t i o n . c o d e ;  
         M q l C a l e n d a r E v e n t   t e m p _ e v e n t s [ ] ;  
         : : R e s e t L a s t E r r o r ( ) ;  
         i f ( ! : : C a l e n d a r E v e n t B y C o u n t r y ( c o u n t r y _ c o d e ,   t e m p _ e v e n t s ) )  
           {  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r E v e n t B y C o u n t r y ( )   f a i l e d !   E r r o r   % d " ,  
                                         : : G e t L a s t E r r o r ( ) ) ;  
             r e t u r n   f a l s e ;  
           }  
         f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   < : : A r r a y S i z e ( t e m p _ e v e n t s ) ;   e v _ i d x + + )  
           {  
             E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   c u r r _ e v e n t _ s e c t o r   =   t e m p _ e v e n t s [ e v _ i d x ] . s e c t o r ;  
             i f ( c u r r _ e v e n t _ s e c t o r   = =   e v e n t _ s e c t o r )  
               {  
                 i n t   e v e n t s _ s i z e   = : : A r r a y S i z e ( e v e n t s ) ;  
                 i f ( : : A r r a y R e s i z e ( e v e n t s ,   + + e v e n t s _ s i z e )   ! =   e v e n t s _ s i z e )  
                   {  
                     : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   r e s i z e   e v e n t s   a r r a y ! " ) ;  
                     r e t u r n   f a l s e ;  
                   }  
                 e v e n t s [ - - e v e n t s _ s i z e ]   =   t e m p _ e v e n t s [ e v _ i d x ] ;  
                 i f ( t o _ l o g )  
                     t h i s . P r i n t E v e n t D e s c r i p t i o n ( e v e n t s [ e v e n t s _ s i z e ] ) ;  
               }  
           }  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   t y p e   d e s c r i p t i o n                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t T y p e D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ T Y P E   e v e n t _ t y p e )  
   {  
     s t r i n g   t y p e _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ t y p e )  
       {  
         c a s e   C A L E N D A R _ T Y P E _ E V E N T :  
           {  
             t y p e _ d e s c r i p t i o n   =   " E v e n t " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ T Y P E _ I N D I C A T O R :  
           {  
             t y p e _ d e s c r i p t i o n   =   " I n d i c a t o r " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ T Y P E _ H O L I D A Y :  
           {  
             t y p e _ d e s c r i p t i o n   =   " H o l i d a y " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   t y p e _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   s e c t o r   d e s c r i p t i o n                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t S e c t o r D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   e v e n t _ s e c t o r ,  
         c o n s t   b o o l   i s _ l o n g _ f o r m   =   t r u e )  
   {  
     s t r i n g   s e c t o r _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ s e c t o r )  
       {  
         c a s e   C A L E N D A R _ S E C T O R _ N O N E :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " N o n e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ M A R K E T :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " M a r k e t " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ G D P :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " G r o s s   D o m e s t i c   P r o d u c t " ;  
             i f ( ! i s _ l o n g _ f o r m )  
                 s e c t o r _ d e s c r i p t i o n   =   " G D P " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ J O B S :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " L a b o r   m a r k e t " ;  
             i f ( ! i s _ l o n g _ f o r m )  
                 s e c t o r _ d e s c r i p t i o n   =   " L a b o r " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ P R I C E S :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " P r i c e s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ M O N E Y :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " M o n e y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ T R A D E :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " T r a d i n g " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ G O V E R N M E N T :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " G o v e r n m e n t " ;  
             i f ( ! i s _ l o n g _ f o r m )  
                 s e c t o r _ d e s c r i p t i o n   =   " G o v e r n . " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ B U S I N E S S :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " B u s i n e s s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ C O N S U M E R :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " C o n s u m p t i o n " ;  
             i f ( ! i s _ l o n g _ f o r m )  
                 s e c t o r _ d e s c r i p t i o n   =   " C o n s u m p . " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ H O U S I N G :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " H o u s i n g " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ T A X E S :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " T a x e s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ S E C T O R _ H O L I D A Y S :  
           {  
             s e c t o r _ d e s c r i p t i o n   =   " H o l i d a y s " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   s e c t o r _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   f r e q u e n c y   d e s c r i p t i o n                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t F r e q u e n c y D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ F R E Q U E N C Y   e v e n t _ f r e q u e n c y )  
   {  
     s t r i n g   f r e q _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ f r e q u e n c y )  
       {  
         c a s e   C A L E N D A R _ F R E Q U E N C Y _ N O N E :  
           {  
             f r e q _ d e s c r i p t i o n   =   " N o n e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ F R E Q U E N C Y _ W E E K :  
           {  
             f r e q _ d e s c r i p t i o n   =   " W e e k l y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ F R E Q U E N C Y _ M O N T H :  
           {  
             f r e q _ d e s c r i p t i o n   =   " M o n t h l y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ F R E Q U E N C Y _ Q U A R T E R :  
           {  
             f r e q _ d e s c r i p t i o n   =   " Q u a r t e r l y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ F R E Q U E N C Y _ Y E A R :  
           {  
             f r e q _ d e s c r i p t i o n   =   " Y e a r l y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ F R E Q U E N C Y _ D A Y :  
           {  
             f r e q _ d e s c r i p t i o n   =   " D a i l y " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   f r e q _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   t i m e   m o d e   d e s c r i p t i o n                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t T i m e M o d e D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ T I M E M O D E   e v e n t _ t i m e _ m o d e )  
   {  
     s t r i n g   t i m e _ m o d e _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ t i m e _ m o d e )  
       {  
         c a s e   C A L E N D A R _ T I M E M O D E _ D A T E T I M E :  
           {  
             t i m e _ m o d e _ d e s c r i p t i o n   =   " E x a c t   t i m e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ T I M E M O D E _ D A T E :  
           {  
             t i m e _ m o d e _ d e s c r i p t i o n   =   " T a k e s   a l l   d a y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ T I M E M O D E _ N O T I M E :  
           {  
             t i m e _ m o d e _ d e s c r i p t i o n   =   " N o   t i m e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ T I M E M O D E _ T E N T A T I V E :  
           {  
             t i m e _ m o d e _ d e s c r i p t i o n   =   " T e n t a t i v e " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   t i m e _ m o d e _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   u n i t   d e s c r i p t i o n                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t U n i t D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ U N I T   e v e n t _ u n i t )  
   {  
     s t r i n g   u n i t _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ u n i t )  
       {  
         c a s e   C A L E N D A R _ U N I T _ N O N E :  
           {  
             u n i t _ d e s c r i p t i o n   =   " N o n e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ P E R C E N T :  
           {  
             u n i t _ d e s c r i p t i o n   =   " P e r c e n t a g e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ C U R R E N C Y :  
           {  
             u n i t _ d e s c r i p t i o n   =   " N a t i o n a l   c u r r e n c y " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ H O U R :  
           {  
             u n i t _ d e s c r i p t i o n   =   " H o u r s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ J O B :  
           {  
             u n i t _ d e s c r i p t i o n   =   " J o b s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ R I G :  
           {  
             u n i t _ d e s c r i p t i o n   =   " D r i l l i n g   r i g s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ U S D :  
           {  
             u n i t _ d e s c r i p t i o n   =   " U S D " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ P E O P L E :  
           {  
             u n i t _ d e s c r i p t i o n   =   " P e o p l e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ M O R T G A G E :  
           {  
             u n i t _ d e s c r i p t i o n   =   " M o r t g a g e   l o a n s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ V O T E :  
           {  
             u n i t _ d e s c r i p t i o n   =   " V o t e s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ B A R R E L :  
           {  
             u n i t _ d e s c r i p t i o n   =   " B a r r e l s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ C U B I C F E E T :  
           {  
             u n i t _ d e s c r i p t i o n   =   " C u b i c   f e e t " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ P O S I T I O N :  
           {  
             u n i t _ d e s c r i p t i o n   =   " N o n - c o m m e r c i a l   n e t   p o s i t i o n s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ U N I T _ B U I L D I N G :  
           {  
             u n i t _ d e s c r i p t i o n   =   " B u i l d i n g s " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   u n i t _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   i m p o r t a n c e   d e s c r i p t i o n                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t I m p o r t a n c e D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ I M P O R T A N C E   e v e n t _ i m p o r t a n c e )  
   {  
     s t r i n g   i m p _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ i m p o r t a n c e )  
       {  
         c a s e   C A L E N D A R _ I M P O R T A N C E _ N O N E :  
           {  
             i m p _ d e s c r i p t i o n   =   " N o n e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ I M P O R T A N C E _ L O W :  
           {  
             i m p _ d e s c r i p t i o n   =   " L o w " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ I M P O R T A N C E _ M O D E R A T E :  
           {  
             i m p _ d e s c r i p t i o n   =   " M o d e r a t e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ I M P O R T A N C E _ H I G H :  
           {  
             i m p _ d e s c r i p t i o n   =   " H i g h " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   i m p _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E v e n t   m u l t i p l i e r   d e s c r i p t i o n                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : E v e n t M u l t i p l i e r D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ M U L T I P L I E R   e v e n t _ m u l t i p l i e r )  
   {  
     s t r i n g   m u l t _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ m u l t i p l i e r )  
       {  
         c a s e   C A L E N D A R _ M U L T I P L I E R _ N O N E :  
           {  
             m u l t _ d e s c r i p t i o n   =   " N o n e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ M U L T I P L I E R _ T H O U S A N D S :  
           {  
             m u l t _ d e s c r i p t i o n   =   " T h o u s a n d s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ M U L T I P L I E R _ M I L L I O N S :  
           {  
             m u l t _ d e s c r i p t i o n   =   " M i l l i o n s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ M U L T I P L I E R _ B I L L I O N S :  
           {  
             m u l t _ d e s c r i p t i o n   =   " B i l l i o n s " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ M U L T I P L I E R _ T R I L L I O N S :  
           {  
             m u l t _ d e s c r i p t i o n   =   " T r i l l i o n s " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   m u l t _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   V a l u e   i m p a c t   d e s c r i p t i o n                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   s t r i n g   C C a l e n d a r I n f o : : V a l u e I m p a c t D e s c r i p t i o n ( c o n s t   E N U M _ C A L E N D A R _ E V E N T _ I M P A C T   e v e n t _ i m p a c t )  
   {  
     s t r i n g   i m p a c t _ d e s c r i p t i o n   =   N U L L ;  
 / / - - -  
     s w i t c h ( e v e n t _ i m p a c t )  
       {  
         c a s e   C A L E N D A R _ I M P A C T _ N A :  
           {  
             i m p a c t _ d e s c r i p t i o n   =   " N o n e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ I M P A C T _ P O S I T I V E :  
           {  
             i m p a c t _ d e s c r i p t i o n   =   " P o s i t i v e " ;  
             b r e a k ;  
           }  
         c a s e   C A L E N D A R _ I M P A C T _ N E G A T I V E :  
           {  
             i m p a c t _ d e s c r i p t i o n   =   " N e g a t i v e " ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   i m p a c t _ d e s c r i p t i o n ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   V a l i d a t e   p r o p e r t i e s                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : V a l i d a t e P r o p e r t i e s ( v o i d )  
   {  
 / / - - -   v a l i d a t e   c o u n t r y   i d  
     i f ( m _ c o u n t r y _ i d   ! =   W R O N G _ V A L U E )  
       {  
         i f ( ! t h i s . C o u n t r y B y I d ( m _ c o u n t r y _ i d ) )  
             r e t u r n   f a l s e ;  
         / / - - -   i f   c u r r e n c y   s e t   b e f o r e  
         i f ( m _ c u r r e n c y   ! =   N U L L )  
           {  
             s t r i n g   c u r r _ c o u n t r y _ c u r r e n c y   =   m _ c o u n t r y _ d e s c r i p t i o n . c u r r e n c y ;  
             i f ( : : S t r i n g C o m p a r e ( c u r r _ c o u n t r y _ c u r r e n c y ,   m _ c u r r e n c y ) )  
               {  
                 : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   C u r r e n c i e s   m u s t   b e   t h e   s a m e ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
           }  
       }  
 / / - - -   v a l i d a t e   e v e n t   i d  
     i f ( m _ e v e n t _ i d   ! =   W R O N G _ V A L U E )  
       {  
         i f ( ! t h i s . E v e n t I d ( ) )  
             r e t u r n   f a l s e ;  
         / / - - -   i f   c o u n t r y   i d   s e t   b e f o r e  
         i f ( m _ c o u n t r y _ i d   ! =   W R O N G _ V A L U E )  
           {  
             u l o n g   c u r r _ c o u n t r y _ i d   =   m _ e v e n t _ d e s c r i p t i o n . c o u n t r y _ i d ;  
             i f ( c u r r _ c o u n t r y _ i d   ! =   m _ c o u n t r y _ i d )  
               {  
                 : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   C o u n t r y   i d s   m u s t   b e   t h e   s a m e ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
           }  
         e l s e  
           {  
             / / - - -   i f   c u r r e n c y   s e t   b e f o r e  
             i f ( m _ c u r r e n c y   ! =   N U L L )  
               {  
                 i f ( ! t h i s . C o u n t r y B y I d ( m _ e v e n t _ d e s c r i p t i o n . c o u n t r y _ i d ) )  
                     r e t u r n   f a l s e ;  
                 s t r i n g   c u r r _ c o u n t r y _ c u r r e n c y   =   m _ c o u n t r y _ d e s c r i p t i o n . c u r r e n c y ;  
                 : : Z e r o M e m o r y ( m _ c o u n t r y _ d e s c r i p t i o n ) ;   / /   r e s e t   M q l C a l e n d a r C o u n t r y  
                 i f ( : : S t r i n g C o m p a r e ( c u r r _ c o u n t r y _ c u r r e n c y ,   m _ c u r r e n c y ) )  
                   {  
                     : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   C u r r e n c i e s   m u s t   b e   t h e   s a m e ! " ) ;  
                     r e t u r n   f a l s e ;  
                   }  
               }  
           }  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   c o u n t r y   b y   i d                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : C o u n t r y B y I d ( c o n s t   u l o n g   c o u n t r y _ i d )  
   {  
     : : R e s e t L a s t E r r o r ( ) ;  
     i f ( ! : : C a l e n d a r C o u n t r y B y I d ( c o u n t r y _ i d ,   m _ c o u n t r y _ d e s c r i p t i o n ) )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r C o u n t r y B y I d ( )   f a i l e d !   E r r o r   % d " ,  
                                     : : G e t L a s t E r r o r ( ) ) ;  
         r e t u r n   f a l s e ;  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   e v e n t   b y   i d                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : E v e n t I d ( v o i d )  
   {  
     : : R e s e t L a s t E r r o r ( ) ;  
     i f ( ! : : C a l e n d a r E v e n t B y I d ( m _ e v e n t _ i d ,   m _ e v e n t _ d e s c r i p t i o n ) )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r E v e n t B y I d ( )   f a i l e d !   E r r o r   % d " ,  
                                     : : G e t L a s t E r r o r ( ) ) ;  
         r e t u r n   f a l s e ;  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   f o r   a l l   e v e n t s   i n   a   s p e c i f i e d   t i m e   r a n g e   b y   a n   e v e n t   I D   |                                                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : V a l u e H i s t o r y S e l e c t B y E v e n t  
 (  
     M q l C a l e n d a r V a l u e   &   v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
     d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
     d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
 )   c o n s t  
   {  
     i f ( m _ e v e n t _ i d   = =   W R O N G _ V A L U E )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   N o   v a l i d   i d   f o r   t h e   e v e n t ! " ) ;  
         r e t u r n   f a l s e ;  
       }  
     : : R e s e t L a s t E r r o r ( ) ;  
     i f ( : : C a l e n d a r V a l u e H i s t o r y B y E v e n t ( m _ e v e n t _ i d ,   v a l u e s ,   d a t e t i m e _ f r o m ,   d a t e t i m e _ t o )   <   0 )  
       {  
         i n t   l a s t _ e r r o r _ c o d e   = : : G e t L a s t E r r o r ( ) ;  
         i f ( l a s t _ e r r o r _ c o d e   >   0 )  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e H i s t o r y B y E v e n t ( )   f a i l e d !   E r r o r   % d " ,  
                                         l a s t _ e r r o r _ c o d e ) ;  
         r e t u r n   f a l s e ;  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   a s   t i m e s e r i e s   f o r   a l l   e v e n t s   i n   a   s p e c i f i e d   t i m e   r a n g e   |  
 / / |   b y   a n   e v e n t   I D                                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : V a l u e H i s t o r y S e l e c t B y E v e n t  
 (  
     S i T i m e S e r i e s   &   d s t _ t s ,             / /   t i m e s e r i e s   f o r   v a l u e   d e s c r i p t i o n s  
     d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
     d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
 )  
   {  
 / / - - -   g e t   v a l u e s   f o r   a l l   e v e n t s  
     M q l C a l e n d a r V a l u e   v a l u e s [ ] ;  
     i f ( t h i s . V a l u e H i s t o r y S e l e c t B y E v e n t ( v a l u e s ,   d a t e t i m e _ f r o m ,   d a t e t i m e _ t o ) )  
       {  
         i n t   v a l u e s _ s i z e   = : : A r r a y S i z e ( v a l u e s ) ;  
         i f ( v a l u e s _ s i z e   >   0 )  
           {  
             / / - - -   c r e a t e   T S  
             d a t e t i m e   t s _ t i m e s [ ] ;  
             i f ( : : A r r a y R e s i z e ( t s _ t i m e s ,   v a l u e s _ s i z e )   = =   v a l u e s _ s i z e )  
               {  
                 : : A r r a y I n i t i a l i z e ( t s _ t i m e s ,   0 ) ;  
                 d o u b l e   t s _ v a l u e s [ ] ;  
                 i f ( : : A r r a y R e s i z e ( t s _ v a l u e s ,   v a l u e s _ s i z e )   = =   v a l u e s _ s i z e )  
                   {  
                     : : A r r a y I n i t i a l i z e ( t s _ v a l u e s ,   E M P T Y _ V A L U E ) ;  
                     f o r ( i n t   v _ i d x   =   0 ;   v _ i d x   <   v a l u e s _ s i z e ;   v _ i d x + + )  
                       {  
                         M q l C a l e n d a r V a l u e   c u r r _ v a l   =   v a l u e s [ v _ i d x ] ;  
                         t s _ t i m e s [ v _ i d x ]   =   c u r r _ v a l . t i m e ;  
                         i f ( c u r r _ v a l . H a s A c t u a l V a l u e ( ) )  
                             t s _ v a l u e s [ v _ i d x ]   =   c u r r _ v a l . G e t A c t u a l V a l u e ( ) ;  
                       }  
                     s t r i n g   t s _ n a m e   =   m _ e v e n t _ d e s c r i p t i o n . n a m e ;  
                     s t r i n g   c o u n t r y _ c o d e   =   t h i s . G e t C o u n t r y C o d e B y I d ( m _ e v e n t _ d e s c r i p t i o n . c o u n t r y _ i d ) ;  
                     i f ( c o u n t r y _ c o d e   ! =   N U L L )  
                         t s _ n a m e   + =   " ,   "   +   c o u n t r y _ c o d e ;  
                     S i T i m e S e r i e s   t e m p _ t s ;  
                     i f ( t e m p _ t s . I n i t ( t s _ t i m e s ,   t s _ v a l u e s ,   t s _ n a m e ) )  
                       {  
                         d s t _ t s   =   t e m p _ t s ;  
                         r e t u r n   t r u e ;  
                       }  
                   }  
               }  
           }  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   o f   t h e   d e f i n e d   t y p e   f o r   a l l   e v e n t s   i n   a   s p e c i f i e d   t i m e     |  
 / / |   r a n g e   b y   a n   e v e n t   I D                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : V a l u e H i s t o r y S e l e c t B y E v e n t  
 (  
     S i T i m e S e r i e s   & d s t _ t s ,               / /   t i m e s e r i e s   f o r   v a l u e   d e s c r i p t i o n s  
     c o n s t   E N U M _ C A L E N D A R _ V A L U E _ T Y P E   v a l _ t y p e ,  
     d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
     d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
 )  
   {  
 / / - - -   g e t   v a l u e s   f o r   a l l   e v e n t s  
     M q l C a l e n d a r V a l u e   v a l u e s [ ] ;  
     i f ( t h i s . V a l u e H i s t o r y S e l e c t B y E v e n t ( v a l u e s ,   d a t e t i m e _ f r o m ,   d a t e t i m e _ t o ) )  
       {  
         i n t   v a l u e s _ s i z e   = : : A r r a y S i z e ( v a l u e s ) ;  
         i f ( v a l u e s _ s i z e   >   0 )  
           {  
             / / - - -   c r e a t e   T S  
             d a t e t i m e   t s _ t i m e s [ ] ;  
             i f ( : : A r r a y R e s i z e ( t s _ t i m e s ,   v a l u e s _ s i z e )   = =   v a l u e s _ s i z e )  
               {  
                 : : A r r a y I n i t i a l i z e ( t s _ t i m e s ,   0 ) ;  
                 d o u b l e   t s _ v a l u e s [ ] ;  
                 i f ( : : A r r a y R e s i z e ( t s _ v a l u e s ,   v a l u e s _ s i z e )   = =   v a l u e s _ s i z e )  
                   {  
                     s t r i n g   v a l _ n a m e   =   N U L L ;  
                     : : A r r a y I n i t i a l i z e ( t s _ v a l u e s ,   E M P T Y _ V A L U E ) ;  
                     f o r ( i n t   v _ i d x   =   0 ;   v _ i d x   <   v a l u e s _ s i z e ;   v _ i d x + + )  
                       {  
                         M q l C a l e n d a r V a l u e   c u r r _ v a l u e   =   v a l u e s [ v _ i d x ] ;  
                         t s _ t i m e s [ v _ i d x ]   =   c u r r _ v a l u e . t i m e ;  
                         d o u b l e   c u r r _ v a l   =   Q N a N ;  
                         s w i t c h ( v a l _ t y p e )  
                           {  
                             c a s e   C A L E N D A R _ V A L U E _ T Y P E _ A C T U A L :  
                               {  
                                 i f ( c u r r _ v a l u e . H a s A c t u a l V a l u e ( ) )  
                                     c u r r _ v a l   =   c u r r _ v a l u e . G e t A c t u a l V a l u e ( ) ;  
                                 v a l _ n a m e   =   " a c t u a l " ;  
                                 b r e a k ;  
                               }  
                             c a s e   C A L E N D A R _ V A L U E _ T Y P E _ P R E V I O U S :  
                               {  
                                 i f ( c u r r _ v a l u e . H a s P r e v i o u s V a l u e ( ) )  
                                     c u r r _ v a l   =   c u r r _ v a l u e . G e t P r e v i o u s V a l u e ( ) ;  
                                 v a l _ n a m e   =   " p r e v i o u s " ;  
                                 b r e a k ;  
                               }  
                             c a s e   C A L E N D A R _ V A L U E _ T Y P E _ R E V I S E D _ P R E V I O U S :  
                               {  
                                 i f ( c u r r _ v a l u e . H a s R e v i s e d V a l u e ( ) )  
                                     c u r r _ v a l   =   c u r r _ v a l u e . G e t R e v i s e d V a l u e ( ) ;  
                                 v a l _ n a m e   =   " r e v i s e d " ;  
                                 b r e a k ;  
                               }  
                             c a s e   C A L E N D A R _ V A L U E _ T Y P E _ F O R E C A S T :  
                               {  
                                 i f ( c u r r _ v a l u e . H a s F o r e c a s t V a l u e ( ) )  
                                     c u r r _ v a l   =   c u r r _ v a l u e . G e t F o r e c a s t V a l u e ( ) ;  
                                 v a l _ n a m e   =   " f o r e c a s t " ;  
                                 b r e a k ;  
                               }  
                           }  
                         t s _ v a l u e s [ v _ i d x ]   =   c u r r _ v a l ;  
                       }  
                     s t r i n g   t s _ n a m e   =   m _ e v e n t _ d e s c r i p t i o n . n a m e ;  
                     s t r i n g   c o u n t r y _ c o d e   =   t h i s . G e t C o u n t r y C o d e B y I d ( m _ e v e n t _ d e s c r i p t i o n . c o u n t r y _ i d ) ;  
                     i f ( c o u n t r y _ c o d e   ! =   N U L L )  
                         t s _ n a m e   + =   " ,   "   +   c o u n t r y _ c o d e ;  
                     / * i f ( v a l _ n a m e   ! =   N U L L )  
                           t s _ n a m e   + =   " ,   "   +   v a l _ n a m e ; * /  
                     S i T i m e S e r i e s   t e m p _ t s ;  
                     i f ( t e m p _ t s . I n i t ( t s _ t i m e s ,   t s _ v a l u e s ,   t s _ n a m e ) )  
                       {  
                         d s t _ t s   =   t e m p _ t s ;  
                         r e t u r n   t r u e ;  
                       }  
                   }  
               }  
           }  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   f o r   a l l   e v e n t s   i n   a   s p e c i f i e d   t i m e   r a n g e   b y   c o u n t r y       |  
 / / |   a n d / o r   c u r r e n c y                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : V a l u e H i s t o r y S e l e c t  
 (  
     M q l C a l e n d a r V a l u e   &   v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
     d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
     d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
 )   c o n s t  
   {  
     i f ( m _ c u r r e n c y   = =   N U L L   & &   m _ c o u n t r y _ i d   = =   W R O N G _ V A L U E )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   N o   v a l i d   c u r r e n c y   a n d   c o u n t r y   c o d e   f o r   t h e   e v e n t ! " ) ;  
         r e t u r n   f a l s e ;  
       }  
     s t r i n g   c u r r _ c o u n t r y _ c o d e   =   m _ c o u n t r y _ d e s c r i p t i o n . c o d e ;  
     : : R e s e t L a s t E r r o r ( ) ;  
     i f ( ! : : C a l e n d a r V a l u e H i s t o r y ( v a l u e s ,   d a t e t i m e _ f r o m ,   d a t e t i m e _ t o ,   c u r r _ c o u n t r y _ c o d e ,   m _ c u r r e n c y ) )  
       {  
         i n t   l a s t _ e r r o r _ c o d e   = : : G e t L a s t E r r o r ( ) ;  
         i f ( l a s t _ e r r o r _ c o d e   >   0 )  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e H i s t o r y ( )   f a i l e d !   E r r o r   % d " ,  
                                         l a s t _ e r r o r _ c o d e ) ;  
         r e t u r n   f a l s e ;  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   a r r a y   o f   t i m e s e r i e s   f o r   a l l   e v e n t s   i n   a   s p e c i f i e d   t i m e   r a n g e   |  
 / / |   b y   c o u n t r y   a n d / o r   c u r r e n c y                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : V a l u e H i s t o r y S e l e c t  
 (  
     S i T i m e S e r i e s   &   d s t _ t s [ ] ,         / /   a r r a y   o f   t i m e s e r i e s   f o r   v a l u e   d e s c r i p t i o n s  
     d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
     d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
 )  
   {  
 / / - - -   g e t   v a l u e s   f o r   a l l   e v e n t s   b y   c o u n t r y   a n d / o r   c u r r e n c y  
     M q l C a l e n d a r V a l u e   v a l u e s [ ] ;  
     i f ( t h i s . V a l u e H i s t o r y S e l e c t ( v a l u e s ,   d a t e t i m e _ f r o m ,   d a t e t i m e _ t o ) )  
       {  
         i n t   v a l u e s _ s i z e   = : : A r r a y S i z e ( v a l u e s ) ;  
         i f ( v a l u e s _ s i z e   >   0 )  
           {  
             / / - - -   c o l l e c t   u n i q u e   e v e n t   i d s  
             C S o r t e d S e t < u l o n g >   e v e n t _ i d _ s e t ;  
             f o r ( i n t   v _ i d x   =   0 ;   v _ i d x   <   v a l u e s _ s i z e ;   v _ i d x + + )  
               {  
                 M q l C a l e n d a r V a l u e   c u r r _ v a l   =   v a l u e s [ v _ i d x ] ;  
                 u l o n g   c u r r _ e v e n t _ i d   =   v a l u e s [ v _ i d x ] . e v e n t _ i d ;  
                 i f ( ! e v e n t _ i d _ s e t . C o n t a i n s ( c u r r _ e v e n t _ i d ) )  
                     i f ( ! e v e n t _ i d _ s e t . A d d ( c u r r _ e v e n t _ i d ) )  
                       {  
                         : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a n   e v e n t   i d ! " ) ;  
                         r e t u r n   f a l s e ;  
                       }  
               }  
             i n t   e v e n t _ c n t   =   e v e n t _ i d _ s e t . C o u n t ( ) ;  
             u l o n g   e v e n t _ i d s [ ] ;  
             i f ( e v e n t _ i d _ s e t . C o p y T o ( e v e n t _ i d s )   ! =   e v e n t _ c n t )  
               {  
                 : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   c o p y   e v e n t   i d s ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
             / / - - -   g e t   v a l u e s   a s   t i m e s e r i e s   b y   a n   e v e n t   I D  
             i f ( : : A r r a y R e s i z e ( d s t _ t s ,   e v e n t _ c n t )   ! =   e v e n t _ c n t )  
               {  
                 : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   r e s i z e   d s t _ t s ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
             f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   e v e n t _ c n t ;   e v _ i d x + + )  
               {  
                 u l o n g   c u r r _ e v e n t _ i d   =   e v e n t _ i d s [ e v _ i d x ] ;  
                 / / - - -   n e w   C a l e n d a r I n f o   o b j e c t   w i t h   o n l y   e v e n t   i d   s p e c i f i e d  
                 C C a l e n d a r I n f o   c u r r _ e v e n t _ i n f o ;  
                 i f ( ! c u r r _ e v e n t _ i n f o . I n i t ( N U L L ,   W R O N G _ V A L U E ,   c u r r _ e v e n t _ i d ,   f a l s e ) )  
                     r e t u r n   f a l s e ;  
                 S i T i m e S e r i e s   t e m p _ t s ;  
                 i f ( ! c u r r _ e v e n t _ i n f o . V a l u e H i s t o r y S e l e c t B y E v e n t ( t e m p _ t s ,  
                         d a t e t i m e _ f r o m ,   d a t e t i m e _ t o ) )  
                     r e t u r n   f a l s e ;  
                 d s t _ t s [ e v _ i d x ]   =   t e m p _ t s ;  
               }  
           }  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   f o r   a l l   e v e n t s   i n   a   s p e c i f i e d   t i m e   r a n g e                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   b o o l   C C a l e n d a r I n f o : : V a l u e H i s t o r y S e l e c t A l l  
 (  
     M q l C a l e n d a r V a l u e   & v a l u e s [ ] ,   / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
     d a t e t i m e   d a t e t i m e _ f r o m ,           / /   l e f t   b o r d e r   o f   a   t i m e   r a n g e  
     d a t e t i m e   d a t e t i m e _ t o   =   0         / /   r i g h t   b o r d e r   o f   a   t i m e   r a n g e  
 )  
   {  
     : : R e s e t L a s t E r r o r ( ) ;  
     i f ( ! : : C a l e n d a r V a l u e H i s t o r y ( v a l u e s ,   d a t e t i m e _ f r o m ,   d a t e t i m e _ t o ) )  
       {  
         i n t   l a s t _ e r r o r _ c o d e   = : : G e t L a s t E r r o r ( ) ;  
         i f ( l a s t _ e r r o r _ c o d e   >   0 )  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e H i s t o r y ( )   f a i l e d !   E r r o r   % d " ,  
                                         l a s t _ e r r o r _ c o d e ) ;  
         r e t u r n   f a l s e ;  
       }  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   b y   a n   e v e n t   I D   s i n c e   t h e   C a l e n d a r   d a t a b a s e   s t a t u s           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 i n t   C C a l e n d a r I n f o : : V a l u e L a s t S e l e c t B y E v e n t  
 (  
     u l o n g   &                               c h a n g e _ i d ,         / /   C a l e n d a r   c h a n g e   I D  
     M q l C a l e n d a r V a l u e   &         v a l u e s [ ]             / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
 )   c o n s t  
   {  
     i f ( m _ e v e n t _ i d   = =   W R O N G _ V A L U E )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   N o   v a l i d   i d   f o r   t h e   e v e n t ! " ) ;  
         r e t u r n   0 ;  
       }  
     : : R e s e t L a s t E r r o r ( ) ;  
     i n t   v a l u e s _ n u m   = : : C a l e n d a r V a l u e L a s t B y E v e n t ( m _ e v e n t _ i d ,   c h a n g e _ i d ,   v a l u e s ) ;  
     i f ( v a l u e s _ n u m   = =   0 )  
       {  
         i n t   l a s t _ e r r o r _ c o d e   = : : G e t L a s t E r r o r ( ) ;  
         i f ( l a s t _ e r r o r _ c o d e   >   0 )  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e L a s t B y E v e n t ( )   f a i l e d !   E r r o r   % d " ,  
                                         l a s t _ e r r o r _ c o d e ) ;  
       }  
     r e t u r n   v a l u e s _ n u m ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   v a l u e s   s i n c e   t h e   C a l e n d a r   d a t a b a s e   s t a t u s   b y   c o u n t r y   a n d / o r     |  
 / / |   c u r r e n c y                                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 i n t   C C a l e n d a r I n f o : : V a l u e L a s t S e l e c t  
 (  
     u l o n g   &                               c h a n g e _ i d ,         / /   C a l e n d a r   c h a n g e   I D  
     M q l C a l e n d a r V a l u e   &         v a l u e s [ ]             / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
 )   c o n s t  
   {  
     i f ( m _ c u r r e n c y   = =   N U L L   & &   m _ c o u n t r y _ i d   = =   W R O N G _ V A L U E )  
       {  
         : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d !   N o   v a l i d   c u r r e n c y   a n d   c o u n t r y   c o d e   f o r   t h e   e v e n t ! " ) ;  
         r e t u r n   f a l s e ;  
       }  
     s t r i n g   c u r r _ c o u n t r y _ c o d e   =   m _ c o u n t r y _ d e s c r i p t i o n . c o d e ;  
     : : R e s e t L a s t E r r o r ( ) ;  
     i n t   v a l u e s _ n u m   = : : C a l e n d a r V a l u e L a s t ( c h a n g e _ i d ,   v a l u e s ,   c u r r _ c o u n t r y _ c o d e ,   m _ c u r r e n c y ) ;  
     i f ( v a l u e s _ n u m   = =   0 )  
       {  
         i n t   l a s t _ e r r o r _ c o d e   = : : G e t L a s t E r r o r ( ) ;  
         i f ( l a s t _ e r r o r _ c o d e   >   0 )  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e L a s t ( )   f a i l e d !   E r r o r   % d " ,  
                                         l a s t _ e r r o r _ c o d e ) ;  
       }  
     r e t u r n   v a l u e s _ n u m ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   a l l   v a l u e s   s i n c e   t h e   C a l e n d a r   d a t a b a s e   s t a t u s                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   i n t   C C a l e n d a r I n f o : : V a l u e L a s t S e l e c t A l l  
 (  
     u l o n g &                               c h a n g e _ i d ,           / /   C a l e n d a r   c h a n g e   I D  
     M q l C a l e n d a r V a l u e &         v a l u e s [ ]               / /   a r r a y   f o r   v a l u e   d e s c r i p t i o n s  
 )  
   {  
     : : R e s e t L a s t E r r o r ( ) ;  
     i n t   v a l u e s _ n u m   = : : C a l e n d a r V a l u e L a s t ( c h a n g e _ i d ,   v a l u e s ) ;  
     i f ( v a l u e s _ n u m   = =   0 )  
       {  
         i n t   l a s t _ e r r o r _ c o d e   = : : G e t L a s t E r r o r ( ) ;  
         i f ( l a s t _ e r r o r _ c o d e   >   0 )  
             : : P r i n t F o r m a t ( _ _ F U N C T I O N _ _   +   " :   C a l e n d a r V a l u e L a s t ( )   f a i l e d !   E r r o r   % d " ,  
                                         l a s t _ e r r o r _ c o d e ) ;  
       }  
     i f ( I S _ D E B U G _ M O D E )  
       {  
         i f ( v a l u e s _ n u m   >   0 )  
             : : D e b u g B r e a k ( ) ;  
       }  
     r e t u r n   v a l u e s _ n u m ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   u n i q u e   c u r r e n c i e s                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t U n i q u e C u r r e n c i e s ( s t r i n g   & c u r r e n c i e s [ ] ,   c o n s t   b o o l   i s _ u p p e r   =   t r u e )  
   {  
 / / - - -   c o l l e c t   u n i q u e   c u r r e n c i e s  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     i f ( c o u n t r i e s _ c n t   >   0 )  
       {  
         C S o r t e d S e t < s t r i n g >   c u r r e n c y _ s e t ;  
         f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
           {  
             M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
             s t r i n g   c u r r _ c o u n t r y _ c u r r e n c y   =   c u r r _ c o u n t r y . c u r r e n c y ;  
             i f ( ! i s _ u p p e r )  
               {  
                 i f ( ! : : S t r i n g T o L o w e r ( c u r r _ c o u n t r y _ c u r r e n c y ) )  
                     r e t u r n   f a l s e ;  
               }  
             i f ( ! c u r r e n c y _ s e t . C o n t a i n s ( c u r r _ c o u n t r y _ c u r r e n c y ) )  
                 i f ( ! c u r r e n c y _ s e t . A d d ( c u r r _ c o u n t r y _ c u r r e n c y ) )  
                   {  
                     : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a   c u r r e n c y ! " ) ;  
                     r e t u r n   f a l s e ;  
                   }  
           }  
         i n t   c u r r e n c i e s _ c n t   =   c u r r e n c y _ s e t . C o u n t ( ) ;  
         i f ( c u r r e n c i e s _ c n t   >   0 )  
             i f ( c u r r e n c y _ s e t . C o p y T o ( c u r r e n c i e s )   = =   c u r r e n c i e s _ c n t )  
                 r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   c o u n t r i e s   l i s t                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t C o u n t r i e s ( C A r r a y S t r i n g   &   c o u n t r i e s _ a r r )  
   {  
     i f ( c o u n t r i e s _ a r r . T o t a l ( )   >   0 )  
         i f ( ! c o u n t r i e s _ a r r . S h u t d o w n ( ) )  
           {  
             : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   c l e a r   c o u n t r i e s   l i s t ! " ) ;  
             r e t u r n   f a l s e ;  
           }  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     i f ( c o u n t r i e s _ c n t   >   0 )  
       {  
         f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
           {  
             M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
             s t r i n g   c u r r _ c o u n t r y _ n a m e   =   c u r r _ c o u n t r y . n a m e ;  
             i f ( ! c o u n t r i e s _ a r r . A d d ( c u r r _ c o u n t r y _ n a m e ) )  
               {  
                 : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a   c o u n t r y   t o   t h e   l i s t ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
           }  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   c a l e n d a r   c o u n t r i e s                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t C o u n t r i e s ( M q l C a l e n d a r C o u n t r y   &   c o u n t r i e s [ ] )  
   {  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     i f ( c o u n t r i e s _ c n t   >   0 )  
         i f ( : : A r r a y R e s i z e ( c o u n t r i e s ,   c o u n t r i e s _ c n t )   = =   c o u n t r i e s _ c n t )  
           {  
             f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
                 c o u n t r i e s [ c _ i d x ]   =   m _ c o u n t r i e s [ c _ i d x ] ;  
             r e t u r n   t r u e ;  
           }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   u n i q u e   c o n t i n e n t s                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t U n i q u e C o n t i n e n t s ( s t r i n g   &   c o n t i n e n t s [ ] )  
   {  
 / / - - -   c o l l e c t   u n i q u e   c o n t i n e n t s  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     i f ( c o u n t r i e s _ c n t   >   0 )  
       {  
         C S o r t e d S e t < s t r i n g >   c o n t i n e n t _ s e t ;  
         f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
           {  
             M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
             s t r i n g   c u r r _ c o u n t r y _ c o d e   =   c u r r _ c o u n t r y . c o d e ;  
             S C o u n t r y B y C o n t i n e n t   c u r r _ c o u n t r y _ c o n t i n e n t _ d a t a ;  
             i f ( c u r r _ c o u n t r y _ c o n t i n e n t _ d a t a . I n i t ( c u r r _ c o u n t r y _ c o d e ) )  
               {  
                 s t r i n g   c u r r _ c o u n t r y _ c o n t i n e n t _ d e s c r i p t i o n   =  
                     c u r r _ c o u n t r y _ c o n t i n e n t _ d a t a . C o n t i n e n t D e s c r i p t i o n ( ) ;  
                 i f ( ! c o n t i n e n t _ s e t . C o n t a i n s ( c u r r _ c o u n t r y _ c o n t i n e n t _ d e s c r i p t i o n ) )  
                     i f ( ! c o n t i n e n t _ s e t . A d d ( c u r r _ c o u n t r y _ c o n t i n e n t _ d e s c r i p t i o n ) )  
                       {  
                         : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a   c o n t i n e n t   d e s c r i p t i o n ! " ) ;  
                         r e t u r n   f a l s e ;  
                       }  
               }  
           }  
         i n t   c o n t i n e n t s _ c n t   =   c o n t i n e n t _ s e t . C o u n t ( ) ;  
         i f ( c o n t i n e n t s _ c n t   >   0 )  
             i f ( c o n t i n e n t _ s e t . C o p y T o ( c o n t i n e n t s )   = =   c o n t i n e n t s _ c n t )  
                 r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   c o u n t r i e s   b y   c o n t i n e n t                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t C o u n t r i e s B y C o n t i n e n t ( c o n s t   E N U M _ C O N T I N E N T   s r c _ c o n t i n e n t ,  
         C A r r a y S t r i n g   &   c o u n t r i e s _ a r r ,   c o n s t   b o o l   i s _ c o u n t r y _ f l a g   =   f a l s e )  
   {  
     i f ( c o u n t r i e s _ a r r . T o t a l ( )   >   0 )  
         i f ( ! c o u n t r i e s _ a r r . S h u t d o w n ( ) )  
           {  
             : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   c l e a r   c o u n t r i e s   l i s t ! " ) ;  
             r e t u r n   f a l s e ;  
           }  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     i f ( c o u n t r i e s _ c n t   >   0 )  
       {  
         f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
           {  
             M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
             s t r i n g   c u r r _ c o u n t r y _ c o d e   =   c u r r _ c o u n t r y . c o d e ;  
             S C o u n t r y B y C o n t i n e n t   c u r r _ c o u n t r y _ c o n t i n e n t _ d a t a ;  
             i f ( c u r r _ c o u n t r y _ c o n t i n e n t _ d a t a . I n i t ( c u r r _ c o u n t r y _ c o d e ) )  
               {  
                 E N U M _ C O N T I N E N T   c u r r _ c o n t i n e n t   =   c u r r _ c o u n t r y _ c o n t i n e n t _ d a t a . C o n t i n e n t ( ) ;  
                 i f ( c u r r _ c o n t i n e n t   = =   s r c _ c o n t i n e n t )  
                   {  
                     s t r i n g   c u r r _ c o u n t r y _ n a m e   =   : : S t r i n g F o r m a t ( " % s " ,   c u r r _ c o u n t r y . n a m e ) ;  
                     i f ( i s _ c o u n t r y _ f l a g )  
                       {  
                         S C o u n t r y B y C o n t i n e n t   c u r r _ c o u n t r y _ b y _ c o n t i n e n t ;  
                         i f ( c u r r _ c o u n t r y _ b y _ c o n t i n e n t . I n i t ( c u r r _ c o u n t r y . c o d e ) )  
                           {  
                             / / c u r r _ c o u n t r y _ n a m e   + =   ( "   "   +   c u r r _ c o u n t r y _ b y _ c o n t i n e n t . C o d e ( ) ) ;  
                             c u r r _ c o u n t r y _ n a m e   =   : : S t r i n g F o r m a t ( " % s   % s " ,   c u r r _ c o u n t r y . n a m e ,  
                                                                                                   c u r r _ c o u n t r y _ b y _ c o n t i n e n t . F l a g U n i c o d e ( ) ) ;  
                           }  
                       }  
                     i f ( ! c o u n t r i e s _ a r r . A d d ( c u r r _ c o u n t r y _ n a m e ) )  
                       {  
                         : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a   c o u n t r y   t o   t h e   l i s t ! " ) ;  
                         r e t u r n   f a l s e ;  
                       }  
                   }  
               }  
           }  
         r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   c o u n t r y   n a m e   b y   i d                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C C a l e n d a r I n f o : : G e t C o u n t r y N a m e B y I d ( c o n s t   u l o n g   c o u n t r y _ i d ,  
         c o n s t   b o o l   i s _ c o u n t r y _ f l a g   =   f a l s e )  
   {  
     s t r i n g   c o u n t r y _ n a m e   =   N U L L ;  
 / / - - -  
     i n t   c o u n t r i e s _ c n t   = : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
       {  
         M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
         u l o n g   c u r r _ c o u n t r y _ i d   =   c u r r _ c o u n t r y . i d ;  
         i f ( c u r r _ c o u n t r y _ i d   = =   c o u n t r y _ i d )  
           {  
             c o u n t r y _ n a m e   =   : : S t r i n g F o r m a t ( " % s " ,   c u r r _ c o u n t r y . n a m e ) ;  
             i f ( i s _ c o u n t r y _ f l a g )  
               {  
                 S C o u n t r y B y C o n t i n e n t   c u r r _ c o u n t r y _ b y _ c o n t i n e n t ;  
                 i f ( c u r r _ c o u n t r y _ b y _ c o n t i n e n t . I n i t ( c u r r _ c o u n t r y . c o d e ) )  
                     c o u n t r y _ n a m e   =   : : S t r i n g F o r m a t ( " % s   % s " ,   c u r r _ c o u n t r y . n a m e ,  
                                                                                 c u r r _ c o u n t r y _ b y _ c o n t i n e n t . F l a g U n i c o d e ( ) ) ;  
               }  
             b r e a k ;  
           }  
       }  
     r e t u r n   c o u n t r y _ n a m e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   c o u n t r y   c o d e   b y   i d                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C C a l e n d a r I n f o : : G e t C o u n t r y C o d e B y I d ( c o n s t   u l o n g   c o u n t r y _ i d )  
   {  
     s t r i n g   c o u n t r y _ c o d e   =   N U L L ;  
 / / - - -  
     i n t   c o u n t r i e s _ c n t   = : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
       {  
         M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
         u l o n g   c u r r _ c o u n t r y _ i d   =   c u r r _ c o u n t r y . i d ;  
         i f ( c u r r _ c o u n t r y _ i d   = =   c o u n t r y _ i d )  
           {  
             c o u n t r y _ c o d e   =   c u r r _ c o u n t r y . c o d e ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   c o u n t r y _ c o d e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   e v e n t s   b y   n a m e                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t E v e n t s B y N a m e ( C A r r a y S t r i n g   &   e v e n t s _ a r r ,   c o n s t   s t r i n g   n a m e   =   N U L L )  
   {  
     i f ( e v e n t s _ a r r . T o t a l ( )   >   0 )  
         i f ( ! e v e n t s _ a r r . S h u t d o w n ( ) )  
           {  
             : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   c l e a r   e v e n t s   l i s t ! " ) ;  
             r e t u r n   f a l s e ;  
           }  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
       {  
         M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
         / / - - -   n e w   C a l e n d a r I n f o   o b j e c t   w i t h   o n l y   c o u n t r y   i d   s p e c i f i e d  
         C C a l e n d a r I n f o   c u r r _ c o u n t r y _ i n f o ;  
         i f ( ! c u r r _ c o u n t r y _ i n f o . I n i t ( N U L L ,   c u r r _ c o u n t r y . i d ,   W R O N G _ V A L U E ,   f a l s e ) )  
             r e t u r n   f a l s e ;  
         M q l C a l e n d a r E v e n t   c o u n t r y _ e v e n t s [ ] ;  
         i f ( ! c u r r _ c o u n t r y _ i n f o . E v e n t s B y C o u n t r y D e s c r i p t i o n ( c o u n t r y _ e v e n t s ) )  
             r e t u r n   f a l s e ;  
         i n t   c o u n t r y _ e v e n t s _ s i z e   = : : A r r a y S i z e ( c o u n t r y _ e v e n t s ) ;  
         / / - - -  
         f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   < : : A r r a y S i z e ( c o u n t r y _ e v e n t s ) ;   e v _ i d x + + )  
           {  
             M q l C a l e n d a r E v e n t   c u r r _ e v e n t   =   c o u n t r y _ e v e n t s [ e v _ i d x ] ;  
             i f ( n a m e   ! =   N U L L )  
               {  
                 i n t   n a m e _ l e n   = : : S t r i n g L e n ( n a m e ) ;  
                 s t r i n g   c u r r _ e v e n t _ n a m e   =   c u r r _ e v e n t . n a m e ;  
                 s t r i n g   r e s _ a r r [ ] ;  
                 s t r i n g   s e p   =   "   " ;  
                 u s h o r t   u _ s e p ;  
                 s t r i n g   r e s u l t [ ] ;  
                 u _ s e p   =   : : S t r i n g G e t C h a r a c t e r ( s e p ,   0 ) ;  
                 i n t   s u b s t r i n g s   = : : S t r i n g S p l i t ( c u r r _ e v e n t _ n a m e ,   u _ s e p ,   r e s _ a r r ) ;  
                 b o o l   i s _ f o u n d   =   f a l s e ;  
                 f o r ( i n t   i   =   0 ;   i   <   s u b s t r i n g s ;   i + + )  
                   {  
                     s t r i n g   c u r r _ s u b _ s t r   =   r e s _ a r r [ i ] ;  
                     i f ( : : S t r i n g F i n d ( c u r r _ e v e n t _ n a m e ,   n a m e )   >   - 1 )  
                         i f ( n a m e _ l e n   = = : : S t r i n g L e n ( c u r r _ s u b _ s t r ) )  
                           {  
                             i s _ f o u n d   =   t r u e ;  
                             b r e a k ;  
                           }  
                   }  
                 i f ( ! i s _ f o u n d )  
                     c o n t i n u e ;  
               }  
             i f ( ! e v e n t s _ a r r . A d d ( c u r r _ e v e n t . n a m e ) )  
               {  
                 : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a n   e v e n t   n a m e   t o   t h e   l i s t ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
           }  
       }  
     r e t u r n   e v e n t s _ a r r . T o t a l ( )   >   0 ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   e v e n t s   b y   n a m e                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t E v e n t s B y N a m e ( M q l C a l e n d a r E v e n t   &   e v e n t s [ ] ,   c o n s t   s t r i n g   n a m e   =   N U L L )  
   {  
     i n t   c o u n t r i e s _ c n t   =   : : A r r a y S i z e ( m _ c o u n t r i e s ) ;  
     f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   c o u n t r i e s _ c n t ;   c _ i d x + + )  
       {  
         M q l C a l e n d a r C o u n t r y   c u r r _ c o u n t r y   =   m _ c o u n t r i e s [ c _ i d x ] ;  
         / / - - -   n e w   C a l e n d a r I n f o   o b j e c t   w i t h   o n l y   c o u n t r y   i d   s p e c i f i e d  
         C C a l e n d a r I n f o   c u r r _ c o u n t r y _ i n f o ;  
         i f ( ! c u r r _ c o u n t r y _ i n f o . I n i t ( N U L L ,   c u r r _ c o u n t r y . i d ,   W R O N G _ V A L U E ,   f a l s e ) )  
             r e t u r n   f a l s e ;  
         M q l C a l e n d a r E v e n t   c o u n t r y _ e v e n t s [ ] ;  
         i f ( ! c u r r _ c o u n t r y _ i n f o . E v e n t s B y C o u n t r y D e s c r i p t i o n ( c o u n t r y _ e v e n t s ) )  
             r e t u r n   f a l s e ;  
         i n t   c o u n t r y _ e v e n t s _ s i z e   = : : A r r a y S i z e ( c o u n t r y _ e v e n t s ) ;  
         / / - - -  
         f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   c o u n t r y _ e v e n t s _ s i z e ;   e v _ i d x + + )  
           {  
             M q l C a l e n d a r E v e n t   c u r r _ e v e n t   =   c o u n t r y _ e v e n t s [ e v _ i d x ] ;  
             i f ( n a m e   ! =   N U L L )  
               {  
                 i n t   n a m e _ l e n   = : : S t r i n g L e n ( n a m e ) ;  
                 s t r i n g   c u r r _ e v e n t _ n a m e   =   c u r r _ e v e n t . n a m e ;  
                 s t r i n g   r e s _ a r r [ ] ;  
                 s t r i n g   s e p   =   "   " ;  
                 u s h o r t   u _ s e p ;  
                 s t r i n g   r e s u l t [ ] ;  
                 u _ s e p   =   : : S t r i n g G e t C h a r a c t e r ( s e p ,   0 ) ;  
                 i n t   s u b s t r i n g s   = : : S t r i n g S p l i t ( c u r r _ e v e n t _ n a m e ,   u _ s e p ,   r e s _ a r r ) ;  
                 b o o l   i s _ f o u n d   =   f a l s e ;  
                 f o r ( i n t   i   =   0 ;   i   <   s u b s t r i n g s ;   i + + )  
                   {  
                     s t r i n g   c u r r _ s u b _ s t r   =   r e s _ a r r [ i ] ;  
                     i f ( : : S t r i n g F i n d ( c u r r _ s u b _ s t r ,   n a m e )   >   - 1 )  
                         i f ( n a m e _ l e n   = = : : S t r i n g L e n ( c u r r _ s u b _ s t r ) )  
                           {  
                             i s _ f o u n d   =   t r u e ;  
                             b r e a k ;  
                           }  
                   }  
                 i f ( ! i s _ f o u n d )  
                     c o n t i n u e ;  
               }  
             i n t   e v e n t s _ s i z e   = : : A r r a y S i z e ( e v e n t s ) ;  
             i f ( : : A r r a y R e s i z e ( e v e n t s ,   + + e v e n t s _ s i z e )   ! =   e v e n t s _ s i z e )  
               {  
                 : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   r e s i z e   e v e n t s   a r r a y ! " ) ;  
                 r e t u r n   f a l s e ;  
               }  
             e v e n t s [ - - e v e n t s _ s i z e ]   =   c u r r _ e v e n t ;  
           }  
       }  
     r e t u r n   : : A r r a y S i z e ( e v e n t s )   >   0 ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   F i l t e r   e v e n t s                                                                                                         |  
 / / |   V a l i d   i f   a n y   c r i t e r i o n                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   b o o l   C C a l e n d a r I n f o : : F i l t e r E v e n t s B y A n y ( M q l C a l e n d a r E v e n t   & f i l t e r e d _ e v e n t s [ ] ,  
         M q l C a l e n d a r E v e n t   & s r c _ e v e n t s [ ] ,   c o n s t   u l o n g   f i l t e r )  
   {  
     i f ( f i l t e r   >   0 )  
       {  
         i n t   s r c _ e v e n t s _ c n t   =   : : A r r a y S i z e ( s r c _ e v e n t s ) ;  
         i f ( s r c _ e v e n t s _ c n t   >   0 )  
           {  
             f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   s r c _ e v e n t s _ c n t ;   e v _ i d x + + )  
               {  
                 M q l C a l e n d a r E v e n t   c u r r _ e v e n t   =   s r c _ e v e n t s [ e v _ i d x ] ;  
                 / / - - -   1 )   t y p e  
                 b o o l   i s _ t y p e   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . t y p e )  
                   {  
                     c a s e   C A L E N D A R _ T Y P E _ E V E N T :  
                       {  
                         i f ( ! I S _ T Y P E _ E V E N T ( f i l t e r ) )  
                             i s _ t y p e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ T Y P E _ I N D I C A T O R :  
                       {  
                         i f ( ! I S _ T Y P E _ I N D I C A T O R ( f i l t e r ) )  
                             i s _ t y p e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ T Y P E _ H O L I D A Y :  
                       {  
                         i f ( ! I S _ T Y P E _ H O L I D A Y ( f i l t e r ) )  
                             i s _ t y p e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ t y p e )  
                     c o n t i n u e ;  
                 / / - - -   2 )   s e c t o r  
                 b o o l   i s _ s e c t o r   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . s e c t o r )  
                   {  
                     c a s e   C A L E N D A R _ S E C T O R _ N O N E :  
                       {  
                         i f ( ! I S _ S E C T O R _ N O N E ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ M A R K E T :  
                       {  
                         i f ( ! I S _ S E C T O R _ M A R K E T ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ G D P :  
                       {  
                         i f ( ! I S _ S E C T O R _ G D P ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ J O B S :  
                       {  
                         i f ( ! I S _ S E C T O R _ J O B S ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ P R I C E S :  
                       {  
                         i f ( ! I S _ S E C T O R _ P R I C E S ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ M O N E Y :  
                       {  
                         i f ( ! I S _ S E C T O R _ M O N E Y ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ T R A D E :  
                       {  
                         i f ( ! I S _ S E C T O R _ T R A D E ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ C O N S U M E R :  
                       {  
                         i f ( ! I S _ S E C T O R _ C O N S U M E R ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ H O U S I N G :  
                       {  
                         i f ( ! I S _ S E C T O R _ H O U S I N G ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ T A X E S :  
                       {  
                         i f ( ! I S _ S E C T O R _ T A X E S ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ S E C T O R _ H O L I D A Y S :  
                       {  
                         i f ( ! I S _ S E C T O R _ H O L I D A Y S ( f i l t e r ) )  
                             i s _ s e c t o r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ s e c t o r )  
                     c o n t i n u e ;  
                 / / - - -   3 )   f r e q u e n c y  
                 b o o l   i s _ f r e q u e n c y   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . f r e q u e n c y )  
                   {  
                     c a s e   C A L E N D A R _ F R E Q U E N C Y _ N O N E :  
                       {  
                         i f ( ! I S _ F R E Q U E N C Y _ N O N E ( f i l t e r ) )  
                             i s _ f r e q u e n c y   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ F R E Q U E N C Y _ W E E K :  
                       {  
                         i f ( ! I S _ F R E Q U E N C Y _ W E E K ( f i l t e r ) )  
                             i s _ f r e q u e n c y   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ F R E Q U E N C Y _ M O N T H :  
                       {  
                         i f ( ! I S _ F R E Q U E N C Y _ M O N T H ( f i l t e r ) )  
                             i s _ f r e q u e n c y   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ F R E Q U E N C Y _ Q U A R T E R :  
                       {  
                         i f ( ! I S _ F R E Q U E N C Y _ Q U A R T E R ( f i l t e r ) )  
                             i s _ f r e q u e n c y   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ F R E Q U E N C Y _ Y E A R :  
                       {  
                         i f ( ! I S _ F R E Q U E N C Y _ Y E A R ( f i l t e r ) )  
                             i s _ f r e q u e n c y   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ F R E Q U E N C Y _ D A Y :  
                       {  
                         i f ( ! I S _ F R E Q U E N C Y _ D A Y ( f i l t e r ) )  
                             i s _ f r e q u e n c y   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ f r e q u e n c y )  
                     c o n t i n u e ;  
                 / / - - -   4 )   i m p o r t a n c e  
                 b o o l   i s _ i m p o r t a n c e   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . i m p o r t a n c e )  
                   {  
                     c a s e   C A L E N D A R _ I M P O R T A N C E _ N O N E :  
                       {  
                         i f ( ! I S _ I M P O R T A N C E _ N O N E ( f i l t e r ) )  
                             i s _ i m p o r t a n c e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ I M P O R T A N C E _ L O W :  
                       {  
                         i f ( ! I S _ I M P O R T A N C E _ L O W ( f i l t e r ) )  
                             i s _ i m p o r t a n c e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ I M P O R T A N C E _ M O D E R A T E :  
                       {  
                         i f ( ! I S _ I M P O R T A N C E _ M O D E R A T E ( f i l t e r ) )  
                             i s _ i m p o r t a n c e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ I M P O R T A N C E _ H I G H :  
                       {  
                         i f ( ! I S _ I M P O R T A N C E _ H I G H ( f i l t e r ) )  
                             i s _ i m p o r t a n c e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ i m p o r t a n c e )  
                     c o n t i n u e ;  
                 / / - - -   5 )   u n i t  
                 b o o l   i s _ u n i t   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . u n i t )  
                   {  
                     c a s e   C A L E N D A R _ U N I T _ N O N E :  
                       {  
                         i f ( ! I S _ U N I T _ N O N E ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ P E R C E N T :  
                       {  
                         i f ( ! I S _ U N I T _ P E R C E N T ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ C U R R E N C Y :  
                       {  
                         i f ( ! I S _ U N I T _ C U R R E N C Y ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ H O U R :  
                       {  
                         i f ( ! I S _ U N I T _ H O U R ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ J O B :  
                       {  
                         i f ( ! I S _ U N I T _ J O B ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ R I G :  
                       {  
                         i f ( ! I S _ U N I T _ R I G ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ U S D :  
                       {  
                         i f ( ! I S _ U N I T _ U S D ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ P E O P L E :  
                       {  
                         i f ( ! I S _ U N I T _ P E O P L E ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ M O R T G A G E :  
                       {  
                         i f ( ! I S _ U N I T _ M O R T G A G E ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ V O T E :  
                       {  
                         i f ( ! I S _ U N I T _ V O T E ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ B A R R E L :  
                       {  
                         i f ( ! I S _ U N I T _ B A R R E L ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ C U B I C F E E T :  
                       {  
                         i f ( ! I S _ U N I T _ C U B I C F E E T ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ P O S I T I O N :  
                       {  
                         i f ( ! I S _ U N I T _ P O S I T I O N ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ U N I T _ B U I L D I N G :  
                       {  
                         i f ( ! I S _ U N I T _ B U I L D I N G ( f i l t e r ) )  
                             i s _ u n i t   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ u n i t )  
                     c o n t i n u e ;  
                 / / - - -   6 )   m u l t i p l i e r  
                 b o o l   i s _ m u l t i p l i e r   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . m u l t i p l i e r )  
                   {  
                     c a s e   C A L E N D A R _ M U L T I P L I E R _ N O N E :  
                       {  
                         i f ( ! I S _ M U L T I P L I E R _ N O N E ( f i l t e r ) )  
                             i s _ m u l t i p l i e r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ M U L T I P L I E R _ T H O U S A N D S :  
                       {  
                         i f ( ! I S _ M U L T I P L I E R _ T H O U S A N D S ( f i l t e r ) )  
                             i s _ m u l t i p l i e r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ M U L T I P L I E R _ M I L L I O N S :  
                       {  
                         i f ( ! I S _ M U L T I P L I E R _ M I L L I O N S ( f i l t e r ) )  
                             i s _ m u l t i p l i e r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ M U L T I P L I E R _ B I L L I O N S :  
                       {  
                         i f ( ! I S _ M U L T I P L I E R _ B I L L I O N S ( f i l t e r ) )  
                             i s _ m u l t i p l i e r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ M U L T I P L I E R _ T R I L L I O N S :  
                       {  
                         i f ( ! I S _ M U L T I P L I E R _ T R I L L I O N S ( f i l t e r ) )  
                             i s _ m u l t i p l i e r   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ m u l t i p l i e r )  
                     c o n t i n u e ;  
                 / / - - -   7 )   t i m e   m o d e  
                 b o o l   i s _ t i m e _ m o d e   =   t r u e ;  
                 s w i t c h ( c u r r _ e v e n t . t i m e _ m o d e )  
                   {  
                     c a s e   C A L E N D A R _ T I M E M O D E _ D A T E T I M E :  
                       {  
                         i f ( ! I S _ T I M E M O D E _ D A T E T I M E ( f i l t e r ) )  
                             i s _ t i m e _ m o d e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ T I M E M O D E _ D A T E :  
                       {  
                         i f ( ! I S _ T I M E M O D E _ D A T E ( f i l t e r ) )  
                             i s _ t i m e _ m o d e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ T I M E M O D E _ N O T I M E :  
                       {  
                         i f ( ! I S _ T I M E M O D E _ N O T I M E ( f i l t e r ) )  
                             i s _ t i m e _ m o d e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                     c a s e   C A L E N D A R _ T I M E M O D E _ T E N T A T I V E :  
                       {  
                         i f ( ! I S _ T I M E M O D E _ T E N T A T I V E ( f i l t e r ) )  
                             i s _ t i m e _ m o d e   =   f a l s e ;  
                         b r e a k ;  
                       }  
                   }  
                 i f ( ! i s _ t i m e _ m o d e )  
                     c o n t i n u e ;  
                 / / - - -   a d d   a n   e v e n t   t o   t h e   a r r a y  
                 i n t   e v e n t s _ s i z e   = : : A r r a y S i z e ( f i l t e r e d _ e v e n t s ) ;  
                 i f ( : : A r r a y R e s i z e ( f i l t e r e d _ e v e n t s ,   + + e v e n t s _ s i z e )   ! =   e v e n t s _ s i z e )  
                   {  
                     : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   r e s i z e   e v e n t s   a r r a y ! " ) ;  
                     r e t u r n   f a l s e ;  
                   }  
                 f i l t e r e d _ e v e n t s [ - - e v e n t s _ s i z e ]   =   c u r r _ e v e n t ;  
               }  
             r e t u r n   t r u e ;  
           }  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   F i l t e r   e v e n t s                                                                                                         |  
 / / |   V a l i d   i f   a l l   c r i t e r i a                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   b o o l   C C a l e n d a r I n f o : : F i l t e r E v e n t s B y A l l ( M q l C a l e n d a r E v e n t   & f i l t e r e d _ e v e n t s [ ] ,  
         M q l C a l e n d a r E v e n t   & s r c _ e v e n t s [ ] ,   c o n s t   u l o n g   f i l t e r )  
   {  
     i f ( f i l t e r   >   0 )  
       {  
         i n t   s r c _ e v e n t s _ c n t   =   : : A r r a y S i z e ( s r c _ e v e n t s ) ;  
         i f ( s r c _ e v e n t s _ c n t   >   0 )  
           {  
             f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   s r c _ e v e n t s _ c n t ;   e v _ i d x + + )  
               {  
                 M q l C a l e n d a r E v e n t   c u r r _ e v e n t   =   s r c _ e v e n t s [ e v _ i d x ] ;  
                 / / - - -   1 )   t y p e  
                 i f ( I S _ T Y P E _ E V E N T ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t y p e   ! =   C A L E N D A R _ T Y P E _ E V E N T )  
                         c o n t i n u e ;  
                 i f ( I S _ T Y P E _ I N D I C A T O R ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t y p e   ! =   C A L E N D A R _ T Y P E _ I N D I C A T O R )  
                         c o n t i n u e ;  
                 i f ( I S _ T Y P E _ H O L I D A Y ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t y p e   ! =   C A L E N D A R _ T Y P E _ H O L I D A Y )  
                         c o n t i n u e ;  
                 / / - - -   2 )   s e c t o r  
                 i f ( I S _ S E C T O R _ N O N E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ N O N E )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ M A R K E T ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ M A R K E T )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ G D P ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ G D P )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ J O B S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ J O B S )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ P R I C E S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ P R I C E S )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ M O N E Y ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ M O N E Y )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ T R A D E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ T R A D E )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ C O N S U M E R ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ C O N S U M E R )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ H O U S I N G ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ H O U S I N G )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ T A X E S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ T A X E S )  
                         c o n t i n u e ;  
                 i f ( I S _ S E C T O R _ H O L I D A Y S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . s e c t o r   ! =   C A L E N D A R _ S E C T O R _ H O L I D A Y S )  
                         c o n t i n u e ;  
                 / / - - -   3 )   f r e q u e n c y  
                 i f ( I S _ F R E Q U E N C Y _ N O N E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . f r e q u e n c y   ! =   C A L E N D A R _ F R E Q U E N C Y _ N O N E )  
                         c o n t i n u e ;  
                 i f ( I S _ F R E Q U E N C Y _ W E E K ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . f r e q u e n c y   ! =   C A L E N D A R _ F R E Q U E N C Y _ W E E K )  
                         c o n t i n u e ;  
                 i f ( I S _ F R E Q U E N C Y _ M O N T H ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . f r e q u e n c y   ! =   C A L E N D A R _ F R E Q U E N C Y _ M O N T H )  
                         c o n t i n u e ;  
                 i f ( I S _ F R E Q U E N C Y _ Q U A R T E R ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . f r e q u e n c y   ! =   C A L E N D A R _ F R E Q U E N C Y _ Q U A R T E R )  
                         c o n t i n u e ;  
                 i f ( I S _ F R E Q U E N C Y _ Y E A R ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . f r e q u e n c y   ! =   C A L E N D A R _ F R E Q U E N C Y _ Y E A R )  
                         c o n t i n u e ;  
                 i f ( I S _ F R E Q U E N C Y _ D A Y ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . f r e q u e n c y   ! =   C A L E N D A R _ F R E Q U E N C Y _ D A Y )  
                         c o n t i n u e ;  
                 / / - - -   4 )   i m p o r t a n c e  
                 i f ( I S _ I M P O R T A N C E _ N O N E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . i m p o r t a n c e   ! =   C A L E N D A R _ I M P O R T A N C E _ N O N E )  
                         c o n t i n u e ;  
                 i f ( I S _ I M P O R T A N C E _ L O W ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . i m p o r t a n c e   ! =   C A L E N D A R _ I M P O R T A N C E _ L O W )  
                         c o n t i n u e ;  
                 i f ( I S _ I M P O R T A N C E _ M O D E R A T E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . i m p o r t a n c e   ! =   C A L E N D A R _ I M P O R T A N C E _ M O D E R A T E )  
                         c o n t i n u e ;  
                 i f ( I S _ I M P O R T A N C E _ H I G H ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . i m p o r t a n c e   ! =   C A L E N D A R _ I M P O R T A N C E _ H I G H )  
                         c o n t i n u e ;  
                 / / - - -   5 )   u n i t  
                 i f ( I S _ U N I T _ N O N E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ N O N E )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ P E R C E N T ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ P E R C E N T )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ C U R R E N C Y ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ C U R R E N C Y )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ H O U R ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ H O U R )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ J O B ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ J O B )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ R I G ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ R I G )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ U S D ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ U S D )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ P E O P L E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ P E O P L E )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ M O R T G A G E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ M O R T G A G E )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ V O T E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ V O T E )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ B A R R E L ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ B A R R E L )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ C U B I C F E E T ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ C U B I C F E E T )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ P O S I T I O N ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ P O S I T I O N )  
                         c o n t i n u e ;  
                 i f ( I S _ U N I T _ B U I L D I N G ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . u n i t   ! =   C A L E N D A R _ U N I T _ B U I L D I N G )  
                         c o n t i n u e ;  
                 / / - - -   6 )   m u l t i p l i e r  
                 i f ( I S _ M U L T I P L I E R _ N O N E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . m u l t i p l i e r   ! =   C A L E N D A R _ M U L T I P L I E R _ N O N E )  
                         c o n t i n u e ;  
                 i f ( I S _ M U L T I P L I E R _ T H O U S A N D S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . m u l t i p l i e r   ! =   C A L E N D A R _ M U L T I P L I E R _ T H O U S A N D S )  
                         c o n t i n u e ;  
                 i f ( I S _ M U L T I P L I E R _ M I L L I O N S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . m u l t i p l i e r   ! =   C A L E N D A R _ M U L T I P L I E R _ M I L L I O N S )  
                         c o n t i n u e ;  
                 i f ( I S _ M U L T I P L I E R _ B I L L I O N S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . m u l t i p l i e r   ! =   C A L E N D A R _ M U L T I P L I E R _ B I L L I O N S )  
                         c o n t i n u e ;  
                 i f ( I S _ M U L T I P L I E R _ T R I L L I O N S ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . m u l t i p l i e r   ! =   C A L E N D A R _ M U L T I P L I E R _ T R I L L I O N S )  
                         c o n t i n u e ;  
                 / / - - -   7 )   t i m e   m o d e  
                 i f ( I S _ T I M E M O D E _ D A T E T I M E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t i m e _ m o d e   ! =   C A L E N D A R _ T I M E M O D E _ D A T E T I M E )  
                         c o n t i n u e ;  
                 i f ( I S _ T I M E M O D E _ D A T E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t i m e _ m o d e   ! =   C A L E N D A R _ T I M E M O D E _ D A T E )  
                         c o n t i n u e ;  
                 i f ( I S _ T I M E M O D E _ N O T I M E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t i m e _ m o d e   ! =   C A L E N D A R _ T I M E M O D E _ N O T I M E )  
                         c o n t i n u e ;  
                 i f ( I S _ T I M E M O D E _ T E N T A T I V E ( f i l t e r ) )  
                     i f ( c u r r _ e v e n t . t i m e _ m o d e   ! =   C A L E N D A R _ T I M E M O D E _ T E N T A T I V E )  
                         c o n t i n u e ;  
                 / / - - -   a d d   a n   e v e n t   t o   t h e   a r r a y  
                 i n t   e v e n t s _ s i z e   = : : A r r a y S i z e ( f i l t e r e d _ e v e n t s ) ;  
                 i f ( : : A r r a y R e s i z e ( f i l t e r e d _ e v e n t s ,   + + e v e n t s _ s i z e )   ! =   e v e n t s _ s i z e )  
                   {  
                     : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   r e s i z e   e v e n t s   a r r a y ! " ) ;  
                     r e t u r n   f a l s e ;  
                   }  
                 f i l t e r e d _ e v e n t s [ - - e v e n t s _ s i z e ]   =   c u r r _ e v e n t ;  
               }  
             r e t u r n   t r u e ;  
           }  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   u n i q u e   s e c t o r s                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   b o o l   C C a l e n d a r I n f o : : G e t U n i q u e S e c t o r s ( s t r i n g   & s e c t o r s [ ] ,  
         c o n s t   M q l C a l e n d a r E v e n t   & s r c _ e v e n t s [ ] )  
   {  
 / / - - -   c o l l e c t   u n i q u e   s e c t o r s  
     i n t   e v e n t s _ c n t   =   : : A r r a y S i z e ( s r c _ e v e n t s ) ;  
     i f ( e v e n t s _ c n t   >   0 )  
       {  
         C S o r t e d S e t < s t r i n g >   s e c t o r _ s e t ;  
         f o r ( i n t   e v _ i d x   =   0 ;   e v _ i d x   <   e v e n t s _ c n t ;   e v _ i d x + + )  
           {  
             E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   c u r r _ s e c t o r   =   s r c _ e v e n t s [ e v _ i d x ] . s e c t o r ;  
             s t r i n g   c u r r _ s e c t o r _ d e s c r i p t i o n   =   C C a l e n d a r I n f o : : E v e n t S e c t o r D e s c r i p t i o n ( c u r r _ s e c t o r ) ;  
             i f ( ! s e c t o r _ s e t . C o n t a i n s ( c u r r _ s e c t o r _ d e s c r i p t i o n ) )  
                 i f ( ! s e c t o r _ s e t . A d d ( c u r r _ s e c t o r _ d e s c r i p t i o n ) )  
                   {  
                     : : P r i n t ( _ _ F U N C T I O N _ _   +   " :   f a i l e d   t o   a d d   a   s e c t o r   d e s c r i p t i o n ! " ) ;  
                     r e t u r n   f a l s e ;  
                   }  
           }  
         i n t   s e c t o r s _ c n t   =   s e c t o r _ s e t . C o u n t ( ) ;  
         i f ( s e c t o r s _ c n t   >   0 )  
             i f ( s e c t o r _ s e t . C o p y T o ( s e c t o r s )   = =   s e c t o r s _ c n t )  
                 r e t u r n   t r u e ;  
       }  
     r e t u r n   f a l s e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   e v e n t s   b y   s e c t o r                                                                                           |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   C C a l e n d a r I n f o : : G e t E v e n t s B y S e c t o r ( C A r r a y S t r i n g   & e v e n t s _ a r r ,  
                                                                             c o n s t   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   e v e n t _ s e c t o r )  
   {  
     r e t u r n   t r u e ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   G e t   s e c t o r   b y   n a m e                                                                                               |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   C C a l e n d a r I n f o : : G e t S e c t o r B y N a m e ( c o n s t   s t r i n g   s e c t o r _ n a m e )  
   {  
     E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   s e c t o r   =   W R O N G _ V A L U E ;  
     s t r i n g   w o u l d _ b e _ n a m e s [ ]   =  
       {  
         " N o n e " ,  
         " M a r k e t " ,  
         " G r o s s   D o m e s t i c   P r o d u c t " ,  
         " L a b o r   m a r k e t " ,  
         " P r i c e s " ,   " M o n e y " ,  
         " T r a d i n g " ,  
         " G o v e r n m e n t " ,  
         " B u s i n e s s " ,  
         " C o n s u m p t i o n " ,  
         " H o u s i n g " ,  
         " T a x e s " ,  
         " H o l i d a y s "  
       } ;  
     E N U M _ C A L E N D A R _ E V E N T _ S E C T O R   w o u l d _ b e _ s e c t o r s [ ]   =  
       {  
         C A L E N D A R _ S E C T O R _ N O N E ,  
         C A L E N D A R _ S E C T O R _ M A R K E T ,  
         C A L E N D A R _ S E C T O R _ G D P ,  
         C A L E N D A R _ S E C T O R _ J O B S ,  
         C A L E N D A R _ S E C T O R _ P R I C E S ,  
         C A L E N D A R _ S E C T O R _ M O N E Y ,  
         C A L E N D A R _ S E C T O R _ T R A D E ,  
         C A L E N D A R _ S E C T O R _ G O V E R N M E N T ,  
         C A L E N D A R _ S E C T O R _ B U S I N E S S ,  
         C A L E N D A R _ S E C T O R _ C O N S U M E R ,  
         C A L E N D A R _ S E C T O R _ H O U S I N G ,  
         C A L E N D A R _ S E C T O R _ T A X E S ,  
         C A L E N D A R _ S E C T O R _ H O L I D A Y S  
       } ;  
 / / - - -  
     f o r ( i n t   s _ i d x   =   0 ;   s _ i d x   < : : A r r a y S i z e ( w o u l d _ b e _ n a m e s ) ;   s _ i d x + + )  
       {  
         s t r i n g   c u r r _ w o u l d _ b e _ n a m e   =   w o u l d _ b e _ n a m e s [ s _ i d x ] ;  
         i f ( ! : : S t r i n g C o m p a r e ( s e c t o r _ n a m e ,   c u r r _ w o u l d _ b e _ n a m e ) )  
           {  
             s e c t o r   =   w o u l d _ b e _ s e c t o r s [ s _ i d x ] ;  
             b r e a k ;  
           }  
       }  
     r e t u r n   s e c t o r ;  
   } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   P r i n t   c o u n t r y   d e s c r i p t i o n                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   v o i d   C C a l e n d a r I n f o : : P r i n t C o u n t r y D e s c r i p t i o n ( c o n s t   M q l C a l e n d a r C o u n t r y   &   c o u n t r y )  
   {  
     : : P r i n t ( " \ n - - - = =   C o u n t r y   d e s c r i p t i o n   = = - - - " ) ;  
     : : P r i n t F o r m a t ( "       I d :   % I 6 4 u " ,   c o u n t r y . i d ) ;  
     : : P r i n t F o r m a t ( "       N a m e :   % s " ,   c o u n t r y . n a m e ) ;  
     : : P r i n t F o r m a t ( "       C o d e :   % s " ,   c o u n t r y . c o d e ) ;  
     : : P r i n t F o r m a t ( "       C u r r e n c y :   % s " ,   c o u n t r y . c u r r e n c y ) ;  
     : : P r i n t F o r m a t ( "       C u r r e n c y   s y m b o l :   % s " ,   c o u n t r y . c u r r e n c y _ s y m b o l ) ;  
     : : P r i n t F o r m a t ( "       U R L   n a m e :   % s " ,   c o u n t r y . u r l _ n a m e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   P r i n t   e v e n t   d e s c r i p t i o n                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   v o i d   C C a l e n d a r I n f o : : P r i n t E v e n t D e s c r i p t i o n ( c o n s t   M q l C a l e n d a r E v e n t   &   e v e n t )  
   {  
     : : P r i n t ( " \ n - - - = =   E v e n t   d e s c r i p t i o n   = = - - - " ) ;  
     : : P r i n t F o r m a t ( "       I d :   % I 6 4 u " ,   e v e n t . i d ) ;  
     : : P r i n t F o r m a t ( "       T y p e :   % s " ,   C C a l e n d a r I n f o : : E v e n t T y p e D e s c r i p t i o n ( e v e n t . t y p e ) ) ;  
     : : P r i n t F o r m a t ( "       S e c t o r :   % s " ,   C C a l e n d a r I n f o : : E v e n t S e c t o r D e s c r i p t i o n ( e v e n t . s e c t o r ) ) ;  
     : : P r i n t F o r m a t ( "       F r e q u e n c y :   % s " ,   C C a l e n d a r I n f o : : E v e n t F r e q u e n c y D e s c r i p t i o n ( e v e n t . f r e q u e n c y ) ) ;  
     : : P r i n t F o r m a t ( "       T i m e   m o d e :   % s " ,   C C a l e n d a r I n f o : : E v e n t T i m e M o d e D e s c r i p t i o n ( e v e n t . t i m e _ m o d e ) ) ;  
     : : P r i n t F o r m a t ( "       C o u n t r y   i d :   % I 6 4 u " ,   e v e n t . c o u n t r y _ i d ) ;  
     : : P r i n t F o r m a t ( "       U n i t :   % s " ,   C C a l e n d a r I n f o : : E v e n t U n i t D e s c r i p t i o n ( e v e n t . u n i t ) ) ;  
     : : P r i n t F o r m a t ( "       I m p o r t a n c e :   % s " ,   C C a l e n d a r I n f o : : E v e n t I m p o r t a n c e D e s c r i p t i o n ( e v e n t . i m p o r t a n c e ) ) ;  
     : : P r i n t F o r m a t ( "       M u l t i p l i e r :   % s " ,   C C a l e n d a r I n f o : : E v e n t M u l t i p l i e r D e s c r i p t i o n ( e v e n t . m u l t i p l i e r ) ) ;  
     : : P r i n t F o r m a t ( "       D i g i t s :   % I 3 2 u " ,   e v e n t . d i g i t s ) ;  
     : : P r i n t F o r m a t ( "       S o u r c e   U R L :   % s " ,   e v e n t . s o u r c e _ u r l ) ;  
     : : P r i n t F o r m a t ( "       E v e n t   c o d e :   % s " ,   e v e n t . e v e n t _ c o d e ) ;  
     : : P r i n t F o r m a t ( "       N a m e :   % s " ,   e v e n t . n a m e ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   P r i n t   v a l u e   d e s c r i p t i o n                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t a t i c   v o i d   C C a l e n d a r I n f o : : P r i n t V a l u e D e s c r i p t i o n ( c o n s t   M q l C a l e n d a r V a l u e   &   v a l u e )  
   {  
     : : P r i n t ( " \ n - - - = =   V a l u e   d e s c r i p t i o n   = = - - - " ) ;  
     : : P r i n t F o r m a t ( "       I d :   % I 6 4 u " ,   v a l u e . i d ) ;  
     : : P r i n t F o r m a t ( "       E v e n t   i d :   % I 6 4 u " ,   v a l u e . e v e n t _ i d ) ;  
     : : P r i n t F o r m a t ( "       T i m e :   % s " ,   : : T i m e T o S t r i n g ( v a l u e . t i m e ) ) ;  
     : : P r i n t F o r m a t ( "       P e r i o d :   % s " ,   : : T i m e T o S t r i n g ( v a l u e . p e r i o d ) ) ;  
     : : P r i n t F o r m a t ( "       R e v i s i o n :   % I 3 2 d " ,   v a l u e . r e v i s i o n ) ;  
     i f ( v a l u e . H a s A c t u a l V a l u e ( ) )  
       {  
         d o u b l e   a c t u a l _ v a l   =   v a l u e . G e t A c t u a l V a l u e ( ) ;  
         : : P r i n t F o r m a t ( "       A c t u a l   v a l u e :   % 0 . 2 f " ,   a c t u a l _ v a l ) ;  
       }  
     i f ( v a l u e . H a s P r e v i o u s V a l u e ( ) )  
       {  
         d o u b l e   p r e v _ v a l   =   v a l u e . G e t P r e v i o u s V a l u e ( ) ;  
         : : P r i n t F o r m a t ( "       P r e v i o u s   v a l u e :   % 0 . 2 f " ,   p r e v _ v a l ) ;  
       }  
     i f ( v a l u e . H a s R e v i s e d V a l u e ( ) )  
       {  
         d o u b l e   r e v i s e d _ v a l   =   v a l u e . G e t R e v i s e d V a l u e ( ) ;  
         : : P r i n t F o r m a t ( "       R e v i s e d   p r e v i o u s   v a l u e :   % 0 . 2 f " ,   r e v i s e d _ v a l ) ;  
       }  
     i f ( v a l u e . H a s F o r e c a s t V a l u e ( ) )  
       {  
         d o u b l e   f o r e c a s t _ v a l   =   v a l u e . G e t F o r e c a s t V a l u e ( ) ;  
         : : P r i n t F o r m a t ( "       F o r e c a s t   v a l u e :   % 0 . 2 f " ,   f o r e c a s t _ v a l ) ;  
       }  
     : : P r i n t F o r m a t ( "       I m p a c t   t y p e :   % s " ,   C C a l e n d a r I n f o : : V a l u e I m p a c t D e s c r i p t i o n ( v a l u e . i m p a c t _ t y p e ) ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / - - -   [ E O F ]  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                       C o n t i n e n t s . m q h   |  
 / / |                                                                                       C o p y r i g h t   2 0 2 1 ,   d e n k i r   |  
 / / |                                                           h t t p s : / / w w w . m q l 5 . c o m / r u / u s e r s / d e n k i r   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 1 ,   d e n k i r "  
 # p r o p e r t y   l i n k             " h t t p s : / / w w w . m q l 5 . c o m / r u / u s e r s / d e n k i r "  
 / / - - -  
 # d e f i n e   C O U N T R I E S _ N U M   1 9 7  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o n t i n e n t s   e n u m e r a t i o n                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 e n u m   E N U M _ C O N T I N E N T  
     {  
       C O N T I N E N T _ W O R L D                           =   0 ,         / /   W o r l d  
       C O N T I N E N T _ A S I A                             =   1 ,         / /   A s i a  
       C O N T I N E N T _ A F R I C A                         =   2 ,         / /   A f r i c a  
       C O N T I N E N T _ E U R O P E                         =   3 ,         / /   E u r o p e  
       C O N T I N E N T _ N O R T H _ A M E R I C A           =   4 ,         / /   N o r t h   A m e r i c a  
       C O N T I N E N T _ S O U T H _ A M E R I C A           =   5 ,         / /   S o u t h   A m e r i c a  
       C O N T I N E N T _ A U S T R A L I A _ O C E A N I A   =   6 ,         / /   A u s t r a l i a / O c e a n i a  
       C O N T I N E N T _ A N T A R C T I C A                 =   7 ,         / /   A n t a r c t i c a  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o u n t r y   b y   c o n t i n e n t   s t r u c t u r e                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r u c t   S C o u n t r y B y C o n t i n e n t  
     {  
 p r i v a t e :  
       s t r i n g                         c o d e ;             / /   c o u n t r y  
       s t r i n g                         u n i c o d e ;       / /   c o u n t r y   u n i c o d e  
       s t r i n g                         c o u n t r y ;       / /   c o u n t r y  
       E N U M _ C O N T I N E N T         c o n t i n e n t ;   / /   c o n t i n e n t  
 p u b l i c :  
       / / - - -   c o n s t r u c t o r  
       v o i d                             S C o u n t r y B y C o n t i n e n t ( v o i d ) ;  
       / / - - -   c o p y   c o n s r u c t o r  
       v o i d                             S C o u n t r y B y C o n t i n e n t ( c o n s t   S C o u n t r y B y C o n t i n e n t   & _ s r c _ c o u n t r y ) ;  
       / / - - -   a s s i g n m e n t   o p e r a t o r  
       v o i d                             o p e r a t o r = ( c o n s t   S C o u n t r y B y C o n t i n e n t   & _ s r c _ c o u n t r y ) ;  
       / / - - -   e q u a l i t y   o p e r a t o r  
       b o o l                             o p e r a t o r = = ( c o n s t   S C o u n t r y B y C o n t i n e n t   & _ s r c _ c o u n t r y ) ;  
       / / - - -   i n i t i l i z a t i o n  
       b o o l                             I n i t ( c o n s t   s t r i n g   _ s r c _ c o u n t r y _ c o d e ) ;  
       / / - - -   g e t  
       s t r i n g                         C o d e ( v o i d )   c o n s t                       {   r e t u r n   c o d e ;         } ;  
       s t r i n g                         F l a g U n i c o d e ( v o i d )   c o n s t         {   r e t u r n   u n i c o d e ;   } ;  
       s t r i n g                         C o u n t r y ( v o i d )   c o n s t                 {   r e t u r n   c o u n t r y ;   } ;  
       E N U M _ C O N T I N E N T         C o n t i n e n t ( v o i d )   c o n s t             {   r e t u r n   c o n t i n e n t ; } ;  
       s t r i n g                         C o n t i n e n t D e s c r i p t i o n ( v o i d )   c o n s t ;  
       s t a t i c   E N U M _ C O N T I N E N T   C o n t i n e n t B y D e s c r i p t i o n ( c o n s t   s t r i n g   _ s r c _ d e s c r i p t i o n ) ;  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o n s t r u c t o r                                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S C o u n t r y B y C o n t i n e n t : : S C o u n t r y B y C o n t i n e n t ( v o i d )  
     {  
       c o d e   =   u n i c o d e   =   c o u n t r y   =   N U L L ;  
       c o n t i n e n t   =   W R O N G _ V A L U E ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o p y   c o n s t r u c t o r                                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S C o u n t r y B y C o n t i n e n t : : S C o u n t r y B y C o n t i n e n t ( c o n s t   S C o u n t r y B y C o n t i n e n t   & _ s r c _ c o u n t r y )  
     {  
       c o d e   =   _ s r c _ c o u n t r y . c o d e ;  
       c o u n t r y   =   _ s r c _ c o u n t r y . c o u n t r y ;  
       c o n t i n e n t   =   _ s r c _ c o u n t r y . c o n t i n e n t ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   A s s i g n m e n t   o p e r a t o r                                                                                             |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   S C o u n t r y B y C o n t i n e n t : : o p e r a t o r = ( c o n s t   S C o u n t r y B y C o n t i n e n t   & _ s r c _ c o u n t r y )  
     {  
       i f ( ! ( t h i s   = =   _ s r c _ c o u n t r y ) )  
           {  
             c o d e   =   _ s r c _ c o u n t r y . c o d e ;  
             c o u n t r y   =   _ s r c _ c o u n t r y . c o u n t r y ;  
             c o n t i n e n t   =   _ s r c _ c o u n t r y . c o n t i n e n t ;  
           }  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   E q u a l i t y   o p e r a t o r                                                                                                 |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   S C o u n t r y B y C o n t i n e n t : : o p e r a t o r = = ( c o n s t   S C o u n t r y B y C o n t i n e n t   & _ s r c _ c o u n t r y )  
     {  
       i f ( : : S t r i n g C o m p a r e ( c o d e ,   _ s r c _ c o u n t r y . c o d e ) )  
             r e t u r n   f a l s e ;  
       i f ( : : S t r i n g C o m p a r e ( c o u n t r y ,   _ s r c _ c o u n t r y . c o u n t r y ) )  
             r e t u r n   f a l s e ;  
       i f ( c o n t i n e n t   ! =   _ s r c _ c o u n t r y . c o n t i n e n t )  
             r e t u r n   f a l s e ;  
       r e t u r n   t r u e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   I n i t i a l i z a t i o n                                                                                                       |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 b o o l   S C o u n t r y B y C o n t i n e n t : : I n i t ( c o n s t   s t r i n g   _ s r c _ c o u n t r y _ c o d e )  
     {  
       c o n s t   s t r i n g   C o d e s [ C O U N T R I E S _ N U M ]   =  
           {  
             " A D " ,   / /   # 1   -   A n d o r r a  
             " A E " ,   / /   # 2   -   U n i t e d   A r a b   E m i r a t e s  
             " A F " ,   / /   # 3   -   A f g h a n i s t a n  
             " A G " ,   / /   # 4   -   A n t i g u a   a n d   B a r b u d a  
             " A I " ,   / /   # 5   -   A n g u i l l a  
             " A L " ,   / /   # 6   -   A l b a n i a  
             " A M " ,   / /   # 7   -   A r m e n i a  
             " A O " ,   / /   # 8   -   A n g o l a  
             " A Q " ,   / /   # 9   -   A n t a r c t i c a  
             " A R " ,   / /   # 1 0   -   A r g e n t i n a  
             " A S " ,   / /   # 1 1   -   A m e r i c a n   S a m o a  
             " A T " ,   / /   # 1 2   -   A u s t r i a  
             " A U " ,   / /   # 1 3   -   A u s t r a l i a  
             " A W " ,   / /   # 1 4   -   A r u b a  
             " A X " ,   / /   # 1 5   -    l a n d   I s l a n d s  
             " A Z " ,   / /   # 1 6   -   A z e r b a i j a n  
             " B A " ,   / /   # 1 7   -   B o s n i a   a n d   H e r z e g o v i n a  
             " B B " ,   / /   # 1 8   -   B a r b a d o s  
             " B D " ,   / /   # 1 9   -   B a n g l a d e s h  
             " B E " ,   / /   # 2 0   -   B e l g i u m  
             " B F " ,   / /   # 2 1   -   B u r k i n a   F a s o  
             " B G " ,   / /   # 2 2   -   B u l g a r i a  
             " B H " ,   / /   # 2 3   -   B a h r a i n  
             " B I " ,   / /   # 2 4   -   B u r u n d i  
             " B J " ,   / /   # 2 5   -   B e n i n  
             " B N " ,   / /   # 2 6   -   B r u n e i   D a r u s s a l a m  
             " B O " ,   / /   # 2 7   -   B o l i v i a  
             " B R " ,   / /   # 2 8   -   B r a z i l  
             " B T " ,   / /   # 2 9   -   B h u t a n  
             " B W " ,   / /   # 3 0   -   B o t s w a n a  
             " B Y " ,   / /   # 3 1   -   B e l a r u s  
             " B Z " ,   / /   # 3 2   -   B e l i z e  
             " C A " ,   / /   # 3 3   -   C a n a d a  
             " C D " ,   / /   # 3 4   -   C o n g o ,   D e m o c r a t i c   R e p u b l i c   o f   t h e  
             " C F " ,   / /   # 3 5   -   C e n t r a l   A f r i c a n   R e p u b l i c  
             " C G " ,   / /   # 3 6   -   C o n g o  
             " C H " ,   / /   # 3 7   -   S w i t z e r l a n d  
             " C I " ,   / /   # 3 8   -   C  t e   d ' I v o i r e  
             " C L " ,   / /   # 3 9   -   C h i l e  
             " C M " ,   / /   # 4 0   -   C a m e r o o n  
             " C N " ,   / /   # 4 1   -   C h i n a  
             " C O " ,   / /   # 4 2   -   C o l o m b i a  
             " C R " ,   / /   # 4 3   -   C o s t a   R i c a  
             " C U " ,   / /   # 4 4   -   C u b a  
             " C V " ,   / /   # 4 5   -   C a b o   V e r d e  
             " C Y " ,   / /   # 4 6   -   C y p r u s  
             " C Z " ,   / /   # 4 7   -   C z e c h i a  
             " D E " ,   / /   # 4 8   -   G e r m a n y  
             " D J " ,   / /   # 4 9   -   D j i b o u t i  
             " D K " ,   / /   # 5 0   -   D e n m a r k  
             " D M " ,   / /   # 5 1   -   D o m i n i c a  
             " D O " ,   / /   # 5 2   -   D o m i n i c a n   R e p u b l i c  
             " D Z " ,   / /   # 5 3   -   A l g e r i a  
             " E C " ,   / /   # 5 4   -   E c u a d o r  
             " E E " ,   / /   # 5 5   -   E s t o n i a  
             " E G " ,   / /   # 5 6   -   E g y p t  
             " E H " ,   / /   # 5 7   -   W e s t e r n   S a h a r a  
             " E R " ,   / /   # 5 8   -   E r i t r e a  
             " E S " ,   / /   # 5 9   -   S p a i n  
             " E T " ,   / /   # 6 0   -   E t h i o p i a  
             " E U " ,   / /   # 6 1   -   E u r o p e a n   U n i o n  
             " F I " ,   / /   # 6 2   -   F i n l a n d  
             " F J " ,   / /   # 6 3   -   F i j i  
             " F O " ,   / /   # 6 4   -   F a r o e   I s l a n d s  
             " F R " ,   / /   # 6 5   -   F r a n c e  
             " G A " ,   / /   # 6 6   -   G a b o n  
             " G B " ,   / /   # 6 7   -   U n i t e d   K i n g d o m   o f   G r e a t   B r i t a i n   a n d   N o r t h e r n   I r e l a n d  
             " G E " ,   / /   # 6 8   -   G e o r g i a  
             " G H " ,   / /   # 6 9   -   G h a n a  
             " G L " ,   / /   # 7 0   -   G r e e n l a n d  
             " G M " ,   / /   # 7 1   -   G a m b i a  
             " G N " ,   / /   # 7 2   -   G u i n e a  
             " G Q " ,   / /   # 7 3   -   E q u a t o r i a l   G u i n e a  
             " G R " ,   / /   # 7 4   -   G r e e c e  
             " G T " ,   / /   # 7 5   -   G u a t e m a l a  
             " G W " ,   / /   # 7 6   -   G u i n e a - B i s s a u  
             " G Y " ,   / /   # 7 7   -   G u y a n a  
             " H K " ,   / /   # 7 8   -   H o n g   K o n g  
             " H N " ,   / /   # 7 9   -   H o n d u r a s  
             " H R " ,   / /   # 8 0   -   C r o a t i a  
             " H T " ,   / /   # 8 1   -   H a i t i  
             " H U " ,   / /   # 8 2   -   H u n g a r y  
             " I D " ,   / /   # 8 3   -   I n d o n e s i a  
             " I E " ,   / /   # 8 4   -   I r e l a n d  
             " I L " ,   / /   # 8 5   -   I s r a e l  
             " I N " ,   / /   # 8 6   -   I n d i a  
             " I Q " ,   / /   # 8 7   -   I r a q  
             " I R " ,   / /   # 8 8   -   I r a n  
             " I S " ,   / /   # 8 9   -   I c e l a n d  
             " I T " ,   / /   # 9 0   -   I t a l y  
             " J M " ,   / /   # 9 1   -   J a m a i c a  
             " J O " ,   / /   # 9 2   -   J o r d a n  
             " J P " ,   / /   # 9 3   -   J a p a n  
             " K E " ,   / /   # 9 4   -   K e n y a  
             " K G " ,   / /   # 9 5   -   K y r g y z s t a n  
             " K H " ,   / /   # 9 6   -   C a m b o d i a  
             " K P " ,   / /   # 9 7   -   K o r e a   ( D e m o c r a t i c   P e o p l e ' s   R e p u b l i c   o f )  
             " K R " ,   / /   # 9 8   -   K o r e a ,   R e p u b l i c   o f  
             " K W " ,   / /   # 9 9   -   K u w a i t  
             " K Z " ,   / /   # 1 0 0   -   K a z a k h s t a n  
             " L A " ,   / /   # 1 0 1   -   L a o   P e o p l e ' s   D e m o c r a t i c   R e p u b l i c  
             " L B " ,   / /   # 1 0 2   -   L e b a n o n  
             " L I " ,   / /   # 1 0 3   -   L i e c h t e n s t e i n  
             " L K " ,   / /   # 1 0 4   -   S r i   L a n k a  
             " L R " ,   / /   # 1 0 5   -   L i b e r i a  
             " L S " ,   / /   # 1 0 6   -   L e s o t h o  
             " L T " ,   / /   # 1 0 7   -   L i t h u a n i a  
             " L U " ,   / /   # 1 0 8   -   L u x e m b o u r g  
             " L V " ,   / /   # 1 0 9   -   L a t v i a  
             " L Y " ,   / /   # 1 1 0   -   L i b y a  
             " M A " ,   / /   # 1 1 1   -   M o r o c c o  
             " M C " ,   / /   # 1 1 2   -   M o n a c o  
             " M D " ,   / /   # 1 1 3   -   M o l d o v a  
             " M E " ,   / /   # 1 1 4   -   M o n t e n e g r o  
             " M G " ,   / /   # 1 1 5   -   M a d a g a s c a r  
             " M K " ,   / /   # 1 1 6   -   N o r t h   M a c e d o n i a  
             " M L " ,   / /   # 1 1 7   -   M a l i  
             " M M " ,   / /   # 1 1 8   -   M y a n m a r  
             " M N " ,   / /   # 1 1 9   -   M o n g o l i a  
             " M R " ,   / /   # 1 2 0   -   M a u r i t a n i a  
             " M T " ,   / /   # 1 2 1   -   M a l t a  
             " M U " ,   / /   # 1 2 2   -   M a u r i t i u s  
             " M V " ,   / /   # 1 2 3   -   M a l d i v e s  
             " M W " ,   / /   # 1 2 4   -   M a l a w i  
             " M X " ,   / /   # 1 2 5   -   M e x i c o  
             " M Y " ,   / /   # 1 2 6   -   M a l a y s i a  
             " M Z " ,   / /   # 1 2 7   -   M o z a m b i q u e  
             " N A " ,   / /   # 1 2 8   -   N a m i b i a  
             " N C " ,   / /   # 1 2 9   -   N e w   C a l e d o n i a  
             " N E " ,   / /   # 1 3 0   -   N i g e r  
             " N G " ,   / /   # 1 3 1   -   N i g e r i a  
             " N I " ,   / /   # 1 3 2   -   N i c a r a g u a  
             " N L " ,   / /   # 1 3 3   -   N e t h e r l a n d s  
             " N O " ,   / /   # 1 3 4   -   N o r w a y  
             " N P " ,   / /   # 1 3 5   -   N e p a l  
             " N Z " ,   / /   # 1 3 6   -   N e w   Z e a l a n d  
             " O M " ,   / /   # 1 3 7   -   O m a n  
             " P A " ,   / /   # 1 3 8   -   P a n a m a  
             " P E " ,   / /   # 1 3 9   -   P e r u  
             " P G " ,   / /   # 1 4 0   -   P a p u a   N e w   G u i n e a  
             " P H " ,   / /   # 1 4 1   -   P h i l i p p i n e s  
             " P K " ,   / /   # 1 4 2   -   P a k i s t a n  
             " P L " ,   / /   # 1 4 3   -   P o l a n d  
             " P R " ,   / /   # 1 4 4   -   P u e r t o   R i c o  
             " P S " ,   / /   # 1 4 5   -   P a l e s t i n e  
             " P T " ,   / /   # 1 4 6   -   P o r t u g a l  
             " P Y " ,   / /   # 1 4 7   -   P a r a g u a y  
             " Q A " ,   / /   # 1 4 8   -   Q a t a r  
             " R O " ,   / /   # 1 4 9   -   R o m a n i a  
             " R S " ,   / /   # 1 5 0   -   S e r b i a  
             " R U " ,   / /   # 1 5 1   -   R u s s i a n   F e d e r a t i o n  
             " R W " ,   / /   # 1 5 2   -   R w a n d a  
             " S A " ,   / /   # 1 5 3   -   S a u d i   A r a b i a  
             " S B " ,   / /   # 1 5 4   -   S o l o m o n   I s l a n d s  
             " S C " ,   / /   # 1 5 5   -   S e y c h e l l e s  
             " S D " ,   / /   # 1 5 6   -   S u d a n  
             " S E " ,   / /   # 1 5 7   -   S w e d e n  
             " S G " ,   / /   # 1 5 8   -   S i n g a p o r e  
             " S I " ,   / /   # 1 5 9   -   S l o v e n i a  
             " S K " ,   / /   # 1 6 0   -   S l o v a k i a  
             " S L " ,   / /   # 1 6 1   -   S i e r r a   L e o n e  
             " S M " ,   / /   # 1 6 2   -   S a n   M a r i n o  
             " S N " ,   / /   # 1 6 3   -   S e n e g a l  
             " S O " ,   / /   # 1 6 4   -   S o m a l i a  
             " S R " ,   / /   # 1 6 5   -   S u r i n a m e  
             " S S " ,   / /   # 1 6 6   -   S o u t h   S u d a n  
             " S T " ,   / /   # 1 6 7   -   S a o   T o m e   a n d   P r i n c i p e  
             " S V " ,   / /   # 1 6 8   -   E l   S a l v a d o r  
             " S Y " ,   / /   # 1 6 9   -   S y r i a n   A r a b   R e p u b l i c  
             " S Z " ,   / /   # 1 7 0   -   E s w a t i n i  
             " T D " ,   / /   # 1 7 1   -   C h a d  
             " T G " ,   / /   # 1 7 2   -   T o g o  
             " T H " ,   / /   # 1 7 3   -   T h a i l a n d  
             " T J " ,   / /   # 1 7 4   -   T a j i k i s t a n  
             " T M " ,   / /   # 1 7 5   -   T u r k m e n i s t a n  
             " T N " ,   / /   # 1 7 6   -   T u n i s i a  
             " T O " ,   / /   # 1 7 7   -   T o n g a  
             " T R " ,   / /   # 1 7 8   -   T u r k e y  
             " T T " ,   / /   # 1 7 9   -   T r i n i d a d   a n d   T o b a g o  
             " T W " ,   / /   # 1 8 0   -   T a i w a n  
             " T Z " ,   / /   # 1 8 1   -   T a n z a n i a  
             " U A " ,   / /   # 1 8 2   -   U k r a i n e  
             " U G " ,   / /   # 1 8 3   -   U g a n d a  
             " U S " ,   / /   # 1 8 4   -   U n i t e d   S t a t e s   o f   A m e r i c a  
             " U Y " ,   / /   # 1 8 5   -   U r u g u a y  
             " U Z " ,   / /   # 1 8 6   -   U z b e k i s t a n  
             " V A " ,   / /   # 1 8 7   -   V a t i c a n  
             " V C " ,   / /   # 1 8 8   -   S a i n t   V i n c e n t   a n d   t h e   G r e n a d i n e s  
             " V E " ,   / /   # 1 8 9   -   V e n e z u e l a  
             " V G " ,   / /   # 1 9 0   -   V i r g i n   I s l a n d s   ( B r i t i s h )  
             " V I " ,   / /   # 1 9 1   -   V i r g i n   I s l a n d s   ( U . S . )  
             " V N " ,   / /   # 1 9 2   -   V i e t   N a m  
             " W W " ,   / /   # 1 9 3   -   W o r l d w i d e  
             " Y E " ,   / /   # 1 9 4   -   Y e m e n  
             " Z A " ,   / /   # 1 9 5   -   S o u t h   A f r i c a  
             " Z M " ,   / /   # 1 9 6   -   Z a m b i a  
             " Z W "     / /   # 1 9 7   -   Z i m b a b w e  
           } ;  
       c o n s t   s t r i n g   C o u n t r i e s [ C O U N T R I E S _ N U M ]   =  
           {  
             " A n d o r r a " ,                               / /   # 1  
             " U n i t e d   A r a b   E m i r a t e s " ,     / /   # 2  
             " A f g h a n i s t a n " ,                       / /   # 3  
             " A n t i g u a   a n d   B a r b u d a " ,       / /   # 4  
             " A n g u i l l a " ,                             / /   # 5  
             " A l b a n i a " ,                               / /   # 6  
             " A r m e n i a " ,                               / /   # 7  
             " A n g o l a " ,                                 / /   # 8  
             " A n t a r c t i c a " ,                         / /   # 9  
             " A r g e n t i n a " ,                           / /   # 1 0  
             " A m e r i c a n   S a m o a " ,                 / /   # 1 1  
             " A u s t r i a " ,                               / /   # 1 2  
             " A u s t r a l i a " ,                           / /   # 1 3  
             " A r u b a " ,                                   / /   # 1 4  
             "  l a n d   I s l a n d s " ,                   / /   # 1 5  
             " A z e r b a i j a n " ,                         / /   # 1 6  
             " B o s n i a   a n d   H e r z e g o v i n a " , / /   # 1 7  
             " B a r b a d o s " ,                             / /   # 1 8  
             " B a n g l a d e s h " ,                         / /   # 1 9  
             " B e l g i u m " ,                               / /   # 2 0  
             " B u r k i n a   F a s o " ,                     / /   # 2 1  
             " B u l g a r i a " ,                             / /   # 2 2  
             " B a h r a i n " ,                               / /   # 2 3  
             " B u r u n d i " ,                               / /   # 2 4  
             " B e n i n " ,                                   / /   # 2 5  
             " B r u n e i   D a r u s s a l a m " ,           / /   # 2 6  
             " B o l i v i a " ,                               / /   # 2 7  
             " B r a z i l " ,                                 / /   # 2 8  
             " B h u t a n " ,                                 / /   # 2 9  
             " B o t s w a n a " ,                             / /   # 3 0  
             " B e l a r u s " ,                               / /   # 3 1  
             " B e l i z e " ,                                 / /   # 3 2  
             " C a n a d a " ,                                 / /   # 3 3  
             " C o n g o ,   D e m o c r a t i c   R e p u b l i c   o f   t h e " ,   / /   # 3 4  
             " C e n t r a l   A f r i c a n   R e p u b l i c " ,   / /   # 3 5  
             " C o n g o " ,                                   / /   # 3 6  
             " S w i t z e r l a n d " ,                       / /   # 3 7  
             " C  t e   d ' I v o i r e " ,                   / /   # 3 8  
             " C h i l e " ,                                   / /   # 3 9  
             " C a m e r o o n " ,                             / /   # 4 0  
             " C h i n a " ,                                   / /   # 4 1  
             " C o l o m b i a " ,                             / /   # 4 2  
             " C o s t a   R i c a " ,                         / /   # 4 3  
             " C u b a " ,                                     / /   # 4 4  
             " C a b o   V e r d e " ,                         / /   # 4 5  
             " C y p r u s " ,                                 / /   # 4 6  
             " C z e c h i a " ,                               / /   # 4 7  
             " G e r m a n y " ,                               / /   # 4 8  
             " D j i b o u t i " ,                             / /   # 4 9  
             " D e n m a r k " ,                               / /   # 5 0  
             " D o m i n i c a " ,                             / /   # 5 1  
             " D o m i n i c a n   R e p u b l i c " ,         / /   # 5 2  
             " A l g e r i a " ,                               / /   # 5 3  
             " E c u a d o r " ,                               / /   # 5 4  
             " E s t o n i a " ,                               / /   # 5 5  
             " E g y p t " ,                                   / /   # 5 6  
             " W e s t e r n   S a h a r a " ,                 / /   # 5 7  
             " E r i t r e a " ,                               / /   # 5 8  
             " S p a i n " ,                                   / /   # 5 9  
             " E t h i o p i a " ,                             / /   # 6 0  
             " E u r o p e a n   U n i o n " ,                 / /   # 6 1  
             " F i n l a n d " ,                               / /   # 6 2  
             " F i j i " ,                                     / /   # 6 3  
             " F a r o e   I s l a n d s " ,                   / /   # 6 4  
             " F r a n c e " ,                                 / /   # 6 5  
             " G a b o n " ,                                   / /   # 6 6  
             " U n i t e d   K i n g d o m   o f   G r e a t   B r i t a i n   a n d   N o r t h e r n   I r e l a n d " , / /   # 6 7  
             " G e o r g i a " ,                               / /   # 6 8  
             " G h a n a " ,                                   / /   # 6 9  
             " G r e e n l a n d " ,                           / /   # 7 0  
             " G a m b i a " ,                                 / /   # 7 1  
             " G u i n e a " ,                                 / /   # 7 2  
             " E q u a t o r i a l   G u i n e a " ,           / /   # 7 3  
             " G r e e c e " ,                                 / /   # 7 4  
             " G u a t e m a l a " ,                           / /   # 7 5  
             " G u i n e a - B i s s a u " ,                   / /   # 7 6  
             " G u y a n a " ,                                 / /   # 7 7  
             " H o n g   K o n g " ,                           / /   # 7 8  
             " H o n d u r a s " ,                             / /   # 7 9  
             " C r o a t i a " ,                               / /   # 8 0  
             " H a i t i " ,                                   / /   # 8 1  
             " H u n g a r y " ,                               / /   # 8 2  
             " I n d o n e s i a " ,                           / /   # 8 3  
             " I r e l a n d " ,                               / /   # 8 4  
             " I s r a e l " ,                                 / /   # 8 5  
             " I n d i a " ,                                   / /   # 8 6  
             " I r a q " ,                                     / /   # 8 7  
             " I r a n " ,                                     / /   # 8 8  
             " I c e l a n d " ,                               / /   # 8 9  
             " I t a l y " ,                                   / /   # 9 0  
             " J a m a i c a " ,                               / /   # 9 1  
             " J o r d a n " ,                                 / /   # 9 2  
             " J a p a n " ,                                   / /   # 9 3  
             " K e n y a " ,                                   / /   # 9 4  
             " K y r g y z s t a n " ,                         / /   # 9 5  
             " C a m b o d i a " ,                             / /   # 9 6  
             " K o r e a   ( D e m o c r a t i c   P e o p l e ' s   R e p u b l i c   o f ) " , / /   # 9 7  
             " K o r e a ,   R e p u b l i c   o f " ,         / /   # 9 8  
             " K u w a i t " ,                                 / /   # 9 9  
             " K a z a k h s t a n " ,                         / /   # 1 0 0  
             " L a o   P e o p l e ' s   D e m o c r a t i c   R e p u b l i c " , / /   # 1 0 1  
             " L e b a n o n " ,                               / /   # 1 0 2  
             " L i e c h t e n s t e i n " ,                   / /   # 1 0 3  
             " S r i   L a n k a " ,                           / /   # 1 0 4  
             " L i b e r i a " ,                               / /   # 1 0 5  
             " L e s o t h o " ,                               / /   # 1 0 6  
             " L i t h u a n i a " ,                           / /   # 1 0 7  
             " L u x e m b o u r g " ,                         / /   # 1 0 8  
             " L a t v i a " ,                                 / /   # 1 0 9  
             " L i b y a " ,                                   / /   # 1 1 0  
             " M o r o c c o " ,                               / /   # 1 1 1  
             " M o n a c o " ,                                 / /   # 1 1 2  
             " M o l d o v a " ,                               / /   # 1 1 3  
             " M o n t e n e g r o " ,                         / /   # 1 1 4  
             " M a d a g a s c a r " ,                         / /   # 1 1 5  
             " N o r t h   M a c e d o n i a " ,               / /   # 1 1 6  
             " M a l i " ,                                     / /   # 1 1 7  
             " M y a n m a r " ,                               / /   # 1 1 8  
             " M o n g o l i a " ,                             / /   # 1 1 9  
             " M a u r i t a n i a " ,                         / /   # 1 2 0  
             " M a l t a " ,                                   / /   # 1 2 1  
             " M a u r i t i u s " ,                           / /   # 1 2 2  
             " M a l d i v e s " ,                             / /   # 1 2 3  
             " M a l a w i " ,                                 / /   # 1 2 4  
             " M e x i c o " ,                                 / /   # 1 2 5  
             " M a l a y s i a " ,                             / /   # 1 2 6  
             " M o z a m b i q u e " ,                         / /   # 1 2 7  
             " N a m i b i a " ,                               / /   # 1 2 8  
             " N e w   C a l e d o n i a " ,                   / /   # 1 2 9  
             " N i g e r " ,                                   / /   # 1 3 0  
             " N i g e r i a " ,                               / /   # 1 3 1  
             " N i c a r a g u a " ,                           / /   # 1 3 2  
             " N e t h e r l a n d s " ,                       / /   # 1 3 3  
             " N o r w a y " ,                                 / /   # 1 3 4  
             " N e p a l " ,                                   / /   # 1 3 5  
             " N e w   Z e a l a n d " ,                       / /   # 1 3 6  
             " O m a n " ,                                     / /   # 1 3 7  
             " P a n a m a " ,                                 / /   # 1 3 8  
             " P e r u " ,                                     / /   # 1 3 9  
             " P a p u a   N e w   G u i n e a " ,             / /   # 1 4 0  
             " P h i l i p p i n e s " ,                       / /   # 1 4 1  
             " P a k i s t a n " ,                             / /   # 1 4 2  
             " P o l a n d " ,                                 / /   # 1 4 3  
             " P u e r t o   R i c o " ,                       / /   # 1 4 4  
             " P a l e s t i n e " ,                           / /   # 1 4 5  
             " P o r t u g a l " ,                             / /   # 1 4 6  
             " P a r a g u a y " ,                             / /   # 1 4 7  
             " Q a t a r " ,                                   / /   # 1 4 8  
             " R o m a n i a " ,                               / /   # 1 4 9  
             " S e r b i a " ,                                 / /   # 1 5 0  
             " R u s s i a n   F e d e r a t i o n " ,         / /   # 1 5 1  
             " R w a n d a " ,                                 / /   # 1 5 2  
             " S a u d i   A r a b i a " ,                     / /   # 1 5 3  
             " S o l o m o n   I s l a n d s " ,               / /   # 1 5 4  
             " S e y c h e l l e s " ,                         / /   # 1 5 5  
             " S u d a n " ,                                   / /   # 1 5 6  
             " S w e d e n " ,                                 / /   # 1 5 7  
             " S i n g a p o r e " ,                           / /   # 1 5 8  
             " S l o v e n i a " ,                             / /   # 1 5 9  
             " S l o v a k i a " ,                             / /   # 1 6 0  
             " S i e r r a   L e o n e " ,                     / /   # 1 6 1  
             " S a n   M a r i n o " ,                         / /   # 1 6 2  
             " S e n e g a l " ,                               / /   # 1 6 3  
             " S o m a l i a " ,                               / /   # 1 6 4  
             " S u r i n a m e " ,                             / /   # 1 6 5  
             " S o u t h   S u d a n " ,                       / /   # 1 6 6  
             " S a o   T o m e   a n d   P r i n c i p e " ,   / /   # 1 6 7  
             " E l   S a l v a d o r " ,                       / /   # 1 6 8  
             " S y r i a n   A r a b   R e p u b l i c " ,     / /   # 1 6 9  
             " E s w a t i n i " ,                             / /   # 1 7 0  
             " C h a d " ,                                     / /   # 1 7 1  
             " T o g o " ,                                     / /   # 1 7 2  
             " T h a i l a n d " ,                             / /   # 1 7 3  
             " T a j i k i s t a n " ,                         / /   # 1 7 4  
             " T u r k m e n i s t a n " ,                     / /   # 1 7 5  
             " T u n i s i a " ,                               / /   # 1 7 6  
             " T o n g a " ,                                   / /   # 1 7 7  
             " T u r k e y " ,                                 / /   # 1 7 8  
             " T r i n i d a d   a n d   T o b a g o " ,       / /   # 1 7 9  
             " T a i w a n " ,                                 / /   # 1 8 0  
             " T a n z a n i a " ,                             / /   # 1 8 1  
             " U k r a i n e " ,                               / /   # 1 8 2  
             " U g a n d a " ,                                 / /   # 1 8 3  
             " U n i t e d   S t a t e s   o f   A m e r i c a " , / /   # 1 8 4  
             " U r u g u a y " ,                               / /   # 1 8 5  
             " U z b e k i s t a n " ,                         / /   # 1 8 6  
             " V a t i c a n " ,                               / /   # 1 8 7  
             " S a i n t   V i n c e n t   a n d   t h e   G r e n a d i n e s " ,   / /   # 1 8 8  
             " V e n e z u e l a " ,                           / /   # 1 8 9  
             " V i r g i n   I s l a n d s   ( B r i t i s h ) " ,   / /   # 1 9 0  
             " V i r g i n   I s l a n d s   ( U . S . ) " ,   / /   # 1 9 1  
             " V i e t   N a m " ,                             / /   # 1 9 2  
             " W o r l d w i d e " ,                           / /   # 1 9 3  
             " Y e m e n " ,                                   / /   # 1 9 4  
             " S o u t h   A f r i c a " ,                     / /   # 1 9 5  
             " Z a m b i a " ,                                 / /   # 1 9 6  
             " Z i m b a b w e "                               / /   # 1 9 7  
           } ;  
       / * c o n s t   s t r i n g   A B C D [ ]   =  
           {  
       " \ x F 1 E 6 " ,   / /             A  
             " \ x F 1 E 7 " ,   / /             B  
             " \ x F 1 E 8 " ,   / /             C  
             " \ x F 1 E 9 " ,   / /             D  
             " \ x F 1 E A " ,   / /             E  
             " \ x F 1 E B " ,   / /             F  
             " \ x F 1 E C " ,   / /             G  
             " \ x F 1 E D " ,   / /             H  
             " \ x F 1 E E " ,   / /             I  
             " \ x F 1 E F " ,   / /             J  
             " \ x F 1 F 0 " ,   / /             K  
             " \ x F 1 F 1 " ,   / /             L  
             " \ x F 1 F 2 " ,   / /             M  
             " \ x F 1 F 3 " ,   / /             N  
             " \ x F 1 F 4 " ,   / /             O  
             " \ x F 1 F 5 " ,   / /             P  
             " \ x F 1 F 6 " ,   / /             Q  
             " \ x F 1 F 7 " ,   / /             R  
             " \ x F 1 F 8 " ,   / /             S  
             " \ x F 1 F 9 " ,   / /             T  
             " \ x F 1 F A " ,   / /             U  
             " \ x F 1 F B " ,   / /             V  
             " \ x F 1 F C " ,   / /             W  
             " \ x F 1 F D " ,   / /             X  
             " \ x F 1 F E " ,   / /             Y  
             " \ x F 1 F F "     / /             Z  
           } ; * /  
       c o n s t   s t r i n g   F l a g _ c o d e s [ ]   =  
           {  
             " \ x F 1 E 6 " ,   / /             A  
             " \ x F 1 E 7 " ,   / /             B  
             " \ x F 1 E 8 " ,   / /             C  
             " \ x F 1 E 9 " ,   / /             D  
             " \ x F 1 E A " ,   / /             E  
             " \ x F 1 E B " ,   / /             F  
             " \ x F 1 E C " ,   / /             G  
             " \ x F 1 E D " ,   / /             H  
             " \ x F 1 E E " ,   / /             I  
             " \ x F 1 E F " ,   / /             J  
             " \ x F 1 F 0 " ,   / /             K  
             " \ x F 1 F 1 " ,   / /             L  
             " \ x F 1 F 2 " ,   / /             M  
             " \ x F 1 F 3 " ,   / /             N  
             " \ x F 1 F 4 " ,   / /             O  
             " \ x F 1 F 5 " ,   / /             P  
             " \ x F 1 F 6 " ,   / /             Q  
             " \ x F 1 F 7 " ,   / /             R  
             " \ x F 1 F 8 " ,   / /             S  
             " \ x F 1 F 9 " ,   / /             T  
             " \ x F 1 F A " ,   / /             U  
             " \ x F 1 F B " ,   / /             V  
             " \ x F 1 F C " ,   / /             W  
             " \ x F 1 F D " ,   / /             X  
             " \ x F 1 F E " ,   / /             Y  
             " \ x F 1 F F "     / /             Z  
           } ;  
       c o n s t   E N U M _ C O N T I N E N T   C o n t i n e n t s [ C O U N T R I E S _ N U M ]   =  
           {  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1   -   A n d o r r a  
             C O N T I N E N T _ A S I A ,                         / /   # 2   -   U n i t e d   A r a b   E m i r a t e s  
             C O N T I N E N T _ A S I A ,                         / /   # 3   -   A f g h a n i s t a n  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 4   -   A n t i g u a   a n d   B a r b u d a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 5   -   A n g u i l l a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 6   -   A l b a n i a  
             C O N T I N E N T _ A S I A ,                         / /   # 7   -   A r m e n i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 8   -   A n g o l a  
             C O N T I N E N T _ A N T A R C T I C A ,             / /   # 9   -   A n t a r c t i c a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 0   -   A r g e n t i n a  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 1   -   A m e r i c a n   S a m o a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 2   -   A u s t r i a  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 3   -   A u s t r a l i a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 4   -   A r u b a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 5   -    l a n d   I s l a n d s  
             C O N T I N E N T _ A S I A ,                         / /   # 1 6   -   A z e r b a i j a n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 7   -   B o s n i a   a n d   H e r z e g o v i n a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 8   -   B a r b a d o s  
             C O N T I N E N T _ A S I A ,                         / /   # 1 9   -   B a n g l a d e s h  
             C O N T I N E N T _ E U R O P E ,                     / /   # 2 0   -   B e l g i u m  
             C O N T I N E N T _ A F R I C A ,                     / /   # 2 1   -   B u r k i n a   F a s o  
             C O N T I N E N T _ E U R O P E ,                     / /   # 2 2   -   B u l g a r i a  
             C O N T I N E N T _ A S I A ,                         / /   # 2 3   -   B a h r a i n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 2 4   -   B u r u n d i  
             C O N T I N E N T _ A F R I C A ,                     / /   # 2 5   -   B e n i n  
             C O N T I N E N T _ A S I A ,                         / /   # 2 6   -   B r u n e i   D a r u s s a l a m  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 2 7   -   B o l i v i a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 2 8   -   B r a z i l  
             C O N T I N E N T _ A S I A ,                         / /   # 2 9   -   B h u t a n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 3 0   -   B o t s w a n a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 3 1   -   B e l a r u s  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 3 2   -   B e l i z e  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 3 3   -   C a n a d a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 3 4   -   C o n g o ,   D e m o c r a t i c   R e p u b l i c   o f   t h e  
             C O N T I N E N T _ A F R I C A ,                     / /   # 3 5   -   C e n t r a l   A f r i c a n   R e p u b l i c  
             C O N T I N E N T _ A F R I C A ,                     / /   # 3 6   -   C o n g o  
             C O N T I N E N T _ E U R O P E ,                     / /   # 3 7   -   S w i t z e r l a n d  
             C O N T I N E N T _ A F R I C A ,                     / /   # 3 8   -   C  t e   d ' I v o i r e  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 3 9   -   C h i l e  
             C O N T I N E N T _ A F R I C A ,                     / /   # 4 0   -   C a m e r o o n  
             C O N T I N E N T _ A S I A ,                         / /   # 4 1   -   C h i n a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 4 2   -   C o l o m b i a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 4 3   -   C o s t a   R i c a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 4 4   -   C u b a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 4 5   -   C a b o   V e r d e  
             C O N T I N E N T _ E U R O P E ,                     / /   # 4 6   -   C y p r u s  
             C O N T I N E N T _ E U R O P E ,                     / /   # 4 7   -   C z e c h i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 4 8   -   G e r m a n y  
             C O N T I N E N T _ A F R I C A ,                     / /   # 4 9   -   D j i b o u t i  
             C O N T I N E N T _ E U R O P E ,                     / /   # 5 0   -   D e n m a r k  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 5 1   -   D o m i n i c a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 5 2   -   D o m i n i c a n   R e p u b l i c  
             C O N T I N E N T _ A F R I C A ,                     / /   # 5 3   -   A l g e r i a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 5 4   -   E c u a d o r  
             C O N T I N E N T _ E U R O P E ,                     / /   # 5 5   -   E s t o n i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 5 6   -   E g y p t  
             C O N T I N E N T _ A F R I C A ,                     / /   # 5 7   -   W e s t e r n   S a h a r a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 5 8   -   E r i t r e a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 5 9   -   S p a i n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 6 0   -   E t h i o p i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 6 1   -   E u r o p e a n   U n i o n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 6 2   -   F i n l a n d  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A ,   / /   # 6 3   -   F i j i  
             C O N T I N E N T _ E U R O P E ,                     / /   # 6 4   -   F a r o e   I s l a n d s  
             C O N T I N E N T _ E U R O P E ,                     / /   # 6 5   -   F r a n c e  
             C O N T I N E N T _ A F R I C A ,                     / /   # 6 6   -   G a b o n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 6 7   -   U n i t e d   K i n g d o m   o f   G r e a t   B r i t a i n   a n d   N o r t h e r n   I r e l a n d  
             C O N T I N E N T _ A S I A ,                         / /   # 6 8   -   G e o r g i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 6 9   -   G h a n a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 7 0   -   G r e e n l a n d  
             C O N T I N E N T _ A F R I C A ,                     / /   # 7 1   -   G a m b i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 7 2   -   G u i n e a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 7 3   -   E q u a t o r i a l   G u i n e a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 7 4   -   G r e e c e  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 7 5   -   G u a t e m a l a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 7 6   -   G u i n e a - B i s s a u  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 7 7   -   G u y a n a  
             C O N T I N E N T _ A S I A ,                         / /   # 7 8   -   H o n g   K o n g  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 7 9   -   H o n d u r a s  
             C O N T I N E N T _ E U R O P E ,                     / /   # 8 0   -   C r o a t i a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 8 1   -   H a i t i  
             C O N T I N E N T _ E U R O P E ,                     / /   # 8 2   -   H u n g a r y  
             C O N T I N E N T _ A S I A ,                         / /   # 8 3   -   I n d o n e s i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 8 4   -   I r e l a n d  
             C O N T I N E N T _ A S I A ,                         / /   # 8 5   -   I s r a e l  
             C O N T I N E N T _ A S I A ,                         / /   # 8 6   -   I n d i a  
             C O N T I N E N T _ A S I A ,                         / /   # 8 7   -   I r a q  
             C O N T I N E N T _ A S I A ,                         / /   # 8 8   -   I r a n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 8 9   -   I c e l a n d  
             C O N T I N E N T _ E U R O P E ,                     / /   # 9 0   -   I t a l y  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 9 1   -   J a m a i c a  
             C O N T I N E N T _ A S I A ,                         / /   # 9 2   -   J o r d a n  
             C O N T I N E N T _ A S I A ,                         / /   # 9 3   -   J a p a n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 9 4   -   K e n y a  
             C O N T I N E N T _ A S I A ,                         / /   # 9 5   -   K y r g y z s t a n  
             C O N T I N E N T _ A S I A ,                         / /   # 9 6   -   C a m b o d i a  
             C O N T I N E N T _ A S I A ,                         / /   # 9 7   -   K o r e a   ( D e m o c r a t i c   P e o p l e ' s   R e p u b l i c   o f )  
             C O N T I N E N T _ A S I A ,                         / /   # 9 8   -   K o r e a ,   R e p u b l i c   o f  
             C O N T I N E N T _ A S I A ,                         / /   # 9 9   -   K u w a i t  
             C O N T I N E N T _ A S I A ,                         / /   # 1 0 0   -   K a z a k h s t a n  
             C O N T I N E N T _ A S I A ,                         / /   # 1 0 1   -   L a o   P e o p l e ' s   D e m o c r a t i c   R e p u b l i c  
             C O N T I N E N T _ A S I A ,                         / /   # 1 0 2   -   L e b a n o n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 0 3   -   L i e c h t e n s t e i n  
             C O N T I N E N T _ A S I A ,                         / /   # 1 0 4   -   S r i   L a n k a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 0 5   -   L i b e r i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 0 6   -   L e s o t h o  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 0 7   -   L i t h u a n i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 0 8   -   L u x e m b o u r g  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 0 9   -   L a t v i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 1 0   -   L i b y a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 1 1   -   M o r o c c o  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 1 2   -   M o n a c o  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 1 3   -   M o l d o v a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 1 4   -   M o n t e n e g r o  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 1 5   -   M a d a g a s c a r  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 1 6   -   N o r t h   M a c e d o n i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 1 7   -   M a l i  
             C O N T I N E N T _ A S I A ,                         / /   # 1 1 8   -   M y a n m a r  
             C O N T I N E N T _ A S I A ,                         / /   # 1 1 9   -   M o n g o l i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 2 0   -   M a u r i t a n i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 2 1   -   M a l t a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 2 2   -   M a u r i t i u s  
             C O N T I N E N T _ A S I A ,                         / /   # 1 2 3   -   M a l d i v e s  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 2 4   -   M a l a w i  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 2 5   -   M e x i c o  
             C O N T I N E N T _ A S I A ,                         / /   # 1 2 6   -   M a l a y s i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 2 7   -   M o z a m b i q u e  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 2 8   -   N a m i b i a  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 2 9   -   N e w   C a l e d o n i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 3 0   -   N i g e r  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 3 1   -   N i g e r i a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 3 2   -   N i c a r a g u a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 3 3   -   N e t h e r l a n d s  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 3 4   -   N o r w a y  
             C O N T I N E N T _ A S I A ,                         / /   # 1 3 5   -   N e p a l  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 3 6   -   N e w   Z e a l a n d  
             C O N T I N E N T _ A S I A ,                         / /   # 1 3 7   -   O m a n  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 3 8   -   P a n a m a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 3 9   -   P e r u  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 4 0   -   P a p u a   N e w   G u i n e a  
             C O N T I N E N T _ A S I A ,                         / /   # 1 4 1   -   P h i l i p p i n e s  
             C O N T I N E N T _ A S I A ,                         / /   # 1 4 2   -   P a k i s t a n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 4 3   -   P o l a n d  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 4 4   -   P u e r t o   R i c o  
             C O N T I N E N T _ A S I A ,                         / /   # 1 4 5   -   P a l e s t i n e  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 4 6   -   P o r t u g a l  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 4 7   -   P a r a g u a y  
             C O N T I N E N T _ A S I A ,                         / /   # 1 4 8   -   Q a t a r  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 4 9   -   R o m a n i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 5 0   -   S e r b i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 5 1   -   R u s s i a n   F e d e r a t i o n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 5 2   -   R w a n d a  
             C O N T I N E N T _ A S I A ,                         / /   # 1 5 3   -   S a u d i   A r a b i a  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 5 4   -   S o l o m o n   I s l a n d s  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 5 5   -   S e y c h e l l e s  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 5 6   -   S u d a n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 5 7   -   S w e d e n  
             C O N T I N E N T _ A S I A ,                         / /   # 1 5 8   -   S i n g a p o r e  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 5 9   -   S l o v e n i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 6 0   -   S l o v a k i a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 6 1   -   S i e r r a   L e o n e  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 6 2   -   S a n   M a r i n o  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 6 3   -   S e n e g a l  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 6 4   -   S o m a l i a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 6 5   -   S u r i n a m e  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 6 6   -   S o u t h   S u d a n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 6 7   -   S a o   T o m e   a n d   P r i n c i p e  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 6 8   -   E l   S a l v a d o r  
             C O N T I N E N T _ A S I A ,                         / /   # 1 6 9   -   S y r i a n   A r a b   R e p u b l i c  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 7 0   -   E s w a t i n i  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 7 1   -   C h a d  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 7 2   -   T o g o  
             C O N T I N E N T _ A S I A ,                         / /   # 1 7 3   -   T h a i l a n d  
             C O N T I N E N T _ A S I A ,                         / /   # 1 7 4   -   T a j i k i s t a n  
             C O N T I N E N T _ A S I A ,                         / /   # 1 7 5   -   T u r k m e n i s t a n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 7 6   -   T u n i s i a  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A , / /   # 1 7 7   -   T o n g a  
             C O N T I N E N T _ A S I A ,                         / /   # 1 7 8   -   T u r k e y  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 7 9   T r i n i d a d   a n d   T o b a g o  
             C O N T I N E N T _ A S I A ,                         / /   # 1 8 0   -   T a i w a n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 8 1   -   T a n z a n i a  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 8 2   -   U k r a i n e  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 8 3   -   U g a n d a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 8 4   -   U n i t e d   S t a t e s   o f   A m e r i c a  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 8 5   -   U r u g u a y  
             C O N T I N E N T _ A S I A ,                         / /   # 1 8 6   -   U z b e k i s t a n  
             C O N T I N E N T _ E U R O P E ,                     / /   # 1 8 7   -   V a t i c a n  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 8 8   -   S a i n t   V i n c e n t   a n d   t h e   G r e n a d i n e s  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,       / /   # 1 8 9   -   V e n e z u e l a  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 9 0   -   V i r g i n   I s l a n d s   ( B r i t i s h )  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,       / /   # 1 9 1   -   V i r g i n   I s l a n d s   ( U . S . )  
             C O N T I N E N T _ A S I A ,                         / /   # 1 9 2   -   V i e t   N a m  
             C O N T I N E N T _ W O R L D ,                       / /   # 1 9 3   -   W o r l d w i d e  
             C O N T I N E N T _ A S I A ,                         / /   # 1 9 4   -   Y e m e n  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 9 5   -   S o u t h   A f r i c a  
             C O N T I N E N T _ A F R I C A ,                     / /   # 1 9 6   -   Z a m b i a  
             C O N T I N E N T _ A F R I C A                       / /   # 1 9 7   -   Z i m b a b w e  
           } ;  
 / / - - -  
       f o r ( i n t   c _ i d x   =   0 ;   c _ i d x   <   C O U N T R I E S _ N U M ;   c _ i d x + + )  
           {  
             s t r i n g   c u r r _ c o d e   =   C o d e s [ c _ i d x ] ;  
             i f ( ! : : S t r i n g C o m p a r e ( c u r r _ c o d e ,   _ s r c _ c o u n t r y _ c o d e ) )  
                 {  
                   c o d e   =   c u r r _ c o d e ;  
                   c o u n t r y   =   C o u n t r i e s [ c _ i d x ] ;  
                   c o n t i n e n t   =   C o n t i n e n t s [ c _ i d x ] ;  
                   s t r i n g   c h a r _ c o d e s [ 2 ] ;  
                   c h a r _ c o d e s [ 0 ]   = : : S t r i n g S u b s t r ( c u r r _ c o d e ,   0 ,   1 ) ;  
                   c h a r _ c o d e s [ 1 ]   = : : S t r i n g S u b s t r ( c u r r _ c o d e ,   1 ,   1 ) ;  
                   s t r i n g   t e m p _ u c o d e   =   N U L L ;  
                   i f ( ! : : S t r i n g C o m p a r e ( c h a r _ c o d e s [ 0 ] ,   " W " ) )  
                         i f ( ! : : S t r i n g C o m p a r e ( c h a r _ c o d e s [ 1 ] ,   " W " ) )  
                             {  
                               t e m p _ u c o d e   =   " \ x F 3 1 0 " ;  
                             }  
                   i f ( t e m p _ u c o d e   = =   N U L L )  
                         f o r ( i n t   l _ i d x   =   0 ;   l _ i d x   < : : A r r a y S i z e ( c h a r _ c o d e s ) ;   l _ i d x + + )  
                             {  
                               s t r i n g   c u r r _ c h a r   =   c h a r _ c o d e s [ l _ i d x ] ;  
                               u s h o r t   a b c d _ s t a r t   =   6 5 ;  
                               f o r ( i n t   l _ j d x   =   0 ;   l _ j d x   <   2 6 ;   l _ j d x + + )  
                                   {  
                                     s t r i n g   c u r r _ a b c d _ s t r   = : : S h o r t T o S t r i n g ( a b c d _ s t a r t ) ;  
                                     i f ( ! : : S t r i n g C o m p a r e ( c u r r _ a b c d _ s t r ,   c u r r _ c h a r ) )  
                                         {  
                                           t e m p _ u c o d e   + =   F l a g _ c o d e s [ l _ j d x ] ;  
                                           b r e a k ;  
                                         }  
                                     a b c d _ s t a r t + + ;  
                                   }  
                             }  
                   i f ( t e m p _ u c o d e   ! =   N U L L )  
                       {  
                         u n i c o d e   =   t e m p _ u c o d e ;  
                       }  
                   r e t u r n   t r u e ;  
                 }  
           }  
       r e t u r n   f a l s e ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o n t i n e n t   d e s c r i p t i o n                                                                                         |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   S C o u n t r y B y C o n t i n e n t : : C o n t i n e n t D e s c r i p t i o n ( v o i d )   c o n s t  
     {  
       s t r i n g   r e s _ s t r   =   N U L L ;  
 / / - - -  
       s w i t c h ( c o n t i n e n t )  
           {  
             c a s e   C O N T I N E N T _ W O R L D :  
                 {  
                   r e s _ s t r   =   " W o r l d " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ A S I A :  
                 {  
                   r e s _ s t r   =   " A s i a " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ A F R I C A :  
                 {  
                   r e s _ s t r   =   " A f r i c a " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ E U R O P E :  
                 {  
                   r e s _ s t r   =   " E u r o p e " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ N O R T H _ A M E R I C A :  
                 {  
                   r e s _ s t r   =   " N o r t h   A m e r i c a " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ S O U T H _ A M E R I C A :  
                 {  
                   r e s _ s t r   =   " S o u t h   A m e r i c a " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ A U S T R A L I A _ O C E A N I A :  
                 {  
                   r e s _ s t r   =   " A u s t r a l i a / O c e a n i a " ;  
                   b r e a k ;  
                 }  
             c a s e   C O N T I N E N T _ A N T A R C T I C A :  
                 {  
                   r e s _ s t r   =   " A n t a r c t i c a " ;  
                   b r e a k ;  
                 }  
           }  
       r e t u r n   r e s _ s t r ;  
     } ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |   C o n t i n e n t   b y   d e s c r i p t i o n                                                                                   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 E N U M _ C O N T I N E N T   S C o u n t r y B y C o n t i n e n t : : C o n t i n e n t B y D e s c r i p t i o n ( c o n s t   s t r i n g   _ s r c _ d e s c r i p t i o n )  
     {  
       E N U M _ C O N T I N E N T   r e s _ c o n t i n e n t   =   W R O N G _ V A L U E ;  
       s t r i n g   d e s c r i p t i o n s [ 8 ]   =  
           {  
             " W o r l d " ,  
             " A s i a " ,  
             " A f r i c a " ,  
             " E u r o p e " ,  
             " N o r t h   A m e r i c a " ,  
             " S o u t h   A m e r i c a " ,  
             " A u s t r a l i a / O c e a n i a " ,  
             " A n t a r c t i c a "  
           } ;  
       E N U M _ C O N T I N E N T   c o n t i n e n t s [ 8 ]   =  
           {  
             C O N T I N E N T _ W O R L D ,  
             C O N T I N E N T _ A S I A ,  
             C O N T I N E N T _ A F R I C A ,  
             C O N T I N E N T _ E U R O P E ,  
             C O N T I N E N T _ N O R T H _ A M E R I C A ,  
             C O N T I N E N T _ S O U T H _ A M E R I C A ,  
             C O N T I N E N T _ A U S T R A L I A _ O C E A N I A ,  
             C O N T I N E N T _ A N T A R C T I C A  
           } ;  
       f o r ( i n t   c t _ i d x   =   0 ;   c t _ i d x   <   8 ;   c t _ i d x + + )  
             i f ( ! : : S t r i n g C o m p a r e ( d e s c r i p t i o n s [ c t _ i d x ] ,   _ s r c _ d e s c r i p t i o n ) )  
                 {  
                   r e s _ c o n t i n e n t   =   c o n t i n e n t s [ c t _ i d x ] ;  
                   b r e a k ;  
                 }  
       r e t u r n   r e s _ c o n t i n e n t ;  
     }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / - - -   [ E O F ]  
 -e 

/ / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                         S e q L o g g e r . m q h   |  
 / / |                                                                         C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u .   |  
 / / |                                                                               h t t p s : / / t . m e / P r o T r a d e r S o f t   |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # p r o p e r t y   c o p y r i g h t   " C o p y r i g h t   2 0 2 4 ,   A k b a r   A t a l o u . "  
 # p r o p e r t y   l i n k             " h t t p s : / / t . m e / P r o T r a d e r S o f t "  
 # p r o p e r t y   s t r i c t  
  
  
 / /   M e s s a g e   l e v e l s  
 # d e f i n e   S E Q _ L E V _ D E B U G                           " D B G "   / /   d e b u g g i n g   ( f o r   s e r v i c e   u s e )  
 # d e f i n e   S E Q _ L E V _ I N F O                             " I N F "   / /   i n f o r m a t i o n   ( t o   t r a c k   t h e   f u n c t i o n a l i t y )  
 # d e f i n e   S E Q _ L E V _ W A R N I N G                       " W R N "   / /   w a r n i n g   ( a t t e n t i o n )  
 # d e f i n e   S E Q _ L E V _ E R R O R                           " E R R "   / /   n o n - c r i t i c a l   e r r o r   ( c h e c k   t h e   l o g ,   w o r k   c a n   b e   c o n t i n u e d )  
 # d e f i n e   S E Q _ L E V _ F A T A L                           " F T L "   / /   f a t a l   e r r o r   ( w o r k   c a n n o t   b e   c o n t i n u e d )  
 / /   M e s s a g e   o u t p u t   m a c r o s  
 # d e f i n e   S E Q _ L O G _ I N I T ( a p p N a m e , u r l S e q , h t t p H e a d e r )               _ S e q L o g g e r . I n I t ( a p p N a m e , u r l S e q , h t t p H e a d e r ) ;  
 # d e f i n e   S E Q _ L O G _ S E N D E R                                                                 _ S e q L o g g e r . S e t S e n d e r ( _ _ F I L E _ _ ,   _ _ F U N C T I O N _ _ ) ;  
 / /   t y p e   o n e  
 # d e f i n e   S E Q _ L O G _ I N F O ( m e s s a g e )                                                   S E Q _ L O G _ S E N D E R ;   _ S e q L o g g e r . I n f o ( m e s s a g e ) ;  
 # d e f i n e   S E Q _ L O G _ D E B U G ( m e s s a g e )                                                 S E Q _ L O G _ S E N D E R ;   _ S e q L o g g e r . D e b u g ( m e s s a g e ) ;  
 # d e f i n e   S E Q _ L O G _ W A R N I N G ( m e s s a g e )                                             S E Q _ L O G _ S E N D E R ;   _ S e q L o g g e r . W a r n i n g ( m e s s a g e ) ;  
 # d e f i n e   S E Q _ L O G _ E R R O R ( m e s s a g e )                                                 S E Q _ L O G _ S E N D E R ;   _ S e q L o g g e r . E r r o r ( m e s s a g e ) ;  
 # d e f i n e   S E Q _ L O G _ F A T A L ( m e s s a g e )                                                 S E Q _ L O G _ S E N D E R ;   _ S e q L o g g e r . F a t a l ( m e s s a g e ) ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 c l a s s   C S e q L o g g e r  
   {  
 p r i v a t e :  
     s t r i n g                           m _ m o d u l e ;   / /   m o d u l e   ( f i l e )   n a m e  
     s t r i n g                           m _ s e n d e r ;   / /   f u n c t i o n   n a m e  
     s t r i n g                           m _ l e v e l ;   / /   m e s s a g e   l e v e l  
     s t r i n g                           m _ m e s s a g e ;   / /   m e s s a g e   t e x t  
     s t r i n g                           m _ u r l S e q ;   / /   u r l   o f   t h e   S e q   s e r v i c e  
     s t r i n g                           m _ a p p N a m e ;   / /   a p p l i c a t i o n   n a m e   f o r   S e q  
     s t r i n g                           m _ h t t p H e a d e r ;  
     s t r i n g                           m _ s y m b o l ;  
     s t r i n g                           m _ p e r i o d ;  
     s t r i n g                           m _ a p p I d ;  
     s t r i n g                           m _ l o g i n ;  
     b o o l                               m _ u s e _ c u r r _ l o g i n ;  
     s t r i n g                           m _ t a s k ;  
     s t r i n g                           m _ s t a t u s ;  
     s t r i n g                           m _ e r r o r C o d e ;  
     s t r i n g                           m _ e r r o r D e s c r i p t ;  
  
     / /   p r i v a t e   m e t h o d s  
     v o i d                               L o g ( s t r i n g   l e v e l ,   s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E ) ;  
     s t r i n g                           T i m e T o S t r ( d a t e t i m e   v a l u e ) ;  
     s t r i n g                           P e r i o d T o S t r ( E N U M _ T I M E F R A M E S   v a l u e ) ;  
     s t r i n g                           Q u o t e ( s t r i n g   v a l u e ) ;  
     s t r i n g                           L e v e l ( v o i d ) ;  
     v o i d                               S e n d T o S e q ( v o i d ) ;  
     s t r i n g                           C r e a t e J s o n M s g ( v o i d ) ;  
 p u b l i c :  
                                           C S e q L o g g e r ( v o i d ) ;  
  
     v o i d                               S e t S e n d e r ( s t r i n g   m o d u l e ,   s t r i n g   s e n d e r ) ;  
     v o i d                               S e t U r l ( c o n s t   s t r i n g   u r l S e q )                               {   m _ u r l S e q   =   u r l S e q ; }  
     v o i d                               S e t A p p N a m e ( c o n s t   s t r i n g   a p p N a m e )                     {   m _ a p p N a m e   =   a p p N a m e ; }  
     v o i d                               S e t H t t p H e a d e r ( c o n s t   s t r i n g   h t t p H e a d e r )         {   m _ h t t p H e a d e r   =   h t t p H e a d e r ; }  
     v o i d                               S e t A p p I d ( c o n s t   s t r i n g   a p p I d )                             {   m _ a p p I d   =   a p p I d ; }  
     v o i d                               S e t L o g i n ( c o n s t   s t r i n g   l o g i n )                             {   m _ l o g i n   =   l o g i n ; }  
     v o i d                               S e t U s e C u r r L o g i n ( c o n s t   b o o l   v a l u e )                   {   m _ u s e _ c u r r _ l o g i n   =   v a l u e ; }  
     v o i d                               S e t T a s k ( c o n s t   s t r i n g   t a s k )                                 {   m _ t a s k   =   t a s k ; }  
     v o i d                               S e t S t a t u s ( c o n s t   s t r i n g   s t a t u s )                         {   m _ s t a t u s   =   s t a t u s ; }  
     v o i d                               S e t E r r o r C o d e ( c o n s t   s t r i n g   e r r o r C o d e )             {   m _ e r r o r C o d e   =   e r r o r C o d e ; }  
     v o i d                               S e t D e s c r i p t i o n ( c o n s t   s t r i n g   d e s c r i p t )           {   m _ e r r o r D e s c r i p t   =   d e s c r i p t ; }  
     v o i d                               I n I t ( c o n s t   s t r i n g   a p p N a m e ,  
                                                     c o n s t   s t r i n g   u r l S e q ,  
                                                     c o n s t   s t r i n g   h t t p H e a d e r ) ;  
     v o i d                               D e b u g ( s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E )         {   L o g ( S E Q _ L E V _ D E B U G ,   m e s s a g e ,   s y m b o l ,   p e r i o d ) ; } ;  
     v o i d                               I n f o ( s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E )           {   L o g ( S E Q _ L E V _ I N F O ,   m e s s a g e ,   s y m b o l ,   p e r i o d ) ; } ;  
     v o i d                               W a r n i n g ( s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E )     {   L o g ( S E Q _ L E V _ W A R N I N G ,   m e s s a g e ,   s y m b o l ,   p e r i o d ) ; } ;  
     v o i d                               E r r o r ( s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E )         {   L o g ( S E Q _ L E V _ E R R O R ,   m e s s a g e ,   s y m b o l ,   p e r i o d ) ; } ;  
     v o i d                               F a t a l ( s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E )         {   L o g ( S E Q _ L E V _ F A T A L ,   m e s s a g e ,   s y m b o l ,   p e r i o d ) ; } ;  
   } ;  
 s t a t i c   C S e q L o g g e r   _ S e q L o g g e r ;  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   C o n s t r u c t o r  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 C S e q L o g g e r : : C S e q L o g g e r ( v o i d )  
   {  
     m _ a p p N a m e   =   " M T 5 " ;  
     m _ u r l S e q   =   " " ;  
     m _ h t t p H e a d e r   =   " C o n t e n t - T y p e :   a p p l i c a t i o n / v n d . s e r i l o g . c l e f \ r \ n " ;  
     m _ a p p I d   =   " - " ;  
     m _ u s e _ c u r r _ l o g i n   =   t r u e ;  
     m _ l o g i n   =   ( s t r i n g ) : : A c c o u n t I n f o I n t e g e r ( A C C O U N T _ L O G I N ) ;  
     m _ t a s k   =   " - " ;  
     m _ s t a t u s   =   " - " ;  
     m _ e r r o r C o d e   =   " - " ;  
     m _ e r r o r D e s c r i p t   =   " - " ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   S e t   t h e   m e s s a g e   s e n d e r  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C S e q L o g g e r : : S e t S e n d e r ( s t r i n g   m o d u l e ,   s t r i n g   s e n d e r )  
   {  
     m _ m o d u l e   =   m o d u l e ;   / /   m o d u l e   ( f i l e )   n a m e  
     m _ s e n d e r   =   s e n d e r ;   / /   f u n c t i o n   n a m e  
     S t r i n g R e p l a c e ( m _ m o d u l e ,   " . m q 5 " ,   " . c p p 5 " ) ;  
     S t r i n g R e p l a c e ( m _ m o d u l e ,   " . m q h " ,   " . c p p " ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C S e q L o g g e r : : I n I t ( c o n s t   s t r i n g   a p p N a m e ,   c o n s t   s t r i n g   u r l S e q ,   c o n s t   s t r i n g   h t t p H e a d e r )  
   {  
     S e t A p p N a m e ( a p p N a m e ) ;  
     S e t U r l ( u r l S e q ) ;  
     S e t H t t p H e a d e r ( h t t p H e a d e r ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   E n c l o s e   t h e   s t r i n g   i n   d o u b l e   q u o t e s  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C S e q L o g g e r : : Q u o t e ( s t r i n g   v a l u e )  
   {  
     r e t u r n   " \ " "   +   v a l u e   +   " \ " " ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   C o n v e r t   t h e   m e s s a g e   l e v e l   t o   a   f o r m a t   f o r   S e q  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C S e q L o g g e r : : L e v e l ( )  
   {  
     i f ( m _ l e v e l   = =   S E Q _ L E V _ D E B U G )  
         r e t u r n   " D e b u g " ;  
     i f ( m _ l e v e l   = =   S E Q _ L E V _ W A R N I N G )  
         r e t u r n   " W a r n i n g " ;  
     i f ( m _ l e v e l   = =   S E Q _ L E V _ E R R O R )  
         r e t u r n   " E r r o r " ;  
     i f ( m _ l e v e l   = =   S E Q _ L E V _ F A T A L )  
         r e t u r n   " F a t a l " ;  
     r e t u r n   " I n f o r m a t i o n " ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   C o n v e r t   t i m e   t o   t h e   I S O 8 6 0 1   f o r m a t   f o r   S e q  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C S e q L o g g e r : : T i m e T o S t r ( d a t e t i m e   v a l u e )  
   {  
     M q l D a t e T i m e   m d t ;  
     T i m e T o S t r u c t ( v a l u e ,   m d t ) ;  
     u l o n g   m s e c   =   G e t T i c k C o u n t 6 4 ( )   %   1 0 0 0 ;   / /   f o r   c o m p a r i s o n  
     r e t u r n   S t r i n g F o r m a t ( " % 4 i - % 0 2 i - % 0 2 i T % 0 2 i : % 0 2 i : % 0 2 i . % 0 3 i Z " ,  
                                             m d t . y e a r ,   m d t . m o n ,   m d t . d a y ,   m d t . h o u r ,   m d t . m i n ,   m d t . s e c ,   m s e c ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   C o n v e r t   p e r i o d   t o   s t r i n g  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C S e q L o g g e r : : P e r i o d T o S t r ( E N U M _ T I M E F R A M E S   v a l u e )  
   {  
     r e t u r n   S t r i n g S u b s t r ( E n u m T o S t r i n g ( v a l u e ) ,   7 ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / / |                                                                                                                                     |  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 s t r i n g   C S e q L o g g e r : : C r e a t e J s o n M s g ( v o i d )  
   {  
 / /   r e p l a c e   i l l e g a l   c h a r a c t e r s  
     S t r i n g R e p l a c e ( m _ m e s s a g e ,   " \ n " ,   "   " ) ;  
     S t r i n g R e p l a c e ( m _ m e s s a g e ,   " \ t " ,   "   " ) ;  
 / /   p r e p a r e   s t r i n g   i n   c l e f   ( C o m p a c t   L o g g i n g   E v e n t   F o r m a t )  
     i f ( m _ u s e _ c u r r _ l o g i n )  
         m _ l o g i n   =   ( s t r i n g ) : : A c c o u n t I n f o I n t e g e r ( A C C O U N T _ L O G I N ) ;  
  
     s t r i n g   e x t _ m e s s a g e   =   : : S t r i n g F o r m a t ( " % s ( % s ) ,   % s ( % s )   /   % s   /   % s   /   % s " ,  
                                                                             m _ a p p N a m e ,   m _ a p p I d ,   m _ t a s k ,   m _ s t a t u s ,   m _ m o d u l e ,   m _ s e n d e r ,   m _ m e s s a g e ) ;  
     r e t u r n   " { "   +  
                   " \ " @ t \ " : "                               +   Q u o t e ( T i m e T o S t r ( T i m e C u r r e n t ( ) ) )   +   / /   m e s s a g e   t i m e  
                   " , \ " @ m t \ " : "                           +   Q u o t e ( e x t _ m e s s a g e )   +                             / /   m e s s a g e   w i t h   a d d i t i o n a l   i n f o  
                   " , \ " @ l \ " : "                             +   Q u o t e ( L e v e l ( ) )   +                                     / /   l e v e l   d e t a i l s   ( I n f o r m a t i o n )  
                   " , \ " A p p l i c a t i o n \ " : "           +   Q u o t e ( m _ a p p N a m e )   +                                 / /   a p p l i c a t i o n   n a m e  
                   " , \ " I d \ " : "                             +   Q u o t e ( m _ a p p I d )   +                                     / /   a p p l i c a t i o n   i d  
                   " , \ " L o g i n \ " : "                       +   Q u o t e ( m _ l o g i n )   +                                     / /   l o g i n  
                   " , \ " T a s k \ " : "                         +   Q u o t e ( m _ t a s k )   +                                       / /   t a s k  
                   " , \ " S y m b o l \ " : "                     +   Q u o t e ( m _ s y m b o l )   +                                   / /   s y m b o l   ( E U R U S D )  
                   " , \ " P e r i o d \ " : "                     +   Q u o t e ( m _ p e r i o d )   +                                   / /   p e r i o d   ( H 4 )  
                   " , \ " M o d u l e \ " : "                     +   Q u o t e ( m _ m o d u l e )   +                                   / /   m o d u l e   n a m e   ( _ _ F I L E _ _ )  
                   " , \ " S e n d e r \ " : "                     +   Q u o t e ( m _ s e n d e r )   +                                   / /   s e n d e r   n a m e   ( _ _ F U N C T I O N _ _ )  
                   " , \ " L e v e l \ " : "                       +   Q u o t e ( m _ l e v e l )   +                                     / /   l e v e l   a b b r e v i a t i o n   ( I N F )  
                   " , \ " S t a t u s \ " : "                     +   Q u o t e ( m _ s t a t u s )   +                                   / /   s t a t u s  
                   " , \ " E r r o r C o d e \ " : "               +   Q u o t e ( m _ e r r o r C o d e )   +                             / /   e r r o r   c o d e  
                   " , \ " E r r o r D e s c r i p \ " : "         +   Q u o t e ( m _ e r r o r D e s c r i p t )   +                     / /   e r r o r   d e s c r i p t i o n  
                   " , \ " M e s s a g e \ " : "                   +   Q u o t e ( m _ m e s s a g e )   +                                 / /   m e s s a g e   w i t h o u t   a d d i t i o n a l   i n f o  
                   " } " ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   S e n d   m e s s a g e   t o   S e q   v i a   h t t p  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C S e q L o g g e r : : S e n d T o S e q ( v o i d )  
   {  
     s t r i n g   c l e f   =   C r e a t e J s o n M s g ( ) ;  
  
 / /   p r e p a r e   d a t a   f r o   P O S T   r e q u e s t  
     c h a r   d a t a [ ] ;   / /   H T T P   m e s s a g e   b o d y   d a t a   a r r a y  
     c h a r   r e s u l t [ ] ;   / /   w e b   s e r v i c e   r e s p o n s e   d a t a   a r r a y  
     s t r i n g   a n s w e r ;   / /   w e b   s e r v i c e   r e s p o n s e   h e a d e r s  
     s t r i n g   h e a d e r s   =   m _ h t t p H e a d e r ;  
     : : A r r a y R e s i z e ( d a t a ,   : : S t r i n g T o C h a r A r r a y ( c l e f ,   d a t a ,   0 ,   W H O L E _ A R R A Y ,   C P _ U T F 8 )   -   1 ) ;  
  
 / /   s e n d   m e s s a g e   t o   S e q   v i a   h t t p  
     : : R e s e t L a s t E r r o r ( ) ;  
     i n t   r c o d e   =   : : W e b R e q u e s t ( " P O S T " ,   m _ u r l S e q ,   h e a d e r s ,   3 0 0 0 ,   d a t a ,   r e s u l t ,   a n s w e r ) ;  
     i f ( r c o d e   >   2 0 1 )  
       {  
         : : P r i n t F o r m a t ( " % s   /   r c o d e = % i   /   u r l = % s   /   a n s w e r = % s   /   % s " ,   _ _ F U N C T I O N _ _ ,  
                                     r c o d e ,   m _ u r l S e q ,   a n s w e r ,   : : C h a r A r r a y T o S t r i n g ( r e s u l t ) ) ;  
       }  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 / /   W r i t e   a   m e s s a g e   t o   l o g  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 v o i d   C S e q L o g g e r : : L o g ( s t r i n g   l e v e l ,   s t r i n g   m e s s a g e ,   s t r i n g   s y m b o l   =   N U L L ,   i n t   p e r i o d   =   W R O N G _ V A L U E )  
   {  
     m _ l e v e l   =   l e v e l ;  
     m _ m e s s a g e   =   m e s s a g e ;  
     m _ s y m b o l   =   s y m b o l   = =   N U L L   ?   " - "   :   _ S y m b o l ;  
     m _ p e r i o d   =   p e r i o d   = =   W R O N G _ V A L U E   ?   " - "   :   P e r i o d T o S t r ( _ P e r i o d ) ;  
  
 / /   p r i n t   m e s s a g e   t o   t h e   e x p e r t s   j o u r n a l   ( T o o l b o x / E x p e r t s )  
 / / P r i n t F o r m a t ( " % s :   % s   % s " ,   m _ l e v e l ,   m _ s e n d e r ,   m _ m e s s a g e ) ;  
  
 / /   i f   U R L   i s   d e f i n e d ,   s e n d   m e s s a g e   t o   S e q   v i a   h t t p  
     i f ( m _ u r l S e q   ! =   " " )  
         S e n d T o S e q ( ) ;  
   }  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 # u n d e f   S E Q _ L E V _ D E B U G  
 # u n d e f   S E Q _ L E V _ I N F O  
 # u n d e f   S E Q _ L E V _ W A R N I N G  
 # u n d e f   S E Q _ L E V _ E R R O R  
 # u n d e f   S E Q _ L E V _ F A T A L  
 / / + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +  
 -e 

//+------------------------------------------------------------------+
//|                                                       winapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include "windef.mqh"
#include "winnt.mqh"
#include "fileapi.mqh"
#include "winbase.mqh"
#include "winuser.mqh"
#include "wingdi.mqh"
#include "winreg.mqh"
#include "handleapi.mqh"
#include "processthreadsapi.mqh"
#include "securitybaseapi.mqh"
#include "errhandlingapi.mqh"
#include "sysinfoapi.mqh"
#include "processenv.mqh"
#include "libloaderapi.mqh"
#include "memoryapi.mqh"
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      WinBase.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>
#include <WinAPI\fileapi.mqh>

//---
#define OFS_MAXPATHNAME            128
#define HW_PROFILE_GUIDLEN         39
#define MAX_PROFILE_LEN            80
#define RESTART_MAX_CMD_LINE       1024

//---
enum COPYFILE2_COPY_PHASE
  {
   COPYFILE2_PHASE_NONE=0,
   COPYFILE2_PHASE_PREPARE_SOURCE,
   COPYFILE2_PHASE_PREPARE_DEST,
   COPYFILE2_PHASE_READ_SOURCE,
   COPYFILE2_PHASE_WRITE_DESTINATION,
   COPYFILE2_PHASE_SERVER_COPY,
   COPYFILE2_PHASE_NAMEGRAFT_COPY,
   COPYFILE2_PHASE_MAX
  };
//---
enum COPYFILE2_MESSAGE_ACTION
  {
   COPYFILE2_PROGRESS_CONTINUE=0,
   COPYFILE2_PROGRESS_CANCEL,
   COPYFILE2_PROGRESS_STOP,
   COPYFILE2_PROGRESS_QUIET,
   COPYFILE2_PROGRESS_PAUSE
  };
//---
enum COPYFILE2_MESSAGE_TYPE
  {
   COPYFILE2_CALLBACK_NONE=0,
   COPYFILE2_CALLBACK_CHUNK_STARTED,
   COPYFILE2_CALLBACK_CHUNK_FINISHED,
   COPYFILE2_CALLBACK_STREAM_STARTED,
   COPYFILE2_CALLBACK_STREAM_FINISHED,
   COPYFILE2_CALLBACK_POLL_CONTINUE,
   COPYFILE2_CALLBACK_ERROR,
   COPYFILE2_CALLBACK_MAX
  };
//---
enum DEP_SYSTEM_POLICY_TYPE
  {
   DEPPolicyAlwaysOff=0,
   DEPPolicyAlwaysOn,
   DEPPolicyOptIn,
   DEPPolicyOptOut,
   DEPTotalPolicyCount
  };
//---
enum FILE_ID_TYPE
  {
   FileIdType,
   ObjectIdType,
   ExtendedFileIdType,
   MaximumFileIdType
  };
//---
enum PRIORITY_HINT
  {
   IoPriorityHintVeryLow=0,
   IoPriorityHintLow,
   IoPriorityHintNormal,
   MaximumIoPriorityHintType
  };
//---
enum PROC_THREAD_ATTRIBUTE_NUM
  {
   ProcThreadAttributeParentProcess=0,
   ProcThreadAttributeHandleList=2,
   ProcThreadAttributeGroupAffinity=3,
   ProcThreadAttributePreferredNode=4,
   ProcThreadAttributeIdealProcessor=5,
   ProcThreadAttributeUmsThread=6,
   ProcThreadAttributeMitigationPolicy=7,
   ProcThreadAttributeSecurityCapabilities=9,
   ProcThreadAttributeProtectionLevel=11,
   ProcThreadAttributeJobList=13,
   ProcThreadAttributeChildProcessPolicy=14,
   ProcThreadAttributeAllApplicationPackagesPolicy=15,
   ProcThreadAttributeWin32kFilter=16,
   ProcThreadAttributeSafeOpenPromptOriginClaim=17,
   ProcThreadAttributeDesktopAppPolicy=18
  };
//---
struct ACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA
  {
   PVOID             lpInformation;
   PVOID             lpSectionBase;
   uint              ulSectionLength;
   PVOID             lpSectionGlobalDataBase;
   uint              ulSectionGlobalDataLength;
  };
//---
struct ACTCTX_SECTION_KEYED_DATA
  {
   uint              cbSize;
   uint              ulDataFormatVersion;
   PVOID             lpData;
   uint              ulLength;
   PVOID             lpSectionGlobalData;
   uint              ulSectionGlobalDataLength;
   PVOID             lpSectionBase;
   uint              ulSectionTotalLength;
   HANDLE            hActCtx;
   uint              ulAssemblyRosterIndex;
   uint              ulFlags;
   ACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA AssemblyMetadata;
  };
//---
struct ACTCTX_SECTION_KEYED_DATA_2600
  {
   uint              cbSize;
   uint              ulDataFormatVersion;
   PVOID             lpData;
   uint              ulLength;
   PVOID             lpSectionGlobalData;
   uint              ulSectionGlobalDataLength;
   PVOID             lpSectionBase;
   uint              ulSectionTotalLength;
   HANDLE            hActCtx;
   uint              ulAssemblyRosterIndex;
  };
//---
struct ACTCTXW
  {
   uint              cbSize;
   uint              dwFlags;
   PVOID             lpSource;
   ushort            wProcessorArchitecture;
   ushort            wLangId;
   PVOID             lpAssemblyDirectory;
   PVOID             lpResourceName;
   PVOID             lpApplicationName;
   HANDLE            hModule;
  };
//---
struct ACTIVATION_CONTEXT_BASIC_INFORMATION
  {
   HANDLE            hActCtx;
   uint              dwFlags;
  };
//---
struct DCB
  {
   uint              DCBlength;
   uint              BaudRate;
   uint              Flags;
   ushort            wReserved;
   ushort            XonLim;
   ushort            XoffLim;
   uchar             ByteSize;
   uchar             Parity;
   uchar             StopBits;
   char              XonChar;
   char              XoffChar;
   char              ErrorChar;
   char              EofChar;
   char              EvtChar;
   ushort            wReserved1;
  };
//---
struct COMMCONFIG
  {
   uint              dwSize;
   ushort            wVersion;
   ushort            wReserved;
   DCB               dcb;
   uint              dwProviderSubType;
   uint              dwProviderOffset;
   uint              dwProviderSize;
   short             wcProviderData[2];
  };
//---
struct COMMPROP
  {
   ushort            wPacketLength;
   ushort            wPacketVersion;
   uint              dwServiceMask;
   uint              dwReserved1;
   uint              dwMaxTxQueue;
   uint              dwMaxRxQueue;
   uint              dwMaxBaud;
   uint              dwProvSubType;
   uint              dwProvCapabilities;
   uint              dwSettableParams;
   uint              dwSettableBaud;
   ushort            wSettableData;
   ushort            wSettableStopParity;
   uint              dwCurrentTxQueue;
   uint              dwCurrentRxQueue;
   uint              dwProvSpec1;
   uint              dwProvSpec2;
   short             wcProvChar[1];
  };
//---
struct COMMTIMEOUTS
  {
   uint              ReadIntervalTimeout;
   uint              ReadTotalTimeoutMultiplier;
   uint              ReadTotalTimeoutConstant;
   uint              WriteTotalTimeoutMultiplier;
   uint              WriteTotalTimeoutConstant;
  };
//---
struct COMSTAT
  {
   uint              cbInQue;
   uint              cbOutQue;
  };
//---
struct COPYFILE2_EXTENDED_PARAMETERS
  {
   uint              dwSize;
   uint              dwCopyFlags;
   PVOID             pfCancel;
   PVOID             pProgressRoutine;
   PVOID             pvCallbackContext;
  };
//---
struct EVENTLOG_FULL_INFORMATION
  {
   uint              dwFull;
  };
//---
struct FILE_ALIGNMENT_INFO: public FILE_INFO
  {
   uint              AlignmentRequirement;
  };
//---
struct FILE_ALLOCATION_INFO: public FILE_INFO
  {
   long              AllocationSize;
  };
//---
struct FILE_ATTRIBUTE_TAG_INFO: public FILE_INFO
  {
   uint              FileAttributes;
   uint              ReparseTag;
  };
//---
struct FILE_BASIC_INFO: public FILE_INFO
  {
   long              CreationTime;
   long              LastAccessTime;
   long              LastWriteTime;
   long              ChangeTime;
   uint              FileAttributes;
  };
//---
struct FILE_COMPRESSION_INFO: public FILE_INFO
  {
   long              CompressedFileSize;
   ushort            CompressionFormat;
   uchar             CompressionUnitShift;
   uchar             ChunkShift;
   uchar             ClusterShift;
   uchar             Reserved[3];
  };
//---
struct FILE_DISPOSITION_INFO: public FILE_INFO
  {
   uchar             DeleteFile;
  };
//---
struct FILE_DISPOSITION_INFO_EX: public FILE_INFO
  {
   uint              Flags;
  };
//---
struct FILE_END_OF_FILE_INFO: public FILE_INFO
  {
   long              EndOfFile;
  };
//---
struct FILE_FULL_DIR_INFO: public FILE_INFO
  {
   uint              NextEntryOffset;
   uint              FileIndex;
   long              CreationTime;
   long              LastAccessTime;
   long              LastWriteTime;
   long              ChangeTime;
   long              EndOfFile;
   long              AllocationSize;
   uint              FileAttributes;
   uint              FileNameLength;
   uint              EaSize;
   short             FileName[1];
  };
//---
struct FILE_ID_BOTH_DIR_INFO: public FILE_INFO
  {
   uint              NextEntryOffset;
   uint              FileIndex;
   long              CreationTime;
   long              LastAccessTime;
   long              LastWriteTime;
   long              ChangeTime;
   long              EndOfFile;
   long              AllocationSize;
   uint              FileAttributes;
   uint              FileNameLength;
   uint              EaSize;
   char              ShortNameLength;
   short             ShortName[12];
   long              FileId;
   short             FileName[1];
  };
//---
struct FILE_ID_EXTD_DIR_INFO: public FILE_INFO
  {
   uint              NextEntryOffset;
   uint              FileIndex;
   long              CreationTime;
   long              LastAccessTime;
   long              LastWriteTime;
   long              ChangeTime;
   long              EndOfFile;
   long              AllocationSize;
   uint              FileAttributes;
   uint              FileNameLength;
   uint              EaSize;
   uint              ReparsePointTag;
   FILE_ID_128       FileId;
   short             FileName[1];
  };
//---
struct FILE_ID_INFO: public FILE_INFO
  {
   ulong             VolumeSerialNumber;
   FILE_ID_128       FileId;
  };
//---
struct FILE_IO_PRIORITY_HINT_INFO: public FILE_INFO
  {
   PRIORITY_HINT     PriorityHint;
  };
//---
struct FILE_NAME_INFO
  {
   uint              FileNameLength;
   short             FileName[2];
  };
//---
struct FILE_STANDARD_INFO: public FILE_INFO
  {
   long              AllocationSize;
   long              EndOfFile;
   uint              NumberOfLinks;
   uchar             DeletePending;
   uchar             Directory;
  };
//---
struct FILE_STORAGE_INFO: public FILE_INFO
  {
   uint              LogicalBytesPerSector;
   uint              PhysicalBytesPerSectorForAtomicity;
   uint              PhysicalBytesPerSectorForPerformance;
   uint              FileSystemEffectivePhysicalBytesPerSectorForAtomicity;
   uint              Flags;
   uint              ByteOffsetForSectorAlignment;
   uint              ByteOffsetForPartitionAlignment;
  };
//---
struct FILE_STREAM_INFO: public FILE_INFO
  {
   uint              NextEntryOffset;
   uint              StreamNameLength;
   long              StreamSize;
   long              StreamAllocationSize;
   short             StreamName[1];
  };
//---
struct HW_PROFILE_INFOW
  {
   uint              dwDockInfo;
   short             szHwProfileGuid[HW_PROFILE_GUIDLEN];
   short             szHwProfileName[MAX_PROFILE_LEN];
  };
//---
struct JIT_DEBUG_INFO
  {
   uint              dwSize;
   uint              dwProcessorArchitecture;
   uint              dwThreadID;
   uint              dwReserved0;
   ulong             lpExceptionAddress;
   ulong             lpExceptionRecord;
   ulong             lpContextRecord;
  };
//---
struct MEMORYSTATUS
  {
   uint              dwLength;
   uint              dwMemoryLoad;
   ulong             dwTotalPhys;
   ulong             dwAvailPhys;
   ulong             dwTotalPageFile;
   ulong             dwAvailPageFile;
   ulong             dwTotalVirtual;
   ulong             dwAvailVirtual;
  };
//---
struct OFSTRUCT
  {
   uchar             cBytes;
   uchar             fFixedDisk;
   ushort            nErrCode;
   ushort            Reserved1;
   ushort            Reserved2;
   char              szPathName[OFS_MAXPATHNAME];
  };
//---
struct OPERATION_END_PARAMETERS
  {
   uint              Version;
   uint              OperationId;
   uint              Flags;
  };
//---
struct OPERATION_START_PARAMETERS
  {
   uint              Version;
   uint              OperationId;
   uint              Flags;
  };
//---
struct SYSTEM_POWER_STATUS
  {
   uchar             ACLineStatus;
   uchar             BatteryFlag;
   uchar             BatteryLifePercent;
   uchar             SystemStatusFlag;
   uint              BatteryLifeTime;
   uint              BatteryFullLifeTime;
  };
//---
struct UMS_SCHEDULER_STARTUP_INFO
  {
   uint              UmsVersion;
   PVOID             CompletionList;
   PVOID             SchedulerProc;
   PVOID             SchedulerParam;
  };
//---
struct WIN32_STREAM_ID
  {
   uint              dwStreamId;
   uint              dwStreamAttributes;
   long              Size;
   uint              dwStreamNameSize;
  };
//---
struct UMS_SYSTEM_THREAD_INFORMATION
  {
   uint              UmsVersion;
   uint              ThreadUmsFlags;
  };
//---
struct FILE_ID_DESCRIPTOR
  {
   uint              dwSize;
   FILE_ID_TYPE      Type;
   long              FileId;
  };
//---
struct SYSTEMTIME
  {
   ushort            wYear;
   ushort            wMonth;
   ushort            wDayOfWeek;
   ushort            wDay;
   ushort            wHour;
   ushort            wMinute;
   ushort            wSecond;
   ushort            wMilliseconds;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int                    ActivateActCtx(HANDLE act_ctx,PVOID &cookie);
int                    ActivateActCtx(ACTCTXW &act_ctx,PVOID &cookie);
ushort                 AddAtomW(const string str);
int                    AddIntegrityLabelToBoundaryDescriptor(HANDLE &BoundaryDescriptor,SID &IntegrityLabel);
void                   AddRefActCtx(HANDLE act_ctx);
void                   AddRefActCtx(ACTCTXW &act_ctx);
int                    AddSecureMemoryCacheCallback(PVOID call_back);
void                   ApplicationRecoveryFinished(int success);
int                    ApplicationRecoveryInProgress(int &cancelled);
int                    BackupRead(HANDLE file,uchar &buffer[],uint number_of_bytes_to_read,uint &number_of_bytes_read,int abort,int process_security,PVOID &context);
int                    BackupSeek(HANDLE file,uint low_bytes_to_seek,uint high_bytes_to_seek,uint &low_byte_seeked,uint &high_byte_seeked,PVOID &context);
int                    BackupWrite(HANDLE file,uchar &buffer[],uint number_of_bytes_to_write,uint &number_of_bytes_written,int abort,int process_security,PVOID &context);
HANDLE                 BeginUpdateResourceW(const string file_name,int delete_existing_resources);
int                    BindIoCompletionCallback(HANDLE FileHandle,PVOID Function,uint Flags);
int                    BuildCommDCBAndTimeoutsW(const string def,DCB &lpDCB,COMMTIMEOUTS &comm_timeouts);
int                    BuildCommDCBW(const string def,DCB &lpDCB);
int                    CancelDeviceWakeupRequest(HANDLE device);
int                    CancelTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer);
int                    CheckNameLegalDOS8Dot3W(const string name,char &oem_name[],uint oem_name_size,int &name_contains_spaces,int &name_legal);
int                    ClearCommBreak(HANDLE file);
int                    ClearCommError(HANDLE file,uint &errors,COMSTAT &stat);
int                    CommConfigDialogW(const string name,HANDLE wnd,COMMCONFIG &lpCC);
int                    ConvertFiberToThread(void);
PVOID                  ConvertThreadToFiber(PVOID parameter);
PVOID                  ConvertThreadToFiberEx(PVOID parameter,uint flags);
int                    CopyContext(CONTEXT &Destination,uint ContextFlags,CONTEXT &Source);
int                    CopyFile2(const string existing_file_name,const string new_file_name,COPYFILE2_EXTENDED_PARAMETERS &extended_parameters);
int                    CopyFileExW(const string existing_file_name,const string new_file_name,PVOID progress_routine,PVOID data,int &cancel,uint copy_flags);
int                    CopyFileTransactedW(const string existing_file_name,const string new_file_name,PVOID progress_routine,PVOID data,int &cancel,uint copy_flags,HANDLE transaction);
int                    CopyFileW(const string existing_file_name,const string new_file_name,int fail_if_exists);
HANDLE                 CreateActCtxW(const ACTCTXW &act_ctx);
int                    CreateDirectoryExW(const string template_directory,const string new_directory,PVOID security_attributes);
int                    CreateDirectoryTransactedW(const string template_directory,const string new_directory,PVOID security_attributes,HANDLE transaction);
PVOID                  CreateFiber(ulong stack_size,PVOID start_address,PVOID parameter);
PVOID                  CreateFiberEx(ulong stack_commit_size,ulong stack_reserve_size,uint flags,PVOID start_address,PVOID parameter);
HANDLE                 CreateFileTransactedW(const string file_name,uint desired_access,uint share_mode,PVOID security_attributes,uint creation_disposition,uint flags_and_attributes,HANDLE template_file,HANDLE transaction,ushort &mini_version,PVOID extended_parameter);
int                    CreateHardLinkTransactedW(const string file_name,const string existing_file_name,PVOID security_attributes,HANDLE transaction);
int                    CreateHardLinkW(const string file_name,const string existing_file_name,PVOID security_attributes);
int                    CreateJobSet(uint NumJob,JOB_SET_ARRAY &UserJobSet,uint Flags);
HANDLE                 CreateMailslotW(const string name,uint max_message_size,uint read_timeout,PVOID security_attributes);
uchar                  CreateSymbolicLinkTransactedW(const string symlink_file_name,const string target_file_name,uint flags,HANDLE transaction);
uchar                  CreateSymbolicLinkW(const string symlink_file_name,const string target_file_name,uint flags);
uint                   CreateTapePartition(HANDLE device,uint partition_method,uint count,uint size);
int                    CreateUmsCompletionList(PVOID &UmsCompletionList);
int                    CreateUmsThreadContext(PVOID &ums_thread);
int                    DeactivateActCtx(uint flags,ulong cookie);
int                    DebugBreakProcess(HANDLE Process);
int                    DebugSetProcessKillOnExit(int KillOnExit);
ushort                 DeleteAtom(ushort atom);
void                   DeleteFiber(PVOID fiber);
int                    DeleteFileTransactedW(const string file_name,HANDLE transaction);
int                    DeleteTimerQueue(HANDLE TimerQueue);
int                    DeleteUmsCompletionList(PVOID UmsCompletionList);
int                    DeleteUmsThreadContext(PVOID UmsThread);
int                    DequeueUmsCompletionListItems(PVOID UmsCompletionList,uint WaitTimeOut,PVOID &UmsThreadList);
uint                   DisableThreadProfiling(HANDLE PerformanceDataHandle);
int                    DnsHostnameToComputerNameW(const string hostname,ushort &computer_name[],uint &size);
int                    DosDateTimeToFileTime(ushort fat_date,ushort fat_time,FILETIME &file_time);
uint                   EnableThreadProfiling(HANDLE ThreadHandle,uint Flags,ulong HardwareCounters,HANDLE &PerformanceDataHandle);
int                    EndUpdateResourceW(HANDLE update,int discard);
int                    EnterUmsSchedulingMode(UMS_SCHEDULER_STARTUP_INFO &SchedulerStartupInfo);
int                    EnumResourceLanguagesW(HANDLE module,const string type,const string name,PVOID enum_func,long param);
int                    EnumResourceTypesW(HANDLE module,PVOID enum_func,long param);
uint                   EraseTape(HANDLE device,uint erase_type,int immediate);
int                    EscapeCommFunction(HANDLE file,uint func);
int                    ExecuteUmsThread(PVOID UmsThread);
void                   FatalExit(int ExitCode);
int                    FileTimeToDosDateTime(FILETIME &file_time,ushort &fat_date,ushort &fat_time);
int                    FindActCtxSectionGuid(uint flags,const GUID &extension_guid[],uint section_id,const GUID &guid_to_find[],ACTCTX_SECTION_KEYED_DATA &ReturnedData);
int                    FindActCtxSectionStringW(uint flags,const GUID &extension_guid[],uint section_id,const string string_to_find,ACTCTX_SECTION_KEYED_DATA &ReturnedData);
ushort                 FindAtomW(const string str);
HANDLE                 FindFirstFileNameTransactedW(const string file_name,uint flags,uint &StringLength,string LinkName,HANDLE transaction);
HANDLE                 FindFirstFileTransactedW(const string file_name,FINDEX_INFO_LEVELS info_level_id,FIND_DATAW &find_file_data,FINDEX_SEARCH_OPS search_op,PVOID search_filter,uint additional_flags,HANDLE transaction);
HANDLE                 FindFirstStreamTransactedW(const string file_name,STREAM_INFO_LEVELS InfoLevel,FIND_STREAM_DATA &find_stream_data,uint flags,HANDLE transaction);
HANDLE                 FindFirstVolumeMountPointW(const string root_path_name,ushort &volume_mount_point[],uint buffer_length);
int                    FindNextVolumeMountPointW(HANDLE find_volume_mount_point,string volume_mount_point,uint buffer_length);
int                    FindVolumeMountPointClose(HANDLE find_volume_mount_point);
uint                   FormatMessageW(uint flags,const uchar &source[],uint message_id,uint language_id,ushort &buffer[],uint size,PVOID &Arguments[]);
uint                   GetActiveProcessorCount(ushort GroupNumber);
ushort                 GetActiveProcessorGroupCount(void);
int                    GetApplicationRecoveryCallback(HANDLE process,PVOID &recovery_callback,PVOID &parameter,uint &ping_interval,uint &flags);
int                    GetApplicationRestartSettings(HANDLE process,ushort &commandline[],uint &size,uint &flags);
uint                   GetAtomNameW(ushort atom,ushort &buffer[],int size);
int                    GetBinaryTypeW(const string application_name,uint &binary_type);
int                    GetCommConfig(HANDLE comm_dev,COMMCONFIG &lpCC,uint &size);
int                    GetCommMask(HANDLE file,uint &evt_mask);
int                    GetCommModemStatus(HANDLE file,uint &modem_stat);
int                    GetCommProperties(HANDLE file,COMMPROP &comm_prop);
int                    GetCommState(HANDLE file,DCB &lpDCB);
int                    GetCommTimeouts(HANDLE file,COMMTIMEOUTS &comm_timeouts);
uint                   GetCompressedFileSizeTransactedW(const string file_name,uint &file_size_high,HANDLE transaction);
int                    GetComputerNameW(ushort &buffer[],uint &size);
int                    GetCurrentActCtx(HANDLE &act_ctx);
int                    GetCurrentActCtx(ACTCTXW &act_ctx);
PVOID                  GetCurrentUmsThread(void);
int                    GetDefaultCommConfigW(const string name,COMMCONFIG &lpCC,uint &size);
int                    GetDevicePowerState(HANDLE device,int &on);
uint                   GetDllDirectoryW(uint buffer_length,ushort &buffer[]);
ulong                  GetEnabledXStateFeatures(void);
int                    GetFileAttributesTransactedW(const string file_name,GET_FILEEX_INFO_LEVELS info_level_id,PVOID file_information,HANDLE transaction);
int                    GetFileBandwidthReservation(HANDLE file,uint &period_milliseconds,uint &bytes_per_period,int &discardable,uint &transfer_size,uint &num_outstanding_requests);
int                    GetFileInformationByHandleEx(HANDLE file,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,PVOID file_information,uint buffer_size);
int                    GetFileInformationByHandleEx(HANDLE file,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,uchar &file_information[],uint buffer_size);
uint                   GetFirmwareEnvironmentVariableExW(const string name,const string guid,PVOID buffer,uint size,uint &attribubutes);
uint                   GetFirmwareEnvironmentVariableW(const string name,const string guid,PVOID buffer,uint size);
int                    GetFirmwareType(FIRMWARE_TYPE &FirmwareType);
uint                   GetFullPathNameTransactedW(const string file_name,uint buffer_length,string buffer,string &file_part,HANDLE transaction);
uint                   GetLongPathNameTransactedW(const string short_path,string long_path,uint buffer,HANDLE transaction);
int                    GetMailslotInfo(HANDLE mailslot,uint &max_message_size,uint &next_size,uint &message_count,uint &read_timeout);
uint                   GetMaximumProcessorCount(ushort GroupNumber);
ushort                 GetMaximumProcessorGroupCount(void);
int                    GetNamedPipeClientProcessId(HANDLE Pipe,uint &ClientProcessId);
int                    GetNamedPipeClientSessionId(HANDLE Pipe,uint &ClientSessionId);
int                    GetNamedPipeServerProcessId(HANDLE Pipe,uint &ServerProcessId);
int                    GetNamedPipeServerSessionId(HANDLE Pipe,uint &ServerSessionId);
PVOID                  GetNextUmsListItem(PVOID UmsContext);
int                    GetNumaAvailableMemoryNode(uchar Node,ulong &AvailableBytes);
int                    GetNumaAvailableMemoryNodeEx(ushort Node,ulong &AvailableBytes);
int                    GetNumaNodeNumberFromHandle(HANDLE file,ushort &NodeNumber);
int                    GetNumaNodeProcessorMask(uchar Node,ulong &ProcessorMask);
int                    GetNumaProcessorNode(uchar Processor,uchar &NodeNumber);
int                    GetNumaProcessorNodeEx(PROCESSOR_NUMBER &Processor,ushort &NodeNumber);
int                    GetNumaProximityNode(uint ProximityId,uchar &NodeNumber);
uint                   GetPrivateProfileIntW(const string app_name,const string key_name,int default_value,const string file_name);
uint                   GetPrivateProfileSectionNamesW(string return_buffer,uint size,const string file_name);
uint                   GetPrivateProfileSectionW(const string app_name,string returned_string,uint size,const string file_name);
uint                   GetPrivateProfileStringW(const string app_name,const string key_name,const string default_value,string returned_string,uint size,const string file_name);
int                    GetPrivateProfileStructW(const string section,const string key,PVOID struct_obj,uint size_struct,const string file);
int                    GetProcessAffinityMask(HANDLE process,ulong &process_affinity_mask,ulong &system_affinity_mask);
int                    GetProcessDEPPolicy(HANDLE process,uint &flags,int &permanent);
int                    GetProcessIoCounters(HANDLE process,IO_COUNTERS &io_counters);
int                    GetProcessWorkingSetSize(HANDLE process,ulong &minimum_working_set_size,ulong &maximum_working_set_size);
uint                   GetProfileIntW(const string app_name,const string key_name,int default_value);
uint                   GetProfileSectionW(const string app_name,string returned_string,uint size);
uint                   GetProfileStringW(const string app_name,const string key_name,const string default_value,string returned_string,uint size);
DEP_SYSTEM_POLICY_TYPE GetSystemDEPPolicy(void);
int                    GetSystemPowerStatus(SYSTEM_POWER_STATUS &system_power_status);
int                    GetSystemRegistryQuota(uint &quota_allowed,uint &quota_used);
uint                   GetTapeParameters(HANDLE device,uint operation,uint &size,PVOID tape_information);
uint                   GetTapePosition(HANDLE device,uint position_type,uint &partition,uint &offset_low,uint &offset_high);
uint                   GetTapeStatus(HANDLE device);
int                    GetThreadSelectorEntry(HANDLE thread,uint selector,LDT_ENTRY &selector_entry);
int                    GetUmsCompletionListEvent(PVOID UmsCompletionList,HANDLE &UmsCompletionEvent);
int                    GetUmsSystemThreadInformation(HANDLE ThreadHandle,UMS_SYSTEM_THREAD_INFORMATION &SystemThreadInfo);
int                    GetXStateFeaturesMask(CONTEXT &Context,ulong &FeatureMask);
ushort                 GlobalAddAtomExW(const string str,uint Flags);
ushort                 GlobalAddAtomW(const string str);
HANDLE                 GlobalAlloc(uint flags,ulong bytes);
ulong                  GlobalCompact(uint min_free);
ushort                 GlobalDeleteAtom(ushort atom);
ushort                 GlobalFindAtomW(const string str);
void                   GlobalFix(HANDLE mem);
uint                   GlobalFlags(HANDLE mem);
HANDLE                 GlobalFree(HANDLE mem);
uint                   GlobalGetAtomNameW(ushort atom,ushort &buffer[],int size);
HANDLE                 GlobalHandle(const PVOID mem);
PVOID                  GlobalLock(HANDLE mem);
void                   GlobalMemoryStatus(MEMORYSTATUS &buffer);
HANDLE                 GlobalReAlloc(HANDLE mem,ulong bytes,uint flags);
ulong                  GlobalSize(HANDLE mem);
void                   GlobalUnfix(HANDLE mem);
int                    GlobalUnlock(HANDLE mem);
int                    GlobalUnWire(HANDLE mem);
PVOID                  GlobalWire(HANDLE mem);
int                    InitAtomTable(uint size);
int                    InitializeContext(uchar &Buffer[],uint ContextFlags,CONTEXT &Context,uint &ContextLength);
int                    InitializeContext(PVOID Buffer,uint ContextFlags,CONTEXT &Context,uint &ContextLength);
int                    IsBadCodePtr(PVOID lpfn);
int                    IsBadHugeReadPtr(PVOID lp,ulong ucb);
int                    IsBadHugeWritePtr(PVOID lp,ulong ucb);
int                    IsBadReadPtr(PVOID lp,ulong ucb);
int                    IsBadStringPtrW(const string lpsz,ulong max);
int                    IsBadWritePtr(PVOID lp,ulong ucb);
int                    IsNativeVhdBoot(int &NativeVhdBoot);
int                    IsSystemResumeAutomatic(void);
HANDLE                 LoadPackagedLibrary(const string lib_file_name,uint Reserved);
HANDLE                 LocalAlloc(uint flags,ulong bytes);
ulong                  LocalCompact(uint min_free);
uint                   LocalFlags(HANDLE mem);
HANDLE                 LocalFree(HANDLE mem);
HANDLE                 LocalHandle(const PVOID mem);
PVOID                  LocalLock(HANDLE mem);
HANDLE                 LocalReAlloc(HANDLE mem,ulong bytes,uint flags);
ulong                  LocalShrink(HANDLE mem,uint new_size);
ulong                  LocalSize(HANDLE mem);
int                    LocalUnlock(HANDLE mem);
PVOID                  LocateXStateFeature(CONTEXT &Context,uint FeatureId,uint &Length);
string                 lstrcatW(ushort &string1[],const string string2);
int                    lstrcmpiW(const string string1,const string string2);
int                    lstrcmpW(const string string1,const string string2);
string                 lstrcpynW(ushort &string1[],const string string2,int max_length);
string                 lstrcpyW(ushort &string1[],const string string2);
int                    lstrlenW(const string str);
int                    MapUserPhysicalPagesScatter(PVOID &VirtualAddresses[],ulong NumberOfPages,ulong &PageArray[]);
PVOID                  MapViewOfFileExNuma(HANDLE file_mapping_object,uint desired_access,uint file_offset_high,uint file_offset_low,ulong number_of_bytes_to_map,PVOID base_address,uint preferred);
int                    MoveFileExW(const string existing_file_name,const string new_file_name,uint flags);
int                    MoveFileTransactedW(const string existing_file_name,const string new_file_name,PVOID progress_routine,PVOID data,uint flags,HANDLE transaction);
int                    MoveFileW(const string existing_file_name,const string new_file_name);
int                    MoveFileWithProgressW(const string existing_file_name,const string new_file_name,PVOID progress_routine,PVOID data,uint flags);
int                    MulDiv(int number,int numerator,int denominator);
HANDLE                 OpenFileById(HANDLE volume_hint,FILE_ID_DESCRIPTOR &file_id,uint desired_access,uint share_mode,PVOID security_attributes,uint flags_and_attributes);
int                    PowerClearRequest(HANDLE PowerRequest,POWER_REQUEST_TYPE RequestType);
HANDLE                 PowerCreateRequest(REASON_CONTEXT &Context);
int                    PowerSetRequest(HANDLE PowerRequest,POWER_REQUEST_TYPE RequestType);
uint                   PrepareTape(HANDLE device,uint operation,int immediate);
int                    PulseEvent(HANDLE event);
int                    PurgeComm(HANDLE file,uint flags);
int                    QueryActCtxSettingsW(uint flags,HANDLE act_ctx,const string name_space,const string name,string buffer,ulong buffer,ulong &written_or_required);
int                    QueryActCtxSettingsW(uint flags,ACTCTXW &act_ctx,const string name_space,const string name,string buffer,ulong buffer,ulong &written_or_required);
int                    QueryActCtxW(uint flags,HANDLE act_ctx,PVOID sub_instance,uint info_class,PVOID buffer,ulong buffer,ulong &written_or_required);
int                    QueryActCtxW(uint flags,ACTCTXW &act_ctx,PVOID sub_instance,uint info_class,PVOID buffer,ulong buffer,ulong &written_or_required);
int                    QueryFullProcessImageNameW(HANDLE process,uint flags,string exe_name,uint &size);
uint                   QueryThreadProfiling(HANDLE ThreadHandle,uchar &Enabled);
int                    QueryUmsThreadInformation(PVOID UmsThread,RTL_UMS_THREAD_INFO_CLASS UmsThreadInfoClass,PVOID UmsThreadInformation,uint UmsThreadInformationLength,uint &ReturnLength);
int                    ReadDirectoryChangesExW(HANDLE directory,PVOID buffer,uint buffer_length,int watch_subtree,uint notify_filter,uint &bytes_returned,OVERLAPPED &overlapped,PVOID completion_routine,READ_DIRECTORY_NOTIFY_INFORMATION_CLASS ReadDirectoryNotifyInformationClass);
int                    ReadDirectoryChangesW(HANDLE directory,PVOID buffer,uint buffer_length,int watch_subtree,uint notify_filter,uint &bytes_returned,OVERLAPPED &overlapped,PVOID completion_routine);
uint                   ReadThreadProfilingData(HANDLE PerformanceDataHandle,uint Flags,PERFORMANCE_DATA &PerformanceData);
int                    RegisterApplicationRecoveryCallback(PVOID recovey_callback,PVOID parameter,uint ping_interval,uint flags);
int                    RegisterApplicationRestart(const string commandline,uint flags);
int                    RegisterWaitForSingleObject(HANDLE &new_wait_object,HANDLE object,PVOID Callback,PVOID Context,uint milliseconds,uint flags);
void                   ReleaseActCtx(HANDLE act_ctx);
void                   ReleaseActCtx(ACTCTXW &act_ctx);
int                    RemoveDirectoryTransactedW(const string path_name,HANDLE transaction);
int                    RemoveSecureMemoryCacheCallback(PVOID call_back);
HANDLE                 ReOpenFile(HANDLE original_file,uint desired_access,uint share_mode,uint flags_and_attributes);
int                    ReplaceFileW(const string replaced_file_name,const string replacement_file_name,const string backup_file_name,uint replace_flags,PVOID exclude,PVOID reserved);
int                    ReplacePartitionUnit(string TargetPartition,string SparePartition,uint Flags);
int                    RequestDeviceWakeup(HANDLE device);
int                    RequestWakeupLatency(LATENCY_TIME latency);
void                   RestoreLastError(uint err_code);
int                    SetCommBreak(HANDLE file);
int                    SetCommConfig(HANDLE comm_dev,COMMCONFIG &lpCC,uint size);
int                    SetCommMask(HANDLE file,uint evt_mask);
int                    SetCommState(HANDLE file,DCB &lpDCB);
int                    SetCommTimeouts(HANDLE file,COMMTIMEOUTS &comm_timeouts);
int                    SetDefaultCommConfigW(const string name,COMMCONFIG &lpCC,uint size);
int                    SetDllDirectoryW(const string path_name);
int                    SetFileAttributesTransactedW(const string file_name,uint file_attributes,HANDLE transaction);
int                    SetFileBandwidthReservation(HANDLE file,uint period_milliseconds,uint bytes_per_period,int discardable,uint &transfer_size,uint &num_outstanding_requests);
int                    SetFileCompletionNotificationModes(HANDLE FileHandle,uchar Flags);
int                    SetFileShortNameW(HANDLE file,const string short_name);
int                    SetFirmwareEnvironmentVariableExW(const string name,const string guid,PVOID value,uint size,uint attributes);
int                    SetFirmwareEnvironmentVariableW(const string name,const string guid,PVOID value,uint size);
uint                   SetHandleCount(uint number);
int                    SetMailslotInfo(HANDLE mailslot,uint read_timeout);
int                    SetMessageWaitingIndicator(HANDLE msg_indicator,uint msg_count);
int                    SetProcessAffinityMask(HANDLE process,PVOID process_affinity_mask);
int                    SetProcessDEPPolicy(uint flags);
int                    SetProcessWorkingSetSize(HANDLE process,ulong minimum_working_set_size,ulong maximum_working_set_size);
int                    SetSearchPathMode(uint flags);
int                    SetSystemPowerState(int suspend,int force);
uint                   SetTapeParameters(HANDLE device,uint operation,PVOID tape_information);
uint                   SetTapePosition(HANDLE device,uint position_method,uint partition,uint offset_low,uint offset_high,int immediate);
PVOID                  SetThreadAffinityMask(HANDLE thread,PVOID thread_affinity_mask);
uint                   SetThreadExecutionState(uint flags);
HANDLE                 SetTimerQueueTimer(HANDLE TimerQueue,PVOID Callback,PVOID Parameter,uint DueTime,uint Period,int PreferIo);
int                    SetUmsThreadInformation(PVOID UmsThread,RTL_UMS_THREAD_INFO_CLASS UmsThreadInfoClass,PVOID UmsThreadInformation,uint UmsThreadInformationLength);
int                    SetupComm(HANDLE file,uint in_queue,uint out_queue);
int                    SetVolumeLabelW(const string root_path_name,const string volume_name);
int                    SetVolumeMountPointW(const string volume_mount_point,const string volume_name);
int                    SetXStateFeaturesMask(CONTEXT &Context,ulong FeatureMask);
uint                   SignalObjectAndWait(HANDLE object_to_signal,HANDLE object_to_wait_on,uint milliseconds,int alertable);
void                   SwitchToFiber(PVOID fiber);
int                    TransmitCommChar(HANDLE file,char symbol);
int                    UmsThreadYield(PVOID SchedulerParam);
int                    UnregisterApplicationRecoveryCallback(void);
int                    UnregisterApplicationRestart(void);
int                    UnregisterWait(HANDLE WaitHandle);
int                    UpdateResourceW(HANDLE update,const string type,const string name,ushort &language,PVOID data,uint cb);
int                    VerifyVersionInfoW(OSVERSIONINFOEXW &version_information,uint type_mask,ulong condition_mask);
int                    WaitCommEvent(HANDLE file,uint &evt_mask,OVERLAPPED &overlapped);
uchar                  Wow64EnableWow64FsRedirection(uchar Wow64FsEnableRedirection);
int                    Wow64GetThreadContext(HANDLE thread,CONTEXT &context);
int                    Wow64GetThreadSelectorEntry(HANDLE thread,uint selector,LDT_ENTRY &selector_entry);
int                    Wow64SetThreadContext(HANDLE thread,CONTEXT &context);
uint                   Wow64SuspendThread(HANDLE thread);
int                    WritePrivateProfileSectionW(const string app_name,const string str,const string file_name);
int                    WritePrivateProfileStringW(const string app_name,const string key_name,const string str,const string file_name);
int                    WritePrivateProfileStructW(const string section,const string key,PVOID struct_obj,uint size_struct,const string file);
int                    WriteProfileSectionW(const string app_name,const string str);
int                    WriteProfileStringW(const string app_name,const string key_name,const string str);
uint                   WriteTapemark(HANDLE device,uint tapemark_type,uint tapemark_count,int immediate);
uint                   WTSGetActiveConsoleSessionId(void);
int                    ZombifyActCtx(HANDLE act_ctx);
int                    ZombifyActCtx(ACTCTXW &act_ctx);
#import

#import "advapi32.dll"
int                    AddConditionalAce(ACL &acl,uint ace_revision,uint AceFlags,uchar AceType,uint AccessMask,SID &sid,string ConditionStr,uint &ReturnLength);
int                    BackupEventLogW(HANDLE event_log,const string backup_file_name);
int                    ClearEventLogW(HANDLE event_log,const string backup_file_name);
void                   CloseEncryptedFileRaw(PVOID context);
int                    CloseEventLog(HANDLE event_log);
int                    DecryptFileW(const string file_name,uint reserved);
int                    DeregisterEventSource(HANDLE event_log);
int                    EncryptFileW(const string file_name);
int                    FileEncryptionStatusW(const string file_name,uint &status);
int                    GetCurrentHwProfileW(HW_PROFILE_INFOW &hw_profile_info);
int                    GetEventLogInformation(HANDLE event_log,uint info_level,PVOID buffer,uint buf_size,uint &bytes_needed);
int                    GetNumberOfEventLogRecords(HANDLE event_log,uint &NumberOfRecords);
int                    GetOldestEventLogRecord(HANDLE event_log,uint &OldestRecord);
int                    GetUserNameW(string buffer,uint &buffer);
int                    IsTextUnicode(PVOID lpv,int size,int &result);
int                    IsTokenUntrusted(HANDLE TokenHandle);
int                    LogonUserExW(const string username,const string domain,const string password,uint logon_type,uint logon_provider,HANDLE &token,PVOID &logon_sid,PVOID &profile_buffer,uint &profile_length,QUOTA_LIMITS &quota_limits);
int                    LogonUserW(const string username,const string domain,const string password,uint logon_type,uint logon_provider,HANDLE &token);
int                    LookupAccountNameW(const string system_name,const string account_name,SID &Sid,uint &sid,string ReferencedDomainName,uint &referenced_domain_name,SID_NAME_USE &use);
int                    LookupAccountSidW(const string system_name,SID &Sid,string Name,uint &name,string ReferencedDomainName,uint &referenced_domain_name,SID_NAME_USE &use);
int                    LookupPrivilegeDisplayNameW(const string system_name,const string name,string display_name,uint &display_name,uint &language_id);
int                    LookupPrivilegeNameW(const string system_name,LUID &luid,string name,uint &name);
int                    LookupPrivilegeValueW(const string system_name,const string name,LUID &luid);
int                    NotifyChangeEventLog(HANDLE event_log,HANDLE event);
HANDLE                 OpenBackupEventLogW(const string lpUNCServerName,const string file_name);
uint                   OpenEncryptedFileRawW(const string file_name,uint flags,PVOID &context);
HANDLE                 OpenEventLogW(const string lpUNCServerName,const string source_name);
int                    OperationEnd(OPERATION_END_PARAMETERS &OperationEndParams);
int                    OperationStart(OPERATION_START_PARAMETERS &OperationStartParams);
uint                   ReadEncryptedFileRaw(PVOID export_callback,PVOID callback_context,PVOID context);
int                    ReadEventLogW(HANDLE event_log,uint read_flags,uint record_offset,PVOID buffer,uint number_of_bytes_to_read,uint &bytes_read,uint &min_number_of_bytes_needed);
HANDLE                 RegisterEventSourceW(const string lpUNCServerName,const string source_name);
int                    ReportEventW(HANDLE event_log,ushort &type,ushort &category,uint dwEventID,SID &user_sid,ushort &num_strings,uint data_size,const string &strings[],PVOID raw_data);
uint                   WriteEncryptedFileRaw(PVOID import_callback,PVOID callback_context,PVOID context);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                    memoryapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>

//---
enum MEMORY_RESOURCE_NOTIFICATION_TYPE
  {
   LowMemoryResourceNotification,
   HighMemoryResourceNotification
  };
//---
enum OFFER_PRIORITY
  {
   VmOfferPriorityVeryLow=1,
   VmOfferPriorityLow,
   VmOfferPriorityBelowNormal,
   VmOfferPriorityNormal
  };
//---
enum WIN32_MEMORY_INFORMATION_CLASS
  {
   MemoryRegionInfo
  };
//---
struct WIN32_MEMORY_RANGE_ENTRY
  {
   PVOID             VirtualAddress;
   ulong             NumberOfBytes;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int     AllocateUserPhysicalPages(HANDLE hProcess,ulong &NumberOfPages,ulong &PageArray[]);
int     AllocateUserPhysicalPagesNuma(HANDLE hProcess,ulong &NumberOfPages,ulong &PageArray[],uint nndPreferred);
HANDLE  CreateFileMappingFromApp(HANDLE hFile,PVOID SecurityAttributes,uint PageProtection,ulong MaximumSize,const string Name);
HANDLE  CreateFileMappingNumaW(HANDLE hFile,PVOID lpFileMappingAttributes,uint flProtect,uint dwMaximumSizeHigh,uint dwMaximumSizeLow,const string lpName,uint nndPreferred);
HANDLE  CreateFileMappingW(HANDLE hFile,PVOID lpFileMappingAttributes,uint flProtect,uint dwMaximumSizeHigh,uint dwMaximumSizeLow,const string lpName);
HANDLE  CreateMemoryResourceNotification(MEMORY_RESOURCE_NOTIFICATION_TYPE NotificationType);
uint    DiscardVirtualMemory(PVOID VirtualAddress,ulong Size);
int     FlushViewOfFile(const PVOID lpBaseAddress,ulong dwNumberOfBytesToFlush);
int     FreeUserPhysicalPages(HANDLE hProcess,ulong &NumberOfPages,ulong &PageArray[]);
ulong   GetLargePageMinimum(void);
int     GetMemoryErrorHandlingCapabilities(uint &Capabilities);
int     GetProcessWorkingSetSizeEx(HANDLE hProcess,ulong &lpMinimumWorkingSetSize,ulong &lpMaximumWorkingSetSize,uint &Flags);
int     GetSystemFileCacheSize(ulong &lpMinimumFileCacheSize,ulong &lpMaximumFileCacheSize,uint &lpFlags);
uint    GetWriteWatch(uint dwFlags,PVOID lpBaseAddress,ulong dwRegionSize,PVOID &lpAddresses[],uint &lpdwCount,uint &lpdwGranularity);
int     MapUserPhysicalPages(PVOID VirtualAddress,ulong &NumberOfPages,ulong &PageArray[]);
PVOID   MapViewOfFile(HANDLE hFileMappingObject,uint dwDesiredAccess,uint dwFileOffsetHigh,uint dwFileOffsetLow,ulong dwNumberOfBytesToMap);
PVOID   MapViewOfFileEx(HANDLE hFileMappingObject,uint dwDesiredAccess,uint dwFileOffsetHigh,uint dwFileOffsetLow,ulong dwNumberOfBytesToMap,PVOID lpBaseAddress);
PVOID   MapViewOfFileFromApp(HANDLE hFileMappingObject,uint DesiredAccess,ulong FileOffset,ulong NumberOfBytesToMap);
uint    OfferVirtualMemory(PVOID VirtualAddress,ulong Size,OFFER_PRIORITY Priority);
HANDLE  OpenFileMappingW(uint dwDesiredAccess,int bInheritHandle,const string lpName);
int     PrefetchVirtualMemory(HANDLE hProcess,uint &NumberOfEntries,WIN32_MEMORY_RANGE_ENTRY &VirtualAddresses,uint Flags);
int     QueryMemoryResourceNotification(HANDLE ResourceNotificationHandle,int &ResourceState);
int     ReadProcessMemory(HANDLE hProcess,const PVOID lpBaseAddress,PVOID lpBuffer,ulong nSize,ulong &lpNumberOfBytesRead);
uint    ReclaimVirtualMemory(const PVOID VirtualAddress,ulong Size);
PVOID   RegisterBadMemoryNotification(PVOID Callback);
uint    ResetWriteWatch(PVOID lpBaseAddress,ulong dwRegionSize);
int     SetProcessWorkingSetSizeEx(HANDLE hProcess,ulong dwMinimumWorkingSetSize,ulong dwMaximumWorkingSetSize,uint Flags);
int     SetSystemFileCacheSize(ulong MinimumFileCacheSize,ulong MaximumFileCacheSize,uint Flags);
int     UnmapViewOfFile(const PVOID lpBaseAddress);
int     UnmapViewOfFileEx(PVOID BaseAddress,uint UnmapFlags);
int     UnregisterBadMemoryNotification(PVOID RegistrationHandle);
PVOID   VirtualAlloc(PVOID lpAddress,ulong dwSize,uint flAllocationType,uint flProtect);
PVOID   VirtualAllocEx(HANDLE hProcess,PVOID lpAddress,ulong dwSize,uint flAllocationType,uint flProtect);
PVOID   VirtualAllocExNuma(HANDLE hProcess,PVOID lpAddress,ulong dwSize,uint flAllocationType,uint flProtect,uint nndPreferred);
int     VirtualFree(PVOID lpAddress,ulong dwSize,uint dwFreeType);
int     VirtualFreeEx(HANDLE hProcess,PVOID lpAddress,ulong dwSize,uint dwFreeType);
int     VirtualLock(PVOID lpAddress,ulong dwSize);
int     VirtualProtect(PVOID lpAddress,ulong dwSize,uint flNewProtect,uint &lpflOldProtect);
int     VirtualProtectEx(HANDLE hProcess,PVOID lpAddress,ulong dwSize,uint flNewProtect,uint &lpflOldProtect);
ulong   VirtualQuery(const PVOID lpAddress,MEMORY_BASIC_INFORMATION &lpBuffer,ulong dwLength);
ulong   VirtualQueryEx(HANDLE hProcess,const PVOID lpAddress,MEMORY_BASIC_INFORMATION &lpBuffer,ulong dwLength);
int     VirtualUnlock(PVOID lpAddress,ulong dwSize);
int     WriteProcessMemory(HANDLE hProcess,PVOID lpBaseAddress,PVOID lpBuffer,ulong nSize,ulong &lpNumberOfBytesWritten);
int     WriteProcessMemory(HANDLE hProcess,PVOID lpBaseAddress,uchar &lpBuffer[],ulong nSize,ulong &lpNumberOfBytesWritten);
int     WriteProcessMemory(HANDLE hProcess,uchar &lpBaseAddress[],PVOID lpBuffer,ulong nSize,ulong &lpNumberOfBytesWritten);
int     WriteProcessMemory(HANDLE hProcess,uchar &lpBaseAddress[],uchar &lpBuffer[],ulong nSize,ulong &lpNumberOfBytesWritten);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                 libloaderapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>

//---
struct ENUMUILANG
  {
   uint              NumOfEnumUILang;
   uint              SizeOfEnumUIBuffer;
   PVOID             EnumUIBuffer;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int                  DisableThreadLibraryCalls(HANDLE lib_module);
HANDLE               FindResourceExW(HANDLE module,const string type,const string name,ushort language);
int                  FindStringOrdinal(uint find_string_ordinal_flags,const string string_source,int source,const string string_value,int value,int ignore_case);
int                  FreeLibrary(HANDLE lib_module);
void                 FreeLibraryAndExitThread(HANDLE lib_module,uint exit_code);
int                  FreeResource(HANDLE res_data);
uint                 GetModuleFileNameW(HANDLE module,ushort &filename[],uint size);
HANDLE               GetModuleHandleW(const string module_name);
int                  GetModuleHandleExW(uint flags,const string module_name,HANDLE &module);
PVOID                GetProcAddress(HANDLE module,uchar &proc_name[]);
HANDLE               LoadLibraryExW(const string lib_file_name,HANDLE file,uint flags);
HANDLE               LoadResource(HANDLE module,HANDLE res_info);
PVOID                LockResource(HANDLE res_data);
uint                 SizeofResource(HANDLE module,HANDLE res_info);
PVOID                AddDllDirectory(const string new_directory);
int                  RemoveDllDirectory(PVOID cookie);
int                  SetDefaultDllDirectories(uint directory_flags);
int                  EnumResourceLanguagesExW(HANDLE module,const string type,const string name,PVOID enum_func,long param,uint flags,ushort lang_id);
int                  EnumResourceNamesExW(HANDLE module,const string type,PVOID enum_func,long param,uint flags,ushort lang_id);
int                  EnumResourceTypesExW(HANDLE module,PVOID enum_func,long param,uint flags,ushort lang_id);
HANDLE               FindResourceW(HANDLE module,const string name,const string type);
HANDLE               LoadLibraryW(const string lib_file_name);
int                  EnumResourceNamesW(HANDLE module,const string type,PVOID enum_func,long param);
#import

#import "user32.dll"
int                  LoadStringW(HANDLE instance,uint id,string buffer,int buffer_max);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      fileapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>

//---
enum STREAM_INFO_LEVELS
  {
   FindStreamInfoStandard,
   FindStreamInfoMaxInfoLevel
  };
//---
struct BY_HANDLE_FILE_INFORMATION
  {
   uint              dwFileAttributes;
   FILETIME          ftCreationTime;
   FILETIME          ftLastAccessTime;
   FILETIME          ftLastWriteTime;
   uint              dwVolumeSerialNumber;
   uint              nFileSizeHigh;
   uint              nFileSizeLow;
   uint              nNumberOfLinks;
   uint              nFileIndexHigh;
   uint              nFileIndexLow;
  };
//---
struct CREATEFILE2_EXTENDED_PARAMETERS
  {
   uint              dwSize;
   uint              dwFileAttributes;
   uint              dwFileFlags;
   uint              dwSecurityQosFlags;
   PVOID             lpSecurityAttributes;
   HANDLE            hTemplateFile;
  };
//---
struct FILE_ATTRIBUTE_DATA
  {
   uint              dwFileAttributes;
   FILETIME          ftCreationTime;
   FILETIME          ftLastAccessTime;
   FILETIME          ftLastWriteTime;
   uint              nFileSizeHigh;
   uint              nFileSizeLow;
  };
//---
struct FIND_STREAM_DATA
  {
   long              StreamSize;
   short             cStreamName[MAX_PATH+36];
  };
//---
struct FIND_DATAW
  {
   uint              dwFileAttributes;
   FILETIME          ftCreationTime;
   FILETIME          ftLastAccessTime;
   FILETIME          ftLastWriteTime;
   uint              nFileSizeHigh;
   uint              nFileSizeLow;
   uint              dwReserved0;
   uint              dwReserved1;
   short             cFileName[MAX_PATH];
   short             cAlternateFileName[14];
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int    AreFileApisANSI(void);
int    CompareFileTime(FILETIME &file_time1,FILETIME &file_time2);
int    CreateDirectoryW(const string path_name,PVOID security_attributes);
HANDLE CreateFile2(const string file_name,uint desired_access,uint share_mode,uint creation_disposition,CREATEFILE2_EXTENDED_PARAMETERS &create_ex_params);
HANDLE CreateFileW(const string file_name,uint desired_access,uint share_mode,PVOID security_attributes,uint creation_disposition,uint flags_and_attributes,HANDLE template_file);
int    DefineDosDeviceW(uint flags,const string device_name,const string target_path);
int    DeleteFileW(const string file_name);
int    DeleteVolumeMountPointW(const string volume_mount_point);
int    FileTimeToLocalFileTime(FILETIME &file_time,FILETIME &local_file_time);
int    FindClose(HANDLE find_file);
int    FindCloseChangeNotification(HANDLE change_handle);
HANDLE FindFirstChangeNotificationW(const string path_name,int watch_subtree,uint notify_filter);
HANDLE FindFirstFileExW(const string file_name,FINDEX_INFO_LEVELS info_level_id,FIND_DATAW &find_file_data,FINDEX_SEARCH_OPS search_op,PVOID search_filter,uint additional_flags);
HANDLE FindFirstFileNameW(const string file_name,uint flags,uint &StringLength,ushort &LinkName[]);
HANDLE FindFirstFileW(const string file_name,FIND_DATAW &find_file_data);
HANDLE FindFirstStreamW(const string file_name,STREAM_INFO_LEVELS InfoLevel,FIND_STREAM_DATA &find_stream_data,uint flags);
HANDLE FindFirstVolumeW(ushort &volume_name[],uint &buffer_length);
int    FindNextChangeNotification(HANDLE change_handle);
int    FindNextFileNameW(HANDLE find_stream,uint &StringLength,ushort &LinkName[]);
int    FindNextFileW(HANDLE find_file,FIND_DATAW &find_file_data);
int    FindNextStreamW(HANDLE find_stream,FIND_STREAM_DATA &find_stream_data);
int    FindNextVolumeW(HANDLE find_volume,ushort &volume_name[],uint &buffer_length);
int    FindVolumeClose(HANDLE find_volume);
int    FlushFileBuffers(HANDLE file);
uint   GetCompressedFileSizeW(const string file_name,uint &file_size_high);
int    GetDiskFreeSpaceExW(const string directory_name,ulong &free_bytes_available_to_caller,ulong &total_number_of_bytes,ulong &total_number_of_free_bytes);
int    GetDiskFreeSpaceW(const string root_path_name,uint &sectors_per_cluster,uint &bytes_per_sector,uint &number_of_free_clusters,uint &total_number_of_clusters);
uint   GetDriveTypeW(const string root_path_name);
int    GetFileAttributesExW(const string file_name,GET_FILEEX_INFO_LEVELS info_level_id,FILE_ATTRIBUTE_DATA &file_information);
uint   GetFileAttributesW(const string file_name);
int    GetFileInformationByHandle(HANDLE file,BY_HANDLE_FILE_INFORMATION &file_information);
uint   GetFileSize(HANDLE file,uint &file_size_high);
int    GetFileSizeEx(HANDLE file,long &file_size);
int    GetFileTime(HANDLE file,FILETIME &creation_time,FILETIME &last_access_time,FILETIME &last_write_time);
uint   GetFileType(HANDLE file);
uint   GetFinalPathNameByHandleW(HANDLE file,ushort &file_path[],uint file_path,uint flags);
uint   GetFullPathNameW(const string file_name,uint buffer_length,ushort &buffer[],ushort &file_part[]);
uint   GetLogicalDrives(void);
uint   GetLogicalDriveStringsW(uint buffer_length,ushort &buffer[]);
uint   GetLongPathNameW(const string short_path,string &long_path,uint buffer);
uint   GetShortPathNameW(const string long_path,string &short_path,uint buffer);
uint   GetTempFileNameW(const string path_name,const string prefix_string,uint unique,ushort &temp_file_name[]);
uint   GetTempPathW(uint buffer_length,ushort &buffer[]);
int    GetVolumeInformationByHandleW(HANDLE file,ushort &volume_name_buffer[],uint volume_name_size,uint &volume_serial_number,uint &maximum_component_length,uint &file_system_flags,ushort &file_system_name_buffer[],uint file_system_name_size);
int    GetVolumeInformationW(const string root_path_name,ushort &volume_name_buffer[],uint volume_name_size,uint &volume_serial_number,uint &maximum_component_length,uint &file_system_flags,ushort &file_system_name_buffer[],uint file_system_name_size);
int    GetVolumeNameForVolumeMountPointW(const string volume_mount_point,string volume_name,uint buffer_length);
int    GetVolumePathNamesForVolumeNameW(const string volume_name,string volume_path_names,uint buffer_length,uint &return_length);
int    GetVolumePathNameW(const string file_name,ushort &volume_path_name[],uint buffer_length);
int    LocalFileTimeToFileTime(FILETIME &local_file_time,FILETIME &file_time);
int    LockFile(HANDLE file,uint file_offset_low,uint file_offset_high,uint number_of_bytes_to_lock_low,uint number_of_bytes_to_lock_high);
int    LockFileEx(HANDLE file,uint flags,uint reserved,uint number_of_bytes_to_lock_low,uint number_of_bytes_to_lock_high,OVERLAPPED &overlapped);
uint   QueryDosDeviceW(const string device_name,ushort &target_path[],uint max);
int    ReadFile(HANDLE file,ushort &buffer[],uint number_of_bytes_to_read,uint &number_of_bytes_read,OVERLAPPED &overlapped);
int    ReadFile(HANDLE file,ushort &buffer[],uint number_of_bytes_to_read,uint &number_of_bytes_read,PVOID overlapped);
int    ReadFileScatter(HANDLE file,FILE_SEGMENT_ELEMENT &segment_array[],uint number_of_bytes_to_read,uint &reserved,OVERLAPPED &overlapped);
int    ReadFileScatter(HANDLE file,FILE_SEGMENT_ELEMENT &segment_array[],uint number_of_bytes_to_read,uint &reserved,PVOID overlapped);
int    RemoveDirectoryW(const string path_name);
int    SetEndOfFile(HANDLE file);
void   SetFileApisToANSI(void);
void   SetFileApisToOEM(void);
int    SetFileAttributesW(const string file_name,uint file_attributes);
int    SetFileInformationByHandle(HANDLE file,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,FILE_INFO &file_information,uint buffer_size);
int    SetFileIoOverlappedRange(HANDLE FileHandle,uchar &OverlappedRangeStart,uint Length);
uint   SetFilePointer(HANDLE file,long distance_to_move,long &distance_to_move_high,uint move_method);
int    SetFilePointerEx(HANDLE file,long distance_to_move,long &new_file_pointer,uint move_method);
int    SetFileTime(HANDLE file,FILETIME &creation_time,FILETIME &last_access_time,FILETIME &last_write_time);
int    SetFileValidData(HANDLE file,long ValidDataLength);
int    UnlockFile(HANDLE file,uint file_offset_low,uint file_offset_high,uint number_of_bytes_to_unlock_low,uint number_of_bytes_to_unlock_high);
int    UnlockFileEx(HANDLE file,uint reserved,uint number_of_bytes_to_unlock_low,uint number_of_bytes_to_unlock_high,OVERLAPPED &overlapped);
int    WriteFile(HANDLE file,const ushort &buffer[],uint number_of_bytes_to_write,uint &number_of_bytes_written,OVERLAPPED &overlapped);
int    WriteFile(HANDLE file,const ushort &buffer[],uint number_of_bytes_to_write,uint &number_of_bytes_written,PVOID overlapped);
int    WriteFileGather(HANDLE file,FILE_SEGMENT_ELEMENT &segment_array[],uint number_of_bytes_to_write,uint &reserved,OVERLAPPED &overlapped);
int    WriteFileGather(HANDLE file,FILE_SEGMENT_ELEMENT &segment_array[],uint number_of_bytes_to_write,uint &reserved,PVOID overlapped);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                            processthreadsapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
//---
enum THREAD_INFORMATION_CLASS
  {
   ThreadMemoryPriority,
   ThreadAbsoluteCpuPriority,
   ThreadDynamicCodePolicy,
   ThreadPowerThrottling,
   ThreadInformationClassMax
  };
//---
enum PROCESS_INFORMATION_CLASS
  {
   ProcessMemoryPriority,
   ProcessMemoryExhaustionInfo,
   ProcessAppMemoryInfo,
   ProcessInPrivateInfo,
   ProcessPowerThrottling,
   ProcessReservedValue1,
   ProcessTelemetryCoverageInfo,
   ProcessProtectionLevelInfo,
   ProcessInformationClassMax
  };
//---
enum PROCESS_MEMORY_EXHAUSTION_TYPE
  {
   PMETypeFailFastOnCommitFailure,
   PMETypeMax
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
//---
struct PROCESS_INFORMATION
  {
   HANDLE            hProcess;
   HANDLE            hThread;
   uint              dwProcessId;
   uint              dwThreadId;
  };
//---
struct STARTUPINFOW
  {
   uint              cb;
   string            lpReserved;
   string            lpDesktop;
   string            lpTitle;
   uint              dwX;
   uint              dwY;
   uint              dwXSize;
   uint              dwYSize;
   uint              dwXCountChars;
   uint              dwYCountChars;
   uint              dwFillAttribute;
   uint              dwFlags;
   ushort            wShowWindow;
   ushort            cbReserved2;
   PVOID             lpReserved2;
   HANDLE            hStdInput;
   HANDLE            hStdOutput;
   HANDLE            hStdError;
  };
//---
struct MEMORY_PRIORITY_INFORMATION
  {
   uint              MemoryPriority;
  };
//---
struct THREAD_POWER_THROTTLING_STATE
  {
   uint              Version;
   uint              ControlMask;
   uint              StateMask;
  };
//---
struct APP_MEMORY_INFORMATION
  {
   ulong             AvailableCommit;
   ulong             PrivateCommitUsage;
   ulong             PeakPrivateCommitUsage;
   ulong             TotalCommitUsage;
  };
//---
struct PROCESS_MEMORY_EXHAUSTION_INFO
  {
   ushort            Version;
   ushort            Reserved;
   PROCESS_MEMORY_EXHAUSTION_TYPE Type;
   ulong             Value;
  };
//---
struct PROCESS_POWER_THROTTLING_STATE
  {
   uint              Version;
   uint              ControlMask;
   uint              StateMask;
  };
//---
struct PROCESS_PROTECTION_LEVEL_INFORMATION
  {
   uint              ProtectionLevel;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
uint    QueueUserAPC(PVOID apc,HANDLE thread,ulong data);
int     GetProcessTimes(HANDLE process,FILETIME &creation_time,FILETIME &exit_time,FILETIME &kernel_time,FILETIME &user_time);
HANDLE  GetCurrentProcess(void);
uint    GetCurrentProcessId(void);
void    ExitProcess(uint exit_code);
int     TerminateProcess(HANDLE process,uint exit_code);
int     GetExitCodeProcess(HANDLE process,uint &exit_code);
int     SwitchToThread(void);
HANDLE  CreateThread(PVOID thread_attributes,ulong stack_size,PVOID start_address,PVOID parameter,uint creation_flags,uint &thread_id);
HANDLE  CreateRemoteThread(HANDLE process,PVOID thread_attributes,ulong stack_size,PVOID start_address,PVOID parameter,uint creation_flags,uint &thread_id);
HANDLE  GetCurrentThread(void);
uint    GetCurrentThreadId(void);
HANDLE  OpenThread(uint desired_access,int inherit_handle,uint thread_id);
int     SetThreadPriority(HANDLE thread,int priority);
int     SetThreadPriorityBoost(HANDLE thread,int disable_priority_boost);
int     GetThreadPriorityBoost(HANDLE thread,int &disable_priority_boost);
int     GetThreadPriority(HANDLE thread);
void    ExitThread(uint exit_code);
int     TerminateThread(HANDLE thread,uint exit_code);
int     GetExitCodeThread(HANDLE thread,uint &exit_code);
uint    SuspendThread(HANDLE thread);
uint    ResumeThread(HANDLE thread);
uint    TlsAlloc(void);
PVOID   TlsGetValue(uint tls_index);
int     TlsSetValue(uint tls_index,PVOID tls_value);
int     TlsFree(uint tls_index);
int     CreateProcessW(const string application_name,string command_line,PVOID process_attributes,PVOID thread_attributes,int inherit_handles,uint creation_flags,PVOID environment,const string current_directory,STARTUPINFOW &startup_info,PROCESS_INFORMATION &process_information);
int     SetProcessShutdownParameters(uint level,uint flags);
uint    GetProcessVersion(uint process_id);
void    GetStartupInfoW(STARTUPINFOW &startup_info);
int     SetPriorityClass(HANDLE process,uint priority_class);
uint    GetPriorityClass(HANDLE process);
int     SetThreadStackGuarantee(ulong stack_size_in_bytes);
int     ProcessIdToSessionId(uint process_id,uint &session_id);
uint    GetProcessId(HANDLE process);
uint    GetThreadId(HANDLE thread);
void    FlushProcessWriteBuffers(void);
uint    GetProcessIdOfThread(HANDLE thread);
int     InitializeProcThreadAttributeList(PVOID attribute_list,uint attribute_count,uint flags,ulong &size);
void    DeleteProcThreadAttributeList(PVOID  attribute_list);
int     SetProcessAffinityUpdateMode(HANDLE process,uint flags);
int     QueryProcessAffinityUpdateMode(HANDLE process,uint &flags);
int     UpdateProcThreadAttribute(PVOID attribute_list,uint flags,uint attribute,PVOID value,ulong size,PVOID previous_value,ulong &return_size);
HANDLE  CreateRemoteThreadEx(HANDLE process,PVOID thread_attributes,ulong stack_size,PVOID start_address,PVOID parameter,uint creation_flags,PVOID attribute_list,uint &thread_id);
void    GetCurrentThreadStackLimits(ulong &low_limit,ulong &high_limit);
int     GetThreadContext(HANDLE thread,CONTEXT &context);
int     GetProcessMitigationPolicy(HANDLE process,PROCESS_MITIGATION_POLICY mitigation_policy,PVOID buffer,ulong length);
int     SetThreadContext(HANDLE thread,const CONTEXT &context);
int     SetProcessMitigationPolicy(PROCESS_MITIGATION_POLICY mitigation_policy,PVOID buffer,ulong length);
int     FlushInstructionCache(HANDLE process,const PVOID base_address,ulong size);
int     GetThreadTimes(HANDLE thread,FILETIME &creation_time,FILETIME &exit_time,FILETIME &kernel_time,FILETIME &user_time);
HANDLE  OpenProcess(uint desired_access,int inherit_handle,uint process_id);
int     IsProcessorFeaturePresent(uint processor_feature);
int     GetProcessHandleCount(HANDLE process,uint &handle_count);
uint    GetCurrentProcessorNumber(void);
int     SetThreadIdealProcessorEx(HANDLE thread,PROCESSOR_NUMBER &ideal_processor,PROCESSOR_NUMBER &previous_ideal_processor);
int     GetThreadIdealProcessorEx(HANDLE thread,PROCESSOR_NUMBER &ideal_processor);
void    GetCurrentProcessorNumberEx(PROCESSOR_NUMBER &proc_number);
int     GetProcessPriorityBoost(HANDLE process,int &disable_priority_boost);
int     SetProcessPriorityBoost(HANDLE process,int disable_priority_boost);
int     GetThreadIOPendingFlag(HANDLE thread,int &io_is_pending);
int     GetSystemTimes(FILETIME &idle_time,FILETIME &kernel_time,FILETIME &user_time);
int     GetThreadInformation(HANDLE thread,THREAD_INFORMATION_CLASS thread_information_class,PVOID thread_information,uint thread_information_size);
int     SetThreadInformation(HANDLE thread,THREAD_INFORMATION_CLASS thread_information_class,PVOID thread_information,uint thread_information_size);
int     IsProcessCritical(HANDLE process,int &critical);
int     SetProtectedPolicy(const GUID &policy_guid,ulong policy_value,ulong &old_policy_value);
int     QueryProtectedPolicy(const GUID &policy_guid,ulong &policy_value);
uint    SetThreadIdealProcessor(HANDLE thread,uint ideal_processor);
int     SetProcessInformation(HANDLE process,PROCESS_INFORMATION_CLASS process_information_class,PVOID process_information,uint process_information_size);
int     GetProcessInformation(HANDLE process,PROCESS_INFORMATION_CLASS process_information_class,PVOID process_information,uint process_information_size);
int     GetSystemCpuSetInformation(SYSTEM_CPU_SET_INFORMATION &information,uint buffer_length,ulong returned_length,HANDLE process,uint flags);
int     GetProcessDefaultCpuSets(HANDLE process,ulong &cpu_set_ids,uint cpu_set_id_count,ulong required_id_count);
int     SetProcessDefaultCpuSets(HANDLE process,const uint &cpu_set_ids,uint cpu_set_id_count);
int     GetThreadSelectedCpuSets(HANDLE thread,ulong &cpu_set_ids,uint cpu_set_id_count,ulong required_id_count);
int     SetThreadSelectedCpuSets(HANDLE thread,const uint &cpu_set_ids,uint cpu_set_id_count);
int     GetProcessShutdownParameters(uint &level,uint &flags);
int     SetThreadDescription(HANDLE thread,const string thread_description);
int     GetThreadDescription(HANDLE thread,string &thread_description);
#import
#import "advapi32.dll"
int     CreateProcessAsUserW(HANDLE token,const string application_name,string command_line,PVOID process_attributes,PVOID thread_attributes,int inherit_handles,uint creation_flags,PVOID environment,const string current_directory,STARTUPINFOW &startup_info,PROCESS_INFORMATION &process_information);
int     SetThreadToken(HANDLE thread,HANDLE token);
int     OpenProcessToken(HANDLE process_handle,uint desired_access,HANDLE &token_handle);
int     OpenThreadToken(HANDLE thread_handle,uint desired_access,int open_as_self,HANDLE &token_handle);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                   processenv.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int    SetEnvironmentStringsW(string new_environment);
HANDLE GetStdHandle(uint std_handle);
int    SetStdHandle(uint std_handle,HANDLE handle);
int    SetStdHandleEx(uint std_handle,HANDLE handle,HANDLE &prev_value);
string GetCommandLineW(void);
string GetEnvironmentStringsW(void);
int    FreeEnvironmentStringsW(string v);
uint   GetEnvironmentVariableW(const string name,ushort &buffer[],uint size);
int    SetEnvironmentVariableW(const string name,const string value);
uint   ExpandEnvironmentStringsW(const string src,string dst,uint size);
int    SetCurrentDirectoryW(const string path_name);
uint   GetCurrentDirectoryW(uint buffer_length,ushort &buffer[]);
uint   GetCurrentDirectoryW(uint buffer_length,string &buffer);
uint   SearchPathW(const string path,const string file_name,const string extension,uint buffer_length,ushort &buffer[],string &file_part);
int    NeedCurrentDirectoryForExePathW(const string exe_name);
#import
-e 

//+------------------------------------------------------------------+
//|                                                       windef.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#define HANDLE                         long
#define PVOID                          long
//---
#define ANYSIZE_ARRAY                  1
#define MAX_BREAKPOINTS                8
#define MAX_WATCHPOINTS                2
#define MAX_HW_COUNTERS                16
#define MAX_PATH                       260
#define EXCEPTION_MAXIMUM_PARAMETERS   15

//---
enum LATENCY_TIME
  {
   LT_DONT_CARE,
   LT_LOWEST_LATENCY
  };
//---
enum GET_FILEEX_INFO_LEVELS
  {
   GetFileExInfoStandard,
   GetFileExMaxInfoLevel
  };
//---
enum FINDEX_INFO_LEVELS
  {
   FindExInfoStandard,
   FindExInfoBasic,
   FindExInfoMaxInfoLevel
  };
//---
enum FINDEX_SEARCH_OPS
  {
   FindExSearchNameMatch,
   FindExSearchLimitToDirectories,
   FindExSearchLimitToDevices,
   FindExSearchMaxSearchOp
  };
//---
enum DPI_AWARENESS
  {
   DPI_AWARENESS_INVALID=-1,
   DPI_AWARENESS_UNAWARE=0,
   DPI_AWARENESS_SYSTEM_AWARE=1,
   DPI_AWARENESS_PER_MONITOR_AWARE=2
  };
//---
enum DPI_HOSTING_BEHAVIOR
  {
   DPI_HOSTING_BEHAVIOR_INVALID=-1,
   DPI_HOSTING_BEHAVIOR_DEFAULT=0,
   DPI_HOSTING_BEHAVIOR_MIXED=1
  };
//---
enum FILE_INFO_BY_HANDLE_CLASS
  {
   FileBasicInfo=0,
   FileStandardInfo=1,
   FileNameInfo=2,
   FileRenameInfo=3,
   FileDispositionInfo= 4,
   FileAllocationInfo = 5,
   FileEndOfFileInfo=6,
   FileStreamInfo=7,
   FileCompressionInfo=8,
   FileAttributeTagInfo=9,
   FileIdBothDirectoryInfo=10,
   FileIdBothDirectoryRestartInfo=11,
   FileIoPriorityHintInfo = 12,
   FileRemoteProtocolInfo = 13,
   FileFullDirectoryInfo=14,
   FileFullDirectoryRestartInfo=15,
   FileStorageInfo=16,
   FileAlignmentInfo=17,
   FileIdInfo=18,
   FileIdExtdDirectoryInfo=19,
   FileIdExtdDirectoryRestartInfo=20,
   MaximumFileInfoByHandlesClass
  };
//---
enum READ_DIRECTORY_NOTIFY_INFORMATION_CLASS
  {
   ReadDirectoryNotifyInformation=1,
   ReadDirectoryNotifyExtendedInformation
  };
//---
enum WELL_KNOWN_SID_TYPE
  {
   WinNullSid=0,
   WinWorldSid= 1,
   WinLocalSid= 2,
   WinCreatorOwnerSid= 3,
   WinCreatorGroupSid= 4,
   WinCreatorOwnerServerSid=5,
   WinCreatorGroupServerSid= 6,
   WinNtAuthoritySid=7,
   WinDialupSid=8,
   WinNetworkSid=9,
   WinBatchSid=10,
   WinInteractiveSid=11,
   WinServiceSid=12,
   WinAnonymousSid=13,
   WinProxySid=14,
   WinEnterpriseControllersSid=15,
   WinSelfSid=16,
   WinAuthenticatedUserSid=17,
   WinRestrictedCodeSid= 18,
   WinTerminalServerSid= 19,
   WinRemoteLogonIdSid=20,
   WinLogonIdsSid=21,
   WinLocalSystemSid=22,
   WinLocalServiceSid=23,
   WinNetworkServiceSid=24,
   WinBuiltinDomainSid=25,
   WinBuiltinAdministratorsSid=26,
   WinBuiltinUsersSid=27,
   WinBuiltinGuestsSid=28,
   WinBuiltinPowerUsersSid=29,
   WinBuiltinAccountOperatorsSid=30,
   WinBuiltinSystemOperatorsSid=31,
   WinBuiltinPrintOperatorsSid=32,
   WinBuiltinBackupOperatorsSid=33,
   WinBuiltinReplicatorSid=34,
   WinBuiltinPreWindows2000CompatibleAccessSid=35,
   WinBuiltinRemoteDesktopUsersSid=36,
   WinBuiltinNetworkConfigurationOperatorsSid=37,
   WinAccountAdministratorSid=38,
   WinAccountGuestSid=39,
   WinAccountKrbtgtSid=40,
   WinAccountDomainAdminsSid=41,
   WinAccountDomainUsersSid=42,
   WinAccountDomainGuestsSid=43,
   WinAccountComputersSid=44,
   WinAccountControllersSid=45,
   WinAccountCertAdminsSid=46,
   WinAccountSchemaAdminsSid=47,
   WinAccountEnterpriseAdminsSid=48,
   WinAccountPolicyAdminsSid=49,
   WinAccountRasAndIasServersSid=50,
   WinNTLMAuthenticationSid=51,
   WinDigestAuthenticationSid=52,
   WinSChannelAuthenticationSid=53,
   WinThisOrganizationSid=54,
   WinOtherOrganizationSid=55,
   WinBuiltinIncomingForestTrustBuildersSid=56,
   WinBuiltinPerfMonitoringUsersSid=57,
   WinBuiltinPerfLoggingUsersSid=58,
   WinBuiltinAuthorizationAccessSid=59,
   WinBuiltinTerminalServerLicenseServersSid=60,
   WinBuiltinDCOMUsersSid=61,
   WinBuiltinIUsersSid=62,
   WinIUserSid=63,
   WinBuiltinCryptoOperatorsSid=64,
   WinUntrustedLabelSid=65,
   WinLowLabelSid=66,
   WinMediumLabelSid=67,
   WinHighLabelSid=68,
   WinSystemLabelSid=69,
   WinWriteRestrictedCodeSid=70,
   WinCreatorOwnerRightsSid=71,
   WinCacheablePrincipalsGroupSid=72,
   WinNonCacheablePrincipalsGroupSid=73,
   WinEnterpriseReadonlyControllersSid=74,
   WinAccountReadonlyControllersSid=75,
   WinBuiltinEventLogReadersGroup=76,
   WinNewEnterpriseReadonlyControllersSid=77,
   WinBuiltinCertSvcDComAccessGroup=78,
   WinMediumPlusLabelSid=79,
   WinLocalLogonSid=80,
   WinConsoleLogonSid=81,
   WinThisOrganizationCertificateSid= 82,
   WinApplicationPackageAuthoritySid= 83,
   WinBuiltinAnyPackageSid=84,
   WinCapabilityInternetClientSid=85,
   WinCapabilityInternetClientServerSid=86,
   WinCapabilityPrivateNetworkClientServerSid=87,
   WinCapabilityPicturesLibrarySid=88,
   WinCapabilityVideosLibrarySid=89,
   WinCapabilityMusicLibrarySid=90,
   WinCapabilityDocumentsLibrarySid=91,
   WinCapabilitySharedUserCertificatesSid=92,
   WinCapabilityEnterpriseAuthenticationSid=93,
   WinCapabilityRemovableStorageSid=94,
   WinBuiltinRDSRemoteAccessServersSid=95,
   WinBuiltinRDSEndpointServersSid=96,
   WinBuiltinRDSManagementServersSid=97,
   WinUserModeDriversSid=98,
   WinBuiltinHyperVAdminsSid=99,
   WinAccountCloneableControllersSid=100,
   WinBuiltinAccessControlAssistanceOperatorsSid=101,
   WinBuiltinRemoteManagementUsersSid=102,
   WinAuthenticationAuthorityAssertedSid=103,
   WinAuthenticationServiceAssertedSid=104,
   WinLocalAccountSid=105,
   WinLocalAccountAndAdministratorSid=106,
   WinAccountProtectedUsersSid=107,
   WinCapabilityAppointmentsSid=108,
   WinCapabilityContactsSid=109,
   WinAccountDefaultSystemManagedSid=110,
   WinBuiltinDefaultSystemManagedGroupSid=111,
   WinBuiltinStorageReplicaAdminsSid=112,
   WinAccountKeyAdminsSid=113,
   WinAccountEnterpriseKeyAdminsSid=114,
   WinAuthenticationKeyTrustSid=115,
   WinAuthenticationKeyPropertyMFASid=116,
   WinAuthenticationKeyPropertyAttestationSid=117,
   WinAuthenticationFreshKeyAuthSid=118,
   WinBuiltinDeviceOwnersSid=119
  };
//---
union FILE_SEGMENT_ELEMENT
  {
   PVOID             Buffer;
   ulong             Alignment;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
//---
struct REASON_CONTEXT
  {
   uint              Version;
   uint              Flags;
   PVOID             Reason;
  };
//---
struct OVERLAPPED
  {
   PVOID             Internal;
   PVOID             InternalHigh;
   uint              Offset;
   uint              OffsetHigh;
   HANDLE            hEvent;
  };
//---
struct LDT_ENTRY
  {
   ushort            LimitLow;
   ushort            BaseLow;
   uchar             BaseMid;
   uchar             Flags1;
   uchar             Flags2;
   uchar             BaseHi;
  };
//---
struct GUID
  {
   ulong             Data1;
   ushort            Data2;
   ushort            Data3;
   uchar             Data4[8];
  };
//---
struct FILETIME
  {
   uint              dwLowDateTime;
   uint              dwHighDateTime;
  };
//---
struct POINT
  {
   int               x;
   int               y;
  };
//---
struct POINTL
  {
   int               x;
   int               y;
  };
//---
struct POINTS
  {
   short             x;
   short             y;
  };
//---
struct RECT
  {
   int               left;
   int               top;
   int               right;
   int               bottom;
  };
//---
struct RECTL
  {
   int               left;
   int               top;
   int               right;
   int               bottom;
  };
//---
struct SIZE
  {
   int               cx;
   int               cy;
  };
//---
struct FILE_INFO
  {
  };
//---
struct CLAIM_SECURITY_ATTRIBUTE_V1
  {
   PVOID             Name;
   ushort            ValueType;
   ushort            Reserved;
   uint              Flags;
   uint              ValueCount;
   PVOID             Values;
  };
//---
struct CLAIM_SECURITY_ATTRIBUTES_INFORMATION
  {
   ushort            Version;
   ushort            Reserved;
   uint              AttributeCount;
   PVOID             Attribute;
  };
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                              securitybaseapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "advapi32.dll"
int                       AccessCheck(SECURITY_DESCRIPTOR &security_descriptor,HANDLE client_token,uint desired_access,GENERIC_MAPPING &generic_mapping,PRIVILEGE_SET &privilege_set,uint &privilege_set_length,uint &granted_access,int &access_status);
int                       AccessCheckAndAuditAlarmW(const string subsystem_name,PVOID handle_id,string object_type_name,string object_name,SECURITY_DESCRIPTOR &security_descriptor,uint desired_access,GENERIC_MAPPING &generic_mapping,int object_creation,uint &granted_access,int &access_status,int &generate_on_close);
int                       AccessCheckByType(SECURITY_DESCRIPTOR &security_descriptor,SID &principal_self_sid,HANDLE client_token,uint desired_access,OBJECT_TYPE_LIST &object_type_list,uint object_type_list_length,GENERIC_MAPPING &generic_mapping,PRIVILEGE_SET &privilege_set,uint &privilege_set_length,uint &granted_access,int &access_status);
int                       AccessCheckByTypeResultList(SECURITY_DESCRIPTOR &security_descriptor,SID &principal_self_sid,HANDLE client_token,uint desired_access,OBJECT_TYPE_LIST &object_type_list,uint object_type_list_length,GENERIC_MAPPING &generic_mapping,PRIVILEGE_SET &privilege_set,uint &privilege_set_length,uint &granted_access_list,uint &access_status_list);
int                       AccessCheckByTypeAndAuditAlarmW(const string subsystem_name,PVOID handle_id,const string object_type_name,const string object_name,SECURITY_DESCRIPTOR &security_descriptor,SID &principal_self_sid,uint desired_access,AUDIT_EVENT_TYPE audit_type,uint flags,OBJECT_TYPE_LIST &object_type_list,uint object_type_list_length,GENERIC_MAPPING &generic_mapping,int object_creation,uint &granted_access,int &access_status,int &generate_on_close);
int                       AccessCheckByTypeResultListAndAuditAlarmW(const string subsystem_name,PVOID handle_id,const string object_type_name,const string object_name,SECURITY_DESCRIPTOR &security_descriptor,SID &principal_self_sid,uint desired_access,AUDIT_EVENT_TYPE audit_type,uint flags,OBJECT_TYPE_LIST &object_type_list,uint object_type_list_length,GENERIC_MAPPING &generic_mapping,int object_creation,uint &granted_access_list,uint &access_status_list,int &generate_on_close);
int                       AccessCheckByTypeResultListAndAuditAlarmByHandleW(const string subsystem_name,PVOID handle_id,HANDLE client_token,const string object_type_name,const string object_name,SECURITY_DESCRIPTOR &security_descriptor,SID &principal_self_sid,uint desired_access,AUDIT_EVENT_TYPE audit_type,uint flags,OBJECT_TYPE_LIST &object_type_list,uint object_type_list_length,GENERIC_MAPPING &generic_mapping,int object_creation,uint &granted_access_list,uint &access_status_list,int &generate_on_close);
int                       AddAccessAllowedAce(ACL &acl,uint ace_revision,uint access_mask,SID &sid);
int                       AddAccessAllowedAceEx(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,SID &sid);
int                       AddAccessAllowedObjectAce(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,GUID &object_type_guid,GUID &inherited_object_type_guid,SID &sid);
int                       AddAccessDeniedAce(ACL &acl,uint ace_revision,uint access_mask,SID &sid);
int                       AddAccessDeniedAceEx(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,SID &sid);
int                       AddAccessDeniedObjectAce(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,GUID &object_type_guid,GUID &inherited_object_type_guid,SID &sid);
int                       AddAce(ACL &acl,uint ace_revision,uint starting_ace_index,PVOID ace_list,uint ace_list_length);
int                       AddAuditAccessAce(ACL &acl,uint ace_revision,uint access_mask,SID &sid,int audit_success,int audit_failure);
int                       AddAuditAccessAceEx(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,SID &sid,int audit_success,int audit_failure);
int                       AddAuditAccessObjectAce(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,GUID &object_type_guid,GUID &inherited_object_type_guid,SID &sid,int audit_success,int audit_failure);
int                       AddMandatoryAce(ACL &acl,uint ace_revision,uint ace_flags,uint mandatory_policy,SID &label_sid);
int                       AdjustTokenGroups(HANDLE token_handle,int reset_to_default,TOKEN_GROUPS &new_state,uint buffer_length,TOKEN_GROUPS &previous_state,uint &return_length);
int                       AdjustTokenPrivileges(HANDLE token_handle,int disable_all_privileges,TOKEN_PRIVILEGES &new_state,uint buffer_length,TOKEN_PRIVILEGES &previous_state,uint &return_length);
int                       AllocateAndInitializeSid(SID_IDENTIFIER_AUTHORITY &identifier_authority,uchar sub_authority_count,uint sub_authority0,uint sub_authority1,uint sub_authority2,uint sub_authority3,uint sub_authority4,uint sub_authority5,uint sub_authority6,uint sub_authority7,SID &sid);
int                       AllocateLocallyUniqueId(LUID &luid);
int                       AreAllAccessesGranted(uint granted_access,uint desired_access);
int                       AreAnyAccessesGranted(uint granted_access,uint desired_access);
int                       CheckTokenMembership(HANDLE token_handle,SID &sid_to_check,int &is_member);
int                       ConvertToAutoInheritPrivateObjectSecurity(SECURITY_DESCRIPTOR &parent_descriptor,SECURITY_DESCRIPTOR &current_security_descriptor,SECURITY_DESCRIPTOR  &new_security_descriptor,GUID &object_type,uchar is_directory_object,GENERIC_MAPPING &generic_mapping);
int                       CopySid(uint destination_sid_length,SID &destination_sid,SID &source_sid);
int                       CreatePrivateObjectSecurity(SECURITY_DESCRIPTOR &parent_descriptor,SECURITY_DESCRIPTOR &creator_descriptor,SECURITY_DESCRIPTOR  &new_descriptor,int is_directory_object,HANDLE token,GENERIC_MAPPING &generic_mapping);
int                       CreatePrivateObjectSecurityEx(SECURITY_DESCRIPTOR &parent_descriptor,SECURITY_DESCRIPTOR &creator_descriptor,SECURITY_DESCRIPTOR  &new_descriptor,GUID &object_type,int is_container_object,uint auto_inherit_flags,HANDLE token,GENERIC_MAPPING &generic_mapping);
int                       CreatePrivateObjectSecurityWithMultipleInheritance(SECURITY_DESCRIPTOR &parent_descriptor,SECURITY_DESCRIPTOR &creator_descriptor,SECURITY_DESCRIPTOR  &new_descriptor,GUID &object_types,uint guid_count,int is_container_object,uint auto_inherit_flags,HANDLE token,GENERIC_MAPPING &generic_mapping);
int                       CreateRestrictedToken(HANDLE existing_token_handle,uint flags,uint disable_sid_count,SID_AND_ATTRIBUTES &sids_to_disable,uint delete_privilege_count,LUID_AND_ATTRIBUTES &privileges_to_delete,uint restricted_sid_count,SID_AND_ATTRIBUTES &sids_to_restrict,HANDLE &new_token_handle);
int                       CreateWellKnownSid(WELL_KNOWN_SID_TYPE well_known_sid_type,SID &domain_sid,SID &sid,uint &sid);
int                       EqualDomainSid(SID &sid1,SID &sid2,int &equal);
int                       DeleteAce(ACL &acl,uint ace_index);
int                       DestroyPrivateObjectSecurity(SECURITY_DESCRIPTOR  &object_descriptor);
int                       DuplicateToken(HANDLE existing_token_handle,SECURITY_IMPERSONATION_LEVEL impersonation_level,HANDLE &duplicate_token_handle);
int                       DuplicateTokenEx(HANDLE existing_token,uint desired_access,PVOID token_attributes,SECURITY_IMPERSONATION_LEVEL impersonation_level,TOKEN_TYPE token_type,HANDLE &new_token);
int                       EqualPrefixSid(SID &sid1,SID &sid2);
int                       EqualSid(SID &sid1,SID &sid2);
int                       FindFirstFreeAce(ACL &acl,PVOID &ace);
PVOID                     FreeSid(SID &sid);
int                       GetAce(ACL &acl,uint ace_index,PVOID &ace);
int                       GetAclInformation(ACL &acl,PVOID acl_information,uint acl_information_length,ACL_INFORMATION_CLASS acl_information_class);
int                       GetFileSecurityW(const string file_name,uint requested_information,SECURITY_DESCRIPTOR  &security_descriptor,uint length,uint &length_needed);
int                       GetKernelObjectSecurity(HANDLE handle,uint requested_information,SECURITY_DESCRIPTOR &security_descriptor,uint length,uint &length_needed);
uint                      GetLengthSid(SID &sid);
int                       GetPrivateObjectSecurity(SECURITY_DESCRIPTOR &object_descriptor,uint security_information,SECURITY_DESCRIPTOR  &resultant_descriptor,uint descriptor_length,uint &return_length);
int                       GetSecurityDescriptorControl(SECURITY_DESCRIPTOR &security_descriptor,ushort &control,uint &revision);
int                       GetSecurityDescriptorDacl(SECURITY_DESCRIPTOR &security_descriptor,int &dacl_present,ACL &dacl,int &dacl_defaulted);
int                       GetSecurityDescriptorGroup(SECURITY_DESCRIPTOR &security_descriptor,SID &group,int &group_defaulted);
uint                      GetSecurityDescriptorLength(SECURITY_DESCRIPTOR &security_descriptor);
int                       GetSecurityDescriptorOwner(SECURITY_DESCRIPTOR &security_descriptor,SID &owner,int &owner_defaulted);
uint                      GetSecurityDescriptorRMControl(SECURITY_DESCRIPTOR &security_descriptor,uchar &rm_control);
int                       GetSecurityDescriptorSacl(SECURITY_DESCRIPTOR &security_descriptor,int &sacl_present,ACL &sacl,int &sacl_defaulted);
PVOID                     GetSidIdentifierAuthority(SID &sid);
uint                      GetSidLengthRequired(uchar sub_authority_count);
PVOID                     GetSidSubAuthority(SID &sid,uint sub_authority);
PVOID                     GetSidSubAuthorityCount(SID &sid);
int                       GetTokenInformation(HANDLE token_handle,TOKEN_INFORMATION_CLASS token_information_class,PVOID &token_information,uint token_information_length,uint &return_length);
int                       GetWindowsAccountDomainSid(SID &sid,SID &domain_sid,uint &domain_sid);
int                       ImpersonateAnonymousToken(HANDLE thread_handle);
int                       ImpersonateLoggedOnUser(HANDLE token);
int                       ImpersonateSelf(SECURITY_IMPERSONATION_LEVEL impersonation_level);
int                       InitializeAcl(ACL &acl,uint acl_length,uint acl_revision);
int                       InitializeSecurityDescriptor(SECURITY_DESCRIPTOR &security_descriptor,uint revision);
int                       InitializeSid(SID &sid,SID_IDENTIFIER_AUTHORITY &identifier_authority,uchar sub_authority_count);
int                       IsTokenRestricted(HANDLE token_handle);
int                       IsValidAcl(ACL &acl);
int                       IsValidSecurityDescriptor(SECURITY_DESCRIPTOR &security_descriptor);
int                       IsValidSid(SID &sid);
int                       IsWellKnownSid(SID &sid,WELL_KNOWN_SID_TYPE well_known_sid_type);
int                       MakeAbsoluteSD(SECURITY_DESCRIPTOR &self_relative_security_descriptor,SECURITY_DESCRIPTOR  &absolute_security_descriptor,uint &absolute_security_descriptor_size,ACL &dacl,uint &dacl_size,ACL &sacl,uint &sacl_size,SID &owner,uint &owner_size,SID &primary_group,uint &primary_group_size);
int                       MakeSelfRelativeSD(SECURITY_DESCRIPTOR &absolute_security_descriptor,SECURITY_DESCRIPTOR  &self_relative_security_descriptor,uint &buffer_length);
void                      MapGenericMask(uint &access_mask,GENERIC_MAPPING &generic_mapping);
int                       ObjectCloseAuditAlarmW(const string subsystem_name,PVOID handle_id,int generate_on_close);
int                       ObjectDeleteAuditAlarmW(const string subsystem_name,PVOID handle_id,int generate_on_close);
int                       ObjectOpenAuditAlarmW(const string subsystem_name,PVOID handle_id,string object_type_name,string object_name,SECURITY_DESCRIPTOR &security_descriptor,HANDLE client_token,uint desired_access,uint granted_access,PRIVILEGE_SET &privileges,int object_creation,int access_granted,int &generate_on_close);
int                       ObjectPrivilegeAuditAlarmW(const string subsystem_name,PVOID handle_id,HANDLE client_token,uint desired_access,PRIVILEGE_SET &privileges,int access_granted);
int                       PrivilegeCheck(HANDLE client_token,PRIVILEGE_SET &required_privileges,int &result);
int                       PrivilegedServiceAuditAlarmW(const string subsystem_name,const string service_name,HANDLE client_token,PRIVILEGE_SET &privileges,int access_granted);
void                      QuerySecurityAccessMask(uint security_information,uint &desired_access);
int                       RevertToSelf(void);
int                       SetAclInformation(ACL &acl,PVOID acl_information,uint acl_information_length,ACL_INFORMATION_CLASS acl_information_class);
int                       SetFileSecurityW(const string file_name,uint security_information,SECURITY_DESCRIPTOR &security_descriptor);
int                       SetKernelObjectSecurity(HANDLE handle,uint security_information,SECURITY_DESCRIPTOR &security_descriptor);
int                       SetPrivateObjectSecurity(uint security_information,SECURITY_DESCRIPTOR &modification_descriptor,SECURITY_DESCRIPTOR  &objects_security_descriptor,GENERIC_MAPPING &generic_mapping,HANDLE token);
int                       SetPrivateObjectSecurityEx(uint security_information,SECURITY_DESCRIPTOR &modification_descriptor,SECURITY_DESCRIPTOR  &objects_security_descriptor,uint auto_inherit_flags,GENERIC_MAPPING &generic_mapping,HANDLE token);
void                      SetSecurityAccessMask(uint security_information,uint &desired_access);
int                       SetSecurityDescriptorControl(SECURITY_DESCRIPTOR &security_descriptor,ushort control_bits_of_interest,ushort control_bits_to_set);
int                       SetSecurityDescriptorDacl(SECURITY_DESCRIPTOR &security_descriptor,int dacl_present,ACL &dacl,int dacl_defaulted);
int                       SetSecurityDescriptorGroup(SECURITY_DESCRIPTOR &security_descriptor,SID &group,int group_defaulted);
int                       SetSecurityDescriptorOwner(SECURITY_DESCRIPTOR &security_descriptor,SID &owner,int owner_defaulted);
uint                      SetSecurityDescriptorRMControl(SECURITY_DESCRIPTOR &security_descriptor,uchar &rm_control);
int                       SetSecurityDescriptorSacl(SECURITY_DESCRIPTOR &security_descriptor,int sacl_present,ACL &sacl,int sacl_defaulted);
int                       SetTokenInformation(HANDLE token_handle,TOKEN_INFORMATION_CLASS token_information_class,PVOID token_information,uint token_information_length);
int                       CveEventWrite(const string cve_id,const string additional_details);
#import

#import "kernel32.dll"
int                       AddResourceAttributeAce(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,SID &sid,CLAIM_SECURITY_ATTRIBUTES_INFORMATION &attribute_info,uint &return_length);
int                       AddScopedPolicyIDAce(ACL &acl,uint ace_revision,uint ace_flags,uint access_mask,SID &sid);
int                       CheckTokenCapability(HANDLE token_handle,SID &capability_sid_to_check,int &has_capability);
int                       GetAppContainerAce(ACL &acl,uint starting_ace_index,PVOID &app_container_ace,uint &app_container_ace_index);
int                       CheckTokenMembershipEx(HANDLE token_handle,SID &sid_to_check,uint flags,int &is_member);
int                       SetCachedSigningLevel(HANDLE &source_files,uint source_file_count,uint flags,HANDLE target_file);
int                       GetCachedSigningLevel(HANDLE file,ulong flags,ulong signing_level,uchar &thumbprint[],ulong thumbprint_size,ulong thumbprint_algorithm);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                      WinUser.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\wingdi.mqh>

//---
#define POINTER_DEVICE_PRODUCT_STRING_MAX 520
#define KL_NAMELENGTH                     9

//---
enum AR_STATE
  {
   AR_ENABLED=0x0,
   AR_DISABLED=0x1,
   AR_SUPPRESSED=0x2,
   AR_REMOTESESSION=0x4,
   AR_MULTIMON=0x8,
   AR_NOSENSOR=0x10,
   AR_NOT_SUPPORTED=0x20,
   AR_DOCKED=0x40,
   AR_LAPTOP=0x80
  };
//---
enum DIALOG_CONTROL_DPI_CHANGE_BEHAVIORS
  {
   DCDC_DEFAULT=0x0000,
   DCDC_DISABLE_FONT_UPDATE=0x0001,
   DCDC_DISABLE_RELAYOUT=0x0002
  };
//---
enum DIALOG_DPI_CHANGE_BEHAVIORS
  {
   DDC_DEFAULT=0x0000,
   DDC_DISABLE_ALL=0x0001,
   DDC_DISABLE_RESIZE=0x0002,
   DDC_DISABLE_CONTROL_RELAYOUT=0x0004
  };
//---
enum EDIT_CONTROL_FEATURE
  {
   EDIT_CONTROL_FEATURE_ENTERPRISE_DATA_PROTECTION_PASTE_SUPPORT=0,
   EDIT_CONTROL_FEATURE_PASTE_NOTIFICATIONS=1
  };
//---
enum FEEDBACK_TYPE
  {
   FEEDBACK_TOUCH_CONTACTVISUALIZATION=1,
   FEEDBACK_PEN_BARRELVISUALIZATION=2,
   FEEDBACK_PEN_TAP=3,
   FEEDBACK_PEN_DOUBLETAP=4,
   FEEDBACK_PEN_PRESSANDHOLD=5,
   FEEDBACK_PEN_RIGHTTAP=6,
   FEEDBACK_TOUCH_TAP=7,
   FEEDBACK_TOUCH_DOUBLETAP=8,
   FEEDBACK_TOUCH_PRESSANDHOLD=9,
   FEEDBACK_TOUCH_RIGHTTAP=10,
   FEEDBACK_GESTURE_PRESSANDTAP=11,
   FEEDBACK_MAX=0xFFFFFFFF
  };
//---
enum HANDEDNESS
  {
   HANDEDNESS_LEFT=0,
   HANDEDNESS_RIGHT
  };
//---
enum INPUT_MESSAGE_DEVICE_TYPE
  {
   IMDT_UNAVAILABLE=0x00000000,
   IMDT_KEYBOARD=0x00000001,
   IMDT_MOUSE=0x00000002,
   IMDT_TOUCH=0x00000004,
   IMDT_PEN=0x00000008,
   IMDT_TOUCHPAD=0x00000010
  };
//---
enum INPUT_MESSAGE_ORIGIN_ID
  {
   IMO_UNAVAILABLE=0x00000000,
   IMO_HARDWARE=0x00000001,
   IMO_INJECTED=0x00000002,
   IMO_SYSTEM=0x00000004
  };
//---
enum ORIENTATION_PREFERENCE
  {
   ORIENTATION_PREFERENCE_NONE=0x0,
   ORIENTATION_PREFERENCE_LANDSCAPE=0x1,
   ORIENTATION_PREFERENCE_PORTRAIT=0x2,
   ORIENTATION_PREFERENCE_LANDSCAPE_FLIPPED=0x4,
   ORIENTATION_PREFERENCE_PORTRAIT_FLIPPED=0x8
  };
//---
enum POINTER_BUTTON_CHANGE_TYPE
  {
   POINTER_CHANGE_NONE,
   POINTER_CHANGE_FIRSTBUTTON_DOWN,
   POINTER_CHANGE_FIRSTBUTTON_UP,
   POINTER_CHANGE_SECONDBUTTON_DOWN,
   POINTER_CHANGE_SECONDBUTTON_UP,
   POINTER_CHANGE_THIRDBUTTON_DOWN,
   POINTER_CHANGE_THIRDBUTTON_UP,
   POINTER_CHANGE_FOURTHBUTTON_DOWN,
   POINTER_CHANGE_FOURTHBUTTON_UP,
   POINTER_CHANGE_FIFTHBUTTON_DOWN,
   POINTER_CHANGE_FIFTHBUTTON_UP
  };
//---
enum POINTER_DEVICE_CURSOR_TYPE
  {
   POINTER_DEVICE_CURSOR_TYPE_UNKNOWN=0x00000000,
   POINTER_DEVICE_CURSOR_TYPE_TIP=0x00000001,
   POINTER_DEVICE_CURSOR_TYPE_ERASER=0x00000002,
   POINTER_DEVICE_CURSOR_TYPE_MAX=0xFFFFFFFF
  };
//---
enum POINTER_DEVICE_TYPE
  {
   POINTER_DEVICE_TYPE_INTEGRATED_PEN=0x00000001,
   POINTER_DEVICE_TYPE_EXTERNAL_PEN=0x00000002,
   POINTER_DEVICE_TYPE_TOUCH=0x00000003,
   POINTER_DEVICE_TYPE_TOUCH_PAD=0x00000004,
   POINTER_DEVICE_TYPE_MAX=0xFFFFFFFF
  };
//---
struct ACCEL
  {
   uchar             fVirt;
   ushort            key;
   ushort            cmd;
  };
//---
struct ACCESSTIMEOUT
  {
   uint              cbSize;
   uint              dwFlags;
   uint              iTimeOutMSec;
  };
//---
struct ALTTABINFO
  {
   uint              cbSize;
   int               cItems;
   int               cColumns;
   int               cRows;
   int               iColFocus;
   int               iRowFocus;
   int               cxItem;
   int               cyItem;
   POINT             ptStart;
  };
//---
struct ANIMATIONINFO
  {
   uint              cbSize;
   int               iMinAnimate;
  };
//---
struct AUDIODESCRIPTION
  {
   uint              cbSize;
   int               Enabled;
   uint              Locale;
  };
//---
struct BSMINFO
  {
   uint              cbSize;
   HANDLE            hdesk;
   HANDLE            hwnd;
   LUID              luid;
  };
//---
struct CBT_CREATEWNDA
  {
   HANDLE            hwndInsertAfter;
  };
//---
struct CBT_CREATEWNDW
  {
   HANDLE            hwndInsertAfter;
  };
//---
struct CBTACTIVATESTRUCT
  {
   int               fMouse;
   HANDLE            hWndActive;
  };
//---
struct CHANGEFILTERSTRUCT
  {
   uint              cbSize;
   uint              ExtStatus;
  };
//---
struct CLIENTCREATESTRUCT
  {
   HANDLE            hWindowMenu;
   uint              idFirstChild;
  };
//---
struct COMBOBOXINFO
  {
   uint              cbSize;
   RECT              rcItem;
   RECT              rcButton;
   uint              stateButton;
   HANDLE            hwndCombo;
   HANDLE            hwndItem;
   HANDLE            hwndList;
  };
//---
struct COMPAREITEMSTRUCT
  {
   uint              CtlType;
   uint              CtlID;
   HANDLE            hwndItem;
   uint              itemID1;
   ulong             itemData1;
   uint              itemID2;
   ulong             itemData2;
   uint              dwLocaleId;
  };
//---
struct COPYDATASTRUCT
  {
   ulong             dwData;
   uint              cbData;
  };
//---
struct CREATESTRUCTW pack(8)
  {
   PVOID             lpCreateParams;
   HANDLE            hInstance;
   HANDLE            hMenu;
   HANDLE            hwndParent;
   int               cy;
   int               cx;
   int               y;
   int               x;
   int               style;
   PVOID             lpszName;
   PVOID             lpszClass;
   uint              dwExStyle;
  };
//---
struct CURSORINFO
  {
   uint              cbSize;
   uint              flags;
   HANDLE            hCursor;
   POINT             ptScreenPos;
  };
//---
struct CURSORSHAPE
  {
   int               xHotSpot;
   int               yHotSpot;
   int               cx;
   int               cy;
   int               cbWidth;
   uchar             Planes;
   uchar             BitsPixel;
  };
//---
struct CWPRETSTRUCT
  {
   PVOID             lResult;
   PVOID             lParam;
   PVOID             wParam;
   uint              message;
   HANDLE            hwnd;
  };
//---
struct CWPSTRUCT
  {
   PVOID             lParam;
   PVOID             wParam;
   uint              message;
   HANDLE            hwnd;
  };
//---
struct DEBUGHOOKINFO
  {
   uint              idThread;
   uint              idThreadInstaller;
   PVOID             lParam;
   PVOID             wParam;
   int               code;
  };
//---
struct DELETEITEMSTRUCT
  {
   uint              CtlType;
   uint              CtlID;
   uint              itemID;
   HANDLE            hwndItem;
   ulong             itemData;
  };
//---
struct DLGITEMTEMPLATE
  {
   uint              style;
   uint              dwExtendedStyle;
   short             x;
   short             y;
   short             cx;
   short             cy;
   ushort            id;
  };
//---
struct DLGTEMPLATE
  {
   uint              style;
   uint              dwExtendedStyle;
   ushort            cdit;
   short             x;
   short             y;
   short             cx;
   short             cy;
  };
//---
struct DRAWITEMSTRUCT
  {
   uint              CtlType;
   uint              CtlID;
   uint              itemID;
   uint              itemAction;
   uint              itemState;
   HANDLE            hwndItem;
   HANDLE            hDC;
   RECT              rcItem;
   ulong             itemData;
  };
//---
struct DRAWTEXTPARAMS
  {
   uint              cbSize;
   int               iTabLength;
   int               iLeftMargin;
   int               iRightMargin;
   uint              uiLengthDrawn;
  };
//---
struct DROPSTRUCT
  {
   HANDLE            hwndSource;
   HANDLE            hwndSink;
   uint              wFmt;
   ulong             dwData;
   POINT             ptDrop;
   uint              dwControlData;
  };
//---
struct EVENTMSG
  {
   uint              message;
   uint              paramL;
   uint              paramH;
   uint              time;
   HANDLE            hwnd;
  };
//---
struct FILTERKEYS
  {
   uint              cbSize;
   uint              dwFlags;
   uint              iWaitMSec;
   uint              iDelayMSec;
   uint              iRepeatMSec;
   uint              iBounceMSec;
  };
//---
struct FLASHWINFO
  {
   uint              cbSize;
   HANDLE            hwnd;
   uint              dwFlags;
   uint              uCount;
   uint              dwTimeout;
  };
//---
struct GESTURECONFIG
  {
   uint              dwID;
   uint              dwWant;
   uint              dwBlock;
  };
//---
struct GESTUREINFO
  {
   uint              cbSize;
   uint              dwFlags;
   uint              dwID;
   HANDLE            hwndTarget;
   POINTS            ptsLocation;
   uint              dwInstanceID;
   uint              dwSequenceID;
   ulong             ullArguments;
   uint              cbExtraArgs;
  };
//---
struct GESTURENOTIFYSTRUCT
  {
   uint              cbSize;
   uint              dwFlags;
   HANDLE            hwndTarget;
   POINTS            ptsLocation;
   uint              dwInstanceID;
  };
//---
struct GUITHREADINFO
  {
   uint              cbSize;
   uint              flags;
   HANDLE            hwndActive;
   HANDLE            hwndFocus;
   HANDLE            hwndCapture;
   HANDLE            hwndMenuOwner;
   HANDLE            hwndMoveSize;
   HANDLE            hwndCaret;
   RECT              rcCaret;
  };
//---
struct HARDWAREHOOKSTRUCT
  {
   HANDLE            hwnd;
   uint              message;
   PVOID             wParam;
   PVOID             lParam;
  };
//---
struct HARDWAREINPUT
  {
   uint              uMsg;
   ushort            wParamL;
   ushort            wParamH;
  };
//---
struct HELPINFO
  {
   uint              cbSize;
   int               iContextType;
   int               iCtrlId;
   HANDLE            hItemHandle;
   uint              dwContextId;
   POINT             MousePos;
  };
//---
struct HELPWININFOA
  {
   int               wStructSize;
   int               x;
   int               y;
   int               dx;
   int               dy;
   int               wMax;
   char              rgchMember[2];
  };
//---
struct HELPWININFOW
  {
   int               wStructSize;
   int               x;
   int               y;
   int               dx;
   int               dy;
   int               wMax;
   short             rgchMember[2];
  };
//---
struct HIGHCONTRASTW
  {
   uint              cbSize;
   uint              dwFlags;
   string            lpszDefaultScheme;
  };
//---
struct ICONINFO
  {
   int               fIcon;
   uint              xHotspot;
   uint              yHotspot;
   HANDLE            hbmMask;
   HANDLE            hbmColor;
  };
//---
struct ICONINFOEXW
  {
   uint              cbSize;
   int               fIcon;
   uint              xHotspot;
   uint              yHotspot;
   HANDLE            hbmMask;
   HANDLE            hbmColor;
   ushort            wResID;
   short             szModName[MAX_PATH];
   short             szResName[MAX_PATH];
  };
//---
struct ICONMETRICSW
  {
   uint              cbSize;
   int               iHorzSpacing;
   int               iVertSpacing;
   int               iTitleWrap;
   LOGFONTW          lfFont;
  };
//---
struct INPUT_INJECTION_VALUE
  {
   ushort            page;
   ushort            usage;
   int               value;
   ushort            index;
  };
//---
struct INPUT_MESSAGE_SOURCE
  {
   INPUT_MESSAGE_DEVICE_TYPE deviceType;
   INPUT_MESSAGE_ORIGIN_ID originId;
  };
//---
struct KBDLLHOOKSTRUCT
  {
   uint              vkCode;
   uint              scanCode;
   uint              flags;
   uint              time;
   ulong             dwExtraInfo;
  };
//---
struct KEYBDINPUT
  {
   ushort            wVk;
   ushort            wScan;
   uint              dwFlags;
   uint              time;
   ulong             dwExtraInfo;
  };
//---
struct LASTINPUTINFO
  {
   uint              cbSize;
   uint              dwTime;
  };
//---
struct MDICREATESTRUCTW
  {
   PVOID             szClass;
   PVOID             szTitle;
   HANDLE            hOwner;
   int               x;
   int               y;
   int               cx;
   int               cy;
   uint              style;
   PVOID             lParam;
  };
//---
struct MDINEXTMENU
  {
   HANDLE            hmenuIn;
   HANDLE            hmenuNext;
   HANDLE            hwndNext;
  };
//---
struct MEASUREITEMSTRUCT
  {
   uint              CtlType;
   uint              CtlID;
   uint              itemID;
   uint              itemWidth;
   uint              itemHeight;
   ulong             itemData;
  };
//---
struct MENUBARINFO
  {
   uint              cbSize;
   RECT              rcBar;
   HANDLE            hMenu;
   HANDLE            hwndMenu;
   int               Focused;
  };
//---
struct MENUGETOBJECTINFO
  {
   uint              dwFlags;
   uint              uPos;
   HANDLE            hmenu;
   PVOID             riid;
   PVOID             pvObj;
  };
//---
struct MENUINFO
  {
   uint              cbSize;
   uint              fMask;
   uint              dwStyle;
   uint              cyMax;
   HANDLE            hbrBack;
   uint              dwContextHelpID;
   ulong             dwMenuData;
  };
//---
struct MENUITEMINFOW
  {
   uint              cbSize;
   uint              fMask;
   uint              fType;
   uint              fState;
   uint              wID;
   HANDLE            hSubMenu;
   HANDLE            hbmpChecked;
   HANDLE            hbmpUnchecked;
   ulong             dwItemData;
   string            dwTypeData;
   uint              cch;
   HANDLE            hbmpItem;
  };
//---
struct MENUITEMTEMPLATE
  {
   ushort            mtOption;
   ushort            mtID;
   short             mtString[1];
  };
//---
struct MENUITEMTEMPLATEHEADER
  {
   ushort            versionNumber;
   ushort            offset;
  };
//---
struct MINIMIZEDMETRICS
  {
   uint              cbSize;
   int               iWidth;
   int               iHorzGap;
   int               iVertGap;
   int               iArrange;
  };
//---
struct MINMAXINFO
  {
   POINT             ptReserved;
   POINT             ptMaxSize;
   POINT             ptMaxPosition;
   POINT             ptMinTrackSize;
   POINT             ptMaxTrackSize;
  };
//---
struct MONITORINFO
  {
   uint              cbSize;
   RECT              rcMonitor;
   RECT              rcWork;
   uint              dwFlags;
  };
//---
struct MOUSEHOOKSTRUCT
  {
   POINT             pt;
   HANDLE            hwnd;
   uint              wHitTestCode;
   ulong             dwExtraInfo;
  };
//---
struct MOUSEHOOKSTRUCTEX: public MONITORINFO
  {
   uint              mouseData;
  };
//---
struct MOUSEINPUT pack(8)
  {
   int               dx;
   int               dy;
   uint              mouseData;
   uint              dwFlags;
   uint              time;
   ulong             dwExtraInfo;
  };
//---
struct MOUSEKEYS
  {
   uint              cbSize;
   uint              dwFlags;
   uint              iMaxSpeed;
   uint              iTimeToMaxSpeed;
   uint              iCtrlSpeed;
   uint              dwReserved1;
   uint              dwReserved2;
  };
//---
struct MOUSEMOVEPOINT
  {
   int               x;
   int               y;
   uint              time;
   ulong             dwExtraInfo;
  };
//---
struct MSG
  {
   HANDLE            hwnd;
   uint              message;
   PVOID             wParam;
   PVOID             lParam;
   uint              time;
   POINT             pt;
   uint              lPrivate;
  };
//---
struct MSGBOXPARAMSW
  {
   uint              cbSize;
   HANDLE            hwndOwner;
   HANDLE            hInstance;
   PVOID             lpszText;
   PVOID             lpszCaption;
   uint              dwStyle;
   PVOID             lpszIcon;
   uint              dwContextHelpId;
   PVOID             lpfnMsgBoxCallback;
   uint              dwLanguageId;
  };
//---
struct MSLLHOOKSTRUCT
  {
   POINT             pt;
   uint              mouseData;
   uint              flags;
   uint              time;
   ulong             dwExtraInfo;
  };
//---
struct MULTIKEYHELPW
  {
   short             mkKeylist;
   short             szKeyphrase[1];
  };
//---
struct NCCALCSIZE_PARAMS
  {
   RECT              rgrc[3];
   PVOID             lppos;
  };
//---
struct NMHDR
  {
   HANDLE            hwndFrom;
   ulong             idFrom;
   uint              code;
  };
//---
struct NONCLIENTMETRICSW
  {
   uint              cbSize;
   int               iBorderWidth;
   int               iScrollWidth;
   int               iScrollHeight;
   int               iCaptionWidth;
   int               iCaptionHeight;
   LOGFONTW          lfCaptionFont;
   int               iSmCaptionWidth;
   int               iSmCaptionHeight;
   LOGFONTW          lfSmCaptionFont;
   int               iMenuWidth;
   int               iMenuHeight;
   LOGFONTW          lfMenuFont;
   LOGFONTW          lfStatusFont;
   LOGFONTW          lfMessageFont;
   int               iPaddedBorderWidth;
  };
//---
struct PAINTSTRUCT
  {
   HANDLE            hdc;
   int               fErase;
   RECT              rcPaint;
   int               fRestore;
   int               fIncUpdate;
   uchar             rgbReserved[32];
  };
//---
struct POINTER_DEVICE_CURSOR_INFO
  {
   uint              cursorId;
   POINTER_DEVICE_CURSOR_TYPE cursor;
  };
//---
struct POINTER_DEVICE_INFO pack(8)
  {
   uint              displayOrientation;
   HANDLE            device;
   POINTER_DEVICE_TYPE pointerDeviceType;
   HANDLE            monitor;
   uint              startingCursorId;
   ushort            maxActiveContacts;
   short             productString[POINTER_DEVICE_PRODUCT_STRING_MAX];
  };
//---
struct POINTER_DEVICE_PROPERTY
  {
   int               logicalMin;
   int               logicalMax;
   int               physicalMin;
   int               physicalMax;
   uint              unit;
   uint              unitExponent;
   ushort            usagePageId;
   ushort            usageId;
  };
//---
struct POINTER_INFO
  {
   uint              pointerType;
   uint              pointerId;
   uint              frameId;
   uint              pointerFlags;
   HANDLE            sourceDevice;
   HANDLE            hwndTarget;
   POINT             ptPixelLocation;
   POINT             ptHimetricLocation;
   POINT             ptPixelLocationRaw;
   POINT             ptHimetricLocationRaw;
   uint              dwTime;
   uint              historyCount;
   int               InputData;
   uint              dwKeyStates;
   ulong             PerformanceCount;
   POINTER_BUTTON_CHANGE_TYPE ButtonChangeType;
  };
//---
struct POINTER_PEN_INFO
  {
   POINTER_INFO      pointerInfo;
   uint              penFlags;
   uint              penMask;
   uint              pressure;
   uint              rotation;
   int               tiltX;
   int               tiltY;
  };
//---
struct POINTER_TOUCH_INFO
  {
   POINTER_INFO      pointerInfo;
   uint              touchFlags;
   uint              touchMask;
   RECT              rcContact;
   RECT              rcContactRaw;
   uint              orientation;
   uint              pressure;
  };
//---
struct POWERBROADCAST_SETTING
  {
   GUID              PowerSetting;
   uint              DataLength;
   uchar             Data[1];
  };
//---
struct RAWINPUTDEVICE
  {
   ushort            usUsagePage;
   ushort            usUsage;
   uint              dwFlags;
   HANDLE            hwndTarget;
  };
//---
struct RAWINPUTDEVICELIST
  {
   HANDLE            hDevice;
   uint              dwType;
  };
//---
struct RAWINPUTHEADER
  {
   uint              dwType;
   uint              dwSize;
   HANDLE            hDevice;
   PVOID             wParam;
  };
//---
struct RID_DEVICE_INFO_HID
  {
   uint              dwVendorId;
   uint              dwProductId;
   uint              dwVersionNumber;
   ushort            usUsagePage;
   ushort            usUsage;
  };
//---
struct RID_DEVICE_INFO_KEYBOARD
  {
   uint              dwType;
   uint              dwSubType;
   uint              dwKeyboardMode;
   uint              dwNumberOfFunctionKeys;
   uint              dwNumberOfIndicators;
   uint              dwNumberOfKeysTotal;
  };
//---
struct RID_DEVICE_INFO_MOUSE
  {
   uint              dwId;
   uint              dwNumberOfButtons;
   uint              dwSampleRate;
   int               fHasHorizontalWheel;
  };
//---
struct SCROLLBARINFO
  {
   uint              cbSize;
   RECT              rcScrollBar;
   int               dxyLineButton;
   int               xyThumbTop;
   int               xyThumbBottom;
   int               reserved;
  };
//---
struct SCROLLINFO
  {
   uint              cbSize;
   uint              fMask;
   int               nMin;
   int               nMax;
   uint              nPage;
   int               nPos;
   int               nTrackPos;
  };
//---
struct SERIALKEYSW
  {
   uint              cbSize;
   uint              dwFlags;
   string            lpszActivePort;
   string            lpszPort;
   uint              iBaudRate;
   uint              iPortState;
   uint              iActive;
  };
//---
struct SHELLHOOKINFO
  {
   HANDLE            hwnd;
   RECT              rc;
  };
//---
struct SOUNDSENTRYW
  {
   uint              cbSize;
   uint              dwFlags;
   uint              iFSTextEffect;
   uint              iFSTextEffectMSec;
   uint              iFSTextEffectColorBits;
   uint              iFSGrafEffect;
   uint              iFSGrafEffectMSec;
   uint              iFSGrafEffectColor;
   uint              iWindowsEffect;
   uint              iWindowsEffectMSec;
   string            lpszWindowsEffectDLL;
   uint              iWindowsEffectOrdinal;
  };
//---
struct STICKYKEYS
  {
   uint              cbSize;
   uint              dwFlags;
  };
//---
struct STYLESTRUCT
  {
   uint              styleOld;
   uint              styleNew;
  };
//---
struct TITLEBARINFO
  {
   uint              cbSize;
   RECT              rcTitleBar;
  };
//---
struct TITLEBARINFOEX
  {
   uint              cbSize;
   RECT              rcTitleBar;
  };
//---
struct TOGGLEKEYS
  {
   uint              cbSize;
   uint              dwFlags;
  };
//---
struct TOUCH_HIT_TESTING_INPUT
  {
   uint              pointerId;
   POINT             point;
   RECT              boundingBox;
   RECT              nonOccludedBoundingBox;
   uint              orientation;
  };
//---
struct TOUCH_HIT_TESTING_PROXIMITY_EVALUATION
  {
   ushort            score;
   POINT             adjustedPoint;
  };
//---
struct TOUCHINPUT
  {
   int               x;
   int               y;
   HANDLE            hSource;
   uint              dwID;
   uint              dwFlags;
   uint              dwMask;
   uint              dwTime;
   ulong             dwExtraInfo;
   uint              cxContact;
   uint              cyContact;
  };
//---
struct TOUCHPREDICTIONPARAMETERS
  {
   uint              cbSize;
   uint              dwLatency;
   uint              dwSampleTime;
   uint              bUseHWTimeStamp;
  };
//---
struct TPMPARAMS
  {
   uint              cbSize;
   RECT              rcExclude;
  };
//---
struct TRACKMOUSEEVENT
  {
   uint              cbSize;
   uint              dwFlags;
   HANDLE            hwndTrack;
   uint              dwHoverTime;
  };
//---
struct UPDATELAYEREDWINDOWINFO
  {
   uint              cbSize;
   HANDLE            hdcDst;
   HANDLE            hdcSrc;
   uint              crKey;
   uint              dwFlags;
  };
//---
struct USAGE_PROPERTIES
  {
   ushort            level;
   ushort            page;
   ushort            usage;
   int               logicalMinimum;
   int               logicalMaximum;
   ushort            unit;
   ushort            exponent;
   uchar             count;
   int               physicalMinimum;
   int               physicalMaximum;
  };
//---
struct USEROBJECTFLAGS
  {
   int               fInherit;
   int               fReserved;
   uint              dwFlags;
  };
//---
struct WINDOWINFO
  {
   uint              cbSize;
   RECT              rcWindow;
   RECT              rcClient;
   uint              dwStyle;
   uint              dwExStyle;
   uint              dwWindowStatus;
   uint              cxWindowBorders;
   uint              cyWindowBorders;
   ushort            atomWindowType;
   ushort            wCreatorVersion;
  };
//---
struct WINDOWPLACEMENT
  {
   uint              length;
   uint              flags;
   uint              showCmd;
   POINT             ptMinPosition;
   POINT             ptMaxPosition;
   RECT              rcNormalPosition;
   RECT              rcDevice;
  };
//---
struct WINDOWPOS
  {
   HANDLE            hwnd;
   HANDLE            hwndInsertAfter;
   int               x;
   int               y;
   int               cx;
   int               cy;
   uint              flags;
  };
//---
struct WNDCLASSEXW pack(8)
  {
   uint              cbSize;
   uint              style;
   PVOID             lpfnWndProc;
   int               cbClsExtra;
   int               cbWndExtra;
   HANDLE            hInstance;
   HANDLE            hIcon;
   HANDLE            hCursor;
   HANDLE            hbrBackground;
   PVOID             lpszMenuName;
   PVOID             lpszClassName;
   HANDLE            hIconSm;
  };
//---
struct WNDCLASSW pack(8)
  {
   uint              style;
   PVOID             lpfnWndProc;
   int               cbClsExtra;
   int               cbWndExtra;
   HANDLE            hInstance;
   HANDLE            hIcon;
   HANDLE            hCursor;
   HANDLE            hbrBackground;
   PVOID             lpszMenuName;
   PVOID             lpszClassName;
  };
//---
struct WTSSESSION_NOTIFICATION
  {
   uint              cbSize;
   uint              dwSessionId;
  };
//---
struct RAWMOUSE pack(4)
  {
   ushort            usFlags;
   uint              ulButtons;
   uint              ulRawButtons;
   int               lLastX;
   int               lLastY;
   uint              ulExtraInformation;
  };
//---
struct RAWKEYBOARD
  {
   ushort            MakeCode;
   ushort            Flags;
   ushort            Reserved;
   ushort            VKey;
   uint              Message;
   uint              ExtraInformation;
  };
//---
struct RAWHID
  {
   uint              dwSizeHid;
   uint              dwCount;
   uchar             bRawData[1];
  };
//---
union RAWFORMAT
  {
   RAWMOUSE          mouse;
   RAWKEYBOARD       keyboard;
   RAWHID            hid;
  };
//---
struct RAWINPUT
  {
   RAWINPUTHEADER    header;
   RAWFORMAT         data;
  };
//---
struct INPUT_TRANSFORM
  {
   float             _11;
   float             _12;
   float             _13;
   float             _14;
   float             _21;
   float             _22;
   float             _23;
   float             _24;
   float             _31;
   float             _32;
   float             _33;
   float             _34;
   float             _41;
   float             _42;
   float             _43;
   float             _44;
  };
//---
struct MENUITEMINFO
  {
   uint              cbSize;
   uint              fMask;
   uint              fType;
   uint              fState;
   uint              wID;
   HANDLE            hSubMenu;
   HANDLE            hbmpChecked;
   HANDLE            hbmpUnchecked;
   uint              dwItemData;
   string            dwTypeData;
   uint              cch;
  };
//---
union INPUT_TYPE
  {
   MOUSEINPUT        mi;
   KEYBDINPUT        ki;
   HARDWAREINPUT     hi;
  };
//---
struct INPUT
  {
   uint              type;
   INPUT_TYPE        in;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "user32.dll"
HANDLE                              ActivateKeyboardLayout(HANDLE hkl,uint Flags);
int                                 AddClipboardFormatListener(HANDLE hwnd);
int                                 AdjustWindowRect(RECT &rect,uint style,int menu);
int                                 AdjustWindowRectEx(RECT &rect,uint style,int menu,uint ex_style);
int                                 AdjustWindowRectExForDpi(RECT &rect,uint style,int menu,uint ex_style,uint dpi);
int                                 AllowSetForegroundWindow(uint process_id);
int                                 AnimateWindow(HANDLE wnd,uint time,uint flags);
int                                 AnyPopup(void);
int                                 AppendMenuW(HANDLE menu,uint flags,ulong uIDNewItem,const string new_item);
int                                 AreDpiAwarenessContextsEqual(HANDLE dpiContextA,HANDLE dpiContextB);
uint                                ArrangeIconicWindows(HANDLE wnd);
int                                 AttachThreadInput(uint attach,uint attach_to,int attach);
HANDLE                              BeginDeferWindowPos(int num_windows);
HANDLE                              BeginPaint(HANDLE wnd,PAINTSTRUCT &paint);
int                                 BlockInput(int block_it);
int                                 BringWindowToTop(HANDLE wnd);
int                                 BroadcastSystemMessage(uint flags,uint &info,uint Msg,PVOID param,PVOID param);
int                                 BroadcastSystemMessageExW(uint flags,uint &info,uint Msg,PVOID param,PVOID param,BSMINFO &info);
int                                 BroadcastSystemMessageW(uint flags,uint &info,uint Msg,PVOID param,PVOID param);
int                                 CalculatePopupWindowPosition(const POINT &point,const SIZE &size,uint flags,RECT &rect,RECT &window_position);
int                                 CallMsgFilterW(MSG &msg,int code);
PVOID                               CallNextHookEx(HANDLE hhk,int code,PVOID param,PVOID param);
PVOID                               CallWindowProcW(PVOID prev_wnd_func,HANDLE wnd,uint Msg,PVOID param,PVOID param);
int                                 CancelShutdown(void);
ushort                              CascadeWindows(HANDLE parent,uint how,const RECT &rect,uint kids,const HANDLE &kids[]);
int                                 ChangeClipboardChain(HANDLE wnd_remove,HANDLE wnd_new_next);
int                                 ChangeDisplaySettingsExW(const string device_name,DEVMODEW &dev_mode,HANDLE hwnd,uint dwflags,PVOID param);
int                                 ChangeDisplaySettingsW(DEVMODEW &dev_mode,uint flags);
int                                 ChangeMenuW(HANDLE menu,uint cmd,const string new_item,uint insert,uint flags);
int                                 ChangeWindowMessageFilter(uint message,uint flag);
int                                 ChangeWindowMessageFilterEx(HANDLE hwnd,uint message,uint action,CHANGEFILTERSTRUCT &change_filter_struct);
uint                                CharLowerBuffW(string &lpsz,uint length);
PVOID                               CharLowerW(string &lpsz);
PVOID                               CharNextW(PVOID lpsz);
PVOID                               CharNextW(string lpsz);
PVOID                               CharPrevW(const PVOID start,const PVOID current);
PVOID                               CharPrevW(const string start,const string current);
int                                 CharToOemBuffW(const string src,char &dst[],uint dst_length);
int                                 CharToOemW(const string src,char &dst[]);
uint                                CharUpperBuffW(string &lpsz,uint length);
PVOID                               CharUpperW(string &lpsz);
int                                 CheckDlgButton(HANDLE dlg,int nIDButton,uint check);
uint                                CheckMenuItem(HANDLE menu,uint uIDCheckItem,uint check);
int                                 CheckMenuRadioItem(HANDLE hmenu,uint first,uint last,uint check,uint flags);
int                                 CheckRadioButton(HANDLE dlg,int nIDFirstButton,int nIDLastButton,int nIDCheckButton);
HANDLE                              ChildWindowFromPoint(HANDLE wnd_parent,POINT &point);
HANDLE                              ChildWindowFromPointEx(HANDLE hwnd,POINT &pt,uint flags);
int                                 ClientToScreen(HANDLE wnd,POINT &point);
int                                 ClipCursor(RECT &rect);
int                                 CloseClipboard(void);
int                                 CloseDesktop(HANDLE desktop);
int                                 CloseGestureInfoHandle(HANDLE gesture_info);
int                                 CloseTouchInputHandle(HANDLE touch_input);
int                                 CloseWindow(HANDLE wnd);
int                                 CloseWindowStation(HANDLE win_sta);
int                                 CopyAcceleratorTableW(HANDLE accel_src,ACCEL &accel_dst,int accel_entries);
HANDLE                              CopyIcon(HANDLE icon);
HANDLE                              CopyImage(HANDLE h,uint type,int cx,int cy,uint flags);
int                                 CopyRect(RECT &dst,RECT &src);
int                                 CountClipboardFormats(void);
HANDLE                              CreateAcceleratorTableW(ACCEL &paccel,int accel);
int                                 CreateCaret(HANDLE wnd,HANDLE bitmap,int width,int height);
HANDLE                              CreateCursor(HANDLE inst,int hot_spot,int hot_spot,int width,int height,PVOID pvANDPlane,PVOID pvXORPlane);
HANDLE                              CreateDesktopExW(const string desktop,const PVOID device,PVOID devmode,uint flags,uint desired_access,PVOID lpsa,uint heap_size,PVOID pvoid);
HANDLE                              CreateDesktopExW(const string desktop,const string device,PVOID devmode,uint flags,uint desired_access,PVOID lpsa,uint heap_size,PVOID pvoid);
HANDLE                              CreateDesktopExW(const string desktop,const PVOID device,DEVMODEW &devmode,uint flags,uint desired_access,PVOID lpsa,uint heap_size,PVOID pvoid);
HANDLE                              CreateDesktopExW(const string desktop,const string device,DEVMODEW &devmode,uint flags,uint desired_access,PVOID lpsa,uint heap_size,PVOID pvoid);
HANDLE                              CreateDesktopW(const string desktop,const PVOID device,PVOID devmode,uint flags,uint desired_access,PVOID lpsa);
HANDLE                              CreateDesktopW(const string desktop,const string device,PVOID devmode,uint flags,uint desired_access,PVOID lpsa);
HANDLE                              CreateDesktopW(const string desktop,const PVOID device,DEVMODEW &devmode,uint flags,uint desired_access,PVOID lpsa);
HANDLE                              CreateDesktopW(const string desktop,const string device,DEVMODEW &devmode,uint flags,uint desired_access,PVOID lpsa);
HANDLE                              CreateDialogIndirectParamW(HANDLE instance,const DLGTEMPLATE &dlg_template,HANDLE wnd_parent,PVOID dialog_func,PVOID init_param);
HANDLE                              CreateDialogParamW(HANDLE instance,const string template_name,HANDLE wnd_parent,PVOID dialog_func,PVOID init_param);
HANDLE                              CreateIcon(HANDLE instance,int width,int height,uchar planes,uchar bits_pixel,const uchar &lpbANDbits[],const uchar &lpbXORbits[]);
HANDLE                              CreateIconFromResource(uchar &presbits,uint res_size,int icon,uint ver);
HANDLE                              CreateIconFromResourceEx(uchar &presbits,uint res_size,int icon,uint ver,int desired,int desired,uint Flags);
HANDLE                              CreateIconIndirect(ICONINFO &piconinfo);
HANDLE                              CreateMDIWindowW(const string class_name,const string window_name,uint style,int X,int Y,int width,int height,HANDLE wnd_parent,HANDLE instance,PVOID param);
HANDLE                              CreateMenu(void);
HANDLE                              CreatePopupMenu(void);
HANDLE                              CreateWindowExW(uint ex_style,const PVOID class_name,const PVOID window_name,uint style,int X,int Y,int width,int height,HANDLE wnd_parent,HANDLE menu,HANDLE instance,PVOID param);
HANDLE                              CreateWindowExW(uint ex_style,const string class_name,const string window_name,uint style,int X,int Y,int width,int height,HANDLE wnd_parent,HANDLE menu,HANDLE instance,PVOID param);
HANDLE                              CreateWindowStationW(const string lpwinsta,uint flags,uint desired_access,PVOID lpsa);
PVOID                               DefDlgProcW(HANDLE dlg,uint Msg,PVOID param,PVOID param);
HANDLE                              DeferWindowPos(HANDLE win_pos_info,HANDLE wnd,HANDLE wnd_insert_after,int x,int y,int cx,int cy,uint flags);
PVOID                               DefFrameProcW(HANDLE wnd,HANDLE hWndMDIClient,uint msg,PVOID param,PVOID param);
PVOID                               DefMDIChildProcW(HANDLE wnd,uint msg,PVOID param,PVOID param);
PVOID                               DefRawInputProc(RAWINPUT &raw_input[],int inp,uint size_header);
PVOID                               DefWindowProcW(HANDLE wnd,uint Msg,PVOID param,PVOID param);
int                                 DeleteMenu(HANDLE menu,uint position,uint flags);
int                                 DeregisterShellHookWindow(HANDLE hwnd);
int                                 DestroyAcceleratorTable(HANDLE accel);
int                                 DestroyCaret(void);
int                                 DestroyCursor(HANDLE cursor);
int                                 DestroyIcon(HANDLE icon);
int                                 DestroyMenu(HANDLE menu);
int                                 DestroyWindow(HANDLE wnd);
long                                DialogBoxIndirectParamW(HANDLE instance,DLGTEMPLATE &dialog_template,HANDLE wnd_parent,PVOID dialog_func,PVOID init_param);
long                                DialogBoxParamW(HANDLE instance,const string template_name,HANDLE wnd_parent,PVOID dialog_func,PVOID init_param);
void                                DisableProcessWindowsGhosting(void);
PVOID                               DispatchMessageW(MSG &msg);
int                                 DisplayConfigGetDeviceInfo(DISPLAYCONFIG_DEVICE_INFO_HEADER &packet);
int                                 DisplayConfigSetDeviceInfo(DISPLAYCONFIG_DEVICE_INFO_HEADER &packet);
int                                 DlgDirListComboBoxW(HANDLE dlg,string path_spec,int nIDComboBox,int nIDStaticPath,uint filetype);
int                                 DlgDirListW(HANDLE dlg,string path_spec,int nIDListBox,int nIDStaticPath,uint file_type);
int                                 DlgDirSelectComboBoxExW(HANDLE dlg,string str,int out,int combo_box);
int                                 DlgDirSelectExW(HANDLE dlg,string str,int count,int list_box);
int                                 DragDetect(HANDLE hwnd,POINT &pt);
uint                                DragObject(HANDLE parent,HANDLE from,uint fmt,ulong data,HANDLE hcur);
int                                 DrawAnimatedRects(HANDLE hwnd,int ani,RECT &from,RECT &to);
int                                 DrawCaption(HANDLE hwnd,HANDLE hdc,RECT &lprect,uint flags);
int                                 DrawEdge(HANDLE hdc,RECT &qrc,uint edge,uint flags);
int                                 DrawFocusRect(HANDLE hDC,RECT &lprc);
int                                 DrawFrameControl(HANDLE,RECT &,uint,uint);
int                                 DrawIcon(HANDLE hDC,int X,int Y,HANDLE icon);
int                                 DrawIconEx(HANDLE hdc,int left,int top,HANDLE icon,int width,int width,uint if_ani_cur,HANDLE flicker_free_draw,uint flags);
int                                 DrawMenuBar(HANDLE wnd);
int                                 DrawStateW(HANDLE hdc,HANDLE fore,PVOID call_back,PVOID data,PVOID data,int x,int y,int cx,int cy,uint flags);
int                                 DrawTextExW(HANDLE hdc,string text,int text,RECT &lprc,uint format,DRAWTEXTPARAMS &lpdtp);
int                                 DrawTextW(HANDLE hdc,const string text,int text,RECT &lprc,uint format);
int                                 EmptyClipboard(void);
int                                 EnableMenuItem(HANDLE menu,uint uIDEnableItem,uint enable);
int                                 EnableMouseInPointer(int enable);
int                                 EnableNonClientDpiScaling(HANDLE hwnd);
int                                 EnableScrollBar(HANDLE wnd,uint wSBflags,uint arrows);
int                                 EnableWindow(HANDLE wnd,int enable);
int                                 EndDeferWindowPos(HANDLE win_pos_info);
int                                 EndDialog(HANDLE dlg,long result);
int                                 EndMenu(void);
int                                 EndPaint(HANDLE wnd,PAINTSTRUCT &paint);
int                                 EndTask(HANDLE wnd,int shut_down,int force);
int                                 EnumChildWindows(HANDLE wnd_parent,PVOID enum_func,PVOID param);
uint                                EnumClipboardFormats(uint format);
int                                 EnumDesktopsW(HANDLE hwinsta,PVOID enum_func,PVOID param);
int                                 EnumDesktopWindows(HANDLE desktop,PVOID lpfn,PVOID param);
int                                 EnumDisplayDevicesW(const string device,uint dev_num,DISPLAY_DEVICEW &display_device,uint flags);
int                                 EnumDisplayMonitors(HANDLE hdc,const RECT &clip,PVOID enum_obj,PVOID data);
int                                 EnumDisplaySettingsExW(const string device_name,uint mode_num,DEVMODEW &dev_mode,uint flags);
int                                 EnumDisplaySettingsW(const string device_name,uint mode_num,DEVMODEW &dev_mode);
int                                 EnumPropsExW(HANDLE wnd,PVOID enum_func,PVOID param);
int                                 EnumPropsW(HANDLE wnd,PVOID enum_func);
int                                 EnumThreadWindows(uint thread_id,PVOID lpfn,PVOID param);
int                                 EnumWindows(PVOID enum_func,PVOID param);
int                                 EnumWindowStationsW(PVOID enum_func,PVOID param);
int                                 EqualRect(RECT &lprc1,RECT &lprc2);
int                                 EvaluateProximityToPolygon(uint vertices,const POINT &polygon[],const TOUCH_HIT_TESTING_INPUT &hit_testing_input[],TOUCH_HIT_TESTING_PROXIMITY_EVALUATION &proximity_eval);
int                                 EvaluateProximityToRect(const RECT &bounding_box[],const TOUCH_HIT_TESTING_INPUT &hit_testing_input[],TOUCH_HIT_TESTING_PROXIMITY_EVALUATION &proximity_eval);
int                                 ExcludeUpdateRgn(HANDLE hDC,HANDLE wnd);
int                                 ExitWindowsEx(uint flags,uint reason);
int                                 FillRect(HANDLE hDC,RECT &lprc,HANDLE hbr);
HANDLE                              FindWindowExW(HANDLE wnd_parent,HANDLE wnd_child_after,const string class_name,const string window);
HANDLE                              FindWindowW(const string class_name,const string window_name);
int                                 FlashWindow(HANDLE wnd,int invert);
int                                 FlashWindowEx(FLASHWINFO &pfwi);
int                                 FrameRect(HANDLE hDC,RECT &lprc,HANDLE hbr);
HANDLE                              GetActiveWindow(void);
int                                 GetAltTabInfoW(HANDLE hwnd,int item,ALTTABINFO &pati,string item_text,uint item_text);
HANDLE                              GetAncestor(HANDLE hwnd,uint flags);
short                               GetAsyncKeyState(int key);
int                                 GetAutoRotationState(AR_STATE &state);
DPI_AWARENESS                       GetAwarenessFromDpiAwarenessContext(HANDLE value);
HANDLE                              GetCapture(void);
uint                                GetCaretBlinkTime(void);
int                                 GetCaretPos(POINT &point);
int                                 GetCIMSSM(INPUT_MESSAGE_SOURCE &message_source);
int                                 GetClassInfoExW(HANDLE instance,const string class_name,WNDCLASSEXW &lpwcx);
int                                 GetClassInfoW(HANDLE instance,const string class_name,WNDCLASSW &wnd_class);
ulong                               GetClassLongPtrW(HANDLE wnd,int index);
uint                                GetClassLongW(HANDLE wnd,int index);
int                                 GetClassNameW(HANDLE wnd,ushort &class_name[],int max_count);
ushort                              GetClassWord(HANDLE wnd,int index);
int                                 GetClientRect(HANDLE wnd,RECT &rect);
HANDLE                              GetClipboardData(uint format);
int                                 GetClipboardFormatNameW(uint format,ushort &format_name[],int max_count);
HANDLE                              GetClipboardOwner(void);
uint                                GetClipboardSequenceNumber(void);
HANDLE                              GetClipboardViewer(void);
int                                 GetClipCursor(RECT &rect);
int                                 GetComboBoxInfo(HANDLE combo,COMBOBOXINFO &pcbi);
int                                 GetCurrentInputMessageSource(INPUT_MESSAGE_SOURCE &message_source);
HANDLE                              GetCursor(void);
int                                 GetCursorInfo(CURSORINFO &pci);
int                                 GetCursorPos(POINT &point);
HANDLE                              GetDC(HANDLE wnd);
HANDLE                              GetDCEx(HANDLE wnd,HANDLE clip,uint flags);
HANDLE                              GetDesktopWindow(void);
int                                 GetDialogBaseUnits(void);
DIALOG_CONTROL_DPI_CHANGE_BEHAVIORS GetDialogControlDpiChangeBehavior(HANDLE wnd);
DIALOG_DPI_CHANGE_BEHAVIORS         GetDialogDpiChangeBehavior(HANDLE dlg);
int                                 GetDisplayAutoRotationPreferences(ORIENTATION_PREFERENCE &orientation);
int                                 GetDisplayConfigBufferSizes(uint flags,uint &path_array_elements,uint &mode_info_array_elements);
int                                 GetDlgCtrlID(HANDLE wnd);
HANDLE                              GetDlgItem(HANDLE dlg,int nIDDlgItem);
uint                                GetDlgItemInt(HANDLE dlg,int nIDDlgItem,int &translated,int signed);
uint                                GetDlgItemTextW(HANDLE dlg,int nIDDlgItem,string str,int max);
uint                                GetDoubleClickTime(void);
uint                                GetDpiForSystem(void);
uint                                GetDpiForWindow(HANDLE hwnd);
uint                                GetDpiFromDpiAwarenessContext(HANDLE value);
HANDLE                              GetFocus(void);
HANDLE                              GetForegroundWindow(void);
int                                 GetGestureConfig(HANDLE hwnd,uint reserved,uint flags,uint &pcIDs,GESTURECONFIG &gesture_config[],uint size);
int                                 GetGestureExtraArgs(HANDLE gesture_info,uint extra_args,uchar &extra_args);
int                                 GetGestureInfo(HANDLE gesture_info,GESTUREINFO &gesture_info);
uint                                GetGuiResources(HANDLE process,uint flags);
int                                 GetGUIThreadInfo(uint thread,GUITHREADINFO &pgui);
int                                 GetIconInfo(HANDLE icon,ICONINFO &piconinfo);
int                                 GetIconInfoExW(HANDLE hicon,ICONINFOEXW &piconinfo);
int                                 GetInputState(void);
uint                                GetKBCodePage(void);
HANDLE                              GetKeyboardLayout(uint thread);
int                                 GetKeyboardLayoutList(int buff,HANDLE &list[]);
int                                 GetKeyboardLayoutNameW(ushort &pwszKLID[]);
int                                 GetKeyboardState(uchar &key_state[]);
int                                 GetKeyboardType(int type_flag);
int                                 GetKeyNameTextW(long param,ushort &str[],int size);
short                               GetKeyState(int virt_key);
HANDLE                              GetLastActivePopup(HANDLE wnd);
int                                 GetLastInputInfo(LASTINPUTINFO &plii);
int                                 GetLayeredWindowAttributes(HANDLE hwnd,uint &key,uchar &alpha,uint &flags);
uint                                GetListBoxInfo(HANDLE hwnd);
HANDLE                              GetMenu(HANDLE wnd);
int                                 GetMenuBarInfo(HANDLE hwnd,int object,int item,MENUBARINFO &pmbi);
int                                 GetMenuCheckMarkDimensions(void);
uint                                GetMenuContextHelpId(HANDLE);
uint                                GetMenuDefaultItem(HANDLE menu,uint by_pos,uint flags);
int                                 GetMenuInfo(HANDLE,MENUINFO &);
int                                 GetMenuItemCount(HANDLE menu);
uint                                GetMenuItemID(HANDLE menu,int pos);
int                                 GetMenuItemInfoW(HANDLE hmenu,uint item,int by_position,MENUITEMINFOW &lpmii);
int                                 GetMenuItemRect(HANDLE wnd,HANDLE menu,uint item,RECT &item);
uint                                GetMenuState(HANDLE menu,uint id,uint flags);
int                                 GetMenuStringW(HANDLE menu,uint uIDItem,string str,int max,uint flags);
PVOID                               GetMessageExtraInfo(void);
uint                                GetMessagePos(void);
int                                 GetMessageTime(void);
int                                 GetMessageW(MSG &msg,HANDLE wnd,uint msg_filter_min,uint msg_filter_max);
int                                 GetMonitorInfoW(HANDLE monitor,MONITORINFO &lpmi);
int                                 GetMouseMovePointsEx(uint size,MOUSEMOVEPOINT &lppt,MOUSEMOVEPOINT &buf,int buf_points,uint resolution);
HANDLE                              GetNextDlgGroupItem(HANDLE dlg,HANDLE ctl,int previous);
HANDLE                              GetNextDlgTabItem(HANDLE dlg,HANDLE ctl,int previous);
HANDLE                              GetOpenClipboardWindow(void);
HANDLE                              GetParent(HANDLE wnd);
int                                 GetPhysicalCursorPos(POINT &point);
int                                 GetPointerCursorId(uint pointer_id,uint &cursor_id);
int                                 GetPointerDevice(HANDLE device,POINTER_DEVICE_INFO &device);
int                                 GetPointerDeviceCursors(HANDLE device,uint &count,POINTER_DEVICE_CURSOR_INFO &cursors[]);
int                                 GetPointerDeviceProperties(HANDLE device,uint &count,POINTER_DEVICE_PROPERTY &properties[]);
int                                 GetPointerDeviceRects(HANDLE device,RECT &device_rect,RECT &rect);
int                                 GetPointerDevices(uint &count,POINTER_DEVICE_INFO &devices[]);
int                                 GetPointerFrameInfo(uint id,uint &count,POINTER_INFO &info[]);
int                                 GetPointerFrameInfoHistory(uint id,uint &count,uint &count,POINTER_INFO &info[]);
int                                 GetPointerFramePenInfo(uint id,uint &count,POINTER_PEN_INFO &info[]);
int                                 GetPointerFramePenInfoHistory(uint id,uint &count,uint &count,POINTER_PEN_INFO &info[]);
int                                 GetPointerFrameTouchInfo(uint id,uint &count,POINTER_TOUCH_INFO &info[]);
int                                 GetPointerFrameTouchInfoHistory(uint id,uint &count,uint &count,POINTER_TOUCH_INFO &info[]);
int                                 GetPointerInfo(uint id,POINTER_INFO &info[]);
int                                 GetPointerInfoHistory(uint id,uint &count,POINTER_INFO &info[]);
int                                 GetPointerInputTransform(uint id,uint count,INPUT_TRANSFORM &transform);
int                                 GetPointerPenInfo(uint id,POINTER_PEN_INFO &info);
int                                 GetPointerPenInfoHistory(uint id,uint &count,POINTER_PEN_INFO &info);
int                                 GetPointerTouchInfo(uint id,POINTER_TOUCH_INFO &info[]);
int                                 GetPointerTouchInfoHistory(uint id,uint &count,POINTER_TOUCH_INFO &info[]);
int                                 GetPointerType(uint id,uint &type);
int                                 GetPriorityClipboardFormat(uint &format_priority_list[],int formats);
int                                 GetProcessDefaultLayout(uint &default_layout);
HANDLE                              GetProcessWindowStation(void);
HANDLE                              GetPropW(HANDLE wnd,const string str);
uint                                GetQueueStatus(uint flags);
uint                                GetRawInputBuffer(RAWINPUT &data,uint &size,uint size_header);
uint                                GetRawInputData(HANDLE raw_input,uint command,PVOID data,uint &size,uint size_header);
uint                                GetRawInputDeviceInfoW(HANDLE device,uint command,PVOID data,uint &size);
uint                                GetRawInputDeviceList(RAWINPUTDEVICELIST &raw_input_device_list,uint &num_devices,uint size);
int                                 GetRawPointerDeviceData(uint id,uint count,uint count,POINTER_DEVICE_PROPERTY &properties[],int &values[]);
uint                                GetRegisteredRawInputDevices(RAWINPUTDEVICE &raw_input_devices,uint &num_devices,uint size);
int                                 GetScrollBarInfo(HANDLE hwnd,int object,SCROLLBARINFO &psbi);
int                                 GetScrollInfo(HANDLE hwnd,int bar,SCROLLINFO &lpsi);
int                                 GetScrollPos(HANDLE wnd,int bar);
int                                 GetScrollRange(HANDLE wnd,int bar,int &min_pos,int &max_pos);
HANDLE                              GetShellWindow(void);
HANDLE                              GetSubMenu(HANDLE menu,int pos);
uint                                GetSysColor(int index);
HANDLE                              GetSysColorBrush(int index);
uint                                GetSystemDpiForProcess(HANDLE process);
HANDLE                              GetSystemMenu(HANDLE wnd,int revert);
int                                 GetSystemMetrics(int index);
int                                 GetSystemMetricsForDpi(int index,uint dpi);
uint                                GetTabbedTextExtentW(HANDLE hdc,const string str,int count,int tab_positions,const int &tab_stop_positions[]);
HANDLE                              GetThreadDesktop(uint thread_id);
HANDLE                              GetThreadDpiAwarenessContext(void);
DPI_HOSTING_BEHAVIOR                GetThreadDpiHostingBehavior(void);
int                                 GetTitleBarInfo(HANDLE hwnd,TITLEBARINFO &pti);
HANDLE                              GetTopWindow(HANDLE wnd);
int                                 GetTouchInputInfo(HANDLE touch_input,uint inputs,TOUCHINPUT &inputs,int size);
uint                                GetUnpredictedMessagePos(void);
int                                 GetUpdatedClipboardFormats(uint &formats[],uint formats_number,uint &formats_out);
int                                 GetUpdateRect(HANDLE wnd,RECT &rect,int erase);
int                                 GetUpdateRgn(HANDLE wnd,HANDLE rgn,int erase);
int                                 GetUserObjectInformationW(HANDLE obj,int index,PVOID info,uint length,uint &length_needed);
int                                 GetUserObjectSecurity(HANDLE obj,uint &pSIRequested,SECURITY_DESCRIPTOR &pSID,uint length,uint &length_needed);
HANDLE                              GetWindow(HANDLE wnd,uint cmd);
uint                                GetWindowContextHelpId(HANDLE);
HANDLE                              GetWindowDC(HANDLE wnd);
int                                 GetWindowDisplayAffinity(HANDLE wnd,uint &affinity);
HANDLE                              GetWindowDpiAwarenessContext(HANDLE hwnd);
DPI_HOSTING_BEHAVIOR                GetWindowDpiHostingBehavior(HANDLE hwnd);
int                                 GetWindowFeedbackSetting(HANDLE hwnd,FEEDBACK_TYPE feedback,uint flags,uint size,int &config);
int                                 GetWindowInfo(HANDLE hwnd,WINDOWINFO &pwi);
long                                GetWindowLongPtrW(HANDLE wnd,int index);
int                                 GetWindowLongW(HANDLE wnd,int index);
uint                                GetWindowModuleFileNameW(HANDLE hwnd,ushort &file_name[],uint file_name_max);
int                                 GetWindowPlacement(HANDLE wnd,WINDOWPLACEMENT &lpwndpl);
int                                 GetWindowRect(HANDLE wnd,RECT &rect);
int                                 GetWindowRgn(HANDLE wnd,HANDLE rgn);
int                                 GetWindowRgnBox(HANDLE wnd,RECT &lprc);
int                                 GetWindowTextLengthW(HANDLE wnd);
int                                 GetWindowTextW(HANDLE wnd,ushort &str[],int max_count);
uint                                GetWindowThreadProcessId(HANDLE wnd,uint &process_id);
ushort                              GetWindowWord(HANDLE wnd,int index);
int                                 GrayStringW(HANDLE hDC,HANDLE brush,PVOID output_func,uchar &data[],int count,int X,int Y,int width,int height);
int                                 GrayStringW(HANDLE hDC,HANDLE brush,PVOID output_func,PVOID data,int count,int X,int Y,int width,int height);
int                                 HideCaret(HANDLE wnd);
int                                 HiliteMenuItem(HANDLE wnd,HANDLE menu,uint uIDHiliteItem,uint hilite);
int                                 InflateRect(RECT &lprc,int dx,int dy);
int                                 InheritWindowMonitor(HANDLE hwnd,HANDLE inherit);
int                                 InitializeTouchInjection(uint count,uint mode);
int                                 InjectTouchInput(uint count,POINTER_TOUCH_INFO &contacts);
int                                 InSendMessage(void);
uint                                InSendMessageEx(PVOID reserved);
int                                 InsertMenuItemW(HANDLE hmenu,uint item,int by_position,const MENUITEMINFO &lpmi);
int                                 InsertMenuW(HANDLE menu,uint position,uint flags,ulong uIDNewItem,const string new_item);
int                                 InternalGetWindowText(HANDLE wnd,string str,int max_count);
int                                 IntersectRect(RECT &dst,RECT &src1,RECT &src2);
int                                 InvalidateRect(HANDLE wnd,RECT &rect,int erase);
int                                 InvalidateRgn(HANDLE wnd,HANDLE rgn,int erase);
int                                 InvertRect(HANDLE hDC,RECT &lprc);
int                                 IsCharAlphaNumericW(short ch);
int                                 IsCharAlphaW(short ch);
int                                 IsCharLowerW(short ch);
int                                 IsCharUpperW(short ch);
int                                 IsChild(HANDLE wnd_parent,HANDLE wnd);
int                                 IsClipboardFormatAvailable(uint format);
int                                 IsDialogMessageW(HANDLE dlg,MSG &msg);
uint                                IsDlgButtonChecked(HANDLE dlg,int nIDButton);
int                                 IsGUIThread(int convert);
int                                 IsHungAppWindow(HANDLE hwnd);
int                                 IsIconic(HANDLE wnd);
int                                 IsImmersiveProcess(HANDLE process);
int                                 IsMenu(HANDLE menu);
int                                 IsMouseInPointerEnabled(void);
int                                 IsProcessDPIAware(void);
int                                 IsRectEmpty(RECT &lprc);
int                                 IsTouchWindow(HANDLE hwnd,uint &flags);
int                                 IsValidDpiAwarenessContext(HANDLE value);
int                                 IsWindow(HANDLE wnd);
int                                 IsWindowEnabled(HANDLE wnd);
int                                 IsWindowUnicode(HANDLE wnd);
int                                 IsWindowVisible(HANDLE wnd);
int                                 IsWinEventHookInstalled(uint event);
int                                 IsWow64Message(void);
int                                 IsZoomed(HANDLE wnd);
void                                keybd_event(uchar vk,uchar scan,uint flags,ulong extra_info);
int                                 KillTimer(HANDLE wnd,ulong uIDEvent);
HANDLE                              LoadAcceleratorsW(HANDLE instance,const string table_name);
HANDLE                              LoadBitmapW(HANDLE instance,const string bitmap_name);
HANDLE                              LoadCursorFromFileW(const string file_name);
HANDLE                              LoadCursorW(HANDLE instance,const string cursor_name);
HANDLE                              LoadIconW(HANDLE instance,const string icon_name);
HANDLE                              LoadImageW(HANDLE inst,const string name,uint type,int cx,int cy,uint load);
HANDLE                              LoadKeyboardLayoutW(const string pwszKLID,uint Flags);
HANDLE                              LoadMenuIndirectW(const PVOID menu_template);
HANDLE                              LoadMenuW(HANDLE instance,const string menu_name);
int                                 LoadStringW(HANDLE instance,uint uID,string buffer,int buffer_max);
int                                 LockSetForegroundWindow(uint lock_code);
int                                 LockWindowUpdate(HANDLE wnd_lock);
int                                 LockWorkStation(void);
int                                 LogicalToPhysicalPoint(HANDLE wnd,POINT &point);
int                                 LogicalToPhysicalPointForPerMonitorDPI(HANDLE wnd,POINT &point);
int                                 LookupIconIdFromDirectory(uchar &presbits[],int icon);
int                                 LookupIconIdFromDirectoryEx(uchar &presbits,int icon,int desired,int desired,uint Flags);
int                                 MapDialogRect(HANDLE dlg,RECT &rect);
uint                                MapVirtualKeyExW(uint code,uint map_type,HANDLE dwhkl);
uint                                MapVirtualKeyW(uint code,uint map_type);
int                                 MapWindowPoints(HANDLE wnd_from,HANDLE wnd_to,POINT &points[],uint points_count);
int                                 MenuItemFromPoint(HANDLE wnd,HANDLE menu,POINT &screen);
int                                 MessageBeep(uint type);
int                                 MessageBoxExW(HANDLE wnd,const string text,const string caption,uint type,ushort language_id);
int                                 MessageBoxIndirectW(MSGBOXPARAMSW &lpmbp);
int                                 MessageBoxW(HANDLE wnd,const string text,const string caption,uint type);
int                                 ModifyMenuW(HANDLE mnu,uint position,uint flags,ulong uIDNewItem,const string new_item);
HANDLE                              MonitorFromPoint(POINT &pt,uint flags);
HANDLE                              MonitorFromRect(const RECT &lprc,uint flags);
HANDLE                              MonitorFromWindow(HANDLE hwnd,uint flags);
void                                mouse_event(uint flags,uint dx,uint dy,uint data,ulong extra_info);
int                                 MoveWindow(HANDLE wnd,int X,int Y,int width,int height,int repaint);
uint                                MsgWaitForMultipleObjects(uint count,const HANDLE &handles[],int wait_all,uint milliseconds,uint wake_mask);
uint                                MsgWaitForMultipleObjectsEx(uint count,const HANDLE &handles[],uint milliseconds,uint wake_mask,uint flags);
void                                NotifyWinEvent(uint event,HANDLE hwnd,int object,int child);
uint                                OemKeyScan(ushort oem_char);
int                                 OemToCharBuffW(const char &src[],ushort &dst[],uint dst_length);
int                                 OemToCharW(const char &src[],ushort &dst[]);
int                                 OffsetRect(RECT &lprc,int dx,int dy);
int                                 OpenClipboard(HANDLE wnd_new_owner);
HANDLE                              OpenDesktopW(const string desktop,uint flags,int inherit,uint desired_access);
int                                 OpenIcon(HANDLE wnd);
HANDLE                              OpenInputDesktop(uint flags,int inherit,uint desired_access);
HANDLE                              OpenWindowStationW(const string win_sta,int inherit,uint desired_access);
PVOID                               PackTouchHitTestingProximityEvaluation(const TOUCH_HIT_TESTING_INPUT &hit_testing_input[],const TOUCH_HIT_TESTING_PROXIMITY_EVALUATION &proximity_eval[]);
int                                 PaintDesktop(HANDLE hdc);
int                                 PeekMessageW(MSG &msg,HANDLE wnd,uint msg_filter_min,uint msg_filter_max,uint remove_msg);
int                                 PhysicalToLogicalPoint(HANDLE wnd,POINT &point);
int                                 PhysicalToLogicalPointForPerMonitorDPI(HANDLE wnd,POINT &point);
int                                 PostMessageW(HANDLE wnd,uint Msg,PVOID param,PVOID param);
void                                PostQuitMessage(int exit_code);
int                                 PostThreadMessageW(uint thread,uint Msg,PVOID param,PVOID param);
int                                 PrintWindow(HANDLE hwnd,HANDLE blt,uint flags);
uint                                PrivateExtractIconsW(const string file_name,int icon_index,int icon,int icon,HANDLE &phicon,uint &piconid,uint icons,uint flags);
int                                 PtInRect(const RECT &lprc,long pt);
long                                QueryDisplayConfig(uint flags,uint &path_array_elements,DISPLAYCONFIG_PATH_INFO &array,uint &mode_info_array_elements,DISPLAYCONFIG_MODE_INFO &info_array[],DISPLAYCONFIG_TOPOLOGY_ID &topology_id);
HANDLE                              RealChildWindowFromPoint(HANDLE parent,long parent_client_coords);
uint                                RealGetWindowClassW(HANDLE hwnd,ushort &class_name[],uint class_name_max);
int                                 RedrawWindow(HANDLE wnd,RECT &rect,HANDLE update,uint flags);
ushort                              RegisterClassExW(const WNDCLASSEXW &lpwcx);
ushort                              RegisterClassW(const WNDCLASSW &wnd_class);
uint                                RegisterClipboardFormatW(const string format);
PVOID                               RegisterDeviceNotificationW(HANDLE recipient,PVOID NotificationFilter,uint Flags);
int                                 RegisterHotKey(HANDLE wnd,int id,uint modifiers,uint vk);
int                                 RegisterPointerDeviceNotifications(HANDLE window,int range);
int                                 RegisterPointerInputTarget(HANDLE hwnd,uint type);
int                                 RegisterPointerInputTargetEx(HANDLE hwnd,uint type,int observe);
PVOID                               RegisterPowerSettingNotification(HANDLE recipient,const GUID &PowerSettingGuid,uint Flags);
int                                 RegisterRawInputDevices(const RAWINPUTDEVICE &raw_input_devices[],uint num_devices,uint size);
int                                 RegisterShellHookWindow(HANDLE hwnd);
PVOID                               RegisterSuspendResumeNotification(HANDLE recipient,uint Flags);
int                                 RegisterTouchHitTestingWindow(HANDLE hwnd,uint value);
int                                 RegisterTouchWindow(HANDLE hwnd,uint flags);
uint                                RegisterWindowMessageW(const string str);
int                                 ReleaseCapture(void);
int                                 ReleaseDC(HANDLE wnd,HANDLE hDC);
int                                 RemoveClipboardFormatListener(HANDLE hwnd);
int                                 RemoveMenu(HANDLE menu,uint position,uint flags);
HANDLE                              RemovePropW(HANDLE wnd,const string str);
int                                 ReplyMessage(PVOID result);
int                                 ScreenToClient(HANDLE wnd,POINT &point);
int                                 ScrollDC(HANDLE hDC,int dx,int dy,RECT &scroll,RECT &clip,HANDLE update,RECT &update);
int                                 ScrollWindow(HANDLE wnd,int XAmount,int YAmount,RECT &rect,RECT &clip_rect);
int                                 ScrollWindowEx(HANDLE wnd,int dx,int dy,RECT &scroll,RECT &clip,HANDLE update,RECT &update,uint flags);
PVOID                               SendDlgItemMessageW(HANDLE dlg,int nIDDlgItem,uint Msg,PVOID param,PVOID param);
uint                                SendInput(uint inputs,INPUT &inputs[],int size);
int                                 SendMessageCallbackW(HANDLE wnd,uint Msg,PVOID param,PVOID param,PVOID result_call_back,ulong data);
PVOID                               SendMessageTimeoutW(HANDLE wnd,uint Msg,PVOID param,PVOID param,uint flags,uint timeout,PVOID result);
PVOID                               SendMessageW(HANDLE wnd,uint Msg,PVOID param,PVOID param);
int                                 SendNotifyMessageW(HANDLE wnd,uint Msg,PVOID param,PVOID param);
HANDLE                              SetActiveWindow(HANDLE wnd);
HANDLE                              SetCapture(HANDLE wnd);
int                                 SetCaretBlinkTime(uint uMSeconds);
int                                 SetCaretPos(int X,int Y);
ulong                               SetClassLongPtrW(HANDLE wnd,int index,long new_long);
uint                                SetClassLongW(HANDLE wnd,int index,int new_long);
ushort                              SetClassWord(HANDLE wnd,int index,ushort new_word);
HANDLE                              SetClipboardData(uint format,HANDLE mem);
HANDLE                              SetClipboardViewer(HANDLE wnd_new_viewer);
ulong                               SetCoalescableTimer(HANDLE wnd,ulong nIDEvent,uint elapse,PVOID timer_func,uint tolerance_delay);
HANDLE                              SetCursor(HANDLE cursor);
int                                 SetCursorPos(int X,int Y);
void                                SetDebugErrorLevel(uint level);
int                                 SetDialogControlDpiChangeBehavior(HANDLE wnd,DIALOG_CONTROL_DPI_CHANGE_BEHAVIORS mask,DIALOG_CONTROL_DPI_CHANGE_BEHAVIORS values);
int                                 SetDialogDpiChangeBehavior(HANDLE dlg,DIALOG_DPI_CHANGE_BEHAVIORS mask,DIALOG_DPI_CHANGE_BEHAVIORS values);
int                                 SetDisplayAutoRotationPreferences(ORIENTATION_PREFERENCE orientation);
int                                 SetDisplayConfig(uint path_array_elements,DISPLAYCONFIG_PATH_INFO &array,uint mode_info_array_elements,DISPLAYCONFIG_MODE_INFO &info_array[],uint flags);
int                                 SetDlgItemInt(HANDLE dlg,int nIDDlgItem,uint value,int signed);
int                                 SetDlgItemTextW(HANDLE dlg,int nIDDlgItem,const string str);
int                                 SetDoubleClickTime(uint);
HANDLE                              SetFocus(HANDLE wnd);
int                                 SetForegroundWindow(HANDLE wnd);
int                                 SetGestureConfig(HANDLE hwnd,uint reserved,uint cIDs,GESTURECONFIG &gesture_config[],uint size);
int                                 SetKeyboardState(uchar &key_state[]);
void                                SetLastErrorEx(uint err_code,uint type);
int                                 SetLayeredWindowAttributes(HANDLE hwnd,uint key,uchar alpha,uint flags);
int                                 SetMenu(HANDLE wnd,HANDLE menu);
int                                 SetMenuContextHelpId(HANDLE,uint);
int                                 SetMenuDefaultItem(HANDLE menu,uint item,uint by_pos);
int                                 SetMenuInfo(HANDLE,const MENUINFO &);
int                                 SetMenuItemBitmaps(HANDLE menu,uint position,uint flags,HANDLE bitmap_unchecked,HANDLE bitmap_checked);
int                                 SetMenuItemInfoW(HANDLE hmenu,uint item,int by_positon,const MENUITEMINFOW &lpmii);
PVOID                               SetMessageExtraInfo(PVOID param);
int                                 SetMessageQueue(int messages_max);
HANDLE                              SetParent(HANDLE wnd_child,HANDLE wnd_new_parent);
int                                 SetPhysicalCursorPos(int X,int Y);
int                                 SetProcessDefaultLayout(uint default_layout);
int                                 SetProcessDPIAware(void);
int                                 SetProcessDpiAwarenessContext(HANDLE value);
int                                 SetProcessRestrictionExemption(int enable_exemption);
int                                 SetProcessWindowStation(HANDLE win_sta);
int                                 SetPropW(HANDLE wnd,const string str,HANDLE data);
int                                 SetRect(RECT &lprc,int left,int top,int right,int bottom);
int                                 SetRectEmpty(RECT &lprc);
int                                 SetScrollInfo(HANDLE hwnd,int bar,const SCROLLINFO &lpsi,int redraw);
int                                 SetScrollPos(HANDLE wnd,int bar,int pos,int redraw);
int                                 SetScrollRange(HANDLE wnd,int bar,int min_pos,int max_pos,int redraw);
int                                 SetSysColors(int elements_count,int &elements[],uint &rgb_values[]);
int                                 SetSystemCursor(HANDLE hcur,uint id);
int                                 SetThreadDesktop(HANDLE desktop);
HANDLE                              SetThreadDpiAwarenessContext(HANDLE context);
DPI_HOSTING_BEHAVIOR                SetThreadDpiHostingBehavior(DPI_HOSTING_BEHAVIOR value);
ulong                               SetTimer(HANDLE wnd,ulong nIDEvent,uint elapse,PVOID timer_func);
int                                 SetUserObjectInformationW(HANDLE obj,int index,PVOID info,uint length);
int                                 SetUserObjectSecurity(HANDLE obj,uint pSIRequested,SECURITY_DESCRIPTOR &pSID);
int                                 SetWindowContextHelpId(HANDLE,uint);
int                                 SetWindowDisplayAffinity(HANDLE wnd,uint affinity);
int                                 SetWindowFeedbackSetting(HANDLE hwnd,FEEDBACK_TYPE feedback,uint flags,uint size,PVOID configuration);
long                                SetWindowLongPtrW(HANDLE wnd,int index,long new_long);
int                                 SetWindowLongW(HANDLE wnd,int index,int new_long);
int                                 SetWindowPlacement(HANDLE wnd,WINDOWPLACEMENT &lpwndpl);
int                                 SetWindowPos(HANDLE wnd,HANDLE wnd_insert_after,int X,int Y,int cx,int cy,uint flags);
int                                 SetWindowRgn(HANDLE wnd,HANDLE rgn,int redraw);
HANDLE                              SetWindowsHookExW(int hook,PVOID lpfn,HANDLE hmod,uint thread_id);
HANDLE                              SetWindowsHookW(int filter_type,PVOID filter_proc);
int                                 SetWindowTextW(HANDLE wnd,const string str);
ushort                              SetWindowWord(HANDLE wnd,int index,ushort &new_word);
HANDLE                              SetWinEventHook(uint min,uint max,HANDLE win_event_proc,PVOID win_event_proc,uint process,uint thread,uint flags);
int                                 ShowCaret(HANDLE wnd);
int                                 ShowCursor(int show);
int                                 ShowOwnedPopups(HANDLE wnd,int show);
int                                 ShowScrollBar(HANDLE wnd,int bar,int show);
int                                 ShowWindow(HANDLE wnd,int cmd_show);
int                                 ShowWindowAsync(HANDLE wnd,int cmd_show);
int                                 ShutdownBlockReasonCreate(HANDLE wnd,const string reason);
int                                 ShutdownBlockReasonDestroy(HANDLE wnd);
int                                 ShutdownBlockReasonQuery(HANDLE wnd,string buff,uint &buff[]);
int                                 SkipPointerFrameMessages(uint id);
int                                 SoundSentry(void);
int                                 SubtractRect(RECT &dst,RECT &src1,RECT &src2);
int                                 SwapMouseButton(int swap);
int                                 SwitchDesktop(HANDLE desktop);
void                                SwitchToThisWindow(HANDLE hwnd,int unknown);
int                                 SystemParametersInfoForDpi(uint action,uint param,PVOID param,uint win_ini,uint dpi);
int                                 SystemParametersInfoW(uint action,uint param,PVOID param,uint win_ini);
int                                 TabbedTextOutW(HANDLE hdc,int x,int y,const string str,int count,int tab_positions,const int &tab_stop_positions[],int tab_origin);
ushort                              TileWindows(HANDLE parent,uint how,const RECT &rect,uint kids,const HANDLE &kids[]);
int                                 ToAscii(uint virt_key,uint scan_code,const uchar &key_state[],ushort &symbol,uint flags);
int                                 ToAsciiEx(uint virt_key,uint scan_code,const uchar &key_state[],ushort &symbol,uint flags,HANDLE dwhkl);
int                                 ToUnicode(uint virt_key,uint scan_code,const uchar &key_state[],ushort &buff[],int buff_size,uint flags);
int                                 ToUnicodeEx(uint virt_key,uint scan_code,const uchar &key_state[],ushort &buff[],int buff_size,uint flags,HANDLE dwhkl);
int                                 TrackMouseEvent(TRACKMOUSEEVENT &event_track);
int                                 TrackPopupMenu(HANDLE menu,uint flags,int x,int y,int reserved,HANDLE wnd,RECT &rect);
int                                 TrackPopupMenuEx(HANDLE menu,uint flags,int x,int y,HANDLE hwnd,TPMPARAMS &lptpm);
int                                 TranslateAcceleratorW(HANDLE wnd,HANDLE acc_table,MSG &msg);
int                                 TranslateMDISysAccel(HANDLE wnd_client,MSG &msg);
int                                 TranslateMessage(MSG &msg);
int                                 UnhookWindowsHook(int code,PVOID filter_proc);
int                                 UnhookWindowsHookEx(HANDLE hhk);
int                                 UnhookWinEvent(HANDLE win_event_hook);
int                                 UnionRect(RECT &dst,RECT &src1,RECT &src2);
int                                 UnloadKeyboardLayout(HANDLE hkl);
int                                 UnregisterClassW(const PVOID class_name,HANDLE instance);
int                                 UnregisterClassW(const string class_name,HANDLE instance);
int                                 UnregisterDeviceNotification(PVOID Handle);
int                                 UnregisterHotKey(HANDLE wnd,int id);
int                                 UnregisterPointerInputTarget(HANDLE hwnd,uint type);
int                                 UnregisterPointerInputTargetEx(HANDLE hwnd,uint type);
int                                 UnregisterPowerSettingNotification(PVOID Handle);
int                                 UnregisterSuspendResumeNotification(PVOID Handle);
int                                 UnregisterTouchWindow(HANDLE hwnd);
int                                 UpdateLayeredWindow(HANDLE wnd,HANDLE dst,POINT &dst,SIZE &psize,HANDLE src,POINT &src,uint key,BLENDFUNCTION &pblend,uint flags);
int                                 UpdateLayeredWindowIndirect(HANDLE wnd,const UPDATELAYEREDWINDOWINFO &pULWInfo[]);
int                                 UpdateWindow(HANDLE wnd);
int                                 UserHandleGrantAccess(HANDLE user_handle,HANDLE job,int grant);
int                                 ValidateRect(HANDLE wnd,RECT &rect);
int                                 ValidateRgn(HANDLE wnd,HANDLE rgn);
short                               VkKeyScanExW(ushort ch,HANDLE dwhkl);
short                               VkKeyScanW(ushort ch);
uint                                WaitForInputIdle(HANDLE process,uint milliseconds);
int                                 WaitMessage(void);
HANDLE                              WindowFromDC(HANDLE hDC);
HANDLE                              WindowFromPhysicalPoint(long point);
HANDLE                              WindowFromPoint(long point);
int                                 WinHelpW(HANDLE wnd_main,const string help,uint command,ulong data);
int                                 wvsprintfW(ushort &[],const string,PVOID &arglist[]);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                   sysinfoapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winbase.mqh>

//---
enum COMPUTER_NAME_FORMAT
  {
   ComputerNameNetBIOS,
   ComputerNameDnsHostname,
   ComputerNameDnsDomain,
   ComputerNameDnsFullyQualified,
   ComputerNamePhysicalNetBIOS,
   ComputerNamePhysicalDnsHostname,
   ComputerNamePhysicalDnsDomain,
   ComputerNamePhysicalDnsFullyQualified,
   ComputerNameMax
  };
//---
struct DUMMYSTRUCTNAME
  {
   uint              dwOemId;
   ushort            wProcessorArchitecture;
   ushort            wReserved;
  };
//---
struct MEMORYSTATUSEX
  {
   uint              dwLength;
   uint              dwMemoryLoad;
   ulong             ullTotalPhys;
   ulong             ullAvailPhys;
   ulong             ullTotalPageFile;
   ulong             ullAvailPageFile;
   ulong             ullTotalVirtual;
   ulong             ullAvailVirtual;
   ulong             ullAvailExtendedVirtual;
  };
//---
struct SYSTEM_INFO
  {
   uint              dwOemId;
   uint              dwPageSize;
   PVOID             lpMinimumApplicationAddress;
   PVOID             lpMaximumApplicationAddress;
   ulong             dwActiveProcessorMask;
   uint              dwNumberOfProcessors;
   uint              dwProcessorType;
   uint              dwAllocationGranularity;
   ushort            wProcessorLevel;
   ushort            wProcessorRevision;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int     GlobalMemoryStatusEx(MEMORYSTATUSEX &buffer);
void    GetSystemInfo(SYSTEM_INFO &system_info);
void    GetSystemTime(SYSTEMTIME &system_time);
void    GetSystemTimeAsFileTime(FILETIME &system_time_as_file_time);
void    GetLocalTime(SYSTEMTIME &system_time);
uint    GetVersion(void);
int     SetLocalTime(const SYSTEMTIME &system_time);
uint    GetTickCount(void);
ulong   GetTickCount64(void);
int     GetSystemTimeAdjustment(uint &time_adjustment,uint &time_increment,int &time_adjustment_disabled);
uint    GetSystemDirectoryW(ushort &buffer[],uint size);
uint    GetWindowsDirectoryW(ushort &buffer[],uint size);
uint    GetSystemWindowsDirectoryW(ushort &buffer[],uint size);
int     GetComputerNameExW(COMPUTER_NAME_FORMAT name_type,ushort &buffer[],uint &size);
int     SetComputerNameExW(COMPUTER_NAME_FORMAT name_type,const string buffer);
int     SetSystemTime(const SYSTEMTIME &system_time);
int     GetVersionExW(OSVERSIONINFOW &version_information);
int     GetLogicalProcessorInformation(SYSTEM_LOGICAL_PROCESSOR_INFORMATION &buffer[],uint &returned_length);
int     GetLogicalProcessorInformationEx(LOGICAL_PROCESSOR_RELATIONSHIP relationship_type,SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX &buffer[],uint &returned_length);
void    GetNativeSystemInfo(SYSTEM_INFO &system_info);
void    GetSystemTimePreciseAsFileTime(FILETIME &system_time_as_file_time);
int     GetProductInfo(uint os_major_version,uint os_minor_version,uint sp_major_version,uint sp_minor_version,uint &returned_product_type);
uint    EnumSystemFirmwareTables(uint firmware_table_provider_signature,PVOID &firmware_table_enum_buffer,uint buffer_size);
uint    EnumSystemFirmwareTables(uint firmware_table_provider_signature,uchar &firmware_table_enum_buffer[],uint buffer_size);
uint    GetSystemFirmwareTable(uint firmware_table_provider_signature,uint firmware_table_id,PVOID firmware_table_buffer,uint buffer_size);
uint    GetSystemFirmwareTable(uint firmware_table_provider_signature,uint firmware_table_id,uchar &firmware_table_buffer[],uint buffer_size);
int     DnsHostnameToComputerNameExW(const string hostname,ushort &computer_name[],uint &size);
int     GetPhysicallyInstalledSystemMemory(ulong &total_memory_in_kilobytes);
int     SetComputerNameEx2W(COMPUTER_NAME_FORMAT name_type,uint flags,const string buffer);
int     SetSystemTimeAdjustment(uint time_adjustment,int time_adjustment_disabled);
int     InstallELAMCertificateInfo(HANDLE elam_file);
int     GetProcessorSystemCycleTime(ushort group,PVOID &buffer,uint &returned_length);
int     GetProcessorSystemCycleTime(ushort group,SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION &buffer[],uint &returned_length);
int     SetComputerNameW(const string computer_name);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                    handleapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>

//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
int  CloseHandle(HANDLE object);
int  DuplicateHandle(HANDLE source_process_handle,HANDLE source_handle,HANDLE target_process_handle,HANDLE &target_handle,uint desired_access,int inherit_handle,uint options);
int  GetHandleInformation(HANDLE object,uint& flags);
int  SetHandleInformation(HANDLE object,uint mask,uint flags);
#import

#import "kernelbase.dll"
int  CompareObjectHandles(HANDLE first_object_handle, HANDLE second_object_handle); 
#import 
//+------------------------------------------------------------------+-e 

//+------------------------------------------------------------------+
//|                                               errhandlingapi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
void                         RaiseException(uint exception_code,uint exception_flags,uint number_of_arguments,const ulong &arguments[]);
int                          UnhandledExceptionFilter(EXCEPTION_POINTERS &exception_info);
PVOID                        SetUnhandledExceptionFilter(PVOID top_level_exception_filter);
uint                         GetLastError(void);
void                         SetLastError(uint err_code);
uint                         GetErrorMode(void);
uint                         SetErrorMode(uint mode);
PVOID                        AddVectoredExceptionHandler(uint first,PVOID handler);
uint                         RemoveVectoredExceptionHandler(PVOID handle);
PVOID                        AddVectoredContinueHandler(uint first,PVOID handler);
uint                         RemoveVectoredContinueHandler(PVOID handle);
void                         RestoreLastError(uint err_code);
void                         RaiseFailFastException(EXCEPTION_RECORD &exception_record,CONTEXT &context_record,uint flags);
void                         FatalAppExitW(uint action,const string message_text);
uint                         GetThreadErrorMode(void);
int                          SetThreadErrorMode(uint new_mode,uint& old_mode);
#import
-e 

//+------------------------------------------------------------------+
//|                                                        winnt.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>

//---
#define UNWIND_HISTORY_TABLE_SIZE            12
#define SIZE_OF_80387_REGISTERS              80
#define MAXIMUM_SUPPORTED_EXTENSION          512
#define WOW64_SIZE_OF_80387_REGISTERS        80
#define WOW64_MAXIMUM_SUPPORTED_EXTENSION    512
#define SID_HASH_SIZE                        32
#define POLICY_AUDIT_SUBCATEGORY_COUNT       59
#define TOKEN_SOURCE_LENGTH                  8
#define MAXIMUM_XSTATE_FEATURES              64
#define POWER_SYSTEM_MAXIMUM                 7
#define NUM_DISCHARGE_POLICIES               4
#define HIBERFILE_TYPE_MAX                   0x03
#define IMAGE_NUMBEROF_DIRECTORY_ENTRIES     16
#define IMAGE_SIZEOF_SHORT_NAME              8
#define IMAGE_ENCLAVE_LONG_ID_LENGTH         32
#define IMAGE_ENCLAVE_SHORT_ID_LENGTH        16
#define RTL_CORRELATION_VECTOR_STRING_LENGTH 129

//---
enum SID_NAME_USE
  {
   SidTypeUser=1,
   SidTypeGroup,
   SidTypeDomain,
   SidTypeAlias,
   SidTypeWellKnownGroup,
   SidTypeDeletedAccount,
   SidTypeInvalid,
   SidTypeUnknown,
   SidTypeComputer,
   SidTypeLabel,
   SidTypeLogonSession
  };
//---
enum ACL_INFORMATION_CLASS
  {
   AclRevisionInformation=1,
   AclSizeInformation
  };
//---
enum AUDIT_EVENT_TYPE
  {
   AuditEventObjectAccess,
   AuditEventDirectoryServiceAccess
  };
//---
enum ACCESS_REASON_TYPE
  {
   AccessReasonNone=0x00000000,
   AccessReasonAllowedAce=0x00010000,
   AccessReasonDeniedAce=0x00020000,
   AccessReasonAllowedParentAce=0x00030000,
   AccessReasonDeniedParentAce=0x00040000,
   AccessReasonNotGrantedByCape=0x00050000,
   AccessReasonNotGrantedByParentCape=0x00060000,
   AccessReasonNotGrantedToAppContainer=0x00070000,
   AccessReasonMissingPrivilege=0x00100000,
   AccessReasonFromPrivilege=0x00200000,
   AccessReasonIntegrityLevel=0x00300000,
   AccessReasonOwnership=0x00400000,
   AccessReasonNullDacl=0x00500000,
   AccessReasonEmptyDacl=0x00600000,
   AccessReasonNoSD=0x00700000,
   AccessReasonNoGrant=0x00800000,
   AccessReasonTrustLabel=0x00900000,
   AccessReasonFilterAce=0x00a00000
  };
//---
enum SECURITY_IMPERSONATION_LEVEL
  {
   SecurityAnonymous,
   SecurityIdentification,
   SecurityImpersonation,
   SecurityDelegation
  };
//---
enum TOKEN_TYPE
  {
   TokenPrimary=1,
   TokenImpersonation
  };
//---
enum TOKEN_ELEVATION_TYPE
  {
   TokenElevationTypeDefault=1,
   TokenElevationTypeFull,
   TokenElevationTypeLimited
  };
//---
enum TOKEN_INFORMATION_CLASS
  {
   TokenUser=1,
   TokenGroups,
   TokenPrivileges,
   TokenOwner,
   TokenPrimaryGroup,
   TokenDefaultDacl,
   TokenSource,
   TokenType,
   TokenImpersonationLevel,
   TokenStatistics,
   TokenRestrictedSids,
   TokenSessionId,
   TokenGroupsAndPrivileges,
   TokenSessionReference,
   TokenSandBoxInert,
   TokenAuditPolicy,
   TokenOrigin,
   TokenElevationType,
   TokenLinkedToken,
   TokenElevation,
   TokenHasRestrictions,
   TokenAccessInformation,
   TokenVirtualizationAllowed,
   TokenVirtualizationEnabled,
   TokenIntegrityLevel,
   TokenUIAccess,
   TokenMandatoryPolicy,
   TokenLogonSid,
   TokenIsAppContainer,
   TokenCapabilities,
   TokenAppContainerSid,
   TokenAppContainerNumber,
   TokenUserClaimAttributes,
   TokenDeviceClaimAttributes,
   TokenRestrictedUserClaimAttributes,
   TokenRestrictedDeviceClaimAttributes,
   TokenDeviceGroups,
   TokenRestrictedDeviceGroups,
   TokenSecurityAttributes,
   TokenIsRestricted,
   TokenProcessTrustLevel,
   TokenPrivateNameSpace,
   TokenSingletonAttributes,
   TokenBnoIsolation,
   TokenChildProcessFlags,
   MaxTokenInfoClass
  };
//---
enum MANDATORY_LEVEL
  {
   MandatoryLevelUntrusted=0,
   MandatoryLevelLow,
   MandatoryLevelMedium,
   MandatoryLevelHigh,
   MandatoryLevelSystem,
   MandatoryLevelSecureProcess,
   MandatoryLevelCount
  };
//---
enum SE_IMAGE_SIGNATURE_TYPE
  {
   SeImageSignatureNone=0,
   SeImageSignatureEmbedded,
   SeImageSignatureCache,
   SeImageSignatureCatalogCached,
   SeImageSignatureCatalogNotCached,
   SeImageSignatureCatalogHint,
   SeImageSignaturePackageCatalog
  };
//---
enum SE_LEARNING_MODE_DATA_TYPE
  {
   SeLearningModeInvalidType=0,
   SeLearningModeSettings,
   SeLearningModeMax
  };
//---
enum HARDWARE_COUNTER_TYPE
  {
   PMCCounter,
   MaxHardwareCounterType
  };
//---
enum PROCESS_MITIGATION_POLICY
  {
   ProcessDEPPolicy,
   ProcessASLRPolicy,
   ProcessDynamicCodePolicy,
   ProcessStrictHandleCheckPolicy,
   ProcessSystemCallDisablePolicy,
   ProcessMitigationOptionsMask,
   ProcessExtensionPointDisablePolicy,
   ProcessControlFlowGuardPolicy,
   ProcessSignaturePolicy,
   ProcessFontDisablePolicy,
   ProcessImageLoadPolicy,
   ProcessSystemCallFilterPolicy,
   ProcessPayloadRestrictionPolicy,
   ProcessChildProcessPolicy,
   MaxProcessMitigationPolicy
  };
//---
enum JOBOBJECT_RATE_CONTROL_TOLERANCE
  {
   ToleranceLow=1,
   ToleranceMedium,
   ToleranceHigh
  };
//---
enum JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL
  {
   ToleranceIntervalShort=1,
   ToleranceIntervalMedium,
   ToleranceIntervalLong
  };
//---
enum JOB_OBJECT_NET_RATE_CONTROL_FLAGS
  {
   JOB_OBJECT_NET_RATE_CONTROL_ENABLE=0x1,
   JOB_OBJECT_NET_RATE_CONTROL_MAX_BANDWIDTH=0x2,
   JOB_OBJECT_NET_RATE_CONTROL_DSCP_TAG=0x4,
   JOB_OBJECT_NET_RATE_CONTROL_VALID_FLAGS=0x7
  };
//---
enum JOB_OBJECT_IO_RATE_CONTROL_FLAGS
  {
   JOB_OBJECT_IO_RATE_CONTROL_ENABLE=0x1,
   JOB_OBJECT_IO_RATE_CONTROL_STANDALONE_VOLUME=0x2,
   JOB_OBJECT_IO_RATE_CONTROL_FORCE_UNIT_ACCESS_ALL=0x4,
   JOB_OBJECT_IO_RATE_CONTROL_FORCE_UNIT_ACCESS_ON_SOFT_CAP=0x8,
   JOB_OBJECT_IO_RATE_CONTROL_VALID_FLAGS=JOB_OBJECT_IO_RATE_CONTROL_ENABLE|
   JOB_OBJECT_IO_RATE_CONTROL_STANDALONE_VOLUME|
   JOB_OBJECT_IO_RATE_CONTROL_FORCE_UNIT_ACCESS_ALL|
   JOB_OBJECT_IO_RATE_CONTROL_FORCE_UNIT_ACCESS_ON_SOFT_CAP
  };
//---
enum JOBOBJECT_IO_ATTRIBUTION_CONTROL_FLAGS
  {
   JOBOBJECT_IO_ATTRIBUTION_CONTROL_ENABLE=0x1,
   JOBOBJECT_IO_ATTRIBUTION_CONTROL_DISABLE=0x2,
   JOBOBJECT_IO_ATTRIBUTION_CONTROL_VALID_FLAGS=0x3
  };
//---
enum JOBOBJECTINFOCLASS
  {
   JobObjectBasicAccountingInformation=1,
   JobObjectBasicLimitInformation,
   JobObjectBasicProcessIdList,
   JobObjectBasicUIRestrictions,
   JobObjectSecurityLimitInformation,
   JobObjectEndOfJobTimeInformation,
   JobObjectAssociateCompletionPortInformation,
   JobObjectBasicAndIoAccountingInformation,
   JobObjectExtendedLimitInformation,
   JobObjectJobSetInformation,
   JobObjectGroupInformation,
   JobObjectNotificationLimitInformation,
   JobObjectLimitViolationInformation,
   JobObjectGroupInformationEx,
   JobObjectCpuRateControlInformation,
   JobObjectCompletionFilter,
   JobObjectCompletionCounter,
   JobObjectReserved1Information=18,
   JobObjectReserved2Information,
   JobObjectReserved3Information,
   JobObjectReserved4Information,
   JobObjectReserved5Information,
   JobObjectReserved6Information,
   JobObjectReserved7Information,
   JobObjectReserved8Information,
   JobObjectReserved9Information,
   JobObjectReserved10Information,
   JobObjectReserved11Information,
   JobObjectReserved12Information,
   JobObjectReserved13Information,
   JobObjectReserved14Information=31,
   JobObjectNetRateControlInformation,
   JobObjectNotificationLimitInformation2,
   JobObjectLimitViolationInformation2,
   JobObjectCreateSilo,
   JobObjectSiloBasicInformation,
   JobObjectReserved15Information=37,
   JobObjectReserved16Information=38,
   JobObjectReserved17Information=39,
   JobObjectReserved18Information=40,
   JobObjectReserved19Information=41,
   JobObjectReserved20Information=42,
   JobObjectReserved21Information=43,
   JobObjectReserved22Information=44,
   JobObjectReserved23Information=45,
   JobObjectReserved24Information=46,
   JobObjectReserved25Information=47,
   MaxJobObjectInfoClass
  };
//---
enum SERVERSILO_STATE
  {
   SERVERSILO_INITING=0,
   SERVERSILO_STARTED,
   SERVERSILO_SHUTTING_DOWN,
   SERVERSILO_TERMINATING,
   SERVERSILO_TERMINATED
  };
//---
enum FIRMWARE_TYPE
  {
   FirmwareTypeUnknown,
   FirmwareTypeBios,
   FirmwareTypeUefi,
   FirmwareTypeMax
  };
//---
enum LOGICAL_PROCESSOR_RELATIONSHIP
  {
   RelationProcessorCore,
   RelationNumaNode,
   RelationCache,
   RelationProcessorPackage,
   RelationGroup,
   RelationAll=0xffff
  };
//---
enum PROCESSOR_CACHE_TYPE
  {
   CacheUnified,
   CacheInstruction,
   CacheData,
   CacheTrace
  };
//---
enum CPU_SET_INFORMATION_TYPE
  {
   CpuSetInformation
  };
//---
enum MEM_EXTENDED_PARAMETER_TYPE
  {
   MemExtendedParameterInvalidType=0,
   MemExtendedParameterAddressRequirements,
   MemExtendedParameterNumaNode,
   MemExtendedParameterPartitionHandle,
   MemExtendedParameterMax
  };
//---
enum SharedVirtualDiskSupportType
  {
   SharedVirtualDisksUnsupported=0,
   SharedVirtualDisksSupported=1,
   SharedVirtualDiskSnapshotsSupported=3,
   SharedVirtualDiskCDPSnapshotsSupported=7
  };
//---
enum SharedVirtualDiskHandleState
  {
   SharedVirtualDiskHandleStateNone=0,
   SharedVirtualDiskHandleStateFileShared=1,
   SharedVirtualDiskHandleStateHandleShared=3
  };
//---
enum SYSTEM_POWER_STATE
  {
   PowerSystemUnspecified=0,
   PowerSystemWorking=1,
   PowerSystemSleeping1=2,
   PowerSystemSleeping2=3,
   PowerSystemSleeping3=4,
   PowerSystemHibernate=5,
   PowerSystemShutdown=6,
   PowerSystemMaximum=7
  };
//---
enum DEVICE_POWER_STATE
  {
   PowerDeviceUnspecified=0,
   PowerDeviceD0,
   PowerDeviceD1,
   PowerDeviceD2,
   PowerDeviceD3,
   PowerDeviceMaximum
  };
//---
enum MONITOR_DISPLAY_STATE
  {
   PowerMonitorOff=0,
   PowerMonitorOn,
   PowerMonitorDim
  };
//---
enum USER_ACTIVITY_PRESENCE
  {
   PowerUserPresent=0,
   PowerUserNotPresent,
   PowerUserInactive,
   PowerUserMaximum,
   PowerUserInvalid=PowerUserMaximum
  };
//---
enum POWER_REQUEST_TYPE
  {
   PowerRequestDisplayRequired,
   PowerRequestSystemRequired,
   PowerRequestAwayModeRequired,
   PowerRequestExecutionRequired
  };
//---
enum POWER_MONITOR_REQUEST_TYPE
  {
   MonitorRequestTypeOff,
   MonitorRequestTypeOnAndPresent,
   MonitorRequestTypeToggleOn
  };
//---
enum POWER_PLATFORM_ROLE
  {
   PlatformRoleUnspecified=0,
   PlatformRoleDesktop,
   PlatformRoleMobile,
   PlatformRoleWorkstation,
   PlatformRoleEnterpriseServer,
   PlatformRoleSOHOServer,
   PlatformRoleAppliancePC,
   PlatformRolePerformanceServer,
   PlatformRoleSlate,
   PlatformRoleMaximum
  };
//---
enum HIBERFILE_BUCKET_SIZE
  {
   HiberFileBucket1GB=0,
   HiberFileBucket2GB,
   HiberFileBucket4GB,
   HiberFileBucket8GB,
   HiberFileBucket16GB,
   HiberFileBucket32GB,
   HiberFileBucketUnlimited,
   HiberFileBucketMax
  };
//---
enum IMAGE_AUX_SYMBOL_TYPE
  {
   IMAGE_AUX_SYMBOL_TYPE_TOKEN_DEF=1
  };
//---
enum IMPORT_OBJECT_TYPE
  {
   IMPORT_OBJECT_CODE=0,
   IMPORT_OBJECT_DATA=1,
   IMPORT_OBJECT_CONST=2
  };
//---
enum IMPORT_OBJECT_NAME_TYPE
  {
   IMPORT_OBJECT_ORDINAL=0,
   IMPORT_OBJECT_NAME=1,
   IMPORT_OBJECT_NAME_NO_PREFIX=2,
   IMPORT_OBJECT_NAME_UNDECORATE=3,
   IMPORT_OBJECT_NAME_EXPORTAS=4
  };
//---
enum ReplacesCorHdrNumericDefines
  {
   COMIMAGE_FLAGS_ILONLY=0x00000001,
   COMIMAGE_FLAGS_32BITREQUIRED=0x00000002,
   COMIMAGE_FLAGS_IL_LIBRARY=0x00000004,
   COMIMAGE_FLAGS_STRONGNAMESIGNED=0x00000008,
   COMIMAGE_FLAGS_NATIVE_ENTRYPOINT=0x00000010,
   COMIMAGE_FLAGS_TRACKDEBUGDATA=0x00010000,
   COMIMAGE_FLAGS_32BITPREFERRED=0x00020000,
   COR_VERSION_MAJOR_V2=2,
   COR_VERSION_MAJOR=COR_VERSION_MAJOR_V2,
   COR_VERSION_MINOR=5,
   COR_DELETED_NAME_LENGTH=8,
   COR_VTABLEGAP_NAME_LENGTH=8,
   NATIVE_TYPE_MAX_CB=1,
   COR_ILMETHOD_SECT_SMALL_MAX_DATASIZE=0xFF,
   IMAGE_COR_MIH_METHODRVA=0x01,
   IMAGE_COR_MIH_EHRVA=0x02,
   IMAGE_COR_MIH_BASICBLOCK=0x08,
   COR_VTABLE_32BIT=0x01,
   COR_VTABLE_64BIT=0x02,
   COR_VTABLE_FROM_UNMANAGED=0x04,
   COR_VTABLE_FROM_UNMANAGED_RETAIN_APPDOMAIN=0x08,
   COR_VTABLE_CALL_MOST_DERIVED=0x10,
   IMAGE_COR_EATJ_THUNK_SIZE=32,
   MAX_CLASS_NAME=1024,
   MAX_PACKAGE_NAME=1024
  };
//---
enum RTL_UMS_THREAD_INFO_CLASS
  {
   UmsThreadInvalidInfoClass=0,
   UmsThreadUserContext,
   UmsThreadPriority,
   UmsThreadAffinity,
   UmsThreadTeb,
   UmsThreadIsSuspended,
   UmsThreadIsTerminated,
   UmsThreadMaxInfoClass
  };
//---
enum RTL_UMS_SCHEDULER_REASON
  {
   UmsSchedulerStartup=0,
   UmsSchedulerThreadBlocked,
   UmsSchedulerThreadYield
  };
//---
enum OS_DEPLOYEMENT_STATE_VALUES
  {
   OS_DEPLOYMENT_STANDARD=1,
   OS_DEPLOYMENT_COMPACT
  };
//---
enum IMAGE_POLICY_ENTRY_TYPE
  {
   ImagePolicyEntryTypeNone=0,
   ImagePolicyEntryTypeBool,
   ImagePolicyEntryTypeInt8,
   ImagePolicyEntryTypeUInt8,
   ImagePolicyEntryTypeInt16,
   ImagePolicyEntryTypeUInt16,
   ImagePolicyEntryTypeInt32,
   ImagePolicyEntryTypeUInt32,
   ImagePolicyEntryTypeInt64,
   ImagePolicyEntryTypeUInt64,
   ImagePolicyEntryTypeAnsiString,
   ImagePolicyEntryTypeUnicodeString,
   ImagePolicyEntryTypeOverride,
   ImagePolicyEntryTypeMaximum
  };
//---
enum IMAGE_POLICY_ID
  {
   ImagePolicyIdNone=0,
   ImagePolicyIdEtw,
   ImagePolicyIdDebug,
   ImagePolicyIdCrashDump,
   ImagePolicyIdCrashDumpKey,
   ImagePolicyIdCrashDumpKeyGuid,
   ImagePolicyIdParentSd,
   ImagePolicyIdParentSdRev,
   ImagePolicyIdSvn,
   ImagePolicyIdDeviceId,
   ImagePolicyIdCapability,
   ImagePolicyIdScenarioId,
   ImagePolicyIdMaximum
  };
//---
enum HEAP_INFORMATION_CLASS
  {
   HeapCompatibilityInformation=0,
   HeapEnableTerminationOnCorruption=1,
   HeapOptimizeResources=3
  };
//---
enum ACTIVATION_CONTEXT_INFO_CLASS
  {
   ActivationContextBasicInformation=1,
   ActivationContextDetailedInformation=2,
   AssemblyDetailedInformationInActivationContext=3,
   FileInformationInAssemblyOfAssemblyInActivationContext=4,
   RunlevelInformationInActivationContext=5,
   CompatibilityInformationInActivationContext=6,
   ActivationContextManifestResourceName=7,
   MaxActivationContextInfoClass,
   AssemblyDetailedInformationInActivationContxt=3,
   FileInformationInAssemblyOfAssemblyInActivationContxt=4
  };
//---
enum SERVICE_NODE_TYPE
  {
   DriverType=0x00000001,
   FileSystemType=0x00000002,
   Win32ServiceOwnProcess=0x00000010,
   Win32ServiceShareProcess=0x00000020,
   AdapterType=0x00000004,
   RecognizerType=0x00000008
  };
//---
enum SERVICE_LOAD_TYPE
  {
   BootLoad=0x00000000,
   SystemLoad=0x00000001,
   AutoLoad=0x00000002,
   DemandLoad=0x00000003,
   DisableLoad=0x00000004
  };
//---
enum SERVICE_ERROR_TYPE
  {
   IgnoreError=0x00000000,
   NormalError=0x00000001,
   SevereError=0x00000002,
   CriticalError=0x00000003
  };
//---
enum TAPE_DRIVE_PROBLEM_TYPE
  {
   TapeDriveProblemNone,
   TapeDriveReadWriteWarning,
   TapeDriveReadWriteError,
   TapeDriveReadWarning,
   TapeDriveWriteWarning,
   TapeDriveReadError,
   TapeDriveWriteError,
   TapeDriveHardwareError,
   TapeDriveUnsupportedMedia,
   TapeDriveScsiConnectionError,
   TapeDriveTimetoClean,
   TapeDriveCleanDriveNow,
   TapeDriveMediaLifeExpired,
   TapeDriveSnappedTape
  };
//---
enum TRANSACTION_OUTCOME
  {
   TransactionOutcomeUndetermined=1,
   TransactionOutcomeCommitted,
   TransactionOutcomeAborted
  };
//---
enum TRANSACTION_STATE
  {
   TransactionStateNormal=1,
   TransactionStateIndoubt,
   TransactionStateCommittedNotify
  };
//---
enum TRANSACTION_INFORMATION_CLASS
  {
   TransactionBasicInformation,
   TransactionPropertiesInformation,
   TransactionEnlistmentInformation,
   TransactionSuperiorEnlistmentInformation,
   TransactionBindInformation,
   TransactionDTCPrivateInformation
  };
//---
enum TRANSACTIONMANAGER_INFORMATION_CLASS
  {
   TransactionManagerBasicInformation,
   TransactionManagerLogInformation,
   TransactionManagerLogPathInformation,
   TransactionManagerRecoveryInformation=4,
   TransactionManagerOnlineProbeInformation=3,
   TransactionManagerOldestTransactionInformation=5
  };
//---
enum RESOURCEMANAGER_INFORMATION_CLASS
  {
   ResourceManagerBasicInformation,
   ResourceManagerCompletionInformation
  };
//---
enum ENLISTMENT_INFORMATION_CLASS
  {
   EnlistmentBasicInformation,
   EnlistmentRecoveryInformation,
   EnlistmentCrmInformation
  };
//---
enum KTMOBJECT_TYPE
  {
   KTMOBJECT_TRANSACTION,
   KTMOBJECT_TRANSACTION_MANAGER,
   KTMOBJECT_RESOURCE_MANAGER,
   KTMOBJECT_ENLISTMENT,
   KTMOBJECT_INVALID
  };
//---
enum TP_CALLBACK_PRIORITY
  {
   TP_CALLBACK_PRIORITY_HIGH,
   TP_CALLBACK_PRIORITY_NORMAL,
   TP_CALLBACK_PRIORITY_LOW,
   TP_CALLBACK_PRIORITY_INVALID,
   TP_CALLBACK_PRIORITY_COUNT=TP_CALLBACK_PRIORITY_INVALID
  };
//---
enum POWER_USER_PRESENCE_TYPE
  {
   UserNotPresent=0,
   UserPresent=1,
   UserUnknown=0xff
  };
//---
enum POWER_MONITOR_REQUEST_REASON
  {
   MonitorRequestReasonUnknown,
   MonitorRequestReasonPowerButton,
   MonitorRequestReasonRemoteConnection,
   MonitorRequestReasonScMonitorpower,
   MonitorRequestReasonUserInput,
   MonitorRequestReasonAcDcDisplayBurst,
   MonitorRequestReasonUserDisplayBurst,
   MonitorRequestReasonPoSetSystemState,
   MonitorRequestReasonSetThreadExecutionState,
   MonitorRequestReasonFullWake,
   MonitorRequestReasonSessionUnlock,
   MonitorRequestReasonScreenOffRequest,
   MonitorRequestReasonIdleTimeout,
   MonitorRequestReasonPolicyChange,
   MonitorRequestReasonSleepButton,
   MonitorRequestReasonLid,
   MonitorRequestReasonBatteryCountChange,
   MonitorRequestReasonGracePeriod,
   MonitorRequestReasonPnP,
   MonitorRequestReasonDP,
   MonitorRequestReasonSxTransition,
   MonitorRequestReasonSystemIdle,
   MonitorRequestReasonNearProximity,
   MonitorRequestReasonThermalStandby,
   MonitorRequestReasonResumePdc,
   MonitorRequestReasonResumeS4,
   MonitorRequestReasonTerminal,
   MonitorRequestReasonPdcSignal,
   MonitorRequestReasonAcDcDisplayBurstSuppressed,
   MonitorRequestReasonSystemStateEntered,
   MonitorRequestReasonWinrt,
   MonitorRequestReasonUserInputKeyboard,
   MonitorRequestReasonUserInputMouse,
   MonitorRequestReasonUserInputTouch,
   MonitorRequestReasonUserInputPen,
   MonitorRequestReasonUserInputAccelerometer,
   MonitorRequestReasonUserInputHid,
   MonitorRequestReasonUserInputPoUserPresent,
   MonitorRequestReasonUserInputSessionSwitch,
   MonitorRequestReasonUserInputInitialization,
   MonitorRequestReasonPdcSignalWindowsMobilePwrNotif,
   MonitorRequestReasonPdcSignalWindowsMobileShell,
   MonitorRequestReasonPdcSignalHeyCortana,
   MonitorRequestReasonPdcSignalHolographicShell,
   MonitorRequestReasonPdcSignalFingerprint,
   MonitorRequestReasonMax
  };
//---
enum POWER_ACTION
  {
   PowerActionNone=0,
   PowerActionReserved,
   PowerActionSleep,
   PowerActionHibernate,
   PowerActionShutdown,
   PowerActionShutdownReset,
   PowerActionShutdownOff,
   PowerActionWarmEject,
   PowerActionDisplayOff
  };
//---
enum ACTCTX_REQUESTED_RUN_LEVEL
  {
   ACTCTX_RUN_LEVEL_UNSPECIFIED=0,
   ACTCTX_RUN_LEVEL_AS_INVOKER,
   ACTCTX_RUN_LEVEL_HIGHEST_AVAILABLE,
   ACTCTX_RUN_LEVEL_REQUIRE_ADMIN,
   ACTCTX_RUN_LEVEL_NUMBERS
  };
//---
enum ACTCTX_COMPATIBILITY_ELEMENT_TYPE
  {
   ACTCTX_COMPATIBILITY_ELEMENT_TYPE_UNKNOWN=0,
   ACTCTX_COMPATIBILITY_ELEMENT_TYPE_OS,
   ACTCTX_COMPATIBILITY_ELEMENT_TYPE_MITIGATION
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
//---
struct PROCESSOR_NUMBER
  {
   ushort            Group;
   uchar             Number;
   uchar             Reserved;
  };
//---
struct GROUP_AFFINITY
  {
   ulong             Mask;
   ushort            Group;
   ushort            Reserved[3];
  };
//---
struct FLOAT128
  {
   long              LowPart;
   long              HighPart;
  };
//---
struct LARGE_INTEGER
  {
   long              QuadPart;
  };
//---
struct ULARGE_INTEGER
  {
   ulong             QuadPart;
  };
//---
struct LUID
  {
   uint              LowPart;
   int               HighPart;
  };
//---
struct LIST_ENTRY
  {
   PVOID             Flink;
   PVOID             Blink;
  };
//---
struct SINGLE_LIST_ENTRY
  {
   PVOID             Next;
  };
//---
struct LIST_ENTRY32
  {
   uint              Flink;
   uint              Blink;
  };
//---
struct LIST_ENTRY64
  {
   ulong             Flink;
   ulong             Blink;
  };
//---
struct OBJECTID
  {
   GUID              Lineage;
   uint              Uniquifier;
  };
//---
struct M128A
  {
   ulong             Low;
   long              High;
  };
//---
struct XSAVE_FORMAT
  {
   ushort            Controlushort;
   ushort            Statusushort;
   uchar             Tagushort;
   uchar             Reserved1;
   ushort            ErrorOpcode;
   uint              ErrorOffset;
   ushort            ErrorSelector;
   ushort            Reserved2;
   uint              DataOffset;
   ushort            DataSelector;
   ushort            Reserved3;
   uint              MxCsr;
   uint              MxCsr_Mask;
   M128A             FloatRegisters[8];
   M128A             XmmRegisters[16];
   uchar             Reserved4[96];
  };
//---
struct XSAVE_AREA_HEADER
  {
   ulong             Mask;
   ulong             CompactionMask;
   ulong             Reserved2[6];
  };
//---
struct XSAVE_AREA
  {
   XSAVE_FORMAT      LegacyState;
   XSAVE_AREA_HEADER Header;
  };
//---
struct XSTATE_CONTEXT
  {
   ulong             Mask;
   uint              Length;
   uint              Reserved1;
   PVOID             Area;
   uint              Reserved2;
   PVOID             Buffer;
   uint              Reserved3;
  };
//---
struct SCOPE_TABLE_AMD64
  {
   uint              Count;
   uint              BeginAddress;
   uint              EndAddress;
   uint              HandlerAddress;
   uint              JumpTarget;
  };
//---
struct UNWIND_HISTORY_TABLE_ENTRY
  {
   ulong             ImageBase;
   PVOID             FunctionEntry;
  };
//---
struct UNWIND_HISTORY_TABLE
  {
   uint              Count;
   uchar             LocalHint;
   uchar             GlobalHint;
   uchar             Search;
   uchar             Once;
   ulong             LowAddress;
   ulong             HighAddress;
   UNWIND_HISTORY_TABLE_ENTRY Entry[UNWIND_HISTORY_TABLE_SIZE];
  };
//---
struct SCOPE_TABLE_ARM64
  {
   uint              Count;
   uint              BeginAddress;
   uint              EndAddress;
   uint              HandlerAddress;
   uint              JumpTarget;
  };
//---
struct NEON128
  {
   ulong             Low;
   long              High;
  };
//---
struct DISPATCHER_CONTEXT
  {
   uint              ControlPc;
   uint              ImageBase;
   PVOID             FunctionEntry;
   uint              EstablisherFrame;
   uint              TargetPc;
   PVOID             ContextRecord;
   PVOID             LanguageHandler;
   PVOID             HandlerData;
   PVOID             HistoryTable;
   uint              ScopeIndex;
   uchar             ControlPcIsUnwound;
   PVOID             NonVolatileRegisters;
   uint              Reserved;
  };
//---
struct KNONVOLATILE_CONTEXT_POINTERS
  {
   PVOID             FloatingContext[16];
   PVOID             IntegerContext[16];
  };
//---
struct SCOPE_TABLE_ARM
  {
   uint              Count;
   uint              BeginAddress;
   uint              EndAddress;
   uint              HandlerAddress;
   uint              JumpTarget;
  };
//---
struct DISPATCHER_CONTEXT_ARM64
  {
   ulong             ControlPc;
   ulong             ImageBase;
   PVOID             FunctionEntry;
   ulong             EstablisherFrame;
   ulong             TargetPc;
   PVOID             ContextRecord;
   PVOID             LanguageHandler;
   PVOID             HandlerData;
   PVOID             HistoryTable;
   uint              ScopeIndex;
   uchar             ControlPcIsUnwound;
   PVOID             NonVolatileRegisters;
  };
//---
struct KNONVOLATILE_CONTEXT_POINTERS_ARM64
  {
   PVOID             X19;
   PVOID             X20;
   PVOID             X21;
   PVOID             X22;
   PVOID             X23;
   PVOID             X24;
   PVOID             X25;
   PVOID             X26;
   PVOID             X27;
   PVOID             X28;
   PVOID             Fp;
   PVOID             Lr;
   PVOID             D8;
   PVOID             D9;
   PVOID             D10;
   PVOID             D11;
   PVOID             D12;
   PVOID             D13;
   PVOID             D14;
   PVOID             D15;
  };
//---
struct FLOATING_SAVE_AREA
  {
   uint              Controlushort;
   uint              Statusushort;
   uint              Tagushort;
   uint              ErrorOffset;
   uint              ErrorSelector;
   uint              DataOffset;
   uint              DataSelector;
   uchar             RegisterArea[SIZE_OF_80387_REGISTERS];
   uint              Spare0;
  };
//---
struct CONTEXT
  {
   ulong             P1Home;
   ulong             P2Home;
   ulong             P3Home;
   ulong             P4Home;
   ulong             P5Home;
   ulong             P6Home;
   uint              ContextFlags;
   uint              MxCsr;
   ushort            SegCs;
   ushort            SegDs;
   ushort            SegEs;
   ushort            SegFs;
   ushort            SegGs;
   ushort            SegSs;
   uint              EFlags;
   ulong             Dr0;
   ulong             Dr1;
   ulong             Dr2;
   ulong             Dr3;
   ulong             Dr6;
   ulong             Dr7;
   ulong             Rax;
   ulong             Rcx;
   ulong             Rdx;
   ulong             Rbx;
   ulong             Rsp;
   ulong             Rbp;
   ulong             Rsi;
   ulong             Rdi;
   ulong             R8;
   ulong             R9;
   ulong             R10;
   ulong             R11;
   ulong             R12;
   ulong             R13;
   ulong             R14;
   ulong             R15;
   ulong             Rip;
   M128A             Header[2];
   M128A             Legacy[8];
   M128A             Xmm0;
   M128A             Xmm1;
   M128A             Xmm2;
   M128A             Xmm3;
   M128A             Xmm4;
   M128A             Xmm5;
   M128A             Xmm6;
   M128A             Xmm7;
   M128A             Xmm8;
   M128A             Xmm9;
   M128A             Xmm10;
   M128A             Xmm11;
   M128A             Xmm12;
   M128A             Xmm13;
   M128A             Xmm14;
   M128A             Xmm15;
   M128A             VectorRegister[26];
   ulong             VectorControl;
   ulong             DebugControl;
   ulong             LastBranchToRip;
   ulong             LastBranchFromRip;
   ulong             LastExceptionToRip;
   ulong             LastExceptionFromRip;
  };
//---
struct WOW64_FLOATING_SAVE_AREA
  {
   uint              Controlushort;
   uint              Statusushort;
   uint              Tagushort;
   uint              ErrorOffset;
   uint              ErrorSelector;
   uint              DataOffset;
   uint              DataSelector;
   uchar             RegisterArea[WOW64_SIZE_OF_80387_REGISTERS];
   uint              Cr0NpxState;
  };
//---
struct WOW64_CONTEXT
  {
   uint              ContextFlags;
   uint              Dr0;
   uint              Dr1;
   uint              Dr2;
   uint              Dr3;
   uint              Dr6;
   uint              Dr7;
   WOW64_FLOATING_SAVE_AREA FloatSave;
   uint              SegGs;
   uint              SegFs;
   uint              SegEs;
   uint              SegDs;
   uint              Edi;
   uint              Esi;
   uint              Ebx;
   uint              Edx;
   uint              Ecx;
   uint              Eax;
   uint              Ebp;
   uint              Eip;
   uint              SegCs;
   uint              EFlags;
   uint              Esp;
   uint              SegSs;
   uchar             ExtendedRegisters[WOW64_MAXIMUM_SUPPORTED_EXTENSION];
  };
//---
struct WOW64_LDT_ENTRY
  {
   uint              LimitLow;
   uint              BaseLow;
   uchar             BaseMid;
   uchar             Flags1;
   uchar             Flags2;
   uchar             BaseHi;
  };
//---
struct WOW64_DESCRIPTOR_TABLE_ENTRY
  {
   uint              Selector;
   WOW64_LDT_ENTRY   Descriptor;
  };
//---
struct EXCEPTION_RECORD
  {
   uint              ExceptionCode;
   uint              ExceptionFlags;
   PVOID             ExceptionRecord;
   PVOID             ExceptionAddress;
   uint              NumberParameters;
   PVOID             ExceptionInformation[EXCEPTION_MAXIMUM_PARAMETERS];
  };
//---
struct EXCEPTION_RECORD32
  {
   uint              ExceptionCode;
   uint              ExceptionFlags;
   uint              ExceptionRecord;
   uint              ExceptionAddress;
   uint              NumberParameters;
   uint              ExceptionInformation[EXCEPTION_MAXIMUM_PARAMETERS];
  };
//---
struct EXCEPTION_RECORD64
  {
   uint              ExceptionCode;
   uint              ExceptionFlags;
   ulong             ExceptionRecord;
   ulong             ExceptionAddress;
   uint              NumberParameters;
   uint              __unusedAlignment;
   ulong             ExceptionInformation[EXCEPTION_MAXIMUM_PARAMETERS];
  };
//---
struct EXCEPTION_POINTERS
  {
   PVOID             ExceptionRecord;
   PVOID             ContextRecord;
  };
//---
struct GENERIC_MAPPING
  {
   uint              GenericRead;
   uint              GenericWrite;
   uint              GenericExecute;
   uint              GenericAll;
  };
//---
struct LUID_AND_ATTRIBUTES
  {
   LUID              Luid;
   uint              Attributes;
  };
//---
struct SID_IDENTIFIER_AUTHORITY
  {
   uchar             Value[6];
  };
//---
//---
struct SID
  {
   uchar             Revision;
   uchar             SubAuthorityCount;
   SID_IDENTIFIER_AUTHORITY IdentifierAuthority;
   uint              SubAuthority[ANYSIZE_ARRAY];
  };
//---
struct SID_AND_ATTRIBUTES
  {
   SID               Sid;
   uint              Attributes;
  };
//---
struct SID_AND_ATTRIBUTES_HASH
  {
   uint              SidCount;
   PVOID             SidAttr;
   ulong             Hash[SID_HASH_SIZE];
  };
//---
struct ACL
  {
   uchar             AclRevision;
   uchar             Sbz1;
   ushort            AclSize;
   ushort            AceCount;
   ushort            Sbz2;
  };
//---
struct ACE_HEADER
  {
   uchar             AceType;
   uchar             AceFlags;
   ushort            AceSize;
  };
//---
struct ACCESS_ALLOWED_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct ACCESS_DENIED_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_AUDIT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_ALARM_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_RESOURCE_ATTRIBUTE_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_SCOPED_POLICY_ID_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_MANDATORY_LABEL_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_PROCESS_TRUST_LABEL_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_ACCESS_FILTER_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct ACCESS_ALLOWED_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct ACCESS_DENIED_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct SYSTEM_AUDIT_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct SYSTEM_ALARM_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct ACCESS_ALLOWED_CALLBACK_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct ACCESS_DENIED_CALLBACK_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_AUDIT_CALLBACK_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct SYSTEM_ALARM_CALLBACK_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              SidStart;
  };
//---
struct ACCESS_ALLOWED_CALLBACK_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct ACCESS_DENIED_CALLBACK_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct SYSTEM_AUDIT_CALLBACK_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct SYSTEM_ALARM_CALLBACK_OBJECT_ACE
  {
   ACE_HEADER        Header;
   uint              Mask;
   uint              Flags;
   GUID              ObjectType;
   GUID              InheritedObjectType;
   uint              SidStart;
  };
//---
struct ACL_REVISION_INFORMATION
  {
   uint              AclRevision;
  };
//---
struct ACL_SIZE_INFORMATION
  {
   uint              AceCount;
   uint              AclBytesInUse;
   uint              AclBytesFree;
  };
//---
struct SECURITY_DESCRIPTOR_RELATIVE
  {
   uchar             Revision;
   uchar             Sbz1;
   ushort            Control;
   uint              Owner;
   uint              Group;
   uint              Sacl;
   uint              Dacl;
  };
//---
struct SECURITY_DESCRIPTOR
  {
   uchar             Revision;
   uchar             Sbz1;
   ushort            Control;
   uchar             offset[4];
   PVOID             Owner;
   PVOID             Group;
   PVOID             Sacl;
   PVOID             Dacl;
  };
//---
struct SECURITY_OBJECT_AI_PARAMS
  {
   uint              Size;
   uint              ConstraintMask;
  };
//---
struct OBJECT_TYPE_LIST
  {
   ushort            Level;
   ushort            Sbz;
   GUID              ObjectType;
  };
//---
struct PRIVILEGE_SET
  {
   uint              PrivilegeCount;
   uint              Control;
   LUID_AND_ATTRIBUTES Privilege[ANYSIZE_ARRAY];
  };
//---
struct ACCESS_REASONS
  {
   uint              Data[32];
  };
//---
struct SE_SECURITY_DESCRIPTOR
  {
   uint              Size;
   uint              Flags;
   PVOID             SecurityDescriptor;
  };
//---
struct SE_ACCESS_REQUEST
  {
   uint              Size;
   PVOID             SeSecurityDescriptor;
   uint              DesiredAccess;
   uint              PreviouslyGrantedAccess;
   PVOID             PrincipalSelfSid;
   PVOID             GenericMapping;
   uint              ObjectTypeListCount;
   PVOID             ObjectTypeList;
  };
//---
struct SE_ACCESS_REPLY
  {
   uint              Size;
   uint              ResultListCount;
   PVOID             GrantedAccess;
   uint              AccessStatus;
   PVOID             AccessReason;
   PVOID             Privileges;
  };
//---
struct TOKEN_USER
  {
   SID_AND_ATTRIBUTES User;
  };
//---
struct SE_TOKEN_USER
  {
   TOKEN_USER        TokenUser;
   SID               Sid;
  };
//---
struct TOKEN_GROUPS
  {
   uint              GroupCount;
   SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];
  };
//---
struct TOKEN_PRIVILEGES
  {
   uint              PrivilegeCount;
   LUID_AND_ATTRIBUTES Privileges[ANYSIZE_ARRAY];
  };
//---
struct TOKEN_OWNER
  {
   PVOID             Owner;
  };
//---
struct TOKEN_PRIMARY_GROUP
  {
   PVOID             PrimaryGroup;
  };
//---
struct TOKEN_DEFAULT_DACL
  {
   PVOID             DefaultDacl;
  };
//---
struct TOKEN_USER_CLAIMS
  {
   PVOID             UserClaims;
  };
//---
struct TOKEN_DEVICE_CLAIMS
  {
   PVOID             DeviceClaims;
  };
//---
struct TOKEN_GROUPS_AND_PRIVILEGES
  {
   uint              SidCount;
   uint              SidLength;
   PVOID             Sids;
   uint              RestrictedSidCount;
   uint              RestrictedSidLength;
   PVOID             RestrictedSids;
   uint              PrivilegeCount;
   uint              PrivilegeLength;
   PVOID             Privileges;
   LUID              AuthenticationId;
  };
//---
struct TOKEN_LINKED_TOKEN
  {
   HANDLE            LinkedToken;
  };
//---
struct TOKEN_ELEVATION
  {
   uint              TokenIsElevated;
  };
//---
struct TOKEN_MANDATORY_LABEL
  {
   SID_AND_ATTRIBUTES Label;
  };
//---
struct TOKEN_MANDATORY_POLICY
  {
   uint              Policy;
  };
//---
struct TOKEN_ACCESS_INFORMATION
  {
   PVOID             SidHash;
   PVOID             RestrictedSidHash;
   PVOID             Privileges;
   LUID              AuthenticationId;
   TOKEN_TYPE        TokenType;
   SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;
   TOKEN_MANDATORY_POLICY MandatoryPolicy;
   uint              Flags;
   uint              AppContainerNumber;
   PVOID             PackageSid;
   PVOID             CapabilitiesHash;
   PVOID             TrustLevelSid;
   PVOID             SecurityAttributes;
  };
//---
struct TOKEN_AUDIT_POLICY
  {
   uchar             PerUserPolicy[((POLICY_AUDIT_SUBCATEGORY_COUNT)>>1)+1];
  };
//---
struct TOKEN_SOURCE
  {
   char              SourceName[TOKEN_SOURCE_LENGTH];
   LUID              SourceIdentifier;
  };
//---
struct TOKEN_STATISTICS
  {
   LUID              TokenId;
   LUID              AuthenticationId;
   long              ExpirationTime;
   TOKEN_TYPE        TokenType;
   SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;
   uint              DynamicCharged;
   uint              DynamicAvailable;
   uint              GroupCount;
   uint              PrivilegeCount;
   LUID              ModifiedId;
  };
//---
struct TOKEN_CONTROL
  {
   LUID              TokenId;
   LUID              AuthenticationId;
   LUID              ModifiedId;
   TOKEN_SOURCE      TokenSource;
  };
//---
struct TOKEN_ORIGIN
  {
   LUID              OriginatingLogonSession;
  };
//---
struct TOKEN_APPCONTAINER_INFORMATION
  {
   PVOID             TokenAppContainer;
  };
//---
struct TOKEN_SID_INFORMATION
  {
   PVOID             Sid;
  };
//---
struct TOKEN_BNO_ISOLATION_INFORMATION
  {
   string            IsolationPrefix;
   uchar             IsolationEnabled;
  };
//---
struct CLAIM_SECURITY_ATTRIBUTE_FQBN_VALUE
  {
   ulong             Version;
   string            Name;
  };
//---
struct CLAIM_SECURITY_ATTRIBUTE_OCTET_STRING_VALUE
  {
   PVOID             pValue;
   uint              ValueLength;
  };
//---
struct CLAIM_SECURITY_ATTRIBUTE_RELATIVE_V1
  {
   uint              Name;
   ushort            ValueType;
   ushort            Reserved;
   uint              Flags;
   uint              ValueCount;
   uint              pInt64[ANYSIZE_ARRAY];
  };
//---
struct Attribute
  {
   ushort            Version;
   ushort            Reserved;
   uint              AttributeCount;
   PVOID             pAttributeV1;
  };
//---
struct SECURITY_QUALITY_OF_SERVICE
  {
   uint              Length;
   SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;
   uchar             ContextTrackingMode;
   uchar             EffectiveOnly;
  };
//---
struct SE_IMPERSONATION_STATE
  {
   PVOID             Token;
   uchar             CopyOnOpen;
   uchar             EffectiveOnly;
   SECURITY_IMPERSONATION_LEVEL Level;
  };
//---
struct SECURITY_CAPABILITIES
  {
   PVOID             AppContainerSid;
   PVOID             Capabilities;
   uint              CapabilityCount;
   uint              Reserved;
  };
//---
struct JOB_SET_ARRAY
  {
   HANDLE            JobHandle;
   uint              MemberLevel;
   uint              Flags;
  };
//---
struct EXCEPTION_REGISTRATION_RECORD
  {
   PVOID             Next;
   PVOID             Handler;
  };
//---
struct NT_TIB
  {
   PVOID             ExceptionList;
   PVOID             StackBase;
   PVOID             StackLimit;
   PVOID             SubSystemTib;
   PVOID             FiberData;
   PVOID             ArbitraryUserPointer;
   PVOID             Self;
  };
//---
struct UMS_CREATE_THREAD_ATTRIBUTES
  {
   uint              UmsVersion;
   PVOID             UmsContext;
   PVOID             UmsCompletionList;
  };
//---
struct WOW64_ARCHITECTURE_INFORMATION
  {
   uint              Info;
  };
//---
struct QUOTA_LIMITS
  {
   ulong             PagedPoolLimit;
   ulong             NonPagedPoolLimit;
   ulong             MinimumWorkingSetSize;
   ulong             MaximumWorkingSetSize;
   ulong             PagefileLimit;
   long              TimeLimit;
  };
//---
struct QUOTA_LIMITS_EX
  {
   ulong             PagedPoolLimit;
   ulong             NonPagedPoolLimit;
   ulong             MinimumWorkingSetSize;
   ulong             MaximumWorkingSetSize;
   ulong             PagefileLimit;
   long              TimeLimit;
   ulong             WorkingSetLimit;
   ulong             Reserved2;
   ulong             Reserved3;
   ulong             Reserved4;
   uint              Flags;
   uint              CpuRateLimit;
  };
//---
struct IO_COUNTERS
  {
   ulong             ReadOperationCount;
   ulong             WriteOperationCount;
   ulong             OtherOperationCount;
   ulong             ReadTransferCount;
   ulong             WriteTransferCount;
   ulong             OtherTransferCount;
  };
//---
struct JOBOBJECT_BASIC_ACCOUNTING_INFORMATION
  {
   long              TotalUserTime;
   long              TotalKernelTime;
   long              ThisPeriodTotalUserTime;
   long              ThisPeriodTotalKernelTime;
   uint              TotalPageFaultCount;
   uint              TotalProcesses;
   uint              ActiveProcesses;
   uint              TotalTerminatedProcesses;
  };
//---
struct JOBOBJECT_BASIC_LIMIT_INFORMATION
  {
   long              PerProcessUserTimeLimit;
   long              PerJobUserTimeLimit;
   uint              LimitFlags;
   ulong             MinimumWorkingSetSize;
   ulong             MaximumWorkingSetSize;
   uint              ActiveProcessLimit;
   ulong             Affinity;
   uint              PriorityClass;
   uint              SchedulingClass;
  };
//---
struct JOBOBJECT_EXTENDED_LIMIT_INFORMATION
  {
   JOBOBJECT_BASIC_LIMIT_INFORMATION BasicLimitInformation;
   IO_COUNTERS       IoInfo;
   ulong             ProcessMemoryLimit;
   ulong             JobMemoryLimit;
   ulong             PeakProcessMemoryUsed;
   ulong             PeakJobMemoryUsed;
  };
//---
struct JOBOBJECT_BASIC_PROCESS_ID_LIST
  {
   uint              NumberOfAssignedProcesses;
   uint              NumberOfProcessIdsInList;
   ulong             ProcessIdList[1];
  };
//---
struct JOBOBJECT_BASIC_UI_RESTRICTIONS
  {
   uint              UIRestrictionsClass;
  };
//---
struct JOBOBJECT_SECURITY_LIMIT_INFORMATION
  {
   uint              SecurityLimitFlags;
   HANDLE            JobToken;
   PVOID             SidsToDisable;
   PVOID             PrivilegesToDelete;
   PVOID             RestrictedSids;
  };
//---
struct JOBOBJECT_END_OF_JOB_TIME_INFORMATION
  {
   uint              EndOfJobTimeAction;
  };
//---
struct JOBOBJECT_ASSOCIATE_COMPLETION_PORT
  {
   PVOID             CompletionKey;
   HANDLE            CompletionPort;
  };
//---
struct JOBOBJECT_BASIC_AND_IO_ACCOUNTING_INFORMATION
  {
   JOBOBJECT_BASIC_ACCOUNTING_INFORMATION BasicInfo;
   IO_COUNTERS       IoInfo;
  };
//---
struct JOBOBJECT_JOBSET_INFORMATION
  {
   uint              MemberLevel;
  };
//---
struct JOBOBJECT_NOTIFICATION_LIMIT_INFORMATION
  {
   ulong             IoReadBytesLimit;
   ulong             IoWriteBytesLimit;
   long              PerJobUserTimeLimit;
   ulong             JobMemoryLimit;
   JOBOBJECT_RATE_CONTROL_TOLERANCE RateControlTolerance;
   JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL RateControlToleranceInterval;
   uint              LimitFlags;
  };
//---
struct JOBOBJECT_LIMIT_VIOLATION_INFORMATION
  {
   uint              LimitFlags;
   uint              ViolationLimitFlags;
   ulong             IoReadBytes;
   ulong             IoReadBytesLimit;
   ulong             IoWriteBytes;
   ulong             IoWriteBytesLimit;
   long              PerJobUserTime;
   long              PerJobUserTimeLimit;
   ulong             JobMemory;
   ulong             JobMemoryLimit;
   JOBOBJECT_RATE_CONTROL_TOLERANCE RateControlTolerance;
   JOBOBJECT_RATE_CONTROL_TOLERANCE RateControlToleranceLimit;
  };
//---
struct JOBOBJECT_NET_RATE_CONTROL_INFORMATION
  {
   ulong             MaxBandwidth;
   JOB_OBJECT_NET_RATE_CONTROL_FLAGS ControlFlags;
   uchar             DscpTag;
  };
//---
struct JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE
  {
   long              MaxIops;
   long              MaxBandwidth;
   long              ReservationIops;
   string            VolumeName;
   uint              BaseIoSize;
   JOB_OBJECT_IO_RATE_CONTROL_FLAGS ControlFlags;
   ushort            VolumeNameLength;
  };
//---
struct JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE_V2
  {
   long              MaxIops;
   long              MaxBandwidth;
   long              ReservationIops;
   string            VolumeName;
   uint              BaseIoSize;
   JOB_OBJECT_IO_RATE_CONTROL_FLAGS ControlFlags;
   ushort            VolumeNameLength;
   long              CriticalReservationIops;
   long              ReservationBandwidth;
   long              CriticalReservationBandwidth;
   long              MaxTimePercent;
   long              ReservationTimePercent;
   long              CriticalReservationTimePercent;
  };
//---
struct JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE_V3
  {
   long              MaxIops;
   long              MaxBandwidth;
   long              ReservationIops;
   string            VolumeName;
   uint              BaseIoSize;
   JOB_OBJECT_IO_RATE_CONTROL_FLAGS ControlFlags;
   ushort            VolumeNameLength;
   long              CriticalReservationIops;
   long              ReservationBandwidth;
   long              CriticalReservationBandwidth;
   long              MaxTimePercent;
   long              ReservationTimePercent;
   long              CriticalReservationTimePercent;
   long              SoftMaxIops;
   long              SoftMaxBandwidth;
   long              SoftMaxTimePercent;
   long              LimitExcessNotifyIops;
   long              LimitExcessNotifyBandwidth;
   long              LimitExcessNotifyTimePercent;
  };
//---
struct JOBOBJECT_IO_ATTRIBUTION_STATS
  {
   ulong             IoCount;
   ulong             TotalNonOverlappedQueueTime;
   ulong             TotalNonOverlappedServiceTime;
   ulong             TotalSize;
  };
//---
struct JOBOBJECT_IO_ATTRIBUTION_INFORMATION
  {
   uint              ControlFlags;
   JOBOBJECT_IO_ATTRIBUTION_STATS ReadStats;
   JOBOBJECT_IO_ATTRIBUTION_STATS WriteStats;
  };
//---
struct SILOOBJECT_BASIC_INFORMATION
  {
   uint              SiloId;
   uint              SiloParentId;
   uint              NumberOfProcesses;
   uchar             IsInServerSilo;
   uchar             Reserved[3];
  };
//---
struct SERVERSILO_BASIC_INFORMATION
  {
   uint              ServiceSessionId;
   SERVERSILO_STATE  State;
   uint              ExitStatus;
  };
//---
struct CACHE_DESCRIPTOR
  {
   uchar             Level;
   uchar             Associativity;
   ushort            LineSize;
   uint              Size;
   PROCESSOR_CACHE_TYPE Type;
  };
//---
struct ProcessorCore
  {
   ulong             ProcessorMask;
   LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
   uchar             Flags;
  };
//---
struct PROCESSOR_RELATIONSHIP
  {
   uchar             Flags;
   uchar             EfficiencyClass;
   uchar             Reserved[20];
   ushort            GroupCount;
   GROUP_AFFINITY    GroupMask[ANYSIZE_ARRAY];
  };
//---
struct NUMA_NODE_RELATIONSHIP
  {
   uint              NodeNumber;
   uchar             Reserved[20];
   GROUP_AFFINITY    GroupMask;
  };
//---
struct CACHE_RELATIONSHIP
  {
   uchar             Level;
   uchar             Associativity;
   ushort            LineSize;
   uint              CacheSize;
   PROCESSOR_CACHE_TYPE Type;
   uchar             Reserved[20];
   GROUP_AFFINITY    GroupMask;
  };
//---
struct PROCESSOR_GROUP_INFO
  {
   uchar             MaximumProcessorCount;
   uchar             ActiveProcessorCount;
   uchar             Reserved[38];
   ulong             ActiveProcessorMask;
  };
//---
struct GROUP_RELATIONSHIP
  {
   ushort            MaximumGroupCount;
   ushort            ActiveGroupCount;
   uchar             Reserved[20];
   PROCESSOR_GROUP_INFO GroupInfo[ANYSIZE_ARRAY];
  };
//---
struct SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION
  {
   ulong             CycleTime;
  };
//---
struct XSTATE_FEATURE
  {
   uint              Offset;
   uint              Size;
  };
//---
struct XSTATE_CONFIGURATION
  {
   ulong             EnabledFeatures;
   ulong             EnabledVolatileFeatures;
   uint              Size;
   uint              ControlFlags;
   XSTATE_FEATURE    Features[MAXIMUM_XSTATE_FEATURES];
   ulong             EnabledSupervisorFeatures;
   ulong             AlignedFeatures;
   uint              AllFeatureSize;
   uint              AllFeatures[MAXIMUM_XSTATE_FEATURES];
  };
//---
struct MEMORY_BASIC_INFORMATION
  {
   PVOID             BaseAddress;
   PVOID             AllocationBase;
   uint              AllocationProtect;
   ulong             RegionSize;
   uint              State;
   uint              Protect;
   uint              Type;
  };
//---
struct MEMORY_BASIC_INFORMATION32
  {
   uint              BaseAddress;
   uint              AllocationBase;
   uint              AllocationProtect;
   uint              RegionSize;
   uint              State;
   uint              Protect;
   uint              Type;
  };
//---
struct MEMORY_BASIC_INFORMATION64
  {
   ulong             BaseAddress;
   ulong             AllocationBase;
   uint              AllocationProtect;
   uint              __alignment1;
   ulong             RegionSize;
   uint              State;
   uint              Protect;
   uint              Type;
   uint              __alignment2;
  };
//---
struct CFG_CALL_TARGET_INFO
  {
   ulong             Offset;
   ulong             Flags;
  };
//---
struct MEM_ADDRESS_REQUIREMENTS
  {
   PVOID             LowestStartingAddress;
   PVOID             HighestEndingAddress;
   ulong             Alignment;
  };
//---
struct ENCLAVE_CREATE_INFO_SGX
  {
   uchar             Secs[4096];
  };
//---
struct ENCLAVE_INIT_INFO_SGX
  {
   uchar             SigStruct[1808];
   uchar             Reserved1[240];
   uchar             EInitToken[304];
   uchar             Reserved2[1744];
  };
//---
struct ENCLAVE_CREATE_INFO_VBS
  {
   uint              Flags;
   uchar             OwnerID[32];
  };
//---
struct ENCLAVE_INIT_INFO_VBS
  {
   uint              Length;
   uint              ThreadCount;
  };
//---
struct FILE_ID_128
  {
   uchar             Identifier[16];
  };
//---
struct FILE_NOTIFY_INFORMATION
  {
   uint              NextEntryOffset;
   uint              Action;
   uint              FileNameLength;
   short             FileName[1];
  };
//---
struct FILE_NOTIFY_EXTENDED_INFORMATION
  {
   uint              NextEntryOffset;
   uint              Action;
   long              CreationTime;
   long              LastModificationTime;
   long              LastChangeTime;
   long              LastAccessTime;
   long              AllocatedLength;
   long              FileSize;
   uint              FileAttributes;
   uint              ReparsePointTag;
   long              FileId;
   long              ParentFileId;
   uint              FileNameLength;
   short             FileName[1];
  };
//---
struct GenericReparseBuffer
  {
   uint              ReparseTag;
   ushort            ReparseDataLength;
   ushort            Reserved;
   GUID              ReparseGuid;
   uchar             DataBuffer[1];
  };
//---
struct SCRUB_DATA_INPUT
  {
   uint              Size;
   uint              Flags;
   uint              MaximumIos;
   uint              ObjectId[4];
   uint              Reserved[13];
   uchar             ResumeContext[816];
  };
//---
struct SCRUB_PARITY_EXTENT
  {
   long              Offset;
   ulong             Length;
  };
//---
struct SCRUB_PARITY_EXTENT_DATA
  {
   ushort            Size;
   ushort            Flags;
   ushort            NumberOfParityExtents;
   ushort            MaximumNumberOfParityExtents;
   SCRUB_PARITY_EXTENT ParityExtents[ANYSIZE_ARRAY];
  };
//---
struct SCRUB_DATA_OUTPUT
  {
   uint              Size;
   uint              Flags;
   uint              Status;
   ulong             ErrorFileOffset;
   ulong             ErrorLength;
   ulong             NumberOfBytesRepaired;
   ulong             NumberOfBytesFailed;
   ulong             InternalFileReference;
   ushort            ResumeContextLength;
   ushort            ParityExtentDataOffset;
   uint              Reserved[5];
   uchar             ResumeContext[816];
  };
//---
struct SHARED_VIRTUAL_DISK_SUPPORT
  {
   SharedVirtualDiskSupportType SharedVirtualDiskSupport;
   SharedVirtualDiskHandleState HandleState;
  };
//---
struct NETWORK_APP_INSTANCE_EA
  {
   GUID              AppInstanceID;
   uint              CsvFlags;
  };
//---
struct CM_POWER_DATA
  {
   uint              PD_Size;
   DEVICE_POWER_STATE PD_MostRecentPowerState;
   uint              PD_Capabilities;
   uint              PD_D1Latency;
   uint              PD_D2Latency;
   uint              PD_D3Latency;
   DEVICE_POWER_STATE PD_PowerStateMapping[POWER_SYSTEM_MAXIMUM];
   SYSTEM_POWER_STATE PD_DeepestSystemWake;
  };
//---
struct POWER_USER_PRESENCE
  {
   POWER_USER_PRESENCE_TYPE UserPresence;
  };
//---
struct POWER_SESSION_CONNECT
  {
   uchar             Connected;
   uchar             Console;
  };
//---
struct POWER_SESSION_TIMEOUTS
  {
   uint              InputTimeout;
   uint              DisplayTimeout;
  };
//---
struct POWER_SESSION_RIT_STATE
  {
   uchar             Active;
   uint              LastInputTime;
  };
//---
struct POWER_SESSION_WINLOGON
  {
   uint              SessionId;
   uchar             Console;
   uchar             Locked;
  };
//---
struct POWER_IDLE_RESILIENCY
  {
   uint              CoalescingTimeout;
   uint              IdleResiliencyPeriod;
  };
//---
struct POWER_MONITOR_INVOCATION
  {
   uchar             Console;
   POWER_MONITOR_REQUEST_REASON RequestReason;
  };
//---
struct RESUME_PERFORMANCE
  {
   uint              PostTimeMs;
   ulong             TotalResumeTimeMs;
   ulong             ResumeCompleteTimestamp;
  };
//---
struct APPLICATIONLAUNCH_SETTING_VALUE
  {
   long              ActivationTime;
   uint              Flags;
   uint              ButtonInstanceID;
  };
//---
struct POWER_PLATFORM_INFORMATION
  {
   uchar             AoAc;
  };
//---
struct POWER_ACTION_POLICY
  {
   POWER_ACTION      Action;
   uint              Flags;
   uint              EventCode;
  };
//---
struct SYSTEM_POWER_LEVEL
  {
   uchar             Enable;
   uchar             Spare[3];
   uint              BatteryLevel;
   POWER_ACTION_POLICY PowerPolicy;
   SYSTEM_POWER_STATE MinSystemState;
  };
//---
struct SYSTEM_POWER_POLICY
  {
   uint              Revision;
   POWER_ACTION_POLICY PowerButton;
   POWER_ACTION_POLICY SleepButton;
   POWER_ACTION_POLICY LidClose;
   SYSTEM_POWER_STATE LidOpenWake;
   uint              Reserved;
   POWER_ACTION_POLICY Idle;
   uint              IdleTimeout;
   uchar             IdleSensitivity;
   uchar             DynamicThrottle;
   uchar             Spare2[2];
   SYSTEM_POWER_STATE MinSleep;
   SYSTEM_POWER_STATE MaxSleep;
   SYSTEM_POWER_STATE ReducedLatencySleep;
   uint              WinLogonFlags;
   uint              Spare3;
   uint              DozeS4Timeout;
   uint              BroadcastCapacityResolution;
   SYSTEM_POWER_LEVEL DischargePolicy[NUM_DISCHARGE_POLICIES];
   uint              VideoTimeout;
   uchar             VideoDimDisplay;
   uint              VideoReserved[3];
   uint              SpindownTimeout;
   uchar             OptimizeForPower;
   uchar             FanThrottleTolerance;
   uchar             ForcedThrottle;
   uchar             MinThrottle;
   POWER_ACTION_POLICY OverThrottled;
  };
//---
struct PROCESSOR_POWER_POLICY_INFO
  {
   uint              TimeCheck;
   uint              DemoteLimit;
   uint              PromoteLimit;
   uchar             DemotePercent;
   uchar             PromotePercent;
   uchar             Spare[2];
   uint              Flags;
  };
//---
struct PROCESSOR_POWER_POLICY
  {
   uint              Revision;
   uchar             DynamicThrottle;
   uchar             Spare[3];
   uint              Flags;
   uint              PolicyCount;
   PROCESSOR_POWER_POLICY_INFO Policy[3];
  };
//---
struct ADMINISTRATOR_POWER_POLICY
  {
   SYSTEM_POWER_STATE MinSleep;
   SYSTEM_POWER_STATE MaxSleep;
   uint              MinVideoTimeout;
   uint              MaxVideoTimeout;
   uint              MinSpindownTimeout;
   uint              MaxSpindownTimeout;
  };
//---
struct HIBERFILE_BUCKET
  {
   ulong             MaxPhysicalMemory;
   uint              PhysicalMemoryPercent[HIBERFILE_TYPE_MAX];
  };
//---
struct IMAGE_DOS_HEADER
  {
   ushort            e_magic;
   ushort            e_cblp;
   ushort            e_cp;
   ushort            e_crlc;
   ushort            e_cparhdr;
   ushort            e_minalloc;
   ushort            e_maxalloc;
   ushort            e_ss;
   ushort            e_sp;
   ushort            e_csum;
   ushort            e_ip;
   ushort            e_cs;
   ushort            e_lfarlc;
   ushort            e_ovno;
   ushort            e_res[4];
   ushort            e_oemid;
   ushort            e_oeminfo;
   ushort            e_res2[10];
   int               e_lfanew;
  };
//---
struct IMAGE_OS2_HEADER
  {
   ushort            ne_magic;
   char              ne_ver;
   char              ne_rev;
   ushort            ne_enttab;
   ushort            ne_cbenttab;
   int               ne_crc;
   ushort            ne_flags;
   ushort            ne_autodata;
   ushort            ne_heap;
   ushort            ne_stack;
   int               ne_csip;
   int               ne_sssp;
   ushort            ne_cseg;
   ushort            ne_cmod;
   ushort            ne_cbnrestab;
   ushort            ne_segtab;
   ushort            ne_rsrctab;
   ushort            ne_restab;
   ushort            ne_modtab;
   ushort            ne_imptab;
   int               ne_nrestab;
   ushort            ne_cmovent;
   ushort            ne_align;
   ushort            ne_cres;
   uchar             ne_exetyp;
   uchar             ne_flagsothers;
   ushort            ne_pretthunks;
   ushort            ne_psegrefbytes;
   ushort            ne_swaparea;
   ushort            ne_expver;
  };
//---
struct IMAGE_VXD_HEADER
  {
   ushort            e32_magic;
   uchar             e32_border;
   uchar             e32_ushorter;
   uint              e32_level;
   ushort            e32_cpu;
   ushort            e32_os;
   uint              e32_ver;
   uint              e32_mflags;
   uint              e32_mpages;
   uint              e32_startobj;
   uint              e32_eip;
   uint              e32_stackobj;
   uint              e32_esp;
   uint              e32_pagesize;
   uint              e32_lastpagesize;
   uint              e32_fixupsize;
   uint              e32_fixupsum;
   uint              e32_ldrsize;
   uint              e32_ldrsum;
   uint              e32_objtab;
   uint              e32_objcnt;
   uint              e32_objmap;
   uint              e32_itermap;
   uint              e32_rsrctab;
   uint              e32_rsrccnt;
   uint              e32_restab;
   uint              e32_enttab;
   uint              e32_dirtab;
   uint              e32_dircnt;
   uint              e32_fpagetab;
   uint              e32_frectab;
   uint              e32_impmod;
   uint              e32_impmodcnt;
   uint              e32_impproc;
   uint              e32_pagesum;
   uint              e32_datapage;
   uint              e32_preload;
   uint              e32_nrestab;
   uint              e32_cbnrestab;
   uint              e32_nressum;
   uint              e32_autodata;
   uint              e32_debuginfo;
   uint              e32_debuglen;
   uint              e32_instpreload;
   uint              e32_instdemand;
   uint              e32_heapsize;
   uchar             e32_res3[12];
   uint              e32_winresoff;
   uint              e32_winreslen;
   ushort            e32_devid;
   ushort            e32_ddkver;
  };
//---
struct IMAGE_FILE_HEADER
  {
   ushort            Machine;
   ushort            NumberOfSections;
   uint              TimeDateStamp;
   uint              PointerToSymbolTable;
   uint              NumberOfSymbols;
   ushort            SizeOfOptionalHeader;
   ushort            Characteristics;
  };
//---
struct IMAGE_DATA_DIRECTORY
  {
   uint              VirtualAddress;
   uint              Size;
  };
//---
struct IMAGE_OPTIONAL_HEADER32
  {
   ushort            Magic;
   uchar             MajorLinkerVersion;
   uchar             MinorLinkerVersion;
   uint              SizeOfCode;
   uint              SizeOfInitializedData;
   uint              SizeOfUninitializedData;
   uint              AddressOfEntryPoint;
   uint              BaseOfCode;
   uint              BaseOfData;
   uint              ImageBase;
   uint              SectionAlignment;
   uint              FileAlignment;
   ushort            MajorOperatingSystemVersion;
   ushort            MinorOperatingSystemVersion;
   ushort            MajorImageVersion;
   ushort            MinorImageVersion;
   ushort            MajorSubsystemVersion;
   ushort            MinorSubsystemVersion;
   uint              Win32VersionValue;
   uint              SizeOfImage;
   uint              SizeOfHeaders;
   uint              CheckSum;
   ushort            Subsystem;
   ushort            DllCharacteristics;
   uint              SizeOfStackReserve;
   uint              SizeOfStackCommit;
   uint              SizeOfHeapReserve;
   uint              SizeOfHeapCommit;
   uint              LoaderFlags;
   uint              NumberOfRvaAndSizes;
   IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
  };
//---
struct IMAGE_ROM_OPTIONAL_HEADER
  {
   ushort            Magic;
   uchar             MajorLinkerVersion;
   uchar             MinorLinkerVersion;
   uint              SizeOfCode;
   uint              SizeOfInitializedData;
   uint              SizeOfUninitializedData;
   uint              AddressOfEntryPoint;
   uint              BaseOfCode;
   uint              BaseOfData;
   uint              BaseOfBss;
   uint              GprMask;
   uint              CprMask[4];
   uint              GpValue;
  };
//---
struct IMAGE_OPTIONAL_HEADER64
  {
   ushort            Magic;
   uchar             MajorLinkerVersion;
   uchar             MinorLinkerVersion;
   uint              SizeOfCode;
   uint              SizeOfInitializedData;
   uint              SizeOfUninitializedData;
   uint              AddressOfEntryPoint;
   uint              BaseOfCode;
   ulong             ImageBase;
   uint              SectionAlignment;
   uint              FileAlignment;
   ushort            MajorOperatingSystemVersion;
   ushort            MinorOperatingSystemVersion;
   ushort            MajorImageVersion;
   ushort            MinorImageVersion;
   ushort            MajorSubsystemVersion;
   ushort            MinorSubsystemVersion;
   uint              Win32VersionValue;
   uint              SizeOfImage;
   uint              SizeOfHeaders;
   uint              CheckSum;
   ushort            Subsystem;
   ushort            DllCharacteristics;
   ulong             SizeOfStackReserve;
   ulong             SizeOfStackCommit;
   ulong             SizeOfHeapReserve;
   ulong             SizeOfHeapCommit;
   uint              LoaderFlags;
   uint              NumberOfRvaAndSizes;
   IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
  };
//---
struct IMAGE_NT_HEADERS64
  {
   uint              Signature;
   IMAGE_FILE_HEADER FileHeader;
   IMAGE_OPTIONAL_HEADER64 OptionalHeader;
  };
//---
struct IMAGE_NT_HEADERS32
  {
   uint              Signature;
   IMAGE_FILE_HEADER FileHeader;
   IMAGE_OPTIONAL_HEADER32 OptionalHeader;
  };
//---
struct IMAGE_ROM_HEADERS
  {
   IMAGE_FILE_HEADER FileHeader;
   IMAGE_ROM_OPTIONAL_HEADER OptionalHeader;
  };
//---
struct ANON_OBJECT_HEADER
  {
   ushort            Sig1;
   ushort            Sig2;
   ushort            Version;
   ushort            Machine;
   uint              TimeDateStamp;
   GUID              ClassID;
   uint              SizeOfData;
  };
//---
struct ANON_OBJECT_HEADER_V2
  {
   ushort            Sig1;
   ushort            Sig2;
   ushort            Version;
   ushort            Machine;
   uint              TimeDateStamp;
   GUID              ClassID;
   uint              SizeOfData;
   uint              Flags;
   uint              MetaDataSize;
   uint              MetaDataOffset;
  };
//---
struct ANON_OBJECT_HEADER_BIGOBJ
  {
   ushort            Sig1;
   ushort            Sig2;
   ushort            Version;
   ushort            Machine;
   uint              TimeDateStamp;
   GUID              ClassID;
   uint              SizeOfData;
   uint              Flags;
   uint              MetaDataSize;
   uint              MetaDataOffset;
   uint              NumberOfSections;
   uint              PointerToSymbolTable;
   uint              NumberOfSymbols;
  };
//---
struct IMAGE_SECTION_HEADER
  {
   uchar             Name[IMAGE_SIZEOF_SHORT_NAME];
   uint              PhysicalAddress;
   uint              VirtualAddress;
   uint              SizeOfRawData;
   uint              PointerToRawData;
   uint              PointerToRelocations;
   uint              PointerToLinenumbers;
   ushort            NumberOfRelocations;
   ushort            NumberOfLinenumbers;
   uint              Characteristics;
  };
//---
struct IMAGE_SYMBOL
  {
   uchar             ShortName[8];
   uint              Value;
   short             SectionNumber;
   ushort            Type;
   uchar             StorageClass;
   uchar             NumberOfAuxSymbols;
  };
//---
struct IMAGE_SYMBOL_EX
  {
   uchar             ShortName[8];
   uint              Value;
   int               SectionNumber;
   ushort            Type;
   uchar             StorageClass;
   uchar             NumberOfAuxSymbols;
  };
//---
struct IMAGE_AUX_SYMBOL_TOKEN_DEF
  {
   uchar             bAuxType;
   uchar             bReserved;
   uint              SymbolTableIndex;
   uchar             rgbReserved[12];
  };
//---
struct IMAGE_LINENUMBER
  {
   uint              VirtualAddress;
   ushort            Linenumber;
  };
//---
struct IMAGE_BASE_RELOCATION
  {
   uint              VirtualAddress;
   uint              SizeOfBlock;
  };
//---
struct IMAGE_ARCHIVE_MEMBER_HEADER
  {
   uchar             Name[16];
   uchar             Date[12];
   uchar             UserID[6];
   uchar             GroupID[6];
   uchar             Mode[8];
   uchar             Size[10];
   uchar             EndHeader[2];
  };
//---
struct IMAGE_EXPORT_DIRECTORY
  {
   uint              Characteristics;
   uint              TimeDateStamp;
   ushort            MajorVersion;
   ushort            MinorVersion;
   uint              Name;
   uint              Base;
   uint              NumberOfFunctions;
   uint              NumberOfNames;
   uint              AddressOfFunctions;
   uint              AddressOfNames;
   uint              AddressOfNameOrdinals;
  };
//---
struct IMAGE_IMPORT_BY_NAME
  {
   ushort            Hint;
   char              Name[1];
  };
//---
struct IMAGE_THUNK_DATA64
  {
   ulong             Data;
  };
//---
struct IMAGE_THUNK_DATA32
  {
   uint              Data;
  };
//---
struct IMAGE_BOUND_IMPORT_DESCRIPTOR
  {
   uint              TimeDateStamp;
   ushort            OffsetModuleName;
   ushort            NumberOfModuleForwarderRefs;
  };
//---
struct IMAGE_BOUND_FORWARDER_REF
  {
   uint              TimeDateStamp;
   ushort            OffsetModuleName;
   ushort            Reserved;
  };
//---
struct IMAGE_RESOURCE_DIRECTORY
  {
   uint              Characteristics;
   uint              TimeDateStamp;
   ushort            MajorVersion;
   ushort            MinorVersion;
   ushort            NumberOfNamedEntries;
   ushort            NumberOfIdEntries;
  };
//---
struct IMAGE_RESOURCE_DIRECTORY_STRING
  {
   ushort            Length;
   char              NameString[1];
  };
//---
struct IMAGE_RESOURCE_DIR_STRING_U
  {
   ushort            Length;
   short             NameString[1];
  };
//---
struct IMAGE_RESOURCE_DATA_ENTRY
  {
   uint              OffsetToData;
   uint              Size;
   uint              CodePage;
   uint              Reserved;
  };
//---
struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY
  {
   ushort            Flags;
   ushort            Catalog;
   uint              CatalogOffset;
   uint              Reserved;
  };
//---
struct IMAGE_DYNAMIC_RELOCATION_TABLE
  {
   uint              Version;
   uint              Size;
  };
//---
struct IMAGE_DYNAMIC_RELOCATION32
  {
   uint              Symbol;
   uint              BaseRelocSize;
  };
//---
struct IMAGE_DYNAMIC_RELOCATION64
  {
   ulong             Symbol;
   uint              BaseRelocSize;
  };
//---
struct IMAGE_DYNAMIC_RELOCATION32_V2
  {
   uint              HeaderSize;
   uint              FixupInfoSize;
   uint              Symbol;
   uint              SymbolGroup;
   uint              Flags;
  };
//---
struct IMAGE_DYNAMIC_RELOCATION64_V2
  {
   uint              HeaderSize;
   uint              FixupInfoSize;
   ulong             Symbol;
   uint              SymbolGroup;
   uint              Flags;
  };
//---
struct IMAGE_PROLOGUE_DYNAMIC_RELOCATION_HEADER
  {
   uchar             PrologueByteCount;
  };
//---
struct IMAGE_EPILOGUE_DYNAMIC_RELOCATION_HEADER
  {
   uint              EpilogueCount;
   uchar             EpilogueByteCount;
   uchar             BranchDescriptorElementSize;
   ushort            BranchDescriptorCount;
  };
//---
struct IMAGE_LOAD_CONFIG_DIRECTORY32
  {
   uint              Size;
   uint              TimeDateStamp;
   ushort            MajorVersion;
   ushort            MinorVersion;
   uint              GlobalFlagsClear;
   uint              GlobalFlagsSet;
   uint              CriticalSectionDefaultTimeout;
   uint              DeCommitFreeBlockThreshold;
   uint              DeCommitTotalFreeThreshold;
   uint              LockPrefixTable;
   uint              MaximumAllocationSize;
   uint              VirtualMemoryThreshold;
   uint              ProcessHeapFlags;
   uint              ProcessAffinityMask;
   ushort            CSDVersion;
   ushort            DependentLoadFlags;
   uint              EditList;
   uint              SecurityCookie;
   uint              SEHandlerTable;
   uint              SEHandlerCount;
   uint              GuardCFCheckFunctionPointer;
   uint              GuardCFDispatchFunctionPointer;
   uint              GuardCFFunctionTable;
   uint              GuardCFFunctionCount;
   uint              GuardFlags;
   IMAGE_LOAD_CONFIG_CODE_INTEGRITY CodeIntegrity;
   uint              GuardAddressTakenIatEntryTable;
   uint              GuardAddressTakenIatEntryCount;
   uint              GuardLongJumpTargetTable;
   uint              GuardLongJumpTargetCount;
   uint              DynamicValueRelocTable;
   uint              CHPEMetadataPointer;
   uint              GuardRFFailureRoutine;
   uint              GuardRFFailureRoutineFunctionPointer;
   uint              DynamicValueRelocTableOffset;
   ushort            DynamicValueRelocTableSection;
   ushort            Reserved2;
   uint              GuardRFVerifyStackPointerFunctionPointer;
   uint              HotPatchTableOffset;
   uint              Reserved3;
   uint              EnclaveConfigurationPointer;
  };
//---
struct IMAGE_LOAD_CONFIG_DIRECTORY64
  {
   uint              Size;
   uint              TimeDateStamp;
   ushort            MajorVersion;
   ushort            MinorVersion;
   uint              GlobalFlagsClear;
   uint              GlobalFlagsSet;
   uint              CriticalSectionDefaultTimeout;
   ulong             DeCommitFreeBlockThreshold;
   ulong             DeCommitTotalFreeThreshold;
   ulong             LockPrefixTable;
   ulong             MaximumAllocationSize;
   ulong             VirtualMemoryThreshold;
   ulong             ProcessAffinityMask;
   uint              ProcessHeapFlags;
   ushort            CSDVersion;
   ushort            DependentLoadFlags;
   ulong             EditList;
   ulong             SecurityCookie;
   ulong             SEHandlerTable;
   ulong             SEHandlerCount;
   ulong             GuardCFCheckFunctionPointer;
   ulong             GuardCFDispatchFunctionPointer;
   ulong             GuardCFFunctionTable;
   ulong             GuardCFFunctionCount;
   uint              GuardFlags;
   IMAGE_LOAD_CONFIG_CODE_INTEGRITY CodeIntegrity;
   ulong             GuardAddressTakenIatEntryTable;
   ulong             GuardAddressTakenIatEntryCount;
   ulong             GuardLongJumpTargetTable;
   ulong             GuardLongJumpTargetCount;
   ulong             DynamicValueRelocTable;
   ulong             CHPEMetadataPointer;
   ulong             GuardRFFailureRoutine;
   ulong             GuardRFFailureRoutineFunctionPointer;
   uint              DynamicValueRelocTableOffset;
   ushort            DynamicValueRelocTableSection;
   ushort            Reserved2;
   ulong             GuardRFVerifyStackPointerFunctionPointer;
   uint              HotPatchTableOffset;
   uint              Reserved3;
   ulong             EnclaveConfigurationPointer;
  };
//---
struct IMAGE_HOT_PATCH_INFO
  {
   uint              Version;
   uint              Size;
   uint              SequenceNumber;
   uint              BaseImageList;
   uint              BaseImageCount;
   uint              BufferOffset;
  };
//---
struct IMAGE_HOT_PATCH_BASE
  {
   uint              SequenceNumber;
   uint              Flags;
   uint              OriginalTimeDateStamp;
   uint              OriginalCheckSum;
   uint              CodeIntegrityInfo;
   uint              CodeIntegritySize;
   uint              PatchTable;
   uint              BufferOffset;
  };
//---
struct IMAGE_HOT_PATCH_HASHES
  {
   uchar             SHA256[32];
   uchar             SHA1[20];
  };
//---
struct IMAGE_CE_RUNTIME_FUNCTION_ENTRY
  {
   uint              FuncStart;
   uint              Flags;
  };
//---
struct IMAGE_ALPHA64_RUNTIME_FUNCTION_ENTRY
  {
   ulong             BeginAddress;
   ulong             EndAddress;
   ulong             ExceptionHandler;
   ulong             HandlerData;
   ulong             PrologEndAddress;
  };
//---
struct IMAGE_ALPHA_RUNTIME_FUNCTION_ENTRY
  {
   uint              BeginAddress;
   uint              EndAddress;
   uint              ExceptionHandler;
   uint              HandlerData;
   uint              PrologEndAddress;
  };
//---
struct IMAGE_ENCLAVE_CONFIG32
  {
   uint              Size;
   uint              MinimumRequiredConfigSize;
   uint              PolicyFlags;
   uint              NumberOfImports;
   uint              ImportList;
   uint              ImportEntrySize;
   uchar             FamilyID[IMAGE_ENCLAVE_SHORT_ID_LENGTH];
   uchar             ImageID[IMAGE_ENCLAVE_SHORT_ID_LENGTH];
   uint              ImageVersion;
   uint              SecurityVersion;
   uint              EnclaveSize;
   uint              NumberOfThreads;
   uint              EnclaveFlags;
  };
//---
struct IMAGE_ENCLAVE_CONFIG64
  {
   uint              Size;
   uint              MinimumRequiredConfigSize;
   uint              PolicyFlags;
   uint              NumberOfImports;
   uint              ImportList;
   uint              ImportEntrySize;
   uchar             FamilyID[IMAGE_ENCLAVE_SHORT_ID_LENGTH];
   uchar             ImageID[IMAGE_ENCLAVE_SHORT_ID_LENGTH];
   uint              ImageVersion;
   uint              SecurityVersion;
   ulong             EnclaveSize;
   uint              NumberOfThreads;
   uint              EnclaveFlags;
  };
//---
struct IMAGE_ENCLAVE_IMPORT
  {
   uint              MatchType;
   uint              MinimumSecurityVersion;
   uchar             UniqueOrAuthorID[IMAGE_ENCLAVE_LONG_ID_LENGTH];
   uchar             FamilyID[IMAGE_ENCLAVE_SHORT_ID_LENGTH];
   uchar             ImageID[IMAGE_ENCLAVE_SHORT_ID_LENGTH];
   uint              ImportName;
   uint              Reserved;
  };
//---
struct IMAGE_DEBUG_DIRECTORY
  {
   uint              Characteristics;
   uint              TimeDateStamp;
   ushort            MajorVersion;
   ushort            MinorVersion;
   uint              Type;
   uint              SizeOfData;
   uint              AddressOfRawData;
   uint              PointerToRawData;
  };
//---
struct IMAGE_COFF_SYMBOLS_HEADER
  {
   uint              NumberOfSymbols;
   uint              LvaToFirstSymbol;
   uint              NumberOfLinenumbers;
   uint              LvaToFirstLinenumber;
   uint              RvaToFirstByteOfCode;
   uint              RvaToLastByteOfCode;
   uint              RvaToFirstByteOfData;
   uint              RvaToLastByteOfData;
  };
//---
struct FPO_DATA
  {
   uint              ulOffStart;
   uint              cbProcSize;
   uint              cdwLocals;
   ushort            cdwParams;
   ushort            data;
  };
//---
struct IMAGE_DEBUG_MISC
  {
   uint              DataType;
   uint              Length;
   uchar             Unicode;
   uchar             Reserved[3];
   uchar             Data[1];
  };
//---
struct IMAGE_FUNCTION_ENTRY
  {
   uint              StartingAddress;
   uint              EndingAddress;
   uint              EndOfPrologue;
  };
//---
struct IMAGE_SEPARATE_DEBUG_HEADER
  {
   ushort            Signature;
   ushort            Flags;
   ushort            Machine;
   ushort            Characteristics;
   uint              TimeDateStamp;
   uint              CheckSum;
   uint              ImageBase;
   uint              SizeOfImage;
   uint              NumberOfSections;
   uint              ExportedNamesSize;
   uint              DebugDirectorySize;
   uint              SectionAlignment;
   uint              Reserved[2];
  };
//---
struct NON_PAGED_DEBUG_INFO
  {
   ushort            Signature;
   ushort            Flags;
   uint              Size;
   ushort            Machine;
   ushort            Characteristics;
   uint              TimeDateStamp;
   uint              CheckSum;
   uint              SizeOfImage;
   ulong             ImageBase;
  };
//---
struct IMAGE_ARCHITECTURE_HEADER
  {
   int               mask;
   uint              FirstEntryRVA;
  };
//---
struct IMAGE_ARCHITECTURE_ENTRY
  {
   uint              FixupInstRVA;
   uint              NewInst;
  };
//---
struct SLIST_ENTRY
  {
   PVOID             Next;
  };
//---
struct RTL_BARRIER
  {
   uint              Reserved1;
   uint              Reserved2;
   ulong             Reserved3[2];
   uint              Reserved4;
   uint              Reserved5;
  };
//---
struct MESSAGE_RESOURCE_ENTRY
  {
   ushort            Length;
   ushort            Flags;
   uchar             Text[1];
  };
//---
struct MESSAGE_RESOURCE_BLOCK
  {
   uint              LowId;
   uint              HighId;
   uint              OffsetToEntries;
  };
//---
struct MESSAGE_RESOURCE_DATA
  {
   uint              NumberOfBlocks;
   MESSAGE_RESOURCE_BLOCK Blocks[1];
  };
//---
struct OSVERSIONINFOW
  {
   uint              dwOSVersionInfoSize;
   uint              dwMajorVersion;
   uint              dwMinorVersion;
   uint              dwBuildNumber;
   uint              dwPlatformId;
   ushort            szCSDVersion[128];
  };
//---
struct OSVERSIONINFOEXW
  {
   uint              dwOSVersionInfoSize;
   uint              dwMajorVersion;
   uint              dwMinorVersion;
   uint              dwBuildNumber;
   uint              dwPlatformId;
   short             szCSDVersion[128];
   ushort            wServicePackMajor;
   ushort            wServicePackMinor;
   ushort            wSuiteMask;
   uchar             wProductType;
   uchar             wReserved;
  };
//---
struct NV_MEMORY_RANGE
  {
   PVOID             BaseAddress;
   ulong             Length;
  };
//---
struct CORRELATION_VECTOR
  {
   char              Version;
   char              Vector[RTL_CORRELATION_VECTOR_STRING_LENGTH];
  };
//---
struct CUSTOM_SYSTEM_EVENT_TRIGGER_CONFIG
  {
   uint              Size;
   const string      TriggerId;
  };
//---
struct IMAGE_POLICY_ENTRY
  {
   IMAGE_POLICY_ENTRY_TYPE Type;
   IMAGE_POLICY_ID   PolicyId;
   PVOID             Value;
  };
//---
struct IMAGE_POLICY_METADATA
  {
   uchar             Version;
   uchar             Reserved0[7];
   ulong             ApplicationId;
   IMAGE_POLICY_ENTRY Policies[];
  };
//---
struct RTL_CRITICAL_SECTION_DEBUG
  {
   ushort            Type;
   ushort            CreatorBackTraceIndex;
   PVOID             CriticalSection;
   LIST_ENTRY        ProcessLocksList;
   uint              EntryCount;
   uint              ContentionCount;
   uint              Flags;
   ushort            CreatorBackTraceIndexHigh;
   ushort            Spareushort;
  };
//---
struct RTL_CRITICAL_SECTION
  {
   PVOID             DebugInfo;
   int               LockCount;
   int               RecursionCount;
   HANDLE            OwningThread;
   HANDLE            LockSemaphore;
   ulong             SpinCount;
  };
//---
struct RTL_SRWLOCK
  {
   PVOID             Ptr;
  };
//---
struct RTL_CONDITION_VARIABLE
  {
   PVOID             Ptr;
  };
//---
struct HEAP_OPTIMIZE_RESOURCES_INFORMATION
  {
   uint              Version;
   uint              Flags;
  };
//---
struct ACTIVATION_CONTEXT_QUERY_INDEX
  {
   uint              ulAssemblyIndex;
   uint              ulFileIndexInAssembly;
  };
//---
struct ASSEMBLY_FILE_DETAILED_INFORMATION
  {
   uint              ulFlags;
   uint              ulFilenameLength;
   uint              ulPathLength;
   const string      lpFileName;
   const string      lpFilePath;
  };
//---
struct ACTIVATION_CONTEXT_ASSEMBLY_DETAILED_INFORMATION
  {
   uint              ulFlags;
   uint              ulEncodedAssemblyIdentityLength;
   uint              ulManifestPathType;
   uint              ulManifestPathLength;
   long              liManifestLastWriteTime;
   uint              ulPolicyPathType;
   uint              ulPolicyPathLength;
   long              liPolicyLastWriteTime;
   uint              ulMetadataSatelliteRosterIndex;
   uint              ulManifestVersionMajor;
   uint              ulManifestVersionMinor;
   uint              ulPolicyVersionMajor;
   uint              ulPolicyVersionMinor;
   uint              ulAssemblyDirectoryNameLength;
   const string      lpAssemblyEncodedAssemblyIdentity;
   const string      lpAssemblyManifestPath;
   const string      lpAssemblyPolicyPath;
   const string      lpAssemblyDirectoryName;
   uint              ulFileCount;
  };
//---
struct ACTIVATION_CONTEXT_RUN_LEVEL_INFORMATION
  {
   uint              ulFlags;
   ACTCTX_REQUESTED_RUN_LEVEL RunLevel;
   uint              UiAccess;
  };
//---
struct COMPATIBILITY_CONTEXT_ELEMENT
  {
   GUID              Id;
   ACTCTX_COMPATIBILITY_ELEMENT_TYPE Type;
  };
//---
struct ACTIVATION_CONTEXT_COMPATIBILITY_INFORMATION
  {
   uint              ElementCount;
   COMPATIBILITY_CONTEXT_ELEMENT Elements[];
  };
//---
struct SUPPORTED_OS_INFO
  {
   ushort            MajorVersion;
   ushort            MinorVersion;
  };
//---
struct ACTIVATION_CONTEXT_DETAILED_INFORMATION
  {
   uint              dwFlags;
   uint              ulFormatVersion;
   uint              ulAssemblyCount;
   uint              ulRootManifestPathType;
   uint              ulRootManifestPathChars;
   uint              ulRootConfigurationPathType;
   uint              ulRootConfigurationPathChars;
   uint              ulAppDirPathType;
   uint              ulAppDirPathChars;
   const string      lpRootManifestPath;
   const string      lpRootConfigurationPath;
   const string      lpAppDirPath;
  };
//---
struct HARDWARE_COUNTER_DATA
  {
   HARDWARE_COUNTER_TYPE Type;
   uint              Reserved;
   ulong             Value;
  };
//---
struct PERFORMANCE_DATA
  {
   ushort            Size;
   uchar             Version;
   uchar             HwCountersCount;
   uint              ContextSwitchCount;
   ulong             WaitReasonBitMap;
   ulong             CycleTime;
   uint              RetryCount;
   uint              Reserved;
   HARDWARE_COUNTER_DATA HwCounters[MAX_HW_COUNTERS];
  };
//---
struct EVENTLOGRECORD
  {
   uint              Length;
   uint              Reserved;
   uint              RecordNumber;
   uint              TimeGenerated;
   uint              TimeWritten;
   uint              EventID;
   ushort            EventType;
   ushort            NumStrings;
   ushort            EventCategory;
   ushort            ReservedFlags;
   uint              ClosingRecordNumber;
   uint              StringOffset;
   uint              UserSidLength;
   uint              UserSidOffset;
   uint              DataLength;
   uint              DataOffset;
  };
//---
struct TAPE_ERASE
  {
   uint              Type;
   uchar             Immediate;
  };
//---
struct TAPE_PREPARE
  {
   uint              Operation;
   uchar             Immediate;
  };
//---
struct TAPE_WRITE_MARKS
  {
   uint              Type;
   uint              Count;
   uchar             Immediate;
  };
//---
struct TAPE_GET_POSITION
  {
   uint              Type;
   uint              Partition;
   long              Offset;
  };
//---
struct TAPE_SET_POSITION
  {
   uint              Method;
   uint              Partition;
   long              Offset;
   uchar             Immediate;
  };
//---
struct TAPE_GET_DRIVE_PARAMETERS
  {
   uchar             ECC;
   uchar             Compression;
   uchar             DataPadding;
   uchar             ReportSetmarks;
   uint              DefaultBlockSize;
   uint              MaximumBlockSize;
   uint              MinimumBlockSize;
   uint              MaximumPartitionCount;
   uint              FeaturesLow;
   uint              FeaturesHigh;
   uint              EOTWarningZoneSize;
  };
//---
struct TAPE_SET_DRIVE_PARAMETERS
  {
   uchar             ECC;
   uchar             Compression;
   uchar             DataPadding;
   uchar             ReportSetmarks;
   uint              EOTWarningZoneSize;
  };
//---
struct TAPE_GET_MEDIA_PARAMETERS
  {
   long              Capacity;
   long              Remaining;
   uint              BlockSize;
   uint              PartitionCount;
   uchar             WriteProtected;
  };
//---
struct TAPE_SET_MEDIA_PARAMETERS
  {
   uint              BlockSize;
  };
//---
struct TAPE_CREATE_PARTITION
  {
   uint              Method;
   uint              Count;
   uint              Size;
  };
//---
struct TAPE_WMI_OPERATIONS
  {
   uint              Method;
   uint              DataBufferSize;
   PVOID             DataBuffer;
  };
//---
struct TRANSACTION_BASIC_INFORMATION
  {
   GUID              TransactionId;
   uint              State;
   uint              Outcome;
  };
//---
struct TRANSACTIONMANAGER_BASIC_INFORMATION
  {
   GUID              TmIdentity;
   long              VirtualClock;
  };
//---
struct TRANSACTIONMANAGER_LOG_INFORMATION
  {
   GUID              LogIdentity;
  };
//---
struct TRANSACTIONMANAGER_LOGPATH_INFORMATION
  {
   uint              LogPathLength;
   short             LogPath[1];
  };
//---
struct TRANSACTIONMANAGER_RECOVERY_INFORMATION
  {
   ulong             LastRecoveredLsn;
  };
//---
struct TRANSACTIONMANAGER_OLDEST_INFORMATION
  {
   GUID              OldestTransactionGuid;
  };
//---
struct TRANSACTION_PROPERTIES_INFORMATION
  {
   uint              IsolationLevel;
   uint              IsolationFlags;
   long              Timeout;
   uint              Outcome;
   uint              DescriptionLength;
   short             Description[1];
  };
//---
struct TRANSACTION_BIND_INFORMATION
  {
   HANDLE            TmHandle;
  };
//---
struct TRANSACTION_ENLISTMENT_PAIR
  {
   GUID              EnlistmentId;
   GUID              ResourceManagerId;
  };
//---
struct TRANSACTION_ENLISTMENTS_INFORMATION
  {
   uint              NumberOfEnlistments;
   TRANSACTION_ENLISTMENT_PAIR EnlistmentPair[1];
  };
//---
struct TRANSACTION_SUPERIOR_ENLISTMENT_INFORMATION
  {
   TRANSACTION_ENLISTMENT_PAIR SuperiorEnlistmentPair;
  };
//---
struct RESOURCEMANAGER_BASIC_INFORMATION
  {
   GUID              ResourceManagerId;
   uint              DescriptionLength;
   short             Description[1];
  };
//---
struct RESOURCEMANAGER_COMPLETION_INFORMATION
  {
   HANDLE            IoCompletionPortHandle;
   ulong             CompletionKey;
  };
//---
struct ENLISTMENT_BASIC_INFORMATION
  {
   GUID              EnlistmentId;
   GUID              TransactionId;
   GUID              ResourceManagerId;
  };
//---
struct ENLISTMENT_CRM_INFORMATION
  {
   GUID              CrmTransactionManagerId;
   GUID              CrmResourceManagerId;
   GUID              CrmEnlistmentId;
  };
//---
struct TRANSACTION_LIST_ENTRY
  {
   GUID              UOW;
  };
//---
struct TRANSACTION_LIST_INFORMATION
  {
   uint              NumberOfTransactions;
   TRANSACTION_LIST_ENTRY TransactionInformation[1];
  };
//---
struct KTMOBJECT_CURSOR
  {
   GUID              LastQuery;
   uint              ObjectIdCount;
   GUID              ObjectIds[1];
  };
//---
struct TP_POOL_STACK_INFORMATION
  {
   ulong             StackReserve;
   ulong             StackCommit;
  };
//---
struct TP_CALLBACK_ENVIRON_V3
  {
   uint              Version;
   PVOID             Pool;
   PVOID             CleanupGroup;
   PVOID             CleanupGroupCancelCallback;
   PVOID             RaceDll;
   PVOID             ActivationContext;
   PVOID             FinalizationCallback;
   uint              Flags;
   TP_CALLBACK_PRIORITY CallbackPriority;
   uint              Size;
  };
//---
struct SYSTEM_LOGICAL_PROCESSOR_INFORMATION
  {
   ulong             ProcessorMask;
   LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
   uchar             offset[4];
   ulong             Reserved[2];
  };
//---
struct SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX
  {
   LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
   uint              Size;
   uchar             info[72];
  };
//---
struct SYSTEM_CPU_SET_INFORMATION
  {
   uint              Size;
   CPU_SET_INFORMATION_TYPE Type;
   uint              Id;
   ushort            Group;
   uchar             LogicalProcessorIndex;
   uchar             CoreIndex;
   uchar             LastLevelCacheIndex;
   uchar             NumaNodeIndex;
   uchar             EfficiencyClass;
   uchar             AllFlags;
   uint              Reserved;
   ulong             AllocationTag;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "kernel32.dll"
ushort   RtlCaptureStackBackTrace(uint frames_to_skip,uint frames_to_capture,PVOID &back_trace[],uint &back_trace_hash);
ulong    RtlCompareMemory(const uchar &source1[],const uchar &source2[],ulong length);
ulong    VerSetConditionMask(ulong condition_mask,uint type_mask,uchar condition);
#import

#import "Win32k.sys"
void     RtlCaptureContext(PVOID context_record);
void     RtlUnwind(PVOID target_frame,PVOID target_ip,EXCEPTION_RECORD &exception_record,PVOID return_value);
PVOID    RtlLookupFunctionEntry(ulong control_pc,PVOID image_base,UNWIND_HISTORY_TABLE &history_table);
void     RtlUnwindEx(PVOID target_frame,PVOID target_ip,EXCEPTION_RECORD &exception_record,PVOID return_value,PVOID context_record,UNWIND_HISTORY_TABLE &history_table);
PVOID    RtlVirtualUnwind(uint handler_type,ulong image_base,ulong control_pc,PVOID function_entry,PVOID context_record,PVOID &handler_data,PVOID establisher_frame,KNONVOLATILE_CONTEXT_POINTERS &context_pointers);
PVOID    RtlLookupFunctionEntry(ulong control_pc,uint &image_base,UNWIND_HISTORY_TABLE &history_table);
void     RtlUnwindEx(PVOID target_frame,PVOID target_ip,EXCEPTION_RECORD &exception_record,PVOID return_value,PVOID context_record,UNWIND_HISTORY_TABLE &history_table);
PVOID    RtlVirtualUnwind(uint handler_type,uint image_base,uint control_pc,PVOID function_entry,PVOID context_record,PVOID &handler_data,uint &establisher_frame,KNONVOLATILE_CONTEXT_POINTERS &context_pointers);
PVOID    RtlLookupFunctionEntry(ulong control_pc,PVOID image_base,UNWIND_HISTORY_TABLE &history_table);
void     RtlUnwindEx(PVOID target_frame,PVOID target_ip,EXCEPTION_RECORD &exception_record,PVOID return_value,PVOID context_record,UNWIND_HISTORY_TABLE &history_table);
PVOID    RtlVirtualUnwind(uint handler_type,ulong image_base,ulong control_pc,PVOID function_entry,PVOID context_record,PVOID &handler_data,PVOID establisher_frame,KNONVOLATILE_CONTEXT_POINTERS &context_pointers);
void     RtlUnwindEx(PVOID target_frame,PVOID target_ip,EXCEPTION_RECORD &exception_record,PVOID return_value,PVOID context_record,PVOID history_table);
PVOID    RtlPcToFileHeader(PVOID pc_value,PVOID &base_of_image);
#import
//+------------------------------------------------------------------+
-e 

//+------------------------------------------------------------------+
//|                                                       winreg.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>

//---
struct VALENTW
  {
   PVOID             ve_valuename;
   uint              ve_valuelen;
   uchar             offset1[4];
   PVOID             ve_valueptr;
   uint              ve_type;
   uchar             offset2[4];
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "advapi32.dll"
int     AbortSystemShutdownW(string machine_name);
uint    CheckForHiberboot(uchar &hiberboot,uchar clear_flag);
uint    InitiateShutdownW(string machine_name,string message,uint grace_period,uint shutdown_flags,uint reason);
int     InitiateSystemShutdownExW(string machine_name,string message,uint timeout,int force_apps_closed,int reboot_after_shutdown,uint reason);
int     InitiateSystemShutdownW(string machine_name,string message,uint timeout,int force_apps_closed,int reboot_after_shutdown);
int     RegCloseKey(HANDLE key);
int     RegConnectRegistryExW(const string machine_name,HANDLE key,uint Flags,HANDLE &result);
int     RegConnectRegistryW(const string machine_name,HANDLE key,HANDLE &result);
int     RegCopyTreeW(HANDLE key_src,const string sub_key,HANDLE key_dest);
int     RegCreateKeyExW(HANDLE key,const string sub_key,PVOID reserved,string class_name,uint options,uint desired,PVOID security_attributes,HANDLE &result,uint &disposition);
int     RegCreateKeyTransactedW(HANDLE key,const string sub_key,PVOID reserved,string class_name,uint options,uint desired,PVOID security_attributes,HANDLE &result,uint &disposition,HANDLE transaction,PVOID extended_parameter);
int     RegCreateKeyW(HANDLE key,const string sub_key,HANDLE &result);
int     RegDeleteKeyExW(HANDLE key,const string sub_key,uint desired,PVOID reserved);
int     RegDeleteKeyTransactedW(HANDLE key,const string sub_key,uint desired,PVOID reserved,HANDLE transaction,PVOID extended_parameter);
int     RegDeleteKeyValueW(HANDLE key,const string sub_key,const string value_name);
int     RegDeleteKeyW(HANDLE key,const string sub_key);
int     RegDeleteTreeW(HANDLE key,const string sub_key);
int     RegDeleteValueW(HANDLE key,const string value_name);
int     RegDisablePredefinedCache(void);
int     RegDisablePredefinedCacheEx(void);
int     RegDisableReflectionKey(HANDLE base);
int     RegEnableReflectionKey(HANDLE base);
int     RegEnumKeyExW(HANDLE key,uint index,ushort &name[],uint &name_size,PVOID reserved,ushort &class_name[],uint &class_size,FILETIME &last_write_time);
int     RegEnumKeyW(HANDLE key,uint index,ushort &name[],uint &name_size);
int     RegEnumValueW(HANDLE key,uint index,ushort &value_name[],uint &value_name_size,PVOID reserved,uint &type,uchar &data[],uint &data_size);
int     RegFlushKey(HANDLE key);
int     RegGetKeySecurity(HANDLE key,uint SecurityInformation,SECURITY_DESCRIPTOR &security_descriptor,uint &security_descriptor_size);
int     RegGetValueW(HANDLE key,const string sub_key,const string value,uint flags,uint &type,uchar &data[],uint &data_size);
int     RegLoadAppKeyW(const string file,HANDLE &result,uint desired,uint options,PVOID reserved);
int     RegLoadKeyW(HANDLE key,const string sub_key,const string file);
int     RegLoadMUIStringW(HANDLE key,const string value,ushort &out_buf[],uint &out_buf_size,uint &data,uint flags,const string directory);
int     RegNotifyChangeKeyValue(HANDLE key,int watch_subtree,uint notify_filter,HANDLE event,int asynchronous);
int     RegOpenCurrentUser(uint desired,HANDLE &result);
int     RegOpenKeyExW(HANDLE key,const string sub_key,uint options,uint desired,HANDLE &result);
int     RegOpenKeyTransactedW(HANDLE key,const string sub_key,uint options,uint desired,HANDLE &result,HANDLE transaction,PVOID extended_paremeter);
int     RegOpenKeyW(HANDLE key,const string sub_key,HANDLE &result);
int     RegOpenUserClassesRoot(HANDLE token,uint options,uint desired,HANDLE &result);
int     RegOverridePredefKey(HANDLE key,HANDLE new_key);
int     RegQueryInfoKeyW(HANDLE key,string class_name,uint &class_size,PVOID reserved,uint &sub_keys,uint &max_sub_key_len,uint &max_class_len,uint &values,uint &max_value_name_len,uint &max_value_len,uint &security_descriptor,FILETIME &last_write_time);
int     RegQueryMultipleValuesW(HANDLE key,VALENTW &val_list[],uint num_vals,ushort &value_buf[],uint &totsize);
int     RegQueryReflectionKey(HANDLE base,int &is_reflection_disabled);
int     RegQueryValueExW(HANDLE key,const string value_name,PVOID reserved,uint &type,uchar &data[],uint &data_size);
int     RegQueryValueW(HANDLE key,const string sub_key,uchar &data[],uint &data_size);
int     RegRenameKey(HANDLE key,const string sub_key_name,const string new_key_name);
int     RegReplaceKeyW(HANDLE key,const string sub_key,const string new_file,const string old_file);
int     RegRestoreKeyW(HANDLE key,const string file,uint flags);
int     RegSaveKeyExW(HANDLE key,const string file,PVOID security_attributes,uint flags);
int     RegSaveKeyW(HANDLE key,const string file,PVOID security_attributes);
int     RegSetKeySecurity(HANDLE key,uint SecurityInformation,SECURITY_DESCRIPTOR &security_descriptor);
int     RegSetKeyValueW(HANDLE key,const string sub_key,const string value_name,uint type,const uchar &data[],uint data);
int     RegSetValueExW(HANDLE key,const string value_name,PVOID reserved,uint type,const uchar &data[],uint data_size);
int     RegSetValueW(HANDLE key,const string sub_key,uint type,const ushort &data[],uint data_size);
int     RegUnLoadKeyW(HANDLE key,const string sub_key);
#import
//+------------------------------------------------------------------+-e 

//+------------------------------------------------------------------+
//|                                                       wingdi.mqh |
//|                             Copyright 2000-2024, MetaQuotes Ltd. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#include <WinAPI\windef.mqh>
#include <WinAPI\winnt.mqh>

//---
#define MM_MAX_AXES_NAMELEN   16
#define MM_MAX_NUMAXES        16
#define CCHDEVICENAME         32
#define LF_FACESIZE           32
#define LF_FULLFACESIZE       64
#define ELF_VENDOR_SIZE       4
#define CCHFORMNAME           32

//---
enum DISPLAYCONFIG_COLOR_ENCODING
  {
   DISPLAYCONFIG_COLOR_ENCODING_RGB=0,
   DISPLAYCONFIG_COLOR_ENCODING_YCBCR444=1,
   DISPLAYCONFIG_COLOR_ENCODING_YCBCR422=2,
   DISPLAYCONFIG_COLOR_ENCODING_YCBCR420=3,
   DISPLAYCONFIG_COLOR_ENCODING_INTENSITY=4,
   DISPLAYCONFIG_COLOR_ENCODING_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_DEVICE_INFO_TYPE
  {
   DISPLAYCONFIG_DEVICE_INFO_GET_SOURCE_NAME=1,
   DISPLAYCONFIG_DEVICE_INFO_GET_TARGET_NAME=2,
   DISPLAYCONFIG_DEVICE_INFO_GET_TARGET_PREFERRED_MODE=3,
   DISPLAYCONFIG_DEVICE_INFO_GET_ADAPTER_NAME=4,
   DISPLAYCONFIG_DEVICE_INFO_SET_TARGET_PERSISTENCE=5,
   DISPLAYCONFIG_DEVICE_INFO_GET_TARGET_BASE_TYPE=6,
   DISPLAYCONFIG_DEVICE_INFO_GET_SUPPORT_VIRTUAL_RESOLUTION=7,
   DISPLAYCONFIG_DEVICE_INFO_SET_SUPPORT_VIRTUAL_RESOLUTION=8,
   DISPLAYCONFIG_DEVICE_INFO_GET_ADVANCED_COLOR_INFO=9,
   DISPLAYCONFIG_DEVICE_INFO_SET_ADVANCED_COLOR_STATE=10,
   DISPLAYCONFIG_DEVICE_INFO_GET_SDR_WHITE_LEVEL=11,
   DISPLAYCONFIG_DEVICE_INFO_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_MODE_INFO_TYPE
  {
   DISPLAYCONFIG_MODE_INFO_TYPE_SOURCE=1,
   DISPLAYCONFIG_MODE_INFO_TYPE_TARGET=2,
   DISPLAYCONFIG_MODE_INFO_TYPE_DESKTOP_IMAGE=3,
   DISPLAYCONFIG_MODE_INFO_TYPE_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_PIXELFORMAT
  {
   DISPLAYCONFIG_PIXELFORMAT_8BPP=1,
   DISPLAYCONFIG_PIXELFORMAT_16BPP=2,
   DISPLAYCONFIG_PIXELFORMAT_24BPP=3,
   DISPLAYCONFIG_PIXELFORMAT_32BPP=4,
   DISPLAYCONFIG_PIXELFORMAT_NONGDI=5,
   DISPLAYCONFIG_PIXELFORMAT_FORCE_UINT32=0xffffffff
  };
//---
enum DISPLAYCONFIG_ROTATION
  {
   DISPLAYCONFIG_ROTATION_IDENTITY=1,
   DISPLAYCONFIG_ROTATION_ROTATE90=2,
   DISPLAYCONFIG_ROTATION_ROTATE180=3,
   DISPLAYCONFIG_ROTATION_ROTATE270=4,
   DISPLAYCONFIG_ROTATION_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_SCALING
  {
   DISPLAYCONFIG_SCALING_IDENTITY=1,
   DISPLAYCONFIG_SCALING_CENTERED=2,
   DISPLAYCONFIG_SCALING_STRETCHED=3,
   DISPLAYCONFIG_SCALING_ASPECTRATIOCENTEREDMAX=4,
   DISPLAYCONFIG_SCALING_CUSTOM=5,
   DISPLAYCONFIG_SCALING_PREFERRED=128,
   DISPLAYCONFIG_SCALING_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_SCANLINE_ORDERING
  {
   DISPLAYCONFIG_SCANLINE_ORDERING_UNSPECIFIED=0,
   DISPLAYCONFIG_SCANLINE_ORDERING_PROGRESSIVE=1,
   DISPLAYCONFIG_SCANLINE_ORDERING_INTERLACED=2,
   DISPLAYCONFIG_SCANLINE_ORDERING_INTERLACED_UPPERFIELDFIRST=DISPLAYCONFIG_SCANLINE_ORDERING_INTERLACED,
   DISPLAYCONFIG_SCANLINE_ORDERING_INTERLACED_LOWERFIELDFIRST=3,
   DISPLAYCONFIG_SCANLINE_ORDERING_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_TOPOLOGY_ID
  {
   DISPLAYCONFIG_TOPOLOGY_INTERNAL=0x00000001,
   DISPLAYCONFIG_TOPOLOGY_CLONE=0x00000002,
   DISPLAYCONFIG_TOPOLOGY_EXTEND=0x00000004,
   DISPLAYCONFIG_TOPOLOGY_EXTERNAL=0x00000008,
   DISPLAYCONFIG_TOPOLOGY_FORCE_UINT32=0xFFFFFFFF
  };
//---
enum DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY
  {
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_OTHER=-1,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_HD15=0,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_SVIDEO=1,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_COMPOSITE_VIDEO=2,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_COMPONENT_VIDEO=3,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_DVI=4,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_HDMI=5,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_LVDS=6,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_D_JPN=8,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_SDI=9,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_DISPLAYPORT_EXTERNAL=10,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_DISPLAYPORT_EMBEDDED=11,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_UDI_EXTERNAL=12,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_UDI_EMBEDDED=13,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_SDTVDONGLE=14,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_MIRACAST=15,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_INDIRECT_WIRED=16,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_INTERNAL=0x80000000,
   DISPLAYCONFIG_OUTPUT_TECHNOLOGY_FORCE_UINT32=0xFFFFFFFF
  };
//---
struct ABC
  {
   int               abcA;
   uint              abcB;
   int               abcC;
  };
//---
struct ABCFLOAT
  {
   float             abcfA;
   float             abcfB;
   float             abcfC;
  };
//---
struct AXISINFOW
  {
   int               axMinValue;
   int               axMaxValue;
   short             axAxisName[MM_MAX_AXES_NAMELEN];
  };
//---
struct AXESLISTW
  {
   uint              axlReserved;
   uint              axlNumAxes;
   AXISINFOW         axlAxisInfo[MM_MAX_NUMAXES];
  };
//---
struct BITMAP
  {
   int               bmType;
   int               bmWidth;
   int               bmHeight;
   int               bmWidthBytes;
   ushort            bmPlanes;
   ushort            bmBitsPixel;
   PVOID             bmBits;
  };
//---
struct BITMAPCOREHEADER
  {
   uint              bcSize;
   ushort            bcWidth;
   ushort            bcHeight;
   ushort            bcPlanes;
   ushort            bcBitCount;
  };
//---
struct BITMAPFILEHEADER
  {
   ushort            bfType;
   uint              bfSize;
   ushort            bfReserved1;
   ushort            bfReserved2;
   uint              bfOffBits;
  };
//---
struct RGBTRIPLE
  {
   uchar             rgbtBlue;
   uchar             rgbtGreen;
   uchar             rgbtRed;
  };
//---
struct BITMAPCOREINFO
  {
   BITMAPCOREHEADER  bmciHeader;
   RGBTRIPLE         bmciColors[1];
  };
//---
struct BITMAPINFOHEADER
  {
   uint              biSize;
   int               biWidth;
   int               biHeight;
   ushort            biPlanes;
   ushort            biBitCount;
   uint              biCompression;
   uint              biSizeImage;
   int               biXPelsPerMeter;
   int               biYPelsPerMeter;
   uint              biClrUsed;
   uint              biClrImportant;
  };
//---
struct RGBQUAD
  {
   uchar             rgbBlue;
   uchar             rgbGreen;
   uchar             rgbRed;
   uchar             rgbReserved;
  };
//---
struct BITMAPINFO
  {
   BITMAPINFOHEADER  bmiHeader;
   RGBQUAD           bmiColors[1];
  };
//---
struct CIEXYZ
  {
   int               ciexyzX;
   int               ciexyzY;
   int               ciexyzZ;
  };
//---
struct CIEXYZTRIPLE
  {
   CIEXYZ            ciexyzRed;
   CIEXYZ            ciexyzGreen;
   CIEXYZ            ciexyzBlue;
  };
//---
struct BITMAPV4HEADER
  {
   uint              bV4Size;
   int               bV4Width;
   int               bV4Height;
   ushort            bV4Planes;
   ushort            bV4BitCount;
   uint              bV4V4Compression;
   uint              bV4SizeImage;
   int               bV4XPelsPerMeter;
   int               bV4YPelsPerMeter;
   uint              bV4ClrUsed;
   uint              bV4ClrImportant;
   uint              bV4RedMask;
   uint              bV4GreenMask;
   uint              bV4BlueMask;
   uint              bV4AlphaMask;
   uint              bV4CSType;
   CIEXYZTRIPLE      bV4Endpoints;
   uint              bV4GammaRed;
   uint              bV4GammaGreen;
   uint              bV4GammaBlue;
  };
//---
struct BITMAPV5HEADER
  {
   uint              bV5Size;
   int               bV5Width;
   int               bV5Height;
   ushort            bV5Planes;
   ushort            bV5BitCount;
   uint              bV5Compression;
   uint              bV5SizeImage;
   int               bV5XPelsPerMeter;
   int               bV5YPelsPerMeter;
   uint              bV5ClrUsed;
   uint              bV5ClrImportant;
   uint              bV5RedMask;
   uint              bV5GreenMask;
   uint              bV5BlueMask;
   uint              bV5AlphaMask;
   uint              bV5CSType;
   CIEXYZTRIPLE      bV5Endpoints;
   uint              bV5GammaRed;
   uint              bV5GammaGreen;
   uint              bV5GammaBlue;
   uint              bV5Intent;
   uint              bV5ProfileData;
   uint              bV5ProfileSize;
   uint              bV5Reserved;
  };
//---
struct BLENDFUNCTION
  {
   uchar             BlendOp;
   uchar             BlendFlags;
   uchar             SourceConstantAlpha;
   uchar             AlphaFormat;
  };
//---
struct FONTSIGNATURE
  {
   uint              fsUsb[4];
   uint              fsCsb[2];
  };
//---
struct CHARSETINFO
  {
   uint              ciCharset;
   uint              ciACP;
   FONTSIGNATURE     fs;
  };
//---
struct COLORADJUSTMENT
  {
   ushort            caSize;
   ushort            caFlags;
   ushort            caIlluminantIndex;
   ushort            caRedGamma;
   ushort            caGreenGamma;
   ushort            caBlueGamma;
   ushort            caReferenceBlack;
   ushort            caReferenceWhite;
   short             caContrast;
   short             caBrightness;
   short             caColorfulness;
   short             caRedGreenTint;
  };
//---
struct DESIGNVECTOR
  {
   uint              dvReserved;
   uint              dvNumAxes;
   int               dvValues[MM_MAX_NUMAXES];
  };
//---
struct DIBSECTION
  {
   BITMAP            dsBm;
   BITMAPINFOHEADER  dsBmih;
   uint              dsBitfields[3];
   HANDLE            dshSection;
   uint              dsOffset;
  };
//---
struct DISPLAY_DEVICEA
  {
   uint              cb;
   char              DeviceName[32];
   char              DeviceString[128];
   uint              StateFlags;
   char              DeviceID[128];
   char              DeviceKey[128];
  };
//---
struct DISPLAY_DEVICEW
  {
   uint              cb;
   short             DeviceName[32];
   short             DeviceString[128];
   uint              StateFlags;
   short             DeviceID[128];
   short             DeviceKey[128];
  };
//---
struct DISPLAYCONFIG_2DREGION
  {
   uint              cx;
   uint              cy;
  };
//---
struct DISPLAYCONFIG_DEVICE_INFO_HEADER
  {
   DISPLAYCONFIG_DEVICE_INFO_TYPE type;
   uint              size;
   LUID              adapterId;
   uint              id;
  };
//---
struct DISPLAYCONFIG_ADAPTER_NAME
  {
   DISPLAYCONFIG_DEVICE_INFO_HEADER header;
   short             adapterDevicePath[128];
  };
//---
struct DISPLAYCONFIG_DESKTOP_IMAGE_INFO
  {
   POINTL            PathSourceSize;
   RECTL             DesktopImageRegion;
   RECTL             DesktopImageClip;
  };
//---
struct DISPLAYCONFIG_PATH_SOURCE_INFO
  {
   LUID              adapterId;
   uint              id;
   uint              modeInfoIdx;
   uint              statusFlags;
  };
//---
struct DISPLAYCONFIG_RATIONAL
  {
   uint              Numerator;
   uint              Denominator;
  };
//---
struct DISPLAYCONFIG_PATH_TARGET_INFO
  {
   LUID              adapterId;
   uint              id;
   uint              modeInfoIdx;
   DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY outputTechnology;
   DISPLAYCONFIG_ROTATION rotation;
   DISPLAYCONFIG_SCALING scaling;
   DISPLAYCONFIG_RATIONAL refreshRate;
   DISPLAYCONFIG_SCANLINE_ORDERING scanLineOrdering;
   int               targetAvailable;
   uint              statusFlags;
  };
//---
struct DISPLAYCONFIG_PATH_INFO
  {
   DISPLAYCONFIG_PATH_SOURCE_INFO sourceInfo;
   DISPLAYCONFIG_PATH_TARGET_INFO targetInfo;
   uint              flags;
  };
//---
struct DISPLAYCONFIG_SDR_WHITE_LEVEL
  {
   DISPLAYCONFIG_DEVICE_INFO_HEADER header;
   uint              SDRWhiteLevel;
  };
//---
struct DISPLAYCONFIG_SOURCE_DEVICE_NAME
  {
   DISPLAYCONFIG_DEVICE_INFO_HEADER header;
   short             viewGdiDeviceName[CCHDEVICENAME];
  };
//---
struct DISPLAYCONFIG_SOURCE_MODE
  {
   uint              width;
   uint              height;
   DISPLAYCONFIG_PIXELFORMAT pixelFormat;
   POINTL            position;
  };
//---
struct DISPLAYCONFIG_TARGET_BASE_TYPE
  {
   DISPLAYCONFIG_DEVICE_INFO_HEADER header;
   DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY baseOutputTechnology;
  };
//---
struct DISPLAYCONFIG_TARGET_DEVICE_NAME_FLAGS
  {
   uint              value;
  };
//---
struct DISPLAYCONFIG_TARGET_DEVICE_NAME
  {
   DISPLAYCONFIG_DEVICE_INFO_HEADER header;
   DISPLAYCONFIG_TARGET_DEVICE_NAME_FLAGS flags;
   DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY outputTechnology;
   ushort            edidManufactureId;
   ushort            edidProductCodeId;
   uint              connectorInstance;
   short             monitorFriendlyDeviceName[64];
   short             monitorDevicePath[128];
  };
//---
struct DISPLAYCONFIG_VIDEO_SIGNAL_INFO
  {
   ulong             pixelRate;
   DISPLAYCONFIG_RATIONAL hSyncFreq;
   DISPLAYCONFIG_RATIONAL vSyncFreq;
   DISPLAYCONFIG_2DREGION activeSize;
   DISPLAYCONFIG_2DREGION totalSize;
   uint              videoStandard;
   DISPLAYCONFIG_SCANLINE_ORDERING scanLineOrdering;
  };
//---
struct DISPLAYCONFIG_TARGET_MODE
  {
   DISPLAYCONFIG_VIDEO_SIGNAL_INFO targetVideoSignalInfo;
  };
//---
struct DISPLAYCONFIG_TARGET_PREFERRED_MODE
  {
   DISPLAYCONFIG_DEVICE_INFO_HEADER header;
   uint              width;
   uint              height;
   DISPLAYCONFIG_TARGET_MODE targetMode;
  };
//---
struct DOCINFOW
  {
   int               cbSize;
   const string      lpszDocName;
   const string      lpszOutput;
   const string      lpszDatatype;
   uint              fwType;
  };
//---
struct DRAWPATRECT
  {
   POINT             ptPosition;
   POINT             ptSize;
   ushort            wStyle;
   ushort            wPattern;
  };
//---
struct EMR
  {
   uint              iType;
   uint              nSize;
  };
//---
struct EMRABORTPATH
  {
   EMR               emr;
  };
//---
struct XFORM
  {
   float             eM11;
   float             eM12;
   float             eM21;
   float             eM22;
   float             eDx;
   float             eDy;
  };
//---
struct EMRALPHABLEND
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               cxDest;
   int               cyDest;
   uint              dwRop;
   int               xSrc;
   int               ySrc;
   XFORM             xformSrc;
   uint              crBkColorSrc;
   uint              iUsageSrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   int               cxSrc;
   int               cySrc;
  };
//---
struct EMRANGLEARC
  {
   EMR               emr;
   POINTL            ptlCenter;
   uint              nRadius;
   float             eStartAngle;
   float             eSweepAngle;
  };
//---
struct EMRARC
  {
   EMR               emr;
   RECTL             rclBox;
   POINTL            ptlStart;
   POINTL            ptlEnd;
  };
//---
struct EMRBITBLT
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               cxDest;
   int               cyDest;
   uint              dwRop;
   int               xSrc;
   int               ySrc;
   XFORM             xformSrc;
   uint              crBkColorSrc;
   uint              iUsageSrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
  };
//---
struct EMRCOLORCORRECTPALETTE
  {
   EMR               emr;
   uint              ihPalette;
   uint              nFirstEntry;
   uint              nPalEntries;
   uint              nReserved;
  };
//---
struct EMRCOLORMATCHTOTARGET
  {
   EMR               emr;
   uint              dwAction;
   uint              dwFlags;
   uint              cbName;
   uint              cbData;
   uchar             Data[1];
  };
//---
struct LOGBRUSH
  {
   uint              lbStyle;
   uint              lbColor;
   ulong             lbHatch;
  };
//---
struct EMRCREATEBRUSHINDIRECT
  {
   EMR               emr;
   uint              ihBrush;
   LOGBRUSH          lb;
  };
//---
struct LOGCOLORSPACEW
  {
   uint              lcsSignature;
   uint              lcsVersion;
   uint              lcsSize;
   int               lcsCSType;
   int               lcsIntent;
   CIEXYZTRIPLE      lcsEndpoints;
   uint              lcsGammaRed;
   uint              lcsGammaGreen;
   uint              lcsGammaBlue;
   short             lcsFilename[MAX_PATH];
  };
//---
struct EMRCREATECOLORSPACEW
  {
   EMR               emr;
   uint              ihCS;
   LOGCOLORSPACEW    lcs;
   uint              dwFlags;
   uint              cbData;
   uchar             Data[1];
  };
//---
struct EMRCREATEDIBPATTERNBRUSHPT
  {
   EMR               emr;
   uint              ihBrush;
   uint              iUsage;
   uint              offBmi;
   uint              cbBmi;
   uint              offBits;
   uint              cbBits;
  };
//---
struct EMRCREATEMONOBRUSH
  {
   EMR               emr;
   uint              ihBrush;
   uint              iUsage;
   uint              offBmi;
   uint              cbBmi;
   uint              offBits;
   uint              cbBits;
  };
//---
struct LOGPALETTE
  {
   ushort            palVersion;
   ushort            palNumEntries;
  };
//---
struct LOGPEN
  {
   uint              lopnStyle;
   POINT             lopnWidth;
   uint              lopnColor;
  };
//---
struct EMRCREATEPALETTE
  {
   EMR               emr;
   uint              ihPal;
   LOGPALETTE        lgpl;
  };
//---
struct EMRCREATEPEN
  {
   EMR               emr;
   uint              ihPen;
   LOGPEN            lopn;
  };
//---
struct EMRELLIPSE
  {
   EMR               emr;
   RECTL             rclBox;
  };
//---
struct EMREOF
  {
   EMR               emr;
   uint              nPalEntries;
   uint              offPalEntries;
   uint              nSizeLast;
  };
//---
struct EMREXCLUDECLIPRECT
  {
   EMR               emr;
   RECTL             rclClip;
  };
//---
struct LOGFONTW
  {
   int               lfHeight;
   int               lfWidth;
   int               lfEscapement;
   int               lfOrientation;
   int               lfWeight;
   uchar             lfItalic;
   uchar             lfUnderline;
   uchar             lfStrikeOut;
   uchar             lfCharSet;
   uchar             lfOutPrecision;
   uchar             lfClipPrecision;
   uchar             lfQuality;
   uchar             lfPitchAndFamily;
   short             lfFaceName[LF_FACESIZE];
  };
//---
struct PANOSE
  {
   uchar             bFamilyType;
   uchar             bSerifStyle;
   uchar             bWeight;
   uchar             bProportion;
   uchar             bContrast;
   uchar             bStrokeVariation;
   uchar             bArmStyle;
   uchar             bLetterform;
   uchar             bMidline;
   uchar             bXHeight;
  };
//---
struct EXTLOGFONTW
  {
   LOGFONTW          elfLogFont;
   short             elfFullName[LF_FULLFACESIZE];
   short             elfStyle[LF_FACESIZE];
   uint              elfVersion;
   uint              elfStyleSize;
   uint              elfMatch;
   uint              elfReserved;
   uchar             elfVendorId[ELF_VENDOR_SIZE];
   uint              elfCulture;
   PANOSE            elfPanose;
  };
//---
struct EMREXTCREATEFONTINDIRECTW
  {
   EMR               emr;
   uint              ihFont;
   EXTLOGFONTW       elfw;
  };
//---
struct EXTLOGPEN
  {
   uint              elpPenStyle;
   uint              elpWidth;
   uint              elpBrushStyle;
   uint              elpColor;
   ulong             elpHatch;
   uint              elpNumEntries;
   uint              elpStyleEntry[1];
  };
//---
struct EMREXTCREATEPEN
  {
   EMR               emr;
   uint              ihPen;
   uint              offBmi;
   uint              cbBmi;
   uint              offBits;
   uint              cbBits;
   EXTLOGPEN         elp;
  };
//---
struct EMREXTESCAPE
  {
   EMR               emr;
   int               iEscape;
   int               cbEscData;
   uchar             EscData[1];
  };
//---
struct EMREXTFLOODFILL
  {
   EMR               emr;
   POINTL            ptlStart;
   uint              crColor;
   uint              iMode;
  };
//---
struct EMREXTSELECTCLIPRGN
  {
   EMR               emr;
   uint              cbRgnData;
   uint              iMode;
   uchar             RgnData[1];
  };
//---
struct EMRTEXT
  {
   POINTL            ptlReference;
   uint              nChars;
   uint              offString;
   uint              fOptions;
   RECTL             rcl;
   uint              offDx;
  };
//---
struct EMREXTTEXTOUTA
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              iGraphicsMode;
   float             exScale;
   float             eyScale;
   EMRTEXT           emrtext;
  };
//---
struct EMRFILLPATH
  {
   EMR               emr;
   RECTL             rclBounds;
  };
//---
struct EMRFILLRGN
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cbRgnData;
   uint              ihBrush;
   uchar             RgnData[1];
  };
//---
struct EMRFORMAT
  {
   uint              dSignature;
   uint              nVersion;
   uint              cbData;
   uint              offData;
  };
//---
struct EMRFRAMERGN
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cbRgnData;
   uint              ihBrush;
   SIZE              szlStroke;
   uchar             RgnData[1];
  };
//---
struct EMRGDICOMMENT
  {
   EMR               emr;
   uint              cbData;
   uchar             Data[1];
  };
//---
struct EMRGLSBOUNDEDRECORD
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cbData;
   uchar             Data[1];
  };
//---
struct EMRGLSRECORD
  {
   EMR               emr;
   uint              cbData;
   uchar             Data[1];
  };
//---
struct PIXELFORMATDESCRIPTOR
  {
   ushort            nSize;
   ushort            nVersion;
   uint              dwFlags;
   uchar             iPixelType;
   uchar             cColorBits;
   uchar             cRedBits;
   uchar             cRedShift;
   uchar             cGreenBits;
   uchar             cGreenShift;
   uchar             cBlueBits;
   uchar             cBlueShift;
   uchar             cAlphaBits;
   uchar             cAlphaShift;
   uchar             cAccumBits;
   uchar             cAccumRedBits;
   uchar             cAccumGreenBits;
   uchar             cAccumBlueBits;
   uchar             cAccumAlphaBits;
   uchar             cDepthBits;
   uchar             cStencilBits;
   uchar             cAuxBuffers;
   uchar             iLayerType;
   uchar             bReserved;
   uint              dwLayerMask;
   uint              dwVisibleMask;
   uint              dwDamageMask;
  };
//---
struct TRIVERTEX
  {
   int               x;
   int               y;
   ushort            red;
   ushort            green;
   ushort            blue;
   ushort            alpha;
  };
//---
struct EMRGRADIENTFILL
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              nVer;
   uint              nTri;
   uint              ulMode;
   TRIVERTEX         Ver[1];
  };
//---
struct EMRINVERTRGN
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cbRgnData;
   uchar             RgnData[1];
  };
//---
struct EMRLINETO
  {
   EMR               emr;
   POINTL            ptl;
  };
//---
struct EMRMASKBLT
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               cxDest;
   int               cyDest;
   uint              dwRop;
   int               xSrc;
   int               ySrc;
   XFORM             xformSrc;
   uint              crBkColorSrc;
   uint              iUsageSrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   int               xMask;
   int               yMask;
   uint              iUsageMask;
   uint              offBmiMask;
   uint              cbBmiMask;
   uint              offBitsMask;
   uint              cbBitsMask;
  };
//---
struct EMRMODIFYWORLDTRANSFORM
  {
   EMR               emr;
   XFORM             xform;
   uint              iMode;
  };
//---
struct EMRNAMEDESCAPE
  {
   EMR               emr;
   int               iEscape;
   int               cbDriver;
   int               cbEscData;
   uchar             EscData[1];
  };
//---
struct EMROFFSETCLIPRGN
  {
   EMR               emr;
   POINTL            ptlOffset;
  };
//---
struct EMRPIXELFORMAT
  {
   EMR               emr;
   PIXELFORMATDESCRIPTOR pfd;
  };
//---
struct EMRPLGBLT
  {
   EMR               emr;
   RECTL             rclBounds;
   POINTL            aptlDest[3];
   int               xSrc;
   int               ySrc;
   int               cxSrc;
   int               cySrc;
   XFORM             xformSrc;
   uint              crBkColorSrc;
   uint              iUsageSrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   int               xMask;
   int               yMask;
   uint              iUsageMask;
   uint              offBmiMask;
   uint              cbBmiMask;
   uint              offBitsMask;
   uint              cbBitsMask;
  };
//---
struct EMRPOLYDRAW
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cptl;
   POINTL            aptl[1];
   uchar             abTypes[1];
  };
//---
struct EMRPOLYDRAW16
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cpts;
   POINTS            apts[1];
   uchar             abTypes[1];
  };
//---
struct EMRPOLYLINE
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cptl;
   POINTL            aptl[1];
  };
//---
struct EMRPOLYLINE16
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              cpts;
   POINTS            apts[1];
  };
//---
struct EMRPOLYPOLYLINE
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              nPolys;
   uint              cptl;
   uint              aPolyCounts[1];
   POINTL            aptl[1];
  };
//---
struct EMRPOLYPOLYLINE16
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              nPolys;
   uint              cpts;
   uint              aPolyCounts[1];
   POINTS            apts[1];
  };
//---
struct EMRPOLYTEXTOUTW
  {
   EMR               emr;
   RECTL             rclBounds;
   uint              iGraphicsMode;
   float             exScale;
   float             eyScale;
   int               cStrings;
   EMRTEXT           aemrtext[1];
  };
//---
struct EMRRESIZEPALETTE
  {
   EMR               emr;
   uint              ihPal;
   uint              cEntries;
  };
//---
struct EMRRESTOREDC
  {
   EMR               emr;
   int               iRelative;
  };
//---
struct EMRROUNDRECT
  {
   EMR               emr;
   RECTL             rclBox;
   SIZE              szlCorner;
  };
//---
struct EMRSCALEVIEWPORTEXTEX
  {
   EMR               emr;
   int               xNum;
   int               xDenom;
   int               yNum;
   int               yDenom;
  };
//---
struct EMRSELECTCLIPPATH
  {
   EMR               emr;
   uint              iMode;
  };
//---
struct EMRSELECTOBJECT
  {
   EMR               emr;
   uint              ihObject;
  };
//---
struct EMRSELECTPALETTE
  {
   EMR               emr;
   uint              ihPal;
  };
//---
struct EMRSETARCDIRECTION
  {
   EMR               emr;
   uint              iArcDirection;
  };
//---
struct EMRSETBKCOLOR
  {
   EMR               emr;
   uint              crColor;
  };
//---
struct EMRSETCOLORADJUSTMENT
  {
   EMR               emr;
   COLORADJUSTMENT   ColorAdjustment;
  };
//---
struct EMRSETCOLORSPACE
  {
   EMR               emr;
   uint              ihCS;
  };
//---
struct EMRSETDIBITSTODEVICE
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               xSrc;
   int               ySrc;
   int               cxSrc;
   int               cySrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   uint              iUsageSrc;
   uint              iStartScan;
   uint              cScans;
  };
//---
struct EMRSETICMPROFILE
  {
   EMR               emr;
   uint              dwFlags;
   uint              cbName;
   uint              cbData;
   uchar             Data[1];
  };
//---
struct EMRSETMAPPERFLAGS
  {
   EMR               emr;
   uint              dwFlags;
  };
//---
struct EMRSETMITERLIMIT
  {
   EMR               emr;
   float             eMiterLimit;
  };
//---
struct PALETTEENTRY
  {
   uchar             red;
   uchar             green;
   uchar             blue;
   uchar             flags;
  };
//---
struct EMRSETPALETTEENTRIES
  {
   EMR               emr;
   uint              ihPal;
   uint              iStart;
   uint              cEntries;
   PALETTEENTRY      aPalEntries[1];
  };
//---
struct EMRSETPIXELV
  {
   EMR               emr;
   POINTL            ptlPixel;
   uint              crColor;
  };
//---
struct EMRSETVIEWPORTEXTEX
  {
   EMR               emr;
   SIZE              szlExtent;
  };
//---
struct EMRSETVIEWPORTORGEX
  {
   EMR               emr;
   POINTL            ptlOrigin;
  };
//---
struct EMRSETWORLDTRANSFORM
  {
   EMR               emr;
   XFORM             xform;
  };
//---
struct EMRSTRETCHBLT
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               cxDest;
   int               cyDest;
   uint              dwRop;
   int               xSrc;
   int               ySrc;
   XFORM             xformSrc;
   uint              crBkColorSrc;
   uint              iUsageSrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   int               cxSrc;
   int               cySrc;
  };
//---
struct EMRSTRETCHDIBITS
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               xSrc;
   int               ySrc;
   int               cxSrc;
   int               cySrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   uint              iUsageSrc;
   uint              dwRop;
   int               cxDest;
   int               cyDest;
  };
//---
struct EMRTRANSPARENTBLT
  {
   EMR               emr;
   RECTL             rclBounds;
   int               xDest;
   int               yDest;
   int               cxDest;
   int               cyDest;
   uint              dwRop;
   int               xSrc;
   int               ySrc;
   XFORM             xformSrc;
   uint              crBkColorSrc;
   uint              iUsageSrc;
   uint              offBmiSrc;
   uint              cbBmiSrc;
   uint              offBitsSrc;
   uint              cbBitsSrc;
   int               cxSrc;
   int               cySrc;
  };
//---
struct ENHMETAHEADER
  {
   uint              iType;
   uint              nSize;
   RECTL             rclBounds;
   RECTL             rclFrame;
   uint              dSignature;
   uint              nVersion;
   uint              nBytes;
   uint              nRecords;
   ushort            nHandles;
   ushort            sReserved;
   uint              nDescription;
   uint              offDescription;
   uint              nPalEntries;
   SIZE              szlDevice;
   SIZE              szlMillimeters;
   uint              cbPixelFormat;
   uint              offPixelFormat;
   uint              bOpenGL;
   SIZE              szlMicrometers;
  };
//---
struct ENHMETARECORD
  {
   uint              iType;
   uint              nSize;
   uint              dParm[1];
  };
//---
struct ENUMLOGFONTEXW
  {
   LOGFONTW          elfLogFont;
   short             elfFullName[LF_FULLFACESIZE];
   short             elfStyle[LF_FACESIZE];
   short             elfScript[LF_FACESIZE];
  };
//---
struct ENUMLOGFONTEXDVW
  {
   ENUMLOGFONTEXW    elfEnumLogfontEx;
   DESIGNVECTOR      elfDesignVector;
  };
//---
struct ENUMLOGFONTW
  {
   LOGFONTW          elfLogFont;
   short             elfFullName[LF_FULLFACESIZE];
   short             elfStyle[LF_FACESIZE];
  };
//---
struct NEWTEXTMETRICW
  {
   int               tmHeight;
   int               tmAscent;
   int               tmDescent;
   int               tmInternalLeading;
   int               tmExternalLeading;
   int               tmAveCharWidth;
   int               tmMaxCharWidth;
   int               tmWeight;
   int               tmOverhang;
   int               tmDigitizedAspectX;
   int               tmDigitizedAspectY;
   short             tmFirstChar;
   short             tmLastChar;
   short             tmDefaultChar;
   short             tmBreakChar;
   uchar             tmItalic;
   uchar             tmUnderlined;
   uchar             tmStruckOut;
   uchar             tmPitchAndFamily;
   uchar             tmCharSet;
   uint              ntmFlags;
   uint              ntmSizeEM;
   uint              ntmCellHeight;
   uint              ntmAvgWidth;
  };
//---
struct NEWTEXTMETRICEXW
  {
   NEWTEXTMETRICW    ntmTm;
   FONTSIGNATURE     ntmFontSig;
  };
//---
struct ENUMTEXTMETRICW
  {
   NEWTEXTMETRICEXW  etmNewTextMetricEx;
   AXESLISTW         etmAxesList;
  };
//---
struct FIXED
  {
   ushort            fract;
   short             value;
  };
//---
struct POINTFLOAT
  {
   float             x;
   float             y;
  };
//---
struct GCP_RESULTSW
  {
   uint              lStructSize;
   string            lpOutString;
   PVOID             lpOrder;    
   PVOID             lpDx;       
   PVOID             lpCaretPos; 
   PVOID             lpClass;    
   PVOID             lpGlyphs;
   uint              nGlyphs;
   int               nMaxFit;
  };
//---
struct GLYPHMETRICS
  {
   uint              gmBlackBoxX;
   uint              gmBlackBoxY;
   POINT             gmptGlyphOrigin;
   short             gmCellIncX;
   short             gmCellIncY;
  };
//---
struct GLYPHMETRICSFLOAT
  {
   float             gmfBlackBoxX;
   float             gmfBlackBoxY;
   POINTFLOAT        gmfptGlyphOrigin;
   float             gmfCellIncX;
   float             gmfCellIncY;
  };
//---
struct WCRANGE
  {
   short             wcLow;
   ushort            cGlyphs;
  };
//---
struct GLYPHSET
  {
   uint              cbThis;
   uint              flAccel;
   uint              cGlyphsSupported;
   uint              cRanges;
   WCRANGE           ranges[1];
  };
//---
struct GRADIENT_RECT
  {
   uint              UpperLeft;
   uint              LowerRight;
  };
//---
struct GRADIENT_TRIANGLE
  {
   uint              Vertex1;
   uint              Vertex2;
   uint              Vertex3;
  };
//---
struct HANDLETABLE
  {
   PVOID             objectHandle[1];
  };
//---
struct KERNINGPAIR
  {
   ushort            wFirst;
   ushort            wSecond;
   int               iKernAmount;
  };
//---
struct LAYERPLANEDESCRIPTOR
  {
   ushort            nSize;
   ushort            nVersion;
   uint              dwFlags;
   uchar             iPixelType;
   uchar             cColorBits;
   uchar             cRedBits;
   uchar             cRedShift;
   uchar             cGreenBits;
   uchar             cGreenShift;
   uchar             cBlueBits;
   uchar             cBlueShift;
   uchar             cAlphaBits;
   uchar             cAlphaShift;
   uchar             cAccumBits;
   uchar             cAccumRedBits;
   uchar             cAccumGreenBits;
   uchar             cAccumBlueBits;
   uchar             cAccumAlphaBits;
   uchar             cDepthBits;
   uchar             cStencilBits;
   uchar             cAuxBuffers;
   uchar             iLayerPlane;
   uchar             bReserved;
   uint              crTransparent;
  };
//---
struct LOCALESIGNATURE
  {
   uint              lsUsb[4];
   uint              lsCsbDefault[2];
   uint              lsCsbSupported[2];
  };
//---
struct MAT2
  {
   FIXED             eM11;
   FIXED             eM12;
   FIXED             eM21;
   FIXED             eM22;
  };
//---
struct METAFILEPICT
  {
   int               mm;
   int               xExt;
   int               yExt;
   HANDLE            hMF;
  };
//---
struct METAHEADER
  {
   ushort            mtType;
   ushort            mtHeaderSize;
   ushort            mtVersion;
   uint              mtSize;
   ushort            mtNoObjects;
   uint              mtMaxRecord;
   ushort            mtNoParameters;
  };
//---
struct METARECORD
  {
   uint              rdSize;
   ushort            rdFunction;
   ushort            rdParm[1];
  };
//---
struct TEXTMETRICW
  {
   int               tmHeight;
   int               tmAscent;
   int               tmDescent;
   int               tmInternalLeading;
   int               tmExternalLeading;
   int               tmAveCharWidth;
   int               tmMaxCharWidth;
   int               tmWeight;
   int               tmOverhang;
   int               tmDigitizedAspectX;
   int               tmDigitizedAspectY;
   short             tmFirstChar;
   short             tmLastChar;
   short             tmDefaultChar;
   short             tmBreakChar;
   uchar             tmItalic;
   uchar             tmUnderlined;
   uchar             tmStruckOut;
   uchar             tmPitchAndFamily;
   uchar             tmCharSet;
  };
//---
struct OUTLINETEXTMETRICW
  {
   uint              otmSize;
   TEXTMETRICW       otmTextMetrics;
   uchar             otmFiller;
   PANOSE            otmPanoseNumber;
   uint              otmfsSelection;
   uint              otmfsType;
   int               otmsCharSlopeRise;
   int               otmsCharSlopeRun;
   int               otmItalicAngle;
   uint              otmEMSquare;
   int               otmAscent;
   int               otmDescent;
   uint              otmLineGap;
   uint              otmsCapEmHeight;
   uint              otmsXHeight;
   RECT              otmrcFontBox;
   int               otmMacAscent;
   int               otmMacDescent;
   uint              otmMacLineGap;
   uint              otmusMinimumPPEM;
   POINT             otmptSubscriptSize;
   POINT             otmptSubscriptOffset;
   POINT             otmptSuperscriptSize;
   POINT             otmptSuperscriptOffset;
   uint              otmsStrikeoutSize;
   int               otmsStrikeoutPosition;
   int               otmsUnderscoreSize;
   int               otmsUnderscorePosition;
   PVOID             otmpFamilyName;   //char              otmpFamilyName[];
   PVOID             otmpFaceName;     //char              otmpFaceName[];
   PVOID             otmpStyleName;    //char              otmpStyleName[];
   PVOID             otmpFullName;     //char              otmpFullName[];
  };
//---
struct PELARRAY
  {
   int               paXCount;
   int               paYCount;
   int               paXExt;
   int               paYExt;
   uchar             paRGBs;
  };
//---
struct POINTFX
  {
   FIXED             x;
   FIXED             y;
  };
//---
struct POLYTEXTW
  {
   int               x;
   int               y;
   uint              n;
   const string      lpstr;
   uint              uiFlags;
   RECT              rcl;
   PVOID             pdx;
  };
//---
struct PSFEATURE_CUSTPAPER
  {
   int               lOrientation;
   int               lWidth;
   int               lHeight;
   int               lWidthOffset;
   int               lHeightOffset;
  };
//---
struct PSFEATURE_OUTPUT
  {
   int               bPageIndependent;
   int               bSetPageDevice;
  };
//---
struct PSINJECTDATA
  {
   uint              DataBytes;
   ushort            InjectionPoint;
   ushort            PageNumber;
  };
//---
struct RASTERIZER_STATUS
  {
   short             nSize;
   short             wFlags;
   short             nLanguageID;
  };
//---
struct RGNDATAHEADER
  {
   uint              dwSize;
   uint              iType;
   uint              nCount;
   uint              nRgnSize;
   RECT              rcBound;
  };
//---
struct RGNDATA
  {
   RGNDATAHEADER     rdh;
   char              Buffer[1];
  };
//---
struct TTPOLYCURVE
  {
   ushort            wType;
   ushort            cpfx;
   POINTFX           apfx[1];
  };
//---
struct TTPOLYGONHEADER
  {
   uint              cb;
   uint              dwType;
   POINTFX           pfxStart;
  };
//---
struct DEVMODEW
  {
   short             dmDeviceName[CCHDEVICENAME];
   ushort            dmSpecVersion;
   ushort            dmDriverVersion;
   ushort            dmSize;
   ushort            dmDriverExtra;
   uint              dmFields;
   short             dmOrientation;
   short             dmPaperSize;
   short             dmPaperLength;
   short             dmPaperWidth;
   short             dmScale;
   short             dmCopies;
   short             dmDefaultSource;
   short             dmPrintQuality;
   short             dmColor;
   short             dmDuplex;
   short             dmYResolution;
   short             dmTTOption;
   short             dmCollate;
   short             dmFormName[CCHFORMNAME];
   ushort            dmLogPixels;
   uint              dmBitsPerPel;
   uint              dmPelsWidth;
   uint              dmPelsHeight;
   uint              dmDisplayFlags;
   uint              dmDisplayFrequency;
   uint              dmICMMethod;
   uint              dmICMIntent;
   uint              dmMediaType;
   uint              dmDitherType;
   uint              dmReserved1;
   uint              dmReserved2;
   uint              dmPanningWidth;
   uint              dmPanningHeight;
  };
//---
struct WGLSWAP
  {
   HANDLE            hdc;
   uint              uiFlags;
  };
//---
union DISPLAYCONFIG_MODE
  {
   DISPLAYCONFIG_TARGET_MODE targetMode;
   DISPLAYCONFIG_SOURCE_MODE sourceMode;
   DISPLAYCONFIG_DESKTOP_IMAGE_INFO desktopImageInfo;
  };
//---
struct DISPLAYCONFIG_MODE_INFO
  {
   DISPLAYCONFIG_MODE_INFO_TYPE infoType;
   uint              id;
   LUID              adapterId;
   DISPLAYCONFIG_MODE mode;
  };
//+------------------------------------------------------------------+
//|                                                                  |
//+------------------------------------------------------------------+
#import "gdi32.dll"
int          AbortDoc(HANDLE hdc);
int          AbortPath(HANDLE hdc);
HANDLE       AddFontMemResourceEx(PVOID file_view,uint size,PVOID resrved,uint &num_fonts);
int          AddFontResourceExW(const string name,uint fl,PVOID res);
int          AddFontResourceW(string);
int          AngleArc(HANDLE hdc,int x,int y,uint r,float StartAngle,float SweepAngle);
int          AnimatePalette(HANDLE pal,uint start_index,uint entries,PALETTEENTRY &ppe);
int          Arc(HANDLE hdc,int x1,int y1,int x2,int y2,int x3,int y3,int x4,int y4);
int          ArcTo(HANDLE hdc,int left,int top,int right,int bottom,int xr1,int yr1,int xr2,int yr2);
int          BeginPath(HANDLE hdc);
int          BitBlt(HANDLE hdc,int x,int y,int cx,int cy,HANDLE src,int x1,int y1,uint rop);
int          CancelDC(HANDLE hdc);
int          CheckColorsInGamut(HANDLE hdc,RGBTRIPLE &lpRGBTriple,PVOID buffer,uint count);
int          ChoosePixelFormat(HANDLE hdc,PIXELFORMATDESCRIPTOR &ppfd);
int          Chord(HANDLE hdc,int x1,int y1,int x2,int y2,int x3,int y3,int x4,int y4);
HANDLE       CloseEnhMetaFile(HANDLE hdc);
int          CloseFigure(HANDLE hdc);
HANDLE       CloseMetaFile(HANDLE hdc);
int          ColorCorrectPalette(HANDLE hdc,HANDLE pal,uint first,uint num);
int          ColorMatchToTarget(HANDLE hdc,HANDLE target,uint action);
int          CombineRgn(HANDLE dst,HANDLE src1,HANDLE src2,int mode);
int          CombineTransform(XFORM &out,XFORM &lpxf1,XFORM &lpxf2);
HANDLE       CopyEnhMetaFileW(HANDLE enh,const string file_name);
HANDLE       CopyMetaFileW(HANDLE,string LPCWSTR);
HANDLE       CreateBitmap(int width,int height,uint planes,uint bit_count,PVOID bits);
HANDLE       CreateBitmap(int width,int height,uint planes,uint bit_count,char &bits[]);
HANDLE       CreateBitmapIndirect(BITMAP &pbm);
HANDLE       CreateBrushIndirect(LOGBRUSH &plbrush);
HANDLE       CreateColorSpaceW(LOGCOLORSPACEW &lplcs);
HANDLE       CreateCompatibleBitmap(HANDLE hdc,int cx,int cy);
HANDLE       CreateCompatibleDC(HANDLE hdc);
HANDLE       CreateDCW(const string driver,const string device,const string port,DEVMODEW &pdm);
HANDLE       CreateDIBitmap(HANDLE hdc,BITMAPINFOHEADER &pbmih,uint init,PVOID bits,BITMAPINFO &pbmi,uint usage);
HANDLE       CreateDIBPatternBrush(HANDLE h,uint usage);
HANDLE       CreateDIBPatternBrushPt(PVOID lpPackedDIB,uint usage);
HANDLE       CreateDIBSection(HANDLE hdc,BITMAPINFO &pbmi,uint usage,PVOID bits,HANDLE section,uint offset);
HANDLE       CreateDiscardableBitmap(HANDLE hdc,int cx,int cy);
HANDLE       CreateEllipticRgn(int x1,int y1,int x2,int y2);
HANDLE       CreateEllipticRgnIndirect(RECT &lprect);
HANDLE       CreateEnhMetaFileW(HANDLE hdc,const string filename,RECT &lprc,const string desc);
HANDLE       CreateFontIndirectExW(ENUMLOGFONTEXDVW &);
HANDLE       CreateFontIndirectW(LOGFONTW &lplf);
HANDLE       CreateFontW(int height,int width,int escapement,int orientation,int weight,uint italic,uint underline,uint strike_out,uint char_set,uint out_precision,uint clip_precision,uint quality,uint pitch_and_family,const string face_name);
HANDLE       CreateHalftonePalette(HANDLE hdc);
HANDLE       CreateHatchBrush(int hatch,uint clr);
HANDLE       CreateICW(const string driver,const string device,const string port,DEVMODEW &pdm);
HANDLE       CreateMetaFileW(const string file);
HANDLE       CreatePalette(LOGPALETTE &plpal);
HANDLE       CreatePatternBrush(HANDLE hbm);
HANDLE       CreatePen(int style,int width,uint clr);
HANDLE       CreatePenIndirect(LOGPEN &plpen);
HANDLE       CreatePolygonRgn(POINT &pptl[],int point,int mode);
HANDLE       CreatePolyPolygonRgn(const POINT &pptl[],const int &pc[],int poly,int mode);
HANDLE       CreateRectRgn(int x1,int y1,int x2,int y2);
HANDLE       CreateRectRgnIndirect(RECT &lprect);
HANDLE       CreateRoundRectRgn(int x1,int y1,int x2,int y2,int w,int h);
int          CreateScalableFontResourceW(uint hidden,const string font,const string file,const string path);
HANDLE       CreateSolidBrush(uint clr);
int          DeleteColorSpace(HANDLE hcs);
int          DeleteDC(HANDLE hdc);
int          DeleteEnhMetaFile(HANDLE hmf);
int          DeleteMetaFile(HANDLE hmf);
int          DeleteObject(PVOID ho);
int          DescribePixelFormat(HANDLE hdc,int pixel_format,uint bytes,PIXELFORMATDESCRIPTOR &ppfd);
int          DPtoLP(HANDLE hdc,POINT &lppt,int c);
int          DrawEscape(HANDLE hdc,int escape,int in,uchar &in[]);
int          Ellipse(HANDLE hdc,int left,int top,int right,int bottom);
int          EndDoc(HANDLE hdc);
int          EndPage(HANDLE hdc);
int          EndPath(HANDLE hdc);
int          EnumEnhMetaFile(HANDLE hdc,HANDLE hmf,PVOID proc,PVOID param,RECT &rect);
int          EnumFontFamiliesExW(HANDLE hdc,LOGFONTW &logfont,PVOID proc,PVOID param,uint flags);
int          EnumFontFamiliesW(HANDLE hdc,const string logfont,PVOID proc,PVOID param);
int          EnumFontsW(HANDLE hdc,const string logfont,PVOID proc,PVOID param);
int          EnumICMProfilesW(HANDLE hdc,PVOID proc,PVOID param);
int          EnumMetaFile(HANDLE hdc,HANDLE hmf,PVOID proc,PVOID param);
int          EnumObjects(HANDLE hdc,int type,PVOID func,PVOID param);
int          EqualRgn(HANDLE hrgn1,HANDLE hrgn2);
int          Escape(HANDLE hdc,int escape,int in,uchar &in[],PVOID out);
int          ExcludeClipRect(HANDLE hdc,int left,int top,int right,int bottom);
HANDLE       ExtCreatePen(uint pen_style,uint width,LOGBRUSH &plbrush,uint style,const uint &pstyle[]);
HANDLE       ExtCreateRegion(XFORM &lpx,uint count,RGNDATA &data);
int          ExtEscape(HANDLE hdc,int escape,int inp,uchar &in_data[],int output,uchar &out_data[]);
int          ExtFloodFill(HANDLE hdc,int x,int y,uint clr,uint type);
int          ExtSelectClipRgn(HANDLE hdc,HANDLE hrgn,int mode);
int          ExtTextOutW(HANDLE hdc,int x,int y,uint options,const RECT &lprect,const string str,uint c,const int &dx[]);
int          FillPath(HANDLE hdc);
int          FillRgn(HANDLE hdc,HANDLE hrgn,HANDLE hbr);
int          FixBrushOrgEx(HANDLE hdc,int x,int y,POINT &ptl);
int          FlattenPath(HANDLE hdc);
int          FloodFill(HANDLE hdc,int x,int y,uint clr);
int          FrameRgn(HANDLE hdc,HANDLE hrgn,HANDLE hbr,int w,int h);
int          GdiAlphaBlend(HANDLE dest,int dest,int dest,int dest,int dest,HANDLE src,int src,int src,int src,int src,BLENDFUNCTION &ftn);
int          GdiComment(HANDLE hdc,uint size,const uchar &data[]);
int          GdiFlush(void);
uint         GdiGetBatchLimit(void);
int          GdiGradientFill(HANDLE hdc,TRIVERTEX &vertex,uint vertex,PVOID mesh,uint count,uint mode);
uint         GdiSetBatchLimit(uint dw);
int          GdiTransparentBlt(HANDLE dest,int dest,int dest,int dest,int dest,HANDLE src,int src,int src,int src,int src,uint transparent);
int          GetArcDirection(HANDLE hdc);
int          GetAspectRatioFilterEx(HANDLE hdc,SIZE &lpsize);
int          GetBitmapBits(HANDLE hbit,int cb,PVOID bits);
int          GetBitmapDimensionEx(HANDLE hbit,SIZE &lpsize);
uint         GetBkColor(HANDLE hdc);
int          GetBkMode(HANDLE hdc);
uint         GetBoundsRect(HANDLE hdc,RECT &lprect,uint flags);
int          GetBrushOrgEx(HANDLE hdc,POINT &lppt);
int          GetCharABCWidthsFloatW(HANDLE hdc,uint first,uint last,ABCFLOAT &lpABC[]);
int          GetCharABCWidthsI(HANDLE hdc,uint first,uint cgi,ushort &pgi[],ABC &pabc[]);
int          GetCharABCWidthsW(HANDLE hdc,uint first,uint last,ABC &lpABC[]);
uint         GetCharacterPlacementW(HANDLE hdc,const string str,int count,int mex_extent,GCP_RESULTSW &results,uint flags);
int          GetCharWidthFloatW(HANDLE hdc,uint first,uint last,float &buffer[]);
int          GetCharWidthI(HANDLE hdc,uint first,uint cgi,ushort &pgi[],int &widths[]);
int          GetCharWidthW(HANDLE hdc,uint first,uint last,int &buffer[]);
int          GetClipBox(HANDLE hdc,RECT &lprect);
int          GetClipRgn(HANDLE hdc,HANDLE hrgn);
int          GetColorAdjustment(HANDLE hdc,COLORADJUSTMENT &lpca);
HANDLE       GetColorSpace(HANDLE hdc);
PVOID        GetCurrentObject(HANDLE hdc,uint type);
int          GetCurrentPositionEx(HANDLE hdc,POINT &lppt);
uint         GetDCBrushColor(HANDLE hdc);
int          GetDCOrgEx(HANDLE hdc,POINT &lppt);
uint         GetDCPenColor(HANDLE hdc);
int          GetDeviceCaps(HANDLE hdc,int index);
int          GetDeviceGammaRamp(HANDLE hdc,PVOID ramp);
int          GetDeviceGammaRamp(HANDLE hdc,ushort &ramp[]);
uint         GetDIBColorTable(HANDLE hdc,uint start,uint entries,RGBQUAD &prgbq[]);
int          GetDIBits(HANDLE hdc,HANDLE hbm,uint start,uint lines,PVOID bits,BITMAPINFO &lpbmi,uint usage);
uint         GetEnhMetaFileBits(HANDLE hEMF,uint size,uchar &data[]);
uint         GetEnhMetaFileDescriptionW(HANDLE hemf,uint buffer,string description);
uint         GetEnhMetaFileHeader(HANDLE hemf,uint size,ENHMETAHEADER &enh_meta_header);
uint         GetEnhMetaFilePaletteEntries(HANDLE hemf,uint num_entries,PALETTEENTRY &palette_entries);
uint         GetEnhMetaFilePixelFormat(HANDLE hemf,uint buffer,PIXELFORMATDESCRIPTOR &ppfd);
HANDLE       GetEnhMetaFileW(const string name);
uint         GetFontData(HANDLE hdc,uint table,uint offset,PVOID buffer,uint buffer);
uint         GetFontLanguageInfo(HANDLE hdc);
uint         GetFontUnicodeRanges(HANDLE hdc,PVOID lpgs);
uint         GetFontUnicodeRanges(HANDLE hdc,GLYPHSET &lpgs);
uint         GetGlyphIndicesW(HANDLE hdc,const string lpstr,int c,ushort &pgi[],uint fl);
uint         GetGlyphOutlineW(HANDLE hdc,uint symbol,uint format,GLYPHMETRICS &lpgm,uint buffer,PVOID buffer,MAT2 &lpmat2);
int          GetGraphicsMode(HANDLE hdc);
int          GetICMProfileW(HANDLE hdc,uint &buf_size,ushort &filename[]);
uint         GetKerningPairsW(HANDLE hdc,uint pairs,KERNINGPAIR &kern_pair);
uint         GetLayout(HANDLE hdc);
int          GetLogColorSpaceW(HANDLE color_space,LOGCOLORSPACEW &buffer,uint size);
int          GetMapMode(HANDLE hdc);
uint         GetMetaFileBitsEx(HANDLE hMF,uint buffer,PVOID data);
HANDLE       GetMetaFileW(const string name);
int          GetMetaRgn(HANDLE hdc,HANDLE hrgn);
int          GetMiterLimit(HANDLE hdc,float &plimit);
uint         GetNearestColor(HANDLE hdc,uint clr);
uint         GetNearestPaletteIndex(HANDLE h,uint clr);
uint         GetObjectType(PVOID h);
int          GetObjectW(HANDLE h,int c,PVOID pv);
uint         GetOutlineTextMetricsW(HANDLE hdc,uint copy,OUTLINETEXTMETRICW &potm);
uint         GetPaletteEntries(HANDLE hpal,uint start,uint entries,PALETTEENTRY &pal_entries);
int          GetPath(HANDLE hdc,POINT &apt,uchar &aj,int cpt);
uint         GetPixel(HANDLE hdc,int x,int y);
int          GetPixelFormat(HANDLE hdc);
int          GetPolyFillMode(HANDLE hdc);
int          GetRandomRgn(HANDLE hdc,HANDLE hrgn,int i);
int          GetRasterizerCaps(RASTERIZER_STATUS &lpraststat,uint bytes);
uint         GetRegionData(HANDLE hrgn,uint count,RGNDATA &rgn_data);
uint         GetRegionData(HANDLE hrgn,uint count,PVOID rgn_data);
int          GetRgnBox(HANDLE hrgn,RECT &lprc);
int          GetROP2(HANDLE hdc);
PVOID        GetStockObject(int i);
int          GetStretchBltMode(HANDLE hdc);
uint         GetSystemPaletteEntries(HANDLE hdc,uint start,uint entries,PALETTEENTRY &pal_entries);
uint         GetSystemPaletteUse(HANDLE hdc);
uint         GetTextAlign(HANDLE hdc);
int          GetTextCharacterExtra(HANDLE hdc);
int          GetTextCharset(HANDLE hdc);
int          GetTextCharsetInfo(HANDLE hdc,FONTSIGNATURE &sig,uint flags);
uint         GetTextColor(HANDLE hdc);
int          GetTextExtentExPointI(HANDLE hdc,ushort &str[],int str_size,int max_extent,int &fit,int &dx[],SIZE &size);
int          GetTextExtentExPointW(HANDLE hdc,const string str,int str,int max_extent,int &fit,int &dx[],SIZE &size);
int          GetTextExtentPoint32W(HANDLE hdc,const string str,int c,SIZE &psizl);
int          GetTextExtentPointI(HANDLE hdc,ushort &in[],int cgi,SIZE &psize);
int          GetTextExtentPointW(HANDLE hdc,const string str,int c,SIZE &lpsz);
int          GetTextFaceW(HANDLE hdc,int c,ushort &name[]);
int          GetTextMetricsW(HANDLE hdc,TEXTMETRICW &lptm);
int          GetViewportExtEx(HANDLE hdc,SIZE &lpsize);
int          GetViewportOrgEx(HANDLE hdc,POINT &lppoint);
int          GetWindowExtEx(HANDLE hdc,SIZE &lpsize);
int          GetWindowOrgEx(HANDLE hdc,POINT &lppoint);
uint         GetWinMetaFileBits(HANDLE hemf,uint data16,uchar &data16,int map_mode,HANDLE ref);
int          GetWorldTransform(HANDLE hdc,XFORM &lpxf);
int          IntersectClipRect(HANDLE hdc,int left,int top,int right,int bottom);
int          InvertRgn(HANDLE hdc,HANDLE hrgn);
int          LineTo(HANDLE hdc,int x,int y);
int          LPtoDP(HANDLE hdc,POINT &lppt[],int c);
int          MaskBlt(HANDLE dest,int dest,int dest,int width,int height,HANDLE src,int src,int src,HANDLE mask,int mask,int mask,uint rop);
int          ModifyWorldTransform(HANDLE hdc,XFORM &lpxf,uint mode);
int          MoveToEx(HANDLE hdc,int x,int y,POINT &lppt);
int          OffsetClipRgn(HANDLE hdc,int x,int y);
int          OffsetRgn(HANDLE hrgn,int x,int y);
int          OffsetViewportOrgEx(HANDLE hdc,int x,int y,POINT &lppt);
int          OffsetWindowOrgEx(HANDLE hdc,int x,int y,POINT &lppt);
int          PaintRgn(HANDLE hdc,HANDLE hrgn);
int          PatBlt(HANDLE hdc,int x,int y,int w,int h,uint rop);
HANDLE       PathToRegion(HANDLE hdc);
int          Pie(HANDLE hdc,int left,int top,int right,int bottom,int xr1,int yr1,int xr2,int yr2);
int          PlayEnhMetaFile(HANDLE hdc,HANDLE hmf,RECT &lprect);
int          PlayEnhMetaFileRecord(HANDLE hdc,HANDLETABLE &pht,ENHMETARECORD &pmr,uint cht);
int          PlayMetaFile(HANDLE hdc,HANDLE hmf);
int          PlayMetaFileRecord(HANDLE hdc,HANDLETABLE &handle_table,METARECORD &lpMR,uint objs);
int          PlgBlt(HANDLE dest,POINT &point,HANDLE src,int src,int src,int width,int height,HANDLE mask,int mask,int mask);
int          PolyBezier(HANDLE hdc,POINT &apt,uint cpt);
int          PolyBezierTo(HANDLE hdc,POINT &apt,uint cpt);
int          PolyDraw(HANDLE hdc,const POINT &apt,const uchar &aj[],int cpt);
int          Polygon(HANDLE hdc,const POINT &apt,int cpt);
int          Polyline(HANDLE hdc,const POINT &apt,int cpt);
int          PolylineTo(HANDLE hdc,const POINT &apt,uint cpt);
int          PolyPolygon(HANDLE hdc,const POINT &apt,int &asz[],int csz);
int          PolyPolyline(HANDLE hdc,const POINT &apt,uint &asz[],uint csz);
int          PolyTextOutW(HANDLE hdc,POLYTEXTW &ppt,int nstrings);
int          PtInRegion(HANDLE hrgn,int x,int y);
int          PtVisible(HANDLE hdc,int x,int y);
uint         RealizePalette(HANDLE hdc);
int          Rectangle(HANDLE hdc,int left,int top,int right,int bottom);
int          RectInRegion(HANDLE hrgn,RECT &lprect);
int          RectVisible(HANDLE hdc,RECT &lprect);
int          RemoveFontMemResourceEx(HANDLE h);
int          RemoveFontResourceExW(const string name,uint fl,PVOID pdv);
int          RemoveFontResourceW(const string file_name);
HANDLE       ResetDCW(HANDLE hdc,DEVMODEW &lpdm);
int          ResizePalette(HANDLE hpal,uint n);
int          RestoreDC(HANDLE hdc,int nSavedDC);
int          RoundRect(HANDLE hdc,int left,int top,int right,int bottom,int width,int height);
int          SaveDC(HANDLE hdc);
int          ScaleViewportExtEx(HANDLE hdc,int xn,int dx,int yn,int yd,SIZE &lpsz);
int          ScaleWindowExtEx(HANDLE hdc,int xn,int xd,int yn,int yd,SIZE &lpsz);
int          SelectClipPath(HANDLE hdc,int mode);
int          SelectClipRgn(HANDLE hdc,HANDLE hrgn);
PVOID        SelectObject(HANDLE hdc,PVOID h);
HANDLE       SelectPalette(HANDLE hdc,HANDLE pal,int force_bkgd);
int          SetAbortProc(HANDLE hdc,PVOID proc);
int          SetArcDirection(HANDLE hdc,int dir);
int          SetBitmapBits(HANDLE hbm,uint cb,const uchar &bits[]);
int          SetBitmapDimensionEx(HANDLE hbm,int w,int h,SIZE &lpsz);
uint         SetBkColor(HANDLE hdc,uint clr);
int          SetBkMode(HANDLE hdc,int mode);
uint         SetBoundsRect(HANDLE hdc,RECT &lprect,uint flags);
int          SetBrushOrgEx(HANDLE hdc,int x,int y,POINT &lppt);
int          SetColorAdjustment(HANDLE hdc,COLORADJUSTMENT &lpca);
HANDLE       SetColorSpace(HANDLE hdc,HANDLE hcs);
uint         SetDCBrushColor(HANDLE hdc,uint clr);
uint         SetDCPenColor(HANDLE hdc,uint clr);
int          SetDeviceGammaRamp(HANDLE hdc,PVOID ramp);
uint         SetDIBColorTable(HANDLE hdc,uint start,uint entries,RGBQUAD &prgbq);
int          SetDIBits(HANDLE hdc,HANDLE hbm,uint start,uint lines,PVOID bits,BITMAPINFO &lpbmi,uint ColorUse);
int          SetDIBitsToDevice(HANDLE hdc,int dest,int dest,uint w,uint h,int src,int src,uint StartScan,uint lines,PVOID bits,BITMAPINFO &lpbmi,uint ColorUse);
HANDLE       SetEnhMetaFileBits(uint size,const uchar &pb[]);
int          SetGraphicsMode(HANDLE hdc,int mode);
int          SetICMMode(HANDLE hdc,int mode);
int          SetICMProfileW(HANDLE hdc,string file_name);
uint         SetLayout(HANDLE hdc,uint l);
int          SetMapMode(HANDLE hdc,int mode);
uint         SetMapperFlags(HANDLE hdc,uint flags);
HANDLE       SetMetaFileBitsEx(uint buffer,const uchar &data[]);
int          SetMetaRgn(HANDLE hdc);
int          SetMiterLimit(HANDLE hdc,float limit,float &old);
uint         SetPaletteEntries(HANDLE hpal,uint start,uint entries,PALETTEENTRY &pal_entries);
uint         SetPixel(HANDLE hdc,int x,int y,uint clr);
int          SetPixelFormat(HANDLE hdc,int format,PIXELFORMATDESCRIPTOR &ppfd);
int          SetPixelV(HANDLE hdc,int x,int y,uint clr);
int          SetPolyFillMode(HANDLE hdc,int mode);
int          SetRectRgn(HANDLE hrgn,int left,int top,int right,int bottom);
int          SetROP2(HANDLE hdc,int rop2);
int          SetStretchBltMode(HANDLE hdc,int mode);
uint         SetSystemPaletteUse(HANDLE hdc,uint use);
uint         SetTextAlign(HANDLE hdc,uint align);
int          SetTextCharacterExtra(HANDLE hdc,int extra);
uint         SetTextColor(HANDLE hdc,uint clr);
int          SetTextJustification(HANDLE hdc,int extra,int count);
int          SetViewportExtEx(HANDLE hdc,int x,int y,SIZE &lpsz);
int          SetViewportOrgEx(HANDLE hdc,int x,int y,POINT &lppt);
int          SetWindowExtEx(HANDLE hdc,int x,int y,SIZE &lpsz);
int          SetWindowOrgEx(HANDLE hdc,int x,int y,POINT &lppt);
HANDLE       SetWinMetaFileBits(uint size,const uchar &lpMeta16Data[],HANDLE ref,const METAFILEPICT &lpMFP);
int          SetWorldTransform(HANDLE hdc,XFORM &lpxf);
int          StartDocW(HANDLE hdc,DOCINFOW &lpdi);
int          StartPage(HANDLE hdc);
int          StretchBlt(HANDLE dest,int dest,int dest,int dest,int dest,HANDLE src,int src,int src,int src,int src,uint rop);
int          StretchDIBits(HANDLE hdc,int dest,int dest,int DestWidth,int DestHeight,int src,int src,int SrcWidth,int SrcHeight,PVOID bits,BITMAPINFO &lpbmi,uint usage,uint rop);
int          StrokeAndFillPath(HANDLE hdc);
int          StrokePath(HANDLE hdc);
int          SwapBuffers(HANDLE);
int          TextOutW(HANDLE hdc,int x,int y,const string str,int c);
int          TranslateCharsetInfo(PVOID src,CHARSETINFO &cs,uint flags);
int          UnrealizeObject(PVOID h);
int          UpdateColors(HANDLE hdc);
int          UpdateICMRegKeyW(uint reserved,string lpszCMID,string file_name,uint command);
int          WidenPath(HANDLE hdc);
#import

#import "Opengl32.dll"
int          wglCopyContext(HANDLE,HANDLE,uint);
HANDLE       wglCreateContext(HANDLE);
HANDLE       wglCreateLayerContext(HANDLE,int);
int          wglDeleteContext(HANDLE);
int          wglDescribeLayerPlane(HANDLE,int,int,uint,LAYERPLANEDESCRIPTOR &);
HANDLE       wglGetCurrentContext(void);
HANDLE       wglGetCurrentDC(void);
int          wglGetLayerPaletteEntries(HANDLE,int,int,int,const uint &[]);
PVOID        wglGetProcAddress(string);
int          wglMakeCurrent(HANDLE,HANDLE);
int          wglRealizeLayerPalette(HANDLE,int,int);
int          wglSetLayerPaletteEntries(HANDLE,int,int,int,const uint &[]);
int          wglShareLists(HANDLE,HANDLE);
int          wglSwapLayerBuffers(HANDLE,uint);
uint         wglSwapMultipleBuffers(uint,WGLSWAP &);
int          wglUseFontBitmapsW(HANDLE,uint,uint,uint);
int          wglUseFontOutlinesW(HANDLE,uint,uint,uint,float,float,int,GLYPHMETRICSFLOAT &);
#import
//+------------------------------------------------------------------+-e 

